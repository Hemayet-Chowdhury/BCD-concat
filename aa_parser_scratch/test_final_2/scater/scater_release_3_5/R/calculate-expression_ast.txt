<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="71" start="132" end="202">## A set of functions for calculating and summarising expression values</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="77" start="394" end="470">#' Calculate which features are expressed in which cells using a threshold on</COMMENT>
  <COMMENT line1="4" col1="1" line2="4" col2="73" start="525" end="597">#' observed counts, transcripts-per-million, counts-per-million, FPKM, or</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="29" start="656" end="684">#' defined expression levels.</COMMENT>
  <COMMENT line1="6" col1="1" line2="6" col2="2" start="787" end="788">#'</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="68" start="918" end="985">#' @param object an SCESet object with expression and/or count data.</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="80" start="1049" end="1128">#' @param lowerDetectionLimit numeric scalar giving the minimum expression level</COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="74" start="1180" end="1253">#' for an expression observation in a cell for it to qualify as expressed.</COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="73" start="1311" end="1383">#' @param exprs_values character scalar indicating whether the count data</COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="71" start="1442" end="1512">#' (\code{"counts"}), the transformed expression data (\code{"exprs"}),</COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="78" start="1573" end="1650">#' transcript-per-million (\code{"tpm"}), counts-per-million (\code{"cpm"}) or</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="79" start="1704" end="1782">#' FPKM (\code{"fpkm"}) should be used to define if an observation is expressed</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="72" start="1835" end="1906">#' or not. Defaults to the first available value of those options in the</COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="15" start="1966" end="1980">#' order shown.</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="79" start="2097" end="2175">#' @return a logical matrix indicating whether or not a feature in a particular</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="21" start="2228" end="2248">#' cell is expressed.</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="10" start="2359" end="2368">#' @export</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="12" start="2490" end="2501">#' @examples</COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="28" start="2621" end="2648">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="31" start="2752" end="2782">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="59" start="2883" end="2941">#' example_sceset &lt;- newSCESet(countData=sc_example_counts)</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="83" start="3014" end="3096">#' is_exprs(example_sceset) &lt;- calcIsExprs(example_sceset, lowerDetectionLimit = 1,</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="26" start="3145" end="3170">#' exprs_values = "exprs")</COMMENT>
  <expr line1="25" col1="1" line2="43" col2="1" start="3276" end="5634">
    <expr line1="25" col1="1" line2="25" col2="11" start="3276" end="3286">
      <SYMBOL line1="25" col1="1" line2="25" col2="11" start="3276" end="3286">calcIsExprs</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="25" col1="13" line2="25" col2="14" start="3288" end="3289">&lt;-</LEFT_ASSIGN>
    <expr line1="25" col1="16" line2="43" col2="1" start="3291" end="5634">
      <FUNCTION line1="25" col1="16" line2="25" col2="23" start="3291" end="3298">function</FUNCTION>
      <OP-LEFT-PAREN line1="25" col1="24" line2="25" col2="24" start="3299" end="3299">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="25" col1="25" line2="25" col2="30" start="3300" end="3305">object</SYMBOL_FORMALS>
      <OP-COMMA line1="25" col1="31" line2="25" col2="31" start="3306" end="3306">,</OP-COMMA>
      <SYMBOL_FORMALS line1="25" col1="33" line2="25" col2="51" start="3308" end="3326">lowerDetectionLimit</SYMBOL_FORMALS>
      <EQ_FORMALS line1="25" col1="53" line2="25" col2="53" start="3328" end="3328">=</EQ_FORMALS>
      <expr line1="25" col1="55" line2="25" col2="58" start="3330" end="3333">
        <NULL_CONST line1="25" col1="55" line2="25" col2="58" start="3330" end="3333">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="25" col1="59" line2="25" col2="59" start="3334" end="3334">,</OP-COMMA>
      <SYMBOL_FORMALS line1="25" col1="61" line2="25" col2="72" start="3336" end="3347">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="25" col1="74" line2="25" col2="74" start="3349" end="3349">=</EQ_FORMALS>
      <expr line1="25" col1="76" line2="25" col2="79" start="3351" end="3354">
        <NULL_CONST line1="25" col1="76" line2="25" col2="79" start="3351" end="3354">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="25" col1="80" line2="25" col2="80" start="3355" end="3355">)</OP-RIGHT-PAREN>
      <expr line1="26" col1="1" line2="43" col2="1" start="3407" end="5634">
        <OP-LEFT-BRACE line1="26" col1="1" line2="26" col2="1" start="3407" end="3407">{</OP-LEFT-BRACE>
        <expr line1="27" col1="5" line2="28" col2="41" start="3542" end="3709">
          <IF line1="27" col1="5" line2="27" col2="6" start="3542" end="3543">if</IF>
          <OP-LEFT-PAREN line1="27" col1="8" line2="27" col2="8" start="3545" end="3545">(</OP-LEFT-PAREN>
          <expr line1="27" col1="10" line2="27" col2="30" start="3547" end="3567">
            <OP-EXCLAMATION line1="27" col1="10" line2="27" col2="10" start="3547" end="3547">!</OP-EXCLAMATION>
            <expr line1="27" col1="11" line2="27" col2="30" start="3548" end="3567">
              <expr line1="27" col1="11" line2="27" col2="12" start="3548" end="3549">
                <SYMBOL_FUNCTION_CALL line1="27" col1="11" line2="27" col2="12" start="3548" end="3549">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="27" col1="13" line2="27" col2="13" start="3550" end="3550">(</OP-LEFT-PAREN>
              <expr line1="27" col1="14" line2="27" col2="19" start="3551" end="3556">
                <SYMBOL line1="27" col1="14" line2="27" col2="19" start="3551" end="3556">object</SYMBOL>
              </expr>
              <OP-COMMA line1="27" col1="20" line2="27" col2="20" start="3557" end="3557">,</OP-COMMA>
              <expr line1="27" col1="22" line2="27" col2="29" start="3559" end="3566">
                <STR_CONST line1="27" col1="22" line2="27" col2="29" start="3559" end="3566">"SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="27" col1="30" line2="27" col2="30" start="3567" end="3567">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="27" col1="32" line2="27" col2="32" start="3569" end="3569">)</OP-RIGHT-PAREN>
          <expr line1="28" col1="9" line2="28" col2="41" start="3677" end="3709">
            <expr line1="28" col1="9" line2="28" col2="12" start="3677" end="3680">
              <SYMBOL_FUNCTION_CALL line1="28" col1="9" line2="28" col2="12" start="3677" end="3680">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="28" col1="13" line2="28" col2="13" start="3681" end="3681">(</OP-LEFT-PAREN>
            <expr line1="28" col1="14" line2="28" col2="40" start="3682" end="3708">
              <STR_CONST line1="28" col1="14" line2="28" col2="40" start="3682" end="3708">"Object must be an SCESet."</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="28" col1="41" line2="28" col2="41" start="3709" end="3709">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="30" col1="5" line2="30" col2="38" start="3935" end="3968">## Check that args are appropriate</COMMENT>
        <expr line1="31" col1="5" line2="31" col2="55" start="4066" end="4116">
          <expr line1="31" col1="5" line2="31" col2="16" start="4066" end="4077">
            <SYMBOL line1="31" col1="5" line2="31" col2="16" start="4066" end="4077">exprs_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="31" col1="18" line2="31" col2="19" start="4079" end="4080">&lt;-</LEFT_ASSIGN>
          <expr line1="31" col1="21" line2="31" col2="55" start="4082" end="4116">
            <expr line1="31" col1="21" line2="31" col2="33" start="4082" end="4094">
              <SYMBOL_FUNCTION_CALL line1="31" col1="21" line2="31" col2="33" start="4082" end="4094">.exprs_hunter</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="31" col1="34" line2="31" col2="34" start="4095" end="4095">(</OP-LEFT-PAREN>
            <expr line1="31" col1="35" line2="31" col2="40" start="4096" end="4101">
              <SYMBOL line1="31" col1="35" line2="31" col2="40" start="4096" end="4101">object</SYMBOL>
            </expr>
            <OP-COMMA line1="31" col1="41" line2="31" col2="41" start="4102" end="4102">,</OP-COMMA>
            <expr line1="31" col1="43" line2="31" col2="54" start="4104" end="4115">
              <SYMBOL line1="31" col1="43" line2="31" col2="54" start="4104" end="4115">exprs_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="31" col1="55" line2="31" col2="55" start="4116" end="4116">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="32" col1="5" line2="32" col2="66" start="4197" end="4258">
          <expr line1="32" col1="5" line2="32" col2="14" start="4197" end="4206">
            <SYMBOL line1="32" col1="5" line2="32" col2="14" start="4197" end="4206">dat_matrix</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="32" col1="16" line2="32" col2="17" start="4208" end="4209">&lt;-</LEFT_ASSIGN>
          <expr line1="32" col1="19" line2="32" col2="66" start="4211" end="4258">
            <expr line1="32" col1="19" line2="32" col2="27" start="4211" end="4219">
              <SYMBOL_FUNCTION_CALL line1="32" col1="19" line2="32" col2="27" start="4211" end="4219">get_exprs</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="32" col1="28" line2="32" col2="28" start="4220" end="4220">(</OP-LEFT-PAREN>
            <expr line1="32" col1="29" line2="32" col2="34" start="4221" end="4226">
              <SYMBOL line1="32" col1="29" line2="32" col2="34" start="4221" end="4226">object</SYMBOL>
            </expr>
            <OP-COMMA line1="32" col1="35" line2="32" col2="35" start="4227" end="4227">,</OP-COMMA>
            <expr line1="32" col1="37" line2="32" col2="48" start="4229" end="4240">
              <SYMBOL line1="32" col1="37" line2="32" col2="48" start="4229" end="4240">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="32" col1="49" line2="32" col2="49" start="4241" end="4241">,</OP-COMMA>
            <SYMBOL_SUB line1="32" col1="51" line2="32" col2="57" start="4243" end="4249">warning</SYMBOL_SUB>
            <EQ_SUB line1="32" col1="59" line2="32" col2="59" start="4251" end="4251">=</EQ_SUB>
            <expr line1="32" col1="61" line2="32" col2="65" start="4253" end="4257">
              <NUM_CONST line1="32" col1="61" line2="32" col2="65" start="4253" end="4257">FALSE</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="32" col1="66" line2="32" col2="66" start="4258" end="4258">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="34" col1="5" line2="34" col2="50" start="4459" end="4504">## Extract lowerDetectionLimit if not provided</COMMENT>
        <expr line1="35" col1="5" line2="36" col2="57" start="4590" end="4773">
          <IF line1="35" col1="5" line2="35" col2="6" start="4590" end="4591">if</IF>
          <OP-LEFT-PAREN line1="35" col1="8" line2="35" col2="8" start="4593" end="4593">(</OP-LEFT-PAREN>
          <expr line1="35" col1="10" line2="35" col2="37" start="4595" end="4622">
            <expr line1="35" col1="10" line2="35" col2="16" start="4595" end="4601">
              <SYMBOL_FUNCTION_CALL line1="35" col1="10" line2="35" col2="16" start="4595" end="4601">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="35" col1="17" line2="35" col2="17" start="4602" end="4602">(</OP-LEFT-PAREN>
            <expr line1="35" col1="18" line2="35" col2="36" start="4603" end="4621">
              <SYMBOL line1="35" col1="18" line2="35" col2="36" start="4603" end="4621">lowerDetectionLimit</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="35" col1="37" line2="35" col2="37" start="4622" end="4622">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="35" col1="39" line2="35" col2="39" start="4624" end="4624">)</OP-RIGHT-PAREN>
          <expr line1="36" col1="9" line2="36" col2="57" start="4725" end="4773">
            <expr line1="36" col1="9" line2="36" col2="27" start="4725" end="4743">
              <SYMBOL line1="36" col1="9" line2="36" col2="27" start="4725" end="4743">lowerDetectionLimit</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="36" col1="29" line2="36" col2="30" start="4745" end="4746">&lt;-</LEFT_ASSIGN>
            <expr line1="36" col1="32" line2="36" col2="57" start="4748" end="4773">
              <expr line1="36" col1="32" line2="36" col2="37" start="4748" end="4753">
                <SYMBOL line1="36" col1="32" line2="36" col2="37" start="4748" end="4753">object</SYMBOL>
              </expr>
              <OP-AT line1="36" col1="38" line2="36" col2="38" start="4754" end="4754">@</OP-AT>
              <SLOT line1="36" col1="39" line2="36" col2="57" start="4755" end="4773">lowerDetectionLimit</SLOT>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="38" col1="5" line2="38" col2="76" start="4983" end="5054">## Decide which observations are above detection limit and return matrix</COMMENT>
        <expr line1="39" col1="5" line2="39" col2="47" start="5114" end="5156">
          <expr line1="39" col1="5" line2="39" col2="11" start="5114" end="5120">
            <SYMBOL line1="39" col1="5" line2="39" col2="11" start="5114" end="5120">isexprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="39" col1="13" line2="39" col2="14" start="5122" end="5123">&lt;-</LEFT_ASSIGN>
          <expr line1="39" col1="16" line2="39" col2="47" start="5125" end="5156">
            <expr line1="39" col1="16" line2="39" col2="25" start="5125" end="5134">
              <SYMBOL line1="39" col1="16" line2="39" col2="25" start="5125" end="5134">dat_matrix</SYMBOL>
            </expr>
            <GT line1="39" col1="27" line2="39" col2="27" start="5136" end="5136">&gt;</GT>
            <expr line1="39" col1="29" line2="39" col2="47" start="5138" end="5156">
              <SYMBOL line1="39" col1="29" line2="39" col2="47" start="5138" end="5156">lowerDetectionLimit</SYMBOL>
            </expr>
          </expr>
        </expr>
        <expr line1="40" col1="5" line2="40" col2="45" start="5245" end="5285">
          <expr line1="40" col1="5" line2="40" col2="21" start="5245" end="5261">
            <expr line1="40" col1="5" line2="40" col2="12" start="5245" end="5252">
              <SYMBOL_FUNCTION_CALL line1="40" col1="5" line2="40" col2="12" start="5245" end="5252">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="40" col1="13" line2="40" col2="13" start="5253" end="5253">(</OP-LEFT-PAREN>
            <expr line1="40" col1="14" line2="40" col2="20" start="5254" end="5260">
              <SYMBOL line1="40" col1="14" line2="40" col2="20" start="5254" end="5260">isexprs</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="40" col1="21" line2="40" col2="21" start="5261" end="5261">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="40" col1="23" line2="40" col2="24" start="5263" end="5264">&lt;-</LEFT_ASSIGN>
          <expr line1="40" col1="26" line2="40" col2="45" start="5266" end="5285">
            <expr line1="40" col1="26" line2="40" col2="33" start="5266" end="5273">
              <SYMBOL_FUNCTION_CALL line1="40" col1="26" line2="40" col2="33" start="5266" end="5273">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="40" col1="34" line2="40" col2="34" start="5274" end="5274">(</OP-LEFT-PAREN>
            <expr line1="40" col1="35" line2="40" col2="44" start="5275" end="5284">
              <SYMBOL line1="40" col1="35" line2="40" col2="44" start="5275" end="5284">dat_matrix</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="40" col1="45" line2="40" col2="45" start="5285" end="5285">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="41" col1="5" line2="41" col2="45" start="5376" end="5416">
          <expr line1="41" col1="5" line2="41" col2="21" start="5376" end="5392">
            <expr line1="41" col1="5" line2="41" col2="12" start="5376" end="5383">
              <SYMBOL_FUNCTION_CALL line1="41" col1="5" line2="41" col2="12" start="5376" end="5383">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="41" col1="13" line2="41" col2="13" start="5384" end="5384">(</OP-LEFT-PAREN>
            <expr line1="41" col1="14" line2="41" col2="20" start="5385" end="5391">
              <SYMBOL line1="41" col1="14" line2="41" col2="20" start="5385" end="5391">isexprs</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="41" col1="21" line2="41" col2="21" start="5392" end="5392">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="41" col1="23" line2="41" col2="24" start="5394" end="5395">&lt;-</LEFT_ASSIGN>
          <expr line1="41" col1="26" line2="41" col2="45" start="5397" end="5416">
            <expr line1="41" col1="26" line2="41" col2="33" start="5397" end="5404">
              <SYMBOL_FUNCTION_CALL line1="41" col1="26" line2="41" col2="33" start="5397" end="5404">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="41" col1="34" line2="41" col2="34" start="5405" end="5405">(</OP-LEFT-PAREN>
            <expr line1="41" col1="35" line2="41" col2="44" start="5406" end="5415">
              <SYMBOL line1="41" col1="35" line2="41" col2="44" start="5406" end="5415">dat_matrix</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="41" col1="45" line2="41" col2="45" start="5416" end="5416">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="42" col1="5" line2="42" col2="11" start="5507" end="5513">
          <SYMBOL line1="42" col1="5" line2="42" col2="11" start="5507" end="5513">isexprs</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="43" col1="1" line2="43" col2="1" start="5634" end="5634">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="45" col1="1" line2="45" col2="47" start="5896" end="5942">#' Count the number of expressed genes per cell</COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="2" start="6027" end="6028">#'</COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="2" start="6158" end="6159">#'</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="40" start="6289" end="6328">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="49" col1="1" line2="49" col2="89" start="6420" end="6508">#' @param lowerDetectionLimit numeric scalar providing the value above which observations</COMMENT>
  <COMMENT line1="50" col1="1" line2="50" col2="77" start="6551" end="6627">#' are deemed to be expressed. Defaults to \code{object@lowerDetectionLimit}.</COMMENT>
  <COMMENT line1="51" col1="1" line2="51" col2="73" start="6682" end="6754">#' @param exprs_values character scalar indicating whether the count data</COMMENT>
  <COMMENT line1="52" col1="1" line2="52" col2="71" start="6813" end="6883">#' (\code{"counts"}), the transformed expression data (\code{"exprs"}),</COMMENT>
  <COMMENT line1="53" col1="1" line2="53" col2="78" start="6944" end="7021">#' transcript-per-million (\code{"tpm"}), counts-per-million (\code{"cpm"}) or</COMMENT>
  <COMMENT line1="54" col1="1" line2="54" col2="79" start="7075" end="7153">#' FPKM (\code{"fpkm"}) should be used to define if an observation is expressed</COMMENT>
  <COMMENT line1="55" col1="1" line2="55" col2="72" start="7206" end="7277">#' or not. Defaults to the first available value of those options in the</COMMENT>
  <COMMENT line1="56" col1="1" line2="56" col2="74" start="7337" end="7410">#' order shown. However, if \code{is_exprs(object)} is present, it will be</COMMENT>
  <COMMENT line1="57" col1="1" line2="57" col2="81" start="7468" end="7548">#' used directly; \code{exprs_values} and \code{lowerDetectionLimit} are ignored.</COMMENT>
  <COMMENT line1="58" col1="1" line2="58" col2="76" start="7599" end="7674">#' @param byrow logical scalar indicating if \code{TRUE} to count expressing</COMMENT>
  <COMMENT line1="59" col1="1" line2="59" col2="72" start="7730" end="7801">#' cells per feature (i.e. gene) and if \code{FALSE} to count expressing</COMMENT>
  <COMMENT line1="60" col1="1" line2="60" col2="34" start="7861" end="7894">#' features (i.e. genes) per cell.</COMMENT>
  <COMMENT line1="61" col1="1" line2="61" col2="78" start="7992" end="8069">#' @param subset_row logical, integeror character vector indicating which rows</COMMENT>
  <COMMENT line1="62" col1="1" line2="62" col2="72" start="8123" end="8194">#' (i.e. features/genes) to use when calculating the number of expressed</COMMENT>
  <COMMENT line1="63" col1="1" line2="63" col2="50" start="8254" end="8303">#' features in each cell, when \code{byrow=FALSE}.</COMMENT>
  <COMMENT line1="64" col1="1" line2="64" col2="82" start="8385" end="8466">#' @param subset_col logical, integer or character vector indicating which columns</COMMENT>
  <COMMENT line1="65" col1="1" line2="65" col2="77" start="8516" end="8592">#' (i.e., cells) to use to calculate the number of cells expressing each gene</COMMENT>
  <COMMENT line1="66" col1="1" line2="66" col2="26" start="8647" end="8672">#' when \code{byrow=TRUE}.</COMMENT>
  <COMMENT line1="67" col1="1" line2="67" col2="2" start="8778" end="8779">#'</COMMENT>
  <COMMENT line1="68" col1="1" line2="68" col2="80" start="8909" end="8988">#' @description An efficient internal function that avoids the need to construct</COMMENT>
  <COMMENT line1="69" col1="1" line2="69" col2="80" start="9040" end="9119">#' 'is_exprs_mat' by counting the number of expressed genes per cell on the fly.</COMMENT>
  <COMMENT line1="70" col1="1" line2="70" col2="2" start="9171" end="9172">#'</COMMENT>
  <COMMENT line1="71" col1="1" line2="71" col2="75" start="9302" end="9376">#' @return a numeric vector of the same length as the number of features if</COMMENT>
  <COMMENT line1="72" col1="1" line2="72" col2="76" start="9433" end="9508">#' \code{byrow} argument is \code{TRUE} and the same length as the number of</COMMENT>
  <COMMENT line1="73" col1="1" line2="73" col2="40" start="9564" end="9603">#' cells if \code{byrow} is \code{FALSE}</COMMENT>
  <COMMENT line1="74" col1="1" line2="74" col2="2" start="9695" end="9696">#'</COMMENT>
  <COMMENT line1="75" col1="1" line2="75" col2="10" start="9826" end="9835">#' @export</COMMENT>
  <COMMENT line1="76" col1="1" line2="76" col2="12" start="9957" end="9968">#' @examples</COMMENT>
  <COMMENT line1="77" col1="1" line2="77" col2="28" start="10088" end="10115">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="78" col1="1" line2="78" col2="31" start="10219" end="10249">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="79" col1="1" line2="79" col2="61" start="10350" end="10410">#' pd &lt;- new("AnnotatedDataFrame", data=sc_example_cell_info)</COMMENT>
  <COMMENT line1="80" col1="1" line2="80" col2="26" start="10481" end="10506">#' rownames(pd) &lt;- pd$Cell</COMMENT>
  <COMMENT line1="81" col1="1" line2="81" col2="73" start="10612" end="10684">#' example_sceset &lt;- newSCESet(countData=sc_example_counts, phenoData=pd)</COMMENT>
  <COMMENT line1="82" col1="1" line2="82" col2="31" start="10743" end="10773">#' nexprs(example_sceset)[1:10]</COMMENT>
  <COMMENT line1="83" col1="1" line2="83" col2="45" start="10874" end="10918">#' nexprs(example_sceset, byrow = TRUE)[1:10]</COMMENT>
  <COMMENT line1="84" col1="1" line2="84" col2="2" start="11005" end="11006">#'</COMMENT>
  <expr line1="85" col1="1" line2="149" col2="1" start="11136" end="19520">
    <expr line1="85" col1="1" line2="85" col2="6" start="11136" end="11141">
      <SYMBOL line1="85" col1="1" line2="85" col2="6" start="11136" end="11141">nexprs</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="85" col1="8" line2="85" col2="9" start="11143" end="11144">&lt;-</LEFT_ASSIGN>
    <expr line1="85" col1="11" line2="149" col2="1" start="11146" end="19520">
      <FUNCTION line1="85" col1="11" line2="85" col2="18" start="11146" end="11153">function</FUNCTION>
      <OP-LEFT-PAREN line1="85" col1="19" line2="85" col2="19" start="11154" end="11154">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="85" col1="20" line2="85" col2="25" start="11155" end="11160">object</SYMBOL_FORMALS>
      <OP-COMMA line1="85" col1="26" line2="85" col2="26" start="11161" end="11161">,</OP-COMMA>
      <SYMBOL_FORMALS line1="85" col1="28" line2="85" col2="46" start="11163" end="11181">lowerDetectionLimit</SYMBOL_FORMALS>
      <EQ_FORMALS line1="85" col1="48" line2="85" col2="48" start="11183" end="11183">=</EQ_FORMALS>
      <expr line1="85" col1="50" line2="85" col2="53" start="11185" end="11188">
        <NULL_CONST line1="85" col1="50" line2="85" col2="53" start="11185" end="11188">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="85" col1="54" line2="85" col2="54" start="11189" end="11189">,</OP-COMMA>
      <SYMBOL_FORMALS line1="85" col1="56" line2="85" col2="67" start="11191" end="11202">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="85" col1="69" line2="85" col2="69" start="11204" end="11204">=</EQ_FORMALS>
      <expr line1="85" col1="71" line2="85" col2="74" start="11206" end="11209">
        <NULL_CONST line1="85" col1="71" line2="85" col2="74" start="11206" end="11209">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="85" col1="75" line2="85" col2="75" start="11210" end="11210">,</OP-COMMA>
      <SYMBOL_FORMALS line1="85" col1="77" line2="85" col2="81" start="11212" end="11216">byrow</SYMBOL_FORMALS>
      <EQ_FORMALS line1="85" col1="83" line2="85" col2="83" start="11218" end="11218">=</EQ_FORMALS>
      <expr line1="85" col1="85" line2="85" col2="89" start="11220" end="11224">
        <NUM_CONST line1="85" col1="85" line2="85" col2="89" start="11220" end="11224">FALSE</NUM_CONST>
      </expr>
      <OP-COMMA line1="85" col1="90" line2="85" col2="90" start="11225" end="11225">,</OP-COMMA>
      <SYMBOL_FORMALS line1="85" col1="92" line2="85" col2="101" start="11227" end="11236">subset_row</SYMBOL_FORMALS>
      <EQ_FORMALS line1="85" col1="103" line2="85" col2="103" start="11238" end="11238">=</EQ_FORMALS>
      <expr line1="85" col1="105" line2="85" col2="108" start="11240" end="11243">
        <NULL_CONST line1="85" col1="105" line2="85" col2="108" start="11240" end="11243">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="85" col1="109" line2="85" col2="109" start="11244" end="11244">,</OP-COMMA>
      <SYMBOL_FORMALS line1="85" col1="111" line2="85" col2="120" start="11246" end="11255">subset_col</SYMBOL_FORMALS>
      <EQ_FORMALS line1="85" col1="122" line2="85" col2="122" start="11257" end="11257">=</EQ_FORMALS>
      <expr line1="85" col1="124" line2="85" col2="127" start="11259" end="11262">
        <NULL_CONST line1="85" col1="124" line2="85" col2="127" start="11259" end="11262">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="85" col1="128" line2="85" col2="128" start="11263" end="11263">)</OP-RIGHT-PAREN>
      <expr line1="85" col1="130" line2="149" col2="1" start="11265" end="19520">
        <OP-LEFT-BRACE line1="85" col1="130" line2="85" col2="130" start="11265" end="11265">{</OP-LEFT-BRACE>
        <expr line1="86" col1="5" line2="88" col2="5" start="11271" end="11533">
          <IF line1="86" col1="5" line2="86" col2="6" start="11271" end="11272">if</IF>
          <OP-LEFT-PAREN line1="86" col1="8" line2="86" col2="8" start="11274" end="11274">(</OP-LEFT-PAREN>
          <expr line1="86" col1="9" line2="86" col2="29" start="11275" end="11295">
            <OP-EXCLAMATION line1="86" col1="9" line2="86" col2="9" start="11275" end="11275">!</OP-EXCLAMATION>
            <expr line1="86" col1="10" line2="86" col2="29" start="11276" end="11295">
              <expr line1="86" col1="10" line2="86" col2="11" start="11276" end="11277">
                <SYMBOL_FUNCTION_CALL line1="86" col1="10" line2="86" col2="11" start="11276" end="11277">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="86" col1="12" line2="86" col2="12" start="11278" end="11278">(</OP-LEFT-PAREN>
              <expr line1="86" col1="13" line2="86" col2="18" start="11279" end="11284">
                <SYMBOL line1="86" col1="13" line2="86" col2="18" start="11279" end="11284">object</SYMBOL>
              </expr>
              <OP-COMMA line1="86" col1="19" line2="86" col2="19" start="11285" end="11285">,</OP-COMMA>
              <expr line1="86" col1="21" line2="86" col2="28" start="11287" end="11294">
                <STR_CONST line1="86" col1="21" line2="86" col2="28" start="11287" end="11294">"SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="86" col1="29" line2="86" col2="29" start="11295" end="11295">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="86" col1="30" line2="86" col2="30" start="11296" end="11296">)</OP-RIGHT-PAREN>
          <expr line1="86" col1="32" line2="88" col2="5" start="11298" end="11533">
            <OP-LEFT-BRACE line1="86" col1="32" line2="86" col2="32" start="11298" end="11298">{</OP-LEFT-BRACE>
            <expr line1="87" col1="9" line2="87" col2="41" start="11406" end="11438">
              <expr line1="87" col1="9" line2="87" col2="12" start="11406" end="11409">
                <SYMBOL_FUNCTION_CALL line1="87" col1="9" line2="87" col2="12" start="11406" end="11409">stop</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="87" col1="13" line2="87" col2="13" start="11410" end="11410">(</OP-LEFT-PAREN>
              <expr line1="87" col1="14" line2="87" col2="40" start="11411" end="11437">
                <STR_CONST line1="87" col1="14" line2="87" col2="40" start="11411" end="11437">"'object' must be a SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="87" col1="41" line2="87" col2="41" start="11438" end="11438">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="88" col1="5" line2="88" col2="5" start="11533" end="11533">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="89" col1="5" line2="89" col2="36" start="11664" end="11695">
          <expr line1="89" col1="5" line2="89" col2="16" start="11664" end="11675">
            <SYMBOL line1="89" col1="5" line2="89" col2="16" start="11664" end="11675">is_exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="89" col1="18" line2="89" col2="19" start="11677" end="11678">&lt;-</LEFT_ASSIGN>
          <expr line1="89" col1="21" line2="89" col2="36" start="11680" end="11695">
            <expr line1="89" col1="21" line2="89" col2="28" start="11680" end="11687">
              <SYMBOL_FUNCTION_CALL line1="89" col1="21" line2="89" col2="28" start="11680" end="11687">is_exprs</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="89" col1="29" line2="89" col2="29" start="11688" end="11688">(</OP-LEFT-PAREN>
            <expr line1="89" col1="30" line2="89" col2="35" start="11689" end="11694">
              <SYMBOL line1="89" col1="30" line2="89" col2="35" start="11689" end="11694">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="89" col1="36" line2="89" col2="36" start="11695" end="11695">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="91" col1="5" line2="91" col2="55" start="11926" end="11976">
          <expr line1="91" col1="5" line2="91" col2="16" start="11926" end="11937">
            <SYMBOL line1="91" col1="5" line2="91" col2="16" start="11926" end="11937">exprs_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="91" col1="18" line2="91" col2="19" start="11939" end="11940">&lt;-</LEFT_ASSIGN>
          <expr line1="91" col1="21" line2="91" col2="55" start="11942" end="11976">
            <expr line1="91" col1="21" line2="91" col2="33" start="11942" end="11954">
              <SYMBOL_FUNCTION_CALL line1="91" col1="21" line2="91" col2="33" start="11942" end="11954">.exprs_hunter</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="91" col1="34" line2="91" col2="34" start="11955" end="11955">(</OP-LEFT-PAREN>
            <expr line1="91" col1="35" line2="91" col2="40" start="11956" end="11961">
              <SYMBOL line1="91" col1="35" line2="91" col2="40" start="11956" end="11961">object</SYMBOL>
            </expr>
            <OP-COMMA line1="91" col1="41" line2="91" col2="41" start="11962" end="11962">,</OP-COMMA>
            <expr line1="91" col1="43" line2="91" col2="54" start="11964" end="11975">
              <SYMBOL line1="91" col1="43" line2="91" col2="54" start="11964" end="11975">exprs_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="91" col1="55" line2="91" col2="55" start="11976" end="11976">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="92" col1="5" line2="92" col2="66" start="12057" end="12118">
          <expr line1="92" col1="5" line2="92" col2="13" start="12057" end="12065">
            <SYMBOL line1="92" col1="5" line2="92" col2="13" start="12057" end="12065">exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="92" col1="15" line2="92" col2="16" start="12067" end="12068">&lt;-</LEFT_ASSIGN>
          <expr line1="92" col1="18" line2="92" col2="66" start="12070" end="12118">
            <expr line1="92" col1="18" line2="92" col2="33" start="12070" end="12085">
              <SYMBOL_FUNCTION_CALL line1="92" col1="18" line2="92" col2="33" start="12070" end="12085">suppressWarnings</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="92" col1="34" line2="92" col2="34" start="12086" end="12086">(</OP-LEFT-PAREN>
            <expr line1="92" col1="35" line2="92" col2="65" start="12087" end="12117">
              <expr line1="92" col1="35" line2="92" col2="43" start="12087" end="12095">
                <SYMBOL_FUNCTION_CALL line1="92" col1="35" line2="92" col2="43" start="12087" end="12095">get_exprs</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="92" col1="44" line2="92" col2="44" start="12096" end="12096">(</OP-LEFT-PAREN>
              <expr line1="92" col1="45" line2="92" col2="50" start="12097" end="12102">
                <SYMBOL line1="92" col1="45" line2="92" col2="50" start="12097" end="12102">object</SYMBOL>
              </expr>
              <OP-COMMA line1="92" col1="51" line2="92" col2="51" start="12103" end="12103">,</OP-COMMA>
              <expr line1="92" col1="53" line2="92" col2="64" start="12105" end="12116">
                <SYMBOL line1="92" col1="53" line2="92" col2="64" start="12105" end="12116">exprs_values</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="92" col1="65" line2="92" col2="65" start="12117" end="12117">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="92" col1="66" line2="92" col2="66" start="12118" end="12118">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="93" col1="5" line2="95" col2="5" start="12188" end="12450">
          <IF line1="93" col1="5" line2="93" col2="6" start="12188" end="12189">if</IF>
          <OP-LEFT-PAREN line1="93" col1="8" line2="93" col2="8" start="12191" end="12191">(</OP-LEFT-PAREN>
          <expr line1="93" col1="9" line2="93" col2="51" start="12192" end="12234">
            <expr line1="93" col1="9" line2="93" col2="29" start="12192" end="12212">
              <expr line1="93" col1="9" line2="93" col2="15" start="12192" end="12198">
                <SYMBOL_FUNCTION_CALL line1="93" col1="9" line2="93" col2="15" start="12192" end="12198">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="93" col1="16" line2="93" col2="16" start="12199" end="12199">(</OP-LEFT-PAREN>
              <expr line1="93" col1="17" line2="93" col2="28" start="12200" end="12211">
                <SYMBOL line1="93" col1="17" line2="93" col2="28" start="12200" end="12211">is_exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="93" col1="29" line2="93" col2="29" start="12212" end="12212">)</OP-RIGHT-PAREN>
            </expr>
            <AND2 line1="93" col1="31" line2="93" col2="32" start="12214" end="12215">&amp;&amp;</AND2>
            <expr line1="93" col1="34" line2="93" col2="51" start="12217" end="12234">
              <expr line1="93" col1="34" line2="93" col2="40" start="12217" end="12223">
                <SYMBOL_FUNCTION_CALL line1="93" col1="34" line2="93" col2="40" start="12217" end="12223">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="93" col1="41" line2="93" col2="41" start="12224" end="12224">(</OP-LEFT-PAREN>
              <expr line1="93" col1="42" line2="93" col2="50" start="12225" end="12233">
                <SYMBOL line1="93" col1="42" line2="93" col2="50" start="12225" end="12233">exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="93" col1="51" line2="93" col2="51" start="12234" end="12234">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="93" col1="52" line2="93" col2="52" start="12235" end="12235">)</OP-RIGHT-PAREN>
          <expr line1="93" col1="54" line2="95" col2="5" start="12237" end="12450">
            <OP-LEFT-BRACE line1="93" col1="54" line2="93" col2="54" start="12237" end="12237">{</OP-LEFT-BRACE>
            <expr line1="94" col1="9" line2="94" col2="97" start="12323" end="12411">
              <expr line1="94" col1="9" line2="94" col2="12" start="12323" end="12326">
                <SYMBOL_FUNCTION_CALL line1="94" col1="9" line2="94" col2="12" start="12323" end="12326">stop</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="94" col1="13" line2="94" col2="13" start="12327" end="12327">(</OP-LEFT-PAREN>
              <expr line1="94" col1="14" line2="94" col2="96" start="12328" end="12410">
                <expr line1="94" col1="14" line2="94" col2="20" start="12328" end="12334">
                  <SYMBOL_FUNCTION_CALL line1="94" col1="14" line2="94" col2="20" start="12328" end="12334">sprintf</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="94" col1="21" line2="94" col2="21" start="12335" end="12335">(</OP-LEFT-PAREN>
                <expr line1="94" col1="22" line2="94" col2="81" start="12336" end="12395">
                  <STR_CONST line1="94" col1="22" line2="94" col2="81" start="12336" end="12395">"either 'is_exprs(object)' or '%s(object)' must be non-NULL"</STR_CONST>
                </expr>
                <OP-COMMA line1="94" col1="82" line2="94" col2="82" start="12396" end="12396">,</OP-COMMA>
                <expr line1="94" col1="84" line2="94" col2="95" start="12398" end="12409">
                  <SYMBOL line1="94" col1="84" line2="94" col2="95" start="12398" end="12409">exprs_values</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="94" col1="96" line2="94" col2="96" start="12410" end="12410">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="94" col1="97" line2="94" col2="97" start="12411" end="12411">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="95" col1="5" line2="95" col2="5" start="12450" end="12450">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="97" col1="5" line2="97" col2="57" start="12712" end="12764"># Setting the detection lowerDetectionLimit properly.</COMMENT>
        <expr line1="98" col1="5" line2="100" col2="5" start="12843" end="13105">
          <IF line1="98" col1="5" line2="98" col2="6" start="12843" end="12844">if</IF>
          <OP-LEFT-PAREN line1="98" col1="8" line2="98" col2="8" start="12846" end="12846">(</OP-LEFT-PAREN>
          <expr line1="98" col1="9" line2="98" col2="36" start="12847" end="12874">
            <expr line1="98" col1="9" line2="98" col2="15" start="12847" end="12853">
              <SYMBOL_FUNCTION_CALL line1="98" col1="9" line2="98" col2="15" start="12847" end="12853">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="98" col1="16" line2="98" col2="16" start="12854" end="12854">(</OP-LEFT-PAREN>
            <expr line1="98" col1="17" line2="98" col2="35" start="12855" end="12873">
              <SYMBOL line1="98" col1="17" line2="98" col2="35" start="12855" end="12873">lowerDetectionLimit</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="98" col1="36" line2="98" col2="36" start="12874" end="12874">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="98" col1="37" line2="98" col2="37" start="12875" end="12875">)</OP-RIGHT-PAREN>
          <expr line1="98" col1="39" line2="100" col2="5" start="12877" end="13105">
            <OP-LEFT-BRACE line1="98" col1="39" line2="98" col2="39" start="12877" end="12877">{</OP-LEFT-BRACE>
            <expr line1="99" col1="9" line2="99" col2="57" start="12978" end="13026">
              <expr line1="99" col1="9" line2="99" col2="27" start="12978" end="12996">
                <SYMBOL line1="99" col1="9" line2="99" col2="27" start="12978" end="12996">lowerDetectionLimit</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="99" col1="29" line2="99" col2="30" start="12998" end="12999">&lt;-</LEFT_ASSIGN>
              <expr line1="99" col1="32" line2="99" col2="57" start="13001" end="13026">
                <expr line1="99" col1="32" line2="99" col2="37" start="13001" end="13006">
                  <SYMBOL line1="99" col1="32" line2="99" col2="37" start="13001" end="13006">object</SYMBOL>
                </expr>
                <OP-AT line1="99" col1="38" line2="99" col2="38" start="13007" end="13007">@</OP-AT>
                <SLOT line1="99" col1="39" line2="99" col2="57" start="13008" end="13026">lowerDetectionLimit</SLOT>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="100" col1="5" line2="100" col2="5" start="13105" end="13105">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="101" col1="5" line2="103" col2="5" start="13236" end="13498">
          <IF line1="101" col1="5" line2="101" col2="6" start="13236" end="13237">if</IF>
          <OP-LEFT-PAREN line1="101" col1="8" line2="101" col2="8" start="13239" end="13239">(</OP-LEFT-PAREN>
          <expr line1="101" col1="9" line2="101" col2="27" start="13240" end="13258">
            <OP-EXCLAMATION line1="101" col1="9" line2="101" col2="9" start="13240" end="13240">!</OP-EXCLAMATION>
            <expr line1="101" col1="10" line2="101" col2="27" start="13241" end="13258">
              <expr line1="101" col1="10" line2="101" col2="16" start="13241" end="13247">
                <SYMBOL_FUNCTION_CALL line1="101" col1="10" line2="101" col2="16" start="13241" end="13247">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="101" col1="17" line2="101" col2="17" start="13248" end="13248">(</OP-LEFT-PAREN>
              <expr line1="101" col1="18" line2="101" col2="26" start="13249" end="13257">
                <SYMBOL line1="101" col1="18" line2="101" col2="26" start="13249" end="13257">exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="101" col1="27" line2="101" col2="27" start="13258" end="13258">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="101" col1="28" line2="101" col2="28" start="13259" end="13259">)</OP-RIGHT-PAREN>
          <expr line1="101" col1="30" line2="103" col2="5" start="13261" end="13498">
            <OP-LEFT-BRACE line1="101" col1="30" line2="101" col2="30" start="13261" end="13261">{</OP-LEFT-BRACE>
            <expr line1="102" col1="9" line2="102" col2="68" start="13371" end="13430">
              <expr line1="102" col1="9" line2="102" col2="41" start="13371" end="13403">
                <expr line1="102" col1="9" line2="102" col2="20" start="13371" end="13382">
                  <SYMBOL_FUNCTION_CALL line1="102" col1="9" line2="102" col2="20" start="13371" end="13382">storage.mode</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="102" col1="21" line2="102" col2="21" start="13383" end="13383">(</OP-LEFT-PAREN>
                <expr line1="102" col1="22" line2="102" col2="40" start="13384" end="13402">
                  <SYMBOL line1="102" col1="22" line2="102" col2="40" start="13384" end="13402">lowerDetectionLimit</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="102" col1="41" line2="102" col2="41" start="13403" end="13403">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="102" col1="43" line2="102" col2="44" start="13405" end="13406">&lt;-</LEFT_ASSIGN>
              <expr line1="102" col1="46" line2="102" col2="68" start="13408" end="13430">
                <expr line1="102" col1="46" line2="102" col2="57" start="13408" end="13419">
                  <SYMBOL_FUNCTION_CALL line1="102" col1="46" line2="102" col2="57" start="13408" end="13419">storage.mode</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="102" col1="58" line2="102" col2="58" start="13420" end="13420">(</OP-LEFT-PAREN>
                <expr line1="102" col1="59" line2="102" col2="67" start="13421" end="13429">
                  <SYMBOL line1="102" col1="59" line2="102" col2="67" start="13421" end="13429">exprs_mat</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="102" col1="68" line2="102" col2="68" start="13430" end="13430">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="103" col1="5" line2="103" col2="5" start="13498" end="13498">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="105" col1="5" line2="147" col2="5" start="13760" end="19262">
          <IF line1="105" col1="5" line2="105" col2="6" start="13760" end="13761">if</IF>
          <OP-LEFT-PAREN line1="105" col1="8" line2="105" col2="8" start="13763" end="13763">(</OP-LEFT-PAREN>
          <expr line1="105" col1="9" line2="105" col2="14" start="13764" end="13769">
            <OP-EXCLAMATION line1="105" col1="9" line2="105" col2="9" start="13764" end="13764">!</OP-EXCLAMATION>
            <expr line1="105" col1="10" line2="105" col2="14" start="13765" end="13769">
              <SYMBOL line1="105" col1="10" line2="105" col2="14" start="13765" end="13769">byrow</SYMBOL>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="105" col1="15" line2="105" col2="15" start="13770" end="13770">)</OP-RIGHT-PAREN>
          <expr line1="105" col1="17" line2="126" col2="5" start="13772" end="16511">
            <OP-LEFT-BRACE line1="105" col1="17" line2="105" col2="17" start="13772" end="13772">{</OP-LEFT-BRACE>
            <expr line1="106" col1="9" line2="125" col2="9" start="13895" end="16384">
              <IF line1="106" col1="9" line2="106" col2="10" start="13895" end="13896">if</IF>
              <OP-LEFT-PAREN line1="106" col1="12" line2="106" col2="12" start="13898" end="13898">(</OP-LEFT-PAREN>
              <expr line1="106" col1="13" line2="106" col2="34" start="13899" end="13920">
                <OP-EXCLAMATION line1="106" col1="13" line2="106" col2="13" start="13899" end="13899">!</OP-EXCLAMATION>
                <expr line1="106" col1="14" line2="106" col2="34" start="13900" end="13920">
                  <expr line1="106" col1="14" line2="106" col2="20" start="13900" end="13906">
                    <SYMBOL_FUNCTION_CALL line1="106" col1="14" line2="106" col2="20" start="13900" end="13906">is.null</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="106" col1="21" line2="106" col2="21" start="13907" end="13907">(</OP-LEFT-PAREN>
                  <expr line1="106" col1="22" line2="106" col2="33" start="13908" end="13919">
                    <SYMBOL line1="106" col1="22" line2="106" col2="33" start="13908" end="13919">is_exprs_mat</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="106" col1="34" line2="106" col2="34" start="13920" end="13920">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="106" col1="35" line2="106" col2="35" start="13921" end="13921">)</OP-RIGHT-PAREN>
              <expr line1="106" col1="37" line2="115" col2="9" start="13923" end="15074">
                <OP-LEFT-BRACE line1="106" col1="37" line2="106" col2="37" start="13923" end="13923">{</OP-LEFT-BRACE>
                <COMMENT line1="107" col1="13" line2="107" col2="86" start="14030" end="14103"># Counting expressing genes per cell, using predefined 'is_exprs(object)'.</COMMENT>
                <expr line1="108" col1="13" line2="114" col2="13" start="14161" end="14947">
                  <IF line1="108" col1="13" line2="108" col2="14" start="14161" end="14162">if</IF>
                  <OP-LEFT-PAREN line1="108" col1="16" line2="108" col2="16" start="14164" end="14164">(</OP-LEFT-PAREN>
                  <expr line1="108" col1="17" line2="108" col2="35" start="14165" end="14183">
                    <expr line1="108" col1="17" line2="108" col2="23" start="14165" end="14171">
                      <SYMBOL_FUNCTION_CALL line1="108" col1="17" line2="108" col2="23" start="14165" end="14171">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="108" col1="24" line2="108" col2="24" start="14172" end="14172">(</OP-LEFT-PAREN>
                    <expr line1="108" col1="25" line2="108" col2="34" start="14173" end="14182">
                      <SYMBOL line1="108" col1="25" line2="108" col2="34" start="14173" end="14182">subset_row</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="108" col1="35" line2="108" col2="35" start="14183" end="14183">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="108" col1="36" line2="108" col2="36" start="14184" end="14184">)</OP-RIGHT-PAREN>
                  <expr line1="108" col1="38" line2="110" col2="13" start="14186" end="14423">
                    <OP-LEFT-BRACE line1="108" col1="38" line2="108" col2="38" start="14186" end="14186">{</OP-LEFT-BRACE>
                    <expr line1="109" col1="17" line2="109" col2="44" start="14296" end="14323">
                      <expr line1="109" col1="17" line2="109" col2="19" start="14296" end="14298">
                        <SYMBOL line1="109" col1="17" line2="109" col2="19" start="14296" end="14298">out</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="109" col1="21" line2="109" col2="22" start="14300" end="14301">&lt;-</LEFT_ASSIGN>
                      <expr line1="109" col1="24" line2="109" col2="44" start="14303" end="14323">
                        <expr line1="109" col1="24" line2="109" col2="30" start="14303" end="14309">
                          <SYMBOL_FUNCTION_CALL line1="109" col1="24" line2="109" col2="30" start="14303" end="14309">colSums</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="109" col1="31" line2="109" col2="31" start="14310" end="14310">(</OP-LEFT-PAREN>
                        <expr line1="109" col1="32" line2="109" col2="43" start="14311" end="14322">
                          <SYMBOL line1="109" col1="32" line2="109" col2="43" start="14311" end="14322">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="109" col1="44" line2="109" col2="44" start="14323" end="14323">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="110" col1="13" line2="110" col2="13" start="14423" end="14423">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="110" col1="15" line2="110" col2="18" start="14425" end="14428">else</ELSE>
                  <expr line1="110" col1="20" line2="114" col2="13" start="14430" end="14947">
                    <OP-LEFT-BRACE line1="110" col1="20" line2="110" col2="20" start="14430" end="14430">{</OP-LEFT-BRACE>
                    <expr line1="111" col1="17" line2="111" col2="69" start="14558" end="14610">
                      <expr line1="111" col1="17" line2="111" col2="26" start="14558" end="14567">
                        <SYMBOL line1="111" col1="17" line2="111" col2="26" start="14558" end="14567">subset_row</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="111" col1="28" line2="111" col2="29" start="14569" end="14570">&lt;-</LEFT_ASSIGN>
                      <expr line1="111" col1="31" line2="111" col2="69" start="14572" end="14610">
                        <expr line1="111" col1="31" line2="111" col2="43" start="14572" end="14584">
                          <SYMBOL_FUNCTION_CALL line1="111" col1="31" line2="111" col2="43" start="14572" end="14584">.subset2index</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="111" col1="44" line2="111" col2="44" start="14585" end="14585">(</OP-LEFT-PAREN>
                        <expr line1="111" col1="45" line2="111" col2="54" start="14586" end="14595">
                          <SYMBOL line1="111" col1="45" line2="111" col2="54" start="14586" end="14595">subset_row</SYMBOL>
                        </expr>
                        <OP-COMMA line1="111" col1="55" line2="111" col2="55" start="14596" end="14596">,</OP-COMMA>
                        <expr line1="111" col1="57" line2="111" col2="68" start="14598" end="14609">
                          <SYMBOL line1="111" col1="57" line2="111" col2="68" start="14598" end="14609">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="111" col1="69" line2="111" col2="69" start="14610" end="14610">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <expr line1="112" col1="17" line2="112" col2="85" start="14689" end="14757">
                      <expr line1="112" col1="17" line2="112" col2="19" start="14689" end="14691">
                        <SYMBOL line1="112" col1="17" line2="112" col2="19" start="14689" end="14691">out</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="112" col1="21" line2="112" col2="22" start="14693" end="14694">&lt;-</LEFT_ASSIGN>
                      <expr line1="112" col1="24" line2="112" col2="85" start="14696" end="14757">
                        <expr line1="112" col1="24" line2="112" col2="35" start="14696" end="14707">
                          <SYMBOL_FUNCTION_CALL line1="112" col1="24" line2="112" col2="35" start="14696" end="14707">.checkedCall</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="112" col1="36" line2="112" col2="36" start="14708" end="14708">(</OP-LEFT-PAREN>
                        <expr line1="112" col1="37" line2="112" col2="53" start="14709" end="14725">
                          <SYMBOL line1="112" col1="37" line2="112" col2="53" start="14709" end="14725">cxx_colsum_subset</SYMBOL>
                        </expr>
                        <OP-COMMA line1="112" col1="54" line2="112" col2="54" start="14726" end="14726">,</OP-COMMA>
                        <expr line1="112" col1="56" line2="112" col2="67" start="14728" end="14739">
                          <SYMBOL line1="112" col1="56" line2="112" col2="67" start="14728" end="14739">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-COMMA line1="112" col1="68" line2="112" col2="68" start="14740" end="14740">,</OP-COMMA>
                        <expr line1="112" col1="70" line2="112" col2="84" start="14742" end="14756">
                          <expr line1="112" col1="70" line2="112" col2="79" start="14742" end="14751">
                            <SYMBOL line1="112" col1="70" line2="112" col2="79" start="14742" end="14751">subset_row</SYMBOL>
                          </expr>
                          <OP-MINUS line1="112" col1="81" line2="112" col2="81" start="14753" end="14753">-</OP-MINUS>
                          <expr line1="112" col1="83" line2="112" col2="84" start="14755" end="14756">
                            <NUM_CONST line1="112" col1="83" line2="112" col2="84" start="14755" end="14756">1L</NUM_CONST>
                          </expr>
                        </expr>
                        <OP-RIGHT-PAREN line1="112" col1="85" line2="112" col2="85" start="14757" end="14757">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <expr line1="113" col1="17" line2="113" col2="52" start="14820" end="14855">
                      <expr line1="113" col1="17" line2="113" col2="26" start="14820" end="14829">
                        <expr line1="113" col1="17" line2="113" col2="21" start="14820" end="14824">
                          <SYMBOL_FUNCTION_CALL line1="113" col1="17" line2="113" col2="21" start="14820" end="14824">names</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="113" col1="22" line2="113" col2="22" start="14825" end="14825">(</OP-LEFT-PAREN>
                        <expr line1="113" col1="23" line2="113" col2="25" start="14826" end="14828">
                          <SYMBOL line1="113" col1="23" line2="113" col2="25" start="14826" end="14828">out</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="113" col1="26" line2="113" col2="26" start="14829" end="14829">)</OP-RIGHT-PAREN>
                      </expr>
                      <LEFT_ASSIGN line1="113" col1="28" line2="113" col2="29" start="14831" end="14832">&lt;-</LEFT_ASSIGN>
                      <expr line1="113" col1="31" line2="113" col2="52" start="14834" end="14855">
                        <expr line1="113" col1="31" line2="113" col2="38" start="14834" end="14841">
                          <SYMBOL_FUNCTION_CALL line1="113" col1="31" line2="113" col2="38" start="14834" end="14841">colnames</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="113" col1="39" line2="113" col2="39" start="14842" end="14842">(</OP-LEFT-PAREN>
                        <expr line1="113" col1="40" line2="113" col2="51" start="14843" end="14854">
                          <SYMBOL line1="113" col1="40" line2="113" col2="51" start="14843" end="14854">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="113" col1="52" line2="113" col2="52" start="14855" end="14855">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="114" col1="13" line2="114" col2="13" start="14947" end="14947">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="115" col1="9" line2="115" col2="9" start="15074" end="15074">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="115" col1="11" line2="115" col2="14" start="15076" end="15079">else</ELSE>
              <expr line1="115" col1="16" line2="125" col2="9" start="15081" end="16384">
                <OP-LEFT-BRACE line1="115" col1="16" line2="115" col2="16" start="15081" end="15081">{</OP-LEFT-BRACE>
                <COMMENT line1="116" col1="13" line2="116" col2="90" start="15209" end="15286"># Counting expressing genes per cell, using the counts to define 'expressing'.</COMMENT>
                <expr line1="117" col1="13" line2="121" col2="13" start="15340" end="15864">
                  <IF line1="117" col1="13" line2="117" col2="14" start="15340" end="15341">if</IF>
                  <OP-LEFT-PAREN line1="117" col1="16" line2="117" col2="16" start="15343" end="15343">(</OP-LEFT-PAREN>
                  <expr line1="117" col1="17" line2="117" col2="35" start="15344" end="15362">
                    <expr line1="117" col1="17" line2="117" col2="23" start="15344" end="15350">
                      <SYMBOL_FUNCTION_CALL line1="117" col1="17" line2="117" col2="23" start="15344" end="15350">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="117" col1="24" line2="117" col2="24" start="15351" end="15351">(</OP-LEFT-PAREN>
                    <expr line1="117" col1="25" line2="117" col2="34" start="15352" end="15361">
                      <SYMBOL line1="117" col1="25" line2="117" col2="34" start="15352" end="15361">subset_row</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="117" col1="35" line2="117" col2="35" start="15362" end="15362">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="117" col1="36" line2="117" col2="36" start="15363" end="15363">)</OP-RIGHT-PAREN>
                  <expr line1="117" col1="38" line2="119" col2="13" start="15365" end="15602">
                    <OP-LEFT-BRACE line1="117" col1="38" line2="117" col2="38" start="15365" end="15365">{</OP-LEFT-BRACE>
                    <expr line1="118" col1="17" line2="118" col2="54" start="15475" end="15512">
                      <expr line1="118" col1="17" line2="118" col2="26" start="15475" end="15484">
                        <SYMBOL line1="118" col1="17" line2="118" col2="26" start="15475" end="15484">subset_row</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="118" col1="28" line2="118" col2="29" start="15486" end="15487">&lt;-</LEFT_ASSIGN>
                      <expr line1="118" col1="31" line2="118" col2="54" start="15489" end="15512">
                        <expr line1="118" col1="31" line2="118" col2="37" start="15489" end="15495">
                          <SYMBOL_FUNCTION_CALL line1="118" col1="31" line2="118" col2="37" start="15489" end="15495">seq_len</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="118" col1="38" line2="118" col2="38" start="15496" end="15496">(</OP-LEFT-PAREN>
                        <expr line1="118" col1="39" line2="118" col2="53" start="15497" end="15511">
                          <expr line1="118" col1="39" line2="118" col2="42" start="15497" end="15500">
                            <SYMBOL_FUNCTION_CALL line1="118" col1="39" line2="118" col2="42" start="15497" end="15500">nrow</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="118" col1="43" line2="118" col2="43" start="15501" end="15501">(</OP-LEFT-PAREN>
                          <expr line1="118" col1="44" line2="118" col2="52" start="15502" end="15510">
                            <SYMBOL line1="118" col1="44" line2="118" col2="52" start="15502" end="15510">exprs_mat</SYMBOL>
                          </expr>
                          <OP-RIGHT-PAREN line1="118" col1="53" line2="118" col2="53" start="15511" end="15511">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-RIGHT-PAREN line1="118" col1="54" line2="118" col2="54" start="15512" end="15512">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="119" col1="13" line2="119" col2="13" start="15602" end="15602">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="119" col1="15" line2="119" col2="18" start="15604" end="15607">else</ELSE>
                  <expr line1="119" col1="20" line2="121" col2="13" start="15609" end="15864">
                    <OP-LEFT-BRACE line1="119" col1="20" line2="119" col2="20" start="15609" end="15609">{</OP-LEFT-BRACE>
                    <expr line1="120" col1="17" line2="120" col2="66" start="15737" end="15786">
                      <expr line1="120" col1="17" line2="120" col2="26" start="15737" end="15746">
                        <SYMBOL line1="120" col1="17" line2="120" col2="26" start="15737" end="15746">subset_row</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="120" col1="28" line2="120" col2="29" start="15748" end="15749">&lt;-</LEFT_ASSIGN>
                      <expr line1="120" col1="31" line2="120" col2="66" start="15751" end="15786">
                        <expr line1="120" col1="31" line2="120" col2="43" start="15751" end="15763">
                          <SYMBOL_FUNCTION_CALL line1="120" col1="31" line2="120" col2="43" start="15751" end="15763">.subset2index</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="120" col1="44" line2="120" col2="44" start="15764" end="15764">(</OP-LEFT-PAREN>
                        <expr line1="120" col1="45" line2="120" col2="54" start="15765" end="15774">
                          <SYMBOL line1="120" col1="45" line2="120" col2="54" start="15765" end="15774">subset_row</SYMBOL>
                        </expr>
                        <OP-COMMA line1="120" col1="55" line2="120" col2="55" start="15775" end="15775">,</OP-COMMA>
                        <expr line1="120" col1="57" line2="120" col2="65" start="15777" end="15785">
                          <SYMBOL line1="120" col1="57" line2="120" col2="65" start="15777" end="15785">exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="120" col1="66" line2="120" col2="66" start="15786" end="15786">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="121" col1="13" line2="121" col2="13" start="15864" end="15864">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <expr line1="122" col1="13" line2="123" col2="69" start="15995" end="16182">
                  <expr line1="122" col1="13" line2="122" col2="15" start="15995" end="15997">
                    <SYMBOL line1="122" col1="13" line2="122" col2="15" start="15995" end="15997">out</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="122" col1="17" line2="122" col2="18" start="15999" end="16000">&lt;-</LEFT_ASSIGN>
                  <expr line1="122" col1="20" line2="123" col2="69" start="16002" end="16182">
                    <expr line1="122" col1="20" line2="122" col2="31" start="16002" end="16013">
                      <SYMBOL_FUNCTION_CALL line1="122" col1="20" line2="122" col2="31" start="16002" end="16013">.checkedCall</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="122" col1="32" line2="122" col2="32" start="16014" end="16014">(</OP-LEFT-PAREN>
                    <expr line1="122" col1="33" line2="122" col2="55" start="16015" end="16037">
                      <SYMBOL line1="122" col1="33" line2="122" col2="55" start="16015" end="16037">cxx_colsum_exprs_subset</SYMBOL>
                    </expr>
                    <OP-COMMA line1="122" col1="56" line2="122" col2="56" start="16038" end="16038">,</OP-COMMA>
                    <expr line1="122" col1="58" line2="122" col2="66" start="16040" end="16048">
                      <SYMBOL line1="122" col1="58" line2="122" col2="66" start="16040" end="16048">exprs_mat</SYMBOL>
                    </expr>
                    <OP-COMMA line1="122" col1="67" line2="122" col2="67" start="16049" end="16049">,</OP-COMMA>
                    <expr line1="123" col1="33" line2="123" col2="51" start="16146" end="16164">
                      <SYMBOL line1="123" col1="33" line2="123" col2="51" start="16146" end="16164">lowerDetectionLimit</SYMBOL>
                    </expr>
                    <OP-COMMA line1="123" col1="52" line2="123" col2="52" start="16165" end="16165">,</OP-COMMA>
                    <expr line1="123" col1="54" line2="123" col2="68" start="16167" end="16181">
                      <expr line1="123" col1="54" line2="123" col2="63" start="16167" end="16176">
                        <SYMBOL line1="123" col1="54" line2="123" col2="63" start="16167" end="16176">subset_row</SYMBOL>
                      </expr>
                      <OP-MINUS line1="123" col1="65" line2="123" col2="65" start="16178" end="16178">-</OP-MINUS>
                      <expr line1="123" col1="67" line2="123" col2="68" start="16180" end="16181">
                        <NUM_CONST line1="123" col1="67" line2="123" col2="68" start="16180" end="16181">1L</NUM_CONST>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="123" col1="69" line2="123" col2="69" start="16182" end="16182">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="124" col1="13" line2="124" col2="45" start="16257" end="16289">
                  <expr line1="124" col1="13" line2="124" col2="22" start="16257" end="16266">
                    <expr line1="124" col1="13" line2="124" col2="17" start="16257" end="16261">
                      <SYMBOL_FUNCTION_CALL line1="124" col1="13" line2="124" col2="17" start="16257" end="16261">names</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="124" col1="18" line2="124" col2="18" start="16262" end="16262">(</OP-LEFT-PAREN>
                    <expr line1="124" col1="19" line2="124" col2="21" start="16263" end="16265">
                      <SYMBOL line1="124" col1="19" line2="124" col2="21" start="16263" end="16265">out</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="124" col1="22" line2="124" col2="22" start="16266" end="16266">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="124" col1="24" line2="124" col2="25" start="16268" end="16269">&lt;-</LEFT_ASSIGN>
                  <expr line1="124" col1="27" line2="124" col2="45" start="16271" end="16289">
                    <expr line1="124" col1="27" line2="124" col2="34" start="16271" end="16278">
                      <SYMBOL_FUNCTION_CALL line1="124" col1="27" line2="124" col2="34" start="16271" end="16278">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="124" col1="35" line2="124" col2="35" start="16279" end="16279">(</OP-LEFT-PAREN>
                    <expr line1="124" col1="36" line2="124" col2="44" start="16280" end="16288">
                      <SYMBOL line1="124" col1="36" line2="124" col2="44" start="16280" end="16288">exprs_mat</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="124" col1="45" line2="124" col2="45" start="16289" end="16289">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="125" col1="9" line2="125" col2="9" start="16384" end="16384">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="126" col1="5" line2="126" col2="5" start="16511" end="16511">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="126" col1="7" line2="126" col2="10" start="16513" end="16516">else</ELSE>
          <expr line1="126" col1="12" line2="147" col2="5" start="16518" end="19262">
            <OP-LEFT-BRACE line1="126" col1="12" line2="126" col2="12" start="16518" end="16518">{</OP-LEFT-BRACE>
            <expr line1="127" col1="9" line2="146" col2="9" start="16646" end="19135">
              <IF line1="127" col1="9" line2="127" col2="10" start="16646" end="16647">if</IF>
              <OP-LEFT-PAREN line1="127" col1="12" line2="127" col2="12" start="16649" end="16649">(</OP-LEFT-PAREN>
              <expr line1="127" col1="13" line2="127" col2="34" start="16650" end="16671">
                <OP-EXCLAMATION line1="127" col1="13" line2="127" col2="13" start="16650" end="16650">!</OP-EXCLAMATION>
                <expr line1="127" col1="14" line2="127" col2="34" start="16651" end="16671">
                  <expr line1="127" col1="14" line2="127" col2="20" start="16651" end="16657">
                    <SYMBOL_FUNCTION_CALL line1="127" col1="14" line2="127" col2="20" start="16651" end="16657">is.null</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="127" col1="21" line2="127" col2="21" start="16658" end="16658">(</OP-LEFT-PAREN>
                  <expr line1="127" col1="22" line2="127" col2="33" start="16659" end="16670">
                    <SYMBOL line1="127" col1="22" line2="127" col2="33" start="16659" end="16670">is_exprs_mat</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="127" col1="34" line2="127" col2="34" start="16671" end="16671">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="127" col1="35" line2="127" col2="35" start="16672" end="16672">)</OP-RIGHT-PAREN>
              <expr line1="127" col1="37" line2="136" col2="9" start="16674" end="17825">
                <OP-LEFT-BRACE line1="127" col1="37" line2="127" col2="37" start="16674" end="16674">{</OP-LEFT-BRACE>
                <COMMENT line1="128" col1="13" line2="128" col2="86" start="16781" end="16854"># Counting expressing cells per gene, using predefined 'is_exprs(object)'.</COMMENT>
                <expr line1="129" col1="13" line2="135" col2="13" start="16912" end="17698">
                  <IF line1="129" col1="13" line2="129" col2="14" start="16912" end="16913">if</IF>
                  <OP-LEFT-PAREN line1="129" col1="16" line2="129" col2="16" start="16915" end="16915">(</OP-LEFT-PAREN>
                  <expr line1="129" col1="17" line2="129" col2="35" start="16916" end="16934">
                    <expr line1="129" col1="17" line2="129" col2="23" start="16916" end="16922">
                      <SYMBOL_FUNCTION_CALL line1="129" col1="17" line2="129" col2="23" start="16916" end="16922">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="129" col1="24" line2="129" col2="24" start="16923" end="16923">(</OP-LEFT-PAREN>
                    <expr line1="129" col1="25" line2="129" col2="34" start="16924" end="16933">
                      <SYMBOL line1="129" col1="25" line2="129" col2="34" start="16924" end="16933">subset_col</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="129" col1="35" line2="129" col2="35" start="16934" end="16934">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="129" col1="36" line2="129" col2="36" start="16935" end="16935">)</OP-RIGHT-PAREN>
                  <expr line1="129" col1="38" line2="131" col2="13" start="16937" end="17174">
                    <OP-LEFT-BRACE line1="129" col1="38" line2="129" col2="38" start="16937" end="16937">{</OP-LEFT-BRACE>
                    <expr line1="130" col1="17" line2="130" col2="44" start="17047" end="17074">
                      <expr line1="130" col1="17" line2="130" col2="19" start="17047" end="17049">
                        <SYMBOL line1="130" col1="17" line2="130" col2="19" start="17047" end="17049">out</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="130" col1="21" line2="130" col2="22" start="17051" end="17052">&lt;-</LEFT_ASSIGN>
                      <expr line1="130" col1="24" line2="130" col2="44" start="17054" end="17074">
                        <expr line1="130" col1="24" line2="130" col2="30" start="17054" end="17060">
                          <SYMBOL_FUNCTION_CALL line1="130" col1="24" line2="130" col2="30" start="17054" end="17060">rowSums</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="130" col1="31" line2="130" col2="31" start="17061" end="17061">(</OP-LEFT-PAREN>
                        <expr line1="130" col1="32" line2="130" col2="43" start="17062" end="17073">
                          <SYMBOL line1="130" col1="32" line2="130" col2="43" start="17062" end="17073">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="130" col1="44" line2="130" col2="44" start="17074" end="17074">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="131" col1="13" line2="131" col2="13" start="17174" end="17174">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="131" col1="15" line2="131" col2="18" start="17176" end="17179">else</ELSE>
                  <expr line1="131" col1="20" line2="135" col2="13" start="17181" end="17698">
                    <OP-LEFT-BRACE line1="131" col1="20" line2="131" col2="20" start="17181" end="17181">{</OP-LEFT-BRACE>
                    <expr line1="132" col1="17" line2="132" col2="84" start="17309" end="17376">
                      <expr line1="132" col1="17" line2="132" col2="26" start="17309" end="17318">
                        <SYMBOL line1="132" col1="17" line2="132" col2="26" start="17309" end="17318">subset_col</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="132" col1="28" line2="132" col2="29" start="17320" end="17321">&lt;-</LEFT_ASSIGN>
                      <expr line1="132" col1="31" line2="132" col2="84" start="17323" end="17376">
                        <expr line1="132" col1="31" line2="132" col2="43" start="17323" end="17335">
                          <SYMBOL_FUNCTION_CALL line1="132" col1="31" line2="132" col2="43" start="17323" end="17335">.subset2index</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="132" col1="44" line2="132" col2="44" start="17336" end="17336">(</OP-LEFT-PAREN>
                        <expr line1="132" col1="45" line2="132" col2="54" start="17337" end="17346">
                          <SYMBOL line1="132" col1="45" line2="132" col2="54" start="17337" end="17346">subset_col</SYMBOL>
                        </expr>
                        <OP-COMMA line1="132" col1="55" line2="132" col2="55" start="17347" end="17347">,</OP-COMMA>
                        <expr line1="132" col1="57" line2="132" col2="68" start="17349" end="17360">
                          <SYMBOL line1="132" col1="57" line2="132" col2="68" start="17349" end="17360">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-COMMA line1="132" col1="69" line2="132" col2="69" start="17361" end="17361">,</OP-COMMA>
                        <SYMBOL_SUB line1="132" col1="71" line2="132" col2="75" start="17363" end="17367">byrow</SYMBOL_SUB>
                        <EQ_SUB line1="132" col1="77" line2="132" col2="77" start="17369" end="17369">=</EQ_SUB>
                        <expr line1="132" col1="79" line2="132" col2="83" start="17371" end="17375">
                          <NUM_CONST line1="132" col1="79" line2="132" col2="83" start="17371" end="17375">FALSE</NUM_CONST>
                        </expr>
                        <OP-RIGHT-PAREN line1="132" col1="84" line2="132" col2="84" start="17376" end="17376">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <expr line1="133" col1="17" line2="133" col2="85" start="17440" end="17508">
                      <expr line1="133" col1="17" line2="133" col2="19" start="17440" end="17442">
                        <SYMBOL line1="133" col1="17" line2="133" col2="19" start="17440" end="17442">out</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="133" col1="21" line2="133" col2="22" start="17444" end="17445">&lt;-</LEFT_ASSIGN>
                      <expr line1="133" col1="24" line2="133" col2="85" start="17447" end="17508">
                        <expr line1="133" col1="24" line2="133" col2="35" start="17447" end="17458">
                          <SYMBOL_FUNCTION_CALL line1="133" col1="24" line2="133" col2="35" start="17447" end="17458">.checkedCall</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="133" col1="36" line2="133" col2="36" start="17459" end="17459">(</OP-LEFT-PAREN>
                        <expr line1="133" col1="37" line2="133" col2="53" start="17460" end="17476">
                          <SYMBOL line1="133" col1="37" line2="133" col2="53" start="17460" end="17476">cxx_rowsum_subset</SYMBOL>
                        </expr>
                        <OP-COMMA line1="133" col1="54" line2="133" col2="54" start="17477" end="17477">,</OP-COMMA>
                        <expr line1="133" col1="56" line2="133" col2="67" start="17479" end="17490">
                          <SYMBOL line1="133" col1="56" line2="133" col2="67" start="17479" end="17490">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-COMMA line1="133" col1="68" line2="133" col2="68" start="17491" end="17491">,</OP-COMMA>
                        <expr line1="133" col1="70" line2="133" col2="84" start="17493" end="17507">
                          <expr line1="133" col1="70" line2="133" col2="79" start="17493" end="17502">
                            <SYMBOL line1="133" col1="70" line2="133" col2="79" start="17493" end="17502">subset_col</SYMBOL>
                          </expr>
                          <OP-MINUS line1="133" col1="81" line2="133" col2="81" start="17504" end="17504">-</OP-MINUS>
                          <expr line1="133" col1="83" line2="133" col2="84" start="17506" end="17507">
                            <NUM_CONST line1="133" col1="83" line2="133" col2="84" start="17506" end="17507">1L</NUM_CONST>
                          </expr>
                        </expr>
                        <OP-RIGHT-PAREN line1="133" col1="85" line2="133" col2="85" start="17508" end="17508">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <expr line1="134" col1="17" line2="134" col2="52" start="17571" end="17606">
                      <expr line1="134" col1="17" line2="134" col2="26" start="17571" end="17580">
                        <expr line1="134" col1="17" line2="134" col2="21" start="17571" end="17575">
                          <SYMBOL_FUNCTION_CALL line1="134" col1="17" line2="134" col2="21" start="17571" end="17575">names</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="134" col1="22" line2="134" col2="22" start="17576" end="17576">(</OP-LEFT-PAREN>
                        <expr line1="134" col1="23" line2="134" col2="25" start="17577" end="17579">
                          <SYMBOL line1="134" col1="23" line2="134" col2="25" start="17577" end="17579">out</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="134" col1="26" line2="134" col2="26" start="17580" end="17580">)</OP-RIGHT-PAREN>
                      </expr>
                      <LEFT_ASSIGN line1="134" col1="28" line2="134" col2="29" start="17582" end="17583">&lt;-</LEFT_ASSIGN>
                      <expr line1="134" col1="31" line2="134" col2="52" start="17585" end="17606">
                        <expr line1="134" col1="31" line2="134" col2="38" start="17585" end="17592">
                          <SYMBOL_FUNCTION_CALL line1="134" col1="31" line2="134" col2="38" start="17585" end="17592">rownames</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="134" col1="39" line2="134" col2="39" start="17593" end="17593">(</OP-LEFT-PAREN>
                        <expr line1="134" col1="40" line2="134" col2="51" start="17594" end="17605">
                          <SYMBOL line1="134" col1="40" line2="134" col2="51" start="17594" end="17605">is_exprs_mat</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="134" col1="52" line2="134" col2="52" start="17606" end="17606">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="135" col1="13" line2="135" col2="13" start="17698" end="17698">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="136" col1="9" line2="136" col2="9" start="17825" end="17825">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="136" col1="11" line2="136" col2="14" start="17827" end="17830">else</ELSE>
              <expr line1="136" col1="16" line2="146" col2="9" start="17832" end="19135">
                <OP-LEFT-BRACE line1="136" col1="16" line2="136" col2="16" start="17832" end="17832">{</OP-LEFT-BRACE>
                <COMMENT line1="137" col1="13" line2="137" col2="90" start="17960" end="18037"># Counting expressing cells per gene, using the counts to define 'expressing'.</COMMENT>
                <expr line1="138" col1="13" line2="142" col2="13" start="18091" end="18615">
                  <IF line1="138" col1="13" line2="138" col2="14" start="18091" end="18092">if</IF>
                  <OP-LEFT-PAREN line1="138" col1="16" line2="138" col2="16" start="18094" end="18094">(</OP-LEFT-PAREN>
                  <expr line1="138" col1="17" line2="138" col2="35" start="18095" end="18113">
                    <expr line1="138" col1="17" line2="138" col2="23" start="18095" end="18101">
                      <SYMBOL_FUNCTION_CALL line1="138" col1="17" line2="138" col2="23" start="18095" end="18101">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="138" col1="24" line2="138" col2="24" start="18102" end="18102">(</OP-LEFT-PAREN>
                    <expr line1="138" col1="25" line2="138" col2="34" start="18103" end="18112">
                      <SYMBOL line1="138" col1="25" line2="138" col2="34" start="18103" end="18112">subset_col</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="138" col1="35" line2="138" col2="35" start="18113" end="18113">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="138" col1="36" line2="138" col2="36" start="18114" end="18114">)</OP-RIGHT-PAREN>
                  <expr line1="138" col1="38" line2="140" col2="13" start="18116" end="18353">
                    <OP-LEFT-BRACE line1="138" col1="38" line2="138" col2="38" start="18116" end="18116">{</OP-LEFT-BRACE>
                    <expr line1="139" col1="17" line2="139" col2="54" start="18226" end="18263">
                      <expr line1="139" col1="17" line2="139" col2="26" start="18226" end="18235">
                        <SYMBOL line1="139" col1="17" line2="139" col2="26" start="18226" end="18235">subset_col</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="139" col1="28" line2="139" col2="29" start="18237" end="18238">&lt;-</LEFT_ASSIGN>
                      <expr line1="139" col1="31" line2="139" col2="54" start="18240" end="18263">
                        <expr line1="139" col1="31" line2="139" col2="37" start="18240" end="18246">
                          <SYMBOL_FUNCTION_CALL line1="139" col1="31" line2="139" col2="37" start="18240" end="18246">seq_len</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="139" col1="38" line2="139" col2="38" start="18247" end="18247">(</OP-LEFT-PAREN>
                        <expr line1="139" col1="39" line2="139" col2="53" start="18248" end="18262">
                          <expr line1="139" col1="39" line2="139" col2="42" start="18248" end="18251">
                            <SYMBOL_FUNCTION_CALL line1="139" col1="39" line2="139" col2="42" start="18248" end="18251">ncol</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="139" col1="43" line2="139" col2="43" start="18252" end="18252">(</OP-LEFT-PAREN>
                          <expr line1="139" col1="44" line2="139" col2="52" start="18253" end="18261">
                            <SYMBOL line1="139" col1="44" line2="139" col2="52" start="18253" end="18261">exprs_mat</SYMBOL>
                          </expr>
                          <OP-RIGHT-PAREN line1="139" col1="53" line2="139" col2="53" start="18262" end="18262">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-RIGHT-PAREN line1="139" col1="54" line2="139" col2="54" start="18263" end="18263">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="140" col1="13" line2="140" col2="13" start="18353" end="18353">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="140" col1="15" line2="140" col2="18" start="18355" end="18358">else</ELSE>
                  <expr line1="140" col1="20" line2="142" col2="13" start="18360" end="18615">
                    <OP-LEFT-BRACE line1="140" col1="20" line2="140" col2="20" start="18360" end="18360">{</OP-LEFT-BRACE>
                    <expr line1="141" col1="17" line2="141" col2="81" start="18488" end="18552">
                      <expr line1="141" col1="17" line2="141" col2="26" start="18488" end="18497">
                        <SYMBOL line1="141" col1="17" line2="141" col2="26" start="18488" end="18497">subset_col</SYMBOL>
                      </expr>
                      <LEFT_ASSIGN line1="141" col1="28" line2="141" col2="29" start="18499" end="18500">&lt;-</LEFT_ASSIGN>
                      <expr line1="141" col1="31" line2="141" col2="81" start="18502" end="18552">
                        <expr line1="141" col1="31" line2="141" col2="43" start="18502" end="18514">
                          <SYMBOL_FUNCTION_CALL line1="141" col1="31" line2="141" col2="43" start="18502" end="18514">.subset2index</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="141" col1="44" line2="141" col2="44" start="18515" end="18515">(</OP-LEFT-PAREN>
                        <expr line1="141" col1="45" line2="141" col2="54" start="18516" end="18525">
                          <SYMBOL line1="141" col1="45" line2="141" col2="54" start="18516" end="18525">subset_col</SYMBOL>
                        </expr>
                        <OP-COMMA line1="141" col1="55" line2="141" col2="55" start="18526" end="18526">,</OP-COMMA>
                        <expr line1="141" col1="57" line2="141" col2="65" start="18528" end="18536">
                          <SYMBOL line1="141" col1="57" line2="141" col2="65" start="18528" end="18536">exprs_mat</SYMBOL>
                        </expr>
                        <OP-COMMA line1="141" col1="66" line2="141" col2="66" start="18537" end="18537">,</OP-COMMA>
                        <SYMBOL_SUB line1="141" col1="68" line2="141" col2="72" start="18539" end="18543">byrow</SYMBOL_SUB>
                        <EQ_SUB line1="141" col1="74" line2="141" col2="74" start="18545" end="18545">=</EQ_SUB>
                        <expr line1="141" col1="76" line2="141" col2="80" start="18547" end="18551">
                          <NUM_CONST line1="141" col1="76" line2="141" col2="80" start="18547" end="18551">FALSE</NUM_CONST>
                        </expr>
                        <OP-RIGHT-PAREN line1="141" col1="81" line2="141" col2="81" start="18552" end="18552">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-BRACE line1="142" col1="13" line2="142" col2="13" start="18615" end="18615">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <expr line1="143" col1="13" line2="144" col2="69" start="18746" end="18933">
                  <expr line1="143" col1="13" line2="143" col2="15" start="18746" end="18748">
                    <SYMBOL line1="143" col1="13" line2="143" col2="15" start="18746" end="18748">out</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="143" col1="17" line2="143" col2="18" start="18750" end="18751">&lt;-</LEFT_ASSIGN>
                  <expr line1="143" col1="20" line2="144" col2="69" start="18753" end="18933">
                    <expr line1="143" col1="20" line2="143" col2="31" start="18753" end="18764">
                      <SYMBOL_FUNCTION_CALL line1="143" col1="20" line2="143" col2="31" start="18753" end="18764">.checkedCall</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="143" col1="32" line2="143" col2="32" start="18765" end="18765">(</OP-LEFT-PAREN>
                    <expr line1="143" col1="33" line2="143" col2="55" start="18766" end="18788">
                      <SYMBOL line1="143" col1="33" line2="143" col2="55" start="18766" end="18788">cxx_rowsum_exprs_subset</SYMBOL>
                    </expr>
                    <OP-COMMA line1="143" col1="56" line2="143" col2="56" start="18789" end="18789">,</OP-COMMA>
                    <expr line1="143" col1="58" line2="143" col2="66" start="18791" end="18799">
                      <SYMBOL line1="143" col1="58" line2="143" col2="66" start="18791" end="18799">exprs_mat</SYMBOL>
                    </expr>
                    <OP-COMMA line1="143" col1="67" line2="143" col2="67" start="18800" end="18800">,</OP-COMMA>
                    <expr line1="144" col1="33" line2="144" col2="51" start="18897" end="18915">
                      <SYMBOL line1="144" col1="33" line2="144" col2="51" start="18897" end="18915">lowerDetectionLimit</SYMBOL>
                    </expr>
                    <OP-COMMA line1="144" col1="52" line2="144" col2="52" start="18916" end="18916">,</OP-COMMA>
                    <expr line1="144" col1="54" line2="144" col2="68" start="18918" end="18932">
                      <expr line1="144" col1="54" line2="144" col2="63" start="18918" end="18927">
                        <SYMBOL line1="144" col1="54" line2="144" col2="63" start="18918" end="18927">subset_col</SYMBOL>
                      </expr>
                      <OP-MINUS line1="144" col1="65" line2="144" col2="65" start="18929" end="18929">-</OP-MINUS>
                      <expr line1="144" col1="67" line2="144" col2="68" start="18931" end="18932">
                        <NUM_CONST line1="144" col1="67" line2="144" col2="68" start="18931" end="18932">1L</NUM_CONST>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="144" col1="69" line2="144" col2="69" start="18933" end="18933">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="145" col1="13" line2="145" col2="45" start="19008" end="19040">
                  <expr line1="145" col1="13" line2="145" col2="22" start="19008" end="19017">
                    <expr line1="145" col1="13" line2="145" col2="17" start="19008" end="19012">
                      <SYMBOL_FUNCTION_CALL line1="145" col1="13" line2="145" col2="17" start="19008" end="19012">names</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="145" col1="18" line2="145" col2="18" start="19013" end="19013">(</OP-LEFT-PAREN>
                    <expr line1="145" col1="19" line2="145" col2="21" start="19014" end="19016">
                      <SYMBOL line1="145" col1="19" line2="145" col2="21" start="19014" end="19016">out</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="145" col1="22" line2="145" col2="22" start="19017" end="19017">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="145" col1="24" line2="145" col2="25" start="19019" end="19020">&lt;-</LEFT_ASSIGN>
                  <expr line1="145" col1="27" line2="145" col2="45" start="19022" end="19040">
                    <expr line1="145" col1="27" line2="145" col2="34" start="19022" end="19029">
                      <SYMBOL_FUNCTION_CALL line1="145" col1="27" line2="145" col2="34" start="19022" end="19029">rownames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="145" col1="35" line2="145" col2="35" start="19030" end="19030">(</OP-LEFT-PAREN>
                    <expr line1="145" col1="36" line2="145" col2="44" start="19031" end="19039">
                      <SYMBOL line1="145" col1="36" line2="145" col2="44" start="19031" end="19039">exprs_mat</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="145" col1="45" line2="145" col2="45" start="19040" end="19040">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="146" col1="9" line2="146" col2="9" start="19135" end="19135">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="147" col1="5" line2="147" col2="5" start="19262" end="19262">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="148" col1="5" line2="148" col2="15" start="19393" end="19403">
          <expr line1="148" col1="5" line2="148" col2="10" start="19393" end="19398">
            <SYMBOL_FUNCTION_CALL line1="148" col1="5" line2="148" col2="10" start="19393" end="19398">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="148" col1="11" line2="148" col2="11" start="19399" end="19399">(</OP-LEFT-PAREN>
          <expr line1="148" col1="12" line2="148" col2="14" start="19400" end="19402">
            <SYMBOL line1="148" col1="12" line2="148" col2="14" start="19400" end="19402">out</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="148" col1="15" line2="148" col2="15" start="19403" end="19403">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="149" col1="1" line2="149" col2="1" start="19520" end="19520">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="151" col1="1" line2="151" col2="42" start="19782" end="19823">#' Calculate transcripts-per-million (TPM)</COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="2" start="19913" end="19914">#'</COMMENT>
  <COMMENT line1="153" col1="1" line2="153" col2="80" start="20044" end="20123">#' Calculate transcripts-per-million (TPM) values for expression from counts for</COMMENT>
  <COMMENT line1="154" col1="1" line2="154" col2="21" start="20175" end="20195">#' a set of features.</COMMENT>
  <COMMENT line1="155" col1="1" line2="155" col2="2" start="20306" end="20307">#'</COMMENT>
  <COMMENT line1="156" col1="1" line2="156" col2="40" start="20437" end="20476">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="157" col1="1" line2="157" col2="73" start="20568" end="20640">#' @param effective_length vector of class \code{"numeric"} providing the</COMMENT>
  <COMMENT line1="158" col1="1" line2="158" col2="64" start="20699" end="20762">#' effective length for each feature in the \code{SCESet} object</COMMENT>
  <COMMENT line1="159" col1="1" line2="159" col2="75" start="20830" end="20904">#' @param calc_from character string indicating whether to compute TPM from</COMMENT>
  <COMMENT line1="160" col1="1" line2="160" col2="78" start="20961" end="21038">#' \code{"counts"}, \code{"norm_counts"}, \code{"fpkm"} or \code{"norm_fpkm"}.</COMMENT>
  <COMMENT line1="161" col1="1" line2="161" col2="79" start="21092" end="21170">#' Default is to use \code{"counts"}, in which case the \code{effective_length}</COMMENT>
  <COMMENT line1="162" col1="1" line2="162" col2="29" start="21223" end="21251">#' argument must be supplied.</COMMENT>
  <COMMENT line1="163" col1="1" line2="163" col2="2" start="21354" end="21355">#'</COMMENT>
  <COMMENT line1="164" col1="1" line2="164" col2="32" start="21485" end="21516">#' @return Matrix of TPM values.</COMMENT>
  <COMMENT line1="165" col1="1" line2="165" col2="10" start="21616" end="21625">#' @export</COMMENT>
  <COMMENT line1="166" col1="1" line2="166" col2="12" start="21747" end="21758">#' @examples</COMMENT>
  <COMMENT line1="167" col1="1" line2="167" col2="28" start="21878" end="21905">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="168" col1="1" line2="168" col2="31" start="22009" end="22039">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="169" col1="1" line2="169" col2="63" start="22140" end="22202">#' pd &lt;- new("AnnotatedDataFrame", data = sc_example_cell_info)</COMMENT>
  <COMMENT line1="170" col1="1" line2="170" col2="77" start="22271" end="22347">#' example_sceset &lt;- newSCESet(countData = sc_example_counts, phenoData = pd)</COMMENT>
  <COMMENT line1="171" col1="1" line2="171" col2="38" start="22402" end="22439">#' effective_length &lt;- rep(1000, 2000)</COMMENT>
  <COMMENT line1="172" col1="1" line2="172" col2="72" start="22533" end="22604">#' tpm(example_sceset) &lt;- calculateTPM(example_sceset, effective_length,</COMMENT>
  <COMMENT line1="173" col1="1" line2="173" col2="28" start="22664" end="22691">#'     calc_from = "counts")</COMMENT>
  <COMMENT line1="174" col1="1" line2="174" col2="2" start="22795" end="22796">#'</COMMENT>
  <COMMENT line1="175" col1="1" line2="175" col2="25" start="22926" end="22950">#' ## calculate from FPKM</COMMENT>
  <COMMENT line1="176" col1="1" line2="176" col2="74" start="23057" end="23130">#' fpkm(example_sceset) &lt;- calculateFPKM(example_sceset, effective_length)</COMMENT>
  <COMMENT line1="177" col1="1" line2="177" col2="72" start="23188" end="23259">#' tpm(example_sceset) &lt;- calculateTPM(example_sceset, effective_length,</COMMENT>
  <COMMENT line1="178" col1="1" line2="178" col2="58" start="23319" end="23376">#'                                     calc_from = "fpkm")</COMMENT>
  <COMMENT line1="179" col1="1" line2="179" col2="2" start="23450" end="23451">#'</COMMENT>
  <expr line1="180" col1="1" line2="202" col2="1" start="23581" end="26463">
    <expr line1="180" col1="1" line2="180" col2="12" start="23581" end="23592">
      <SYMBOL line1="180" col1="1" line2="180" col2="12" start="23581" end="23592">calculateTPM</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="180" col1="14" line2="180" col2="15" start="23594" end="23595">&lt;-</LEFT_ASSIGN>
    <expr line1="180" col1="17" line2="202" col2="1" start="23597" end="26463">
      <FUNCTION line1="180" col1="17" line2="180" col2="24" start="23597" end="23604">function</FUNCTION>
      <OP-LEFT-PAREN line1="180" col1="25" line2="180" col2="25" start="23605" end="23605">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="180" col1="26" line2="180" col2="31" start="23606" end="23611">object</SYMBOL_FORMALS>
      <OP-COMMA line1="180" col1="32" line2="180" col2="32" start="23612" end="23612">,</OP-COMMA>
      <SYMBOL_FORMALS line1="180" col1="34" line2="180" col2="49" start="23614" end="23629">effective_length</SYMBOL_FORMALS>
      <EQ_FORMALS line1="180" col1="51" line2="180" col2="51" start="23631" end="23631">=</EQ_FORMALS>
      <expr line1="180" col1="53" line2="180" col2="56" start="23633" end="23636">
        <NULL_CONST line1="180" col1="53" line2="180" col2="56" start="23633" end="23636">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="180" col1="57" line2="180" col2="57" start="23637" end="23637">,</OP-COMMA>
      <SYMBOL_FORMALS line1="180" col1="59" line2="180" col2="67" start="23639" end="23647">calc_from</SYMBOL_FORMALS>
      <EQ_FORMALS line1="180" col1="69" line2="180" col2="69" start="23649" end="23649">=</EQ_FORMALS>
      <expr line1="180" col1="71" line2="180" col2="78" start="23651" end="23658">
        <STR_CONST line1="180" col1="71" line2="180" col2="78" start="23651" end="23658">"counts"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="180" col1="79" line2="180" col2="79" start="23659" end="23659">)</OP-RIGHT-PAREN>
      <expr line1="180" col1="81" line2="202" col2="1" start="23661" end="26463">
        <OP-LEFT-BRACE line1="180" col1="81" line2="180" col2="81" start="23661" end="23661">{</OP-LEFT-BRACE>
        <expr line1="181" col1="5" line2="182" col2="40" start="23716" end="23882">
          <IF line1="181" col1="5" line2="181" col2="6" start="23716" end="23717">if</IF>
          <OP-LEFT-PAREN line1="181" col1="8" line2="181" col2="8" start="23719" end="23719">(</OP-LEFT-PAREN>
          <expr line1="181" col1="10" line2="181" col2="30" start="23721" end="23741">
            <OP-EXCLAMATION line1="181" col1="10" line2="181" col2="10" start="23721" end="23721">!</OP-EXCLAMATION>
            <expr line1="181" col1="11" line2="181" col2="30" start="23722" end="23741">
              <expr line1="181" col1="11" line2="181" col2="12" start="23722" end="23723">
                <SYMBOL_FUNCTION_CALL line1="181" col1="11" line2="181" col2="12" start="23722" end="23723">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="181" col1="13" line2="181" col2="13" start="23724" end="23724">(</OP-LEFT-PAREN>
              <expr line1="181" col1="14" line2="181" col2="19" start="23725" end="23730">
                <SYMBOL line1="181" col1="14" line2="181" col2="19" start="23725" end="23730">object</SYMBOL>
              </expr>
              <OP-COMMA line1="181" col1="20" line2="181" col2="20" start="23731" end="23731">,</OP-COMMA>
              <expr line1="181" col1="22" line2="181" col2="29" start="23733" end="23740">
                <STR_CONST line1="181" col1="22" line2="181" col2="29" start="23733" end="23740">"SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="181" col1="30" line2="181" col2="30" start="23741" end="23741">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="181" col1="31" line2="181" col2="31" start="23742" end="23742">)</OP-RIGHT-PAREN>
          <expr line1="182" col1="9" line2="182" col2="40" start="23851" end="23882">
            <expr line1="182" col1="9" line2="182" col2="12" start="23851" end="23854">
              <SYMBOL_FUNCTION_CALL line1="182" col1="9" line2="182" col2="12" start="23851" end="23854">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="182" col1="13" line2="182" col2="13" start="23855" end="23855">(</OP-LEFT-PAREN>
            <expr line1="182" col1="14" line2="182" col2="39" start="23856" end="23881">
              <STR_CONST line1="182" col1="14" line2="182" col2="39" start="23856" end="23881">"object must be an SCESet"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="182" col1="40" line2="182" col2="40" start="23882" end="23882">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="183" col1="5" line2="183" col2="39" start="23978" end="24012">## Check that arguments are correct</COMMENT>
        <expr line1="184" col1="5" line2="185" col2="73" start="24109" end="24308">
          <expr line1="184" col1="5" line2="184" col2="13" start="24109" end="24117">
            <SYMBOL line1="184" col1="5" line2="184" col2="13" start="24109" end="24117">calc_from</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="184" col1="15" line2="184" col2="16" start="24119" end="24120">&lt;-</LEFT_ASSIGN>
          <expr line1="184" col1="18" line2="185" col2="73" start="24122" end="24308">
            <expr line1="184" col1="18" line2="184" col2="26" start="24122" end="24130">
              <SYMBOL_FUNCTION_CALL line1="184" col1="18" line2="184" col2="26" start="24122" end="24130">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="184" col1="27" line2="184" col2="27" start="24131" end="24131">(</OP-LEFT-PAREN>
            <expr line1="184" col1="28" line2="184" col2="36" start="24132" end="24140">
              <SYMBOL line1="184" col1="28" line2="184" col2="36" start="24132" end="24140">calc_from</SYMBOL>
            </expr>
            <OP-COMMA line1="184" col1="37" line2="184" col2="37" start="24141" end="24141">,</OP-COMMA>
            <expr line1="184" col1="39" line2="185" col2="52" start="24143" end="24287">
              <expr line1="184" col1="39" line2="184" col2="39" start="24143" end="24143">
                <SYMBOL_FUNCTION_CALL line1="184" col1="39" line2="184" col2="39" start="24143" end="24143">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="184" col1="40" line2="184" col2="40" start="24144" end="24144">(</OP-LEFT-PAREN>
              <expr line1="184" col1="41" line2="184" col2="48" start="24145" end="24152">
                <STR_CONST line1="184" col1="41" line2="184" col2="48" start="24145" end="24152">"counts"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="49" line2="184" col2="49" start="24153" end="24153">,</OP-COMMA>
              <expr line1="184" col1="51" line2="184" col2="63" start="24155" end="24167">
                <STR_CONST line1="184" col1="51" line2="184" col2="63" start="24155" end="24167">"norm_counts"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="64" line2="184" col2="64" start="24168" end="24168">,</OP-COMMA>
              <expr line1="184" col1="66" line2="184" col2="71" start="24170" end="24175">
                <STR_CONST line1="184" col1="66" line2="184" col2="71" start="24170" end="24175">"fpkm"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="72" line2="184" col2="72" start="24176" end="24176">,</OP-COMMA>
              <expr line1="185" col1="41" line2="185" col2="51" start="24276" end="24286">
                <STR_CONST line1="185" col1="41" line2="185" col2="51" start="24276" end="24286">"norm_fpkm"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="185" col1="52" line2="185" col2="52" start="24287" end="24287">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="185" col1="53" line2="185" col2="53" start="24288" end="24288">,</OP-COMMA>
            <SYMBOL_SUB line1="185" col1="55" line2="185" col2="64" start="24290" end="24299">several.ok</SYMBOL_SUB>
            <EQ_SUB line1="185" col1="66" line2="185" col2="66" start="24301" end="24301">=</EQ_SUB>
            <expr line1="185" col1="68" line2="185" col2="72" start="24303" end="24307">
              <NUM_CONST line1="185" col1="68" line2="185" col2="72" start="24303" end="24307">FALSE</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="185" col1="73" line2="185" col2="73" start="24308" end="24308">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="186" col1="5" line2="189" col2="5" start="24371" end="24764">
          <IF line1="186" col1="5" line2="186" col2="6" start="24371" end="24372">if</IF>
          <OP-LEFT-PAREN line1="186" col1="8" line2="186" col2="8" start="24374" end="24374">(</OP-LEFT-PAREN>
          <expr line1="186" col1="10" line2="186" col2="60" start="24376" end="24426">
            <expr line1="186" col1="10" line2="186" col2="30" start="24376" end="24396">
              <expr line1="186" col1="10" line2="186" col2="18" start="24376" end="24384">
                <SYMBOL line1="186" col1="10" line2="186" col2="18" start="24376" end="24384">calc_from</SYMBOL>
              </expr>
              <EQ line1="186" col1="20" line2="186" col2="21" start="24386" end="24387">==</EQ>
              <expr line1="186" col1="23" line2="186" col2="30" start="24389" end="24396">
                <STR_CONST line1="186" col1="23" line2="186" col2="30" start="24389" end="24396">"counts"</STR_CONST>
              </expr>
            </expr>
            <OR2 line1="186" col1="32" line2="186" col2="33" start="24398" end="24399">||</OR2>
            <expr line1="186" col1="35" line2="186" col2="60" start="24401" end="24426">
              <expr line1="186" col1="35" line2="186" col2="43" start="24401" end="24409">
                <SYMBOL line1="186" col1="35" line2="186" col2="43" start="24401" end="24409">calc_from</SYMBOL>
              </expr>
              <EQ line1="186" col1="45" line2="186" col2="46" start="24411" end="24412">==</EQ>
              <expr line1="186" col1="48" line2="186" col2="60" start="24414" end="24426">
                <STR_CONST line1="186" col1="48" line2="186" col2="60" start="24414" end="24426">"norm_counts"</STR_CONST>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="186" col1="62" line2="186" col2="62" start="24428" end="24428">)</OP-RIGHT-PAREN>
          <expr line1="186" col1="64" line2="189" col2="5" start="24430" end="24764">
            <OP-LEFT-BRACE line1="186" col1="64" line2="186" col2="64" start="24430" end="24430">{</OP-LEFT-BRACE>
            <expr line1="187" col1="9" line2="188" col2="86" start="24506" end="24714">
              <IF line1="187" col1="9" line2="187" col2="10" start="24506" end="24507">if</IF>
              <OP-LEFT-PAREN line1="187" col1="12" line2="187" col2="12" start="24509" end="24509">(</OP-LEFT-PAREN>
              <expr line1="187" col1="14" line2="187" col2="38" start="24511" end="24535">
                <expr line1="187" col1="14" line2="187" col2="20" start="24511" end="24517">
                  <SYMBOL_FUNCTION_CALL line1="187" col1="14" line2="187" col2="20" start="24511" end="24517">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="187" col1="21" line2="187" col2="21" start="24518" end="24518">(</OP-LEFT-PAREN>
                <expr line1="187" col1="22" line2="187" col2="37" start="24519" end="24534">
                  <SYMBOL line1="187" col1="22" line2="187" col2="37" start="24519" end="24534">effective_length</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="187" col1="38" line2="187" col2="38" start="24535" end="24535">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="187" col1="40" line2="187" col2="40" start="24537" end="24537">)</OP-RIGHT-PAREN>
              <expr line1="188" col1="13" line2="188" col2="86" start="24641" end="24714">
                <expr line1="188" col1="13" line2="188" col2="16" start="24641" end="24644">
                  <SYMBOL_FUNCTION_CALL line1="188" col1="13" line2="188" col2="16" start="24641" end="24644">stop</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="188" col1="17" line2="188" col2="17" start="24645" end="24645">(</OP-LEFT-PAREN>
                <expr line1="188" col1="18" line2="188" col2="85" start="24646" end="24713">
                  <STR_CONST line1="188" col1="18" line2="188" col2="85" start="24646" end="24713">"effective_length argument is required if computing TPM from counts"</STR_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="188" col1="86" line2="188" col2="86" start="24714" end="24714">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="189" col1="5" line2="189" col2="5" start="24764" end="24764">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="190" col1="5" line2="190" col2="31" start="24895" end="24921">## Compute values to return</COMMENT>
        <expr line1="191" col1="5" line2="196" col2="67" start="25026" end="25743">
          <expr line1="191" col1="5" line2="191" col2="14" start="25026" end="25035">
            <SYMBOL line1="191" col1="5" line2="191" col2="14" start="25026" end="25035">tpm_to_add</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="191" col1="16" line2="191" col2="17" start="25037" end="25038">&lt;-</LEFT_ASSIGN>
          <expr line1="191" col1="19" line2="196" col2="67" start="25040" end="25743">
            <expr line1="191" col1="19" line2="191" col2="24" start="25040" end="25045">
              <SYMBOL_FUNCTION_CALL line1="191" col1="19" line2="191" col2="24" start="25040" end="25045">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="191" col1="25" line2="191" col2="25" start="25046" end="25046">(</OP-LEFT-PAREN>
            <expr line1="191" col1="26" line2="191" col2="34" start="25047" end="25055">
              <SYMBOL line1="191" col1="26" line2="191" col2="34" start="25047" end="25055">calc_from</SYMBOL>
            </expr>
            <OP-COMMA line1="191" col1="35" line2="191" col2="35" start="25056" end="25056">,</OP-COMMA>
            <SYMBOL_SUB line1="192" col1="26" line2="192" col2="31" start="25178" end="25183">counts</SYMBOL_SUB>
            <EQ_SUB line1="192" col1="33" line2="192" col2="33" start="25185" end="25185">=</EQ_SUB>
            <expr line1="192" col1="35" line2="192" col2="79" start="25187" end="25231">
              <expr line1="192" col1="35" line2="192" col2="45" start="25187" end="25197">
                <SYMBOL_FUNCTION_CALL line1="192" col1="35" line2="192" col2="45" start="25187" end="25197">.countToTpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="192" col1="46" line2="192" col2="46" start="25198" end="25198">(</OP-LEFT-PAREN>
              <expr line1="192" col1="47" line2="192" col2="60" start="25199" end="25212">
                <expr line1="192" col1="47" line2="192" col2="52" start="25199" end="25204">
                  <SYMBOL_FUNCTION_CALL line1="192" col1="47" line2="192" col2="52" start="25199" end="25204">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="192" col1="53" line2="192" col2="53" start="25205" end="25205">(</OP-LEFT-PAREN>
                <expr line1="192" col1="54" line2="192" col2="59" start="25206" end="25211">
                  <SYMBOL line1="192" col1="54" line2="192" col2="59" start="25206" end="25211">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="192" col1="60" line2="192" col2="60" start="25212" end="25212">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="192" col1="61" line2="192" col2="61" start="25213" end="25213">,</OP-COMMA>
              <expr line1="192" col1="63" line2="192" col2="78" start="25215" end="25230">
                <SYMBOL line1="192" col1="63" line2="192" col2="78" start="25215" end="25230">effective_length</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="192" col1="79" line2="192" col2="79" start="25231" end="25231">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="192" col1="80" line2="192" col2="80" start="25232" end="25232">,</OP-COMMA>
            <SYMBOL_SUB line1="193" col1="26" line2="193" col2="36" start="25309" end="25319">norm_counts</SYMBOL_SUB>
            <EQ_SUB line1="193" col1="38" line2="193" col2="38" start="25321" end="25321">=</EQ_SUB>
            <expr line1="193" col1="40" line2="194" col2="69" start="25323" end="25483">
              <expr line1="193" col1="40" line2="193" col2="50" start="25323" end="25333">
                <SYMBOL_FUNCTION_CALL line1="193" col1="40" line2="193" col2="50" start="25323" end="25333">.countToTpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="193" col1="51" line2="193" col2="51" start="25334" end="25334">(</OP-LEFT-PAREN>
              <expr line1="193" col1="52" line2="193" col2="70" start="25335" end="25353">
                <expr line1="193" col1="52" line2="193" col2="62" start="25335" end="25345">
                  <SYMBOL_FUNCTION_CALL line1="193" col1="52" line2="193" col2="62" start="25335" end="25345">norm_counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="193" col1="63" line2="193" col2="63" start="25346" end="25346">(</OP-LEFT-PAREN>
                <expr line1="193" col1="64" line2="193" col2="69" start="25347" end="25352">
                  <SYMBOL line1="193" col1="64" line2="193" col2="69" start="25347" end="25352">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="193" col1="70" line2="193" col2="70" start="25353" end="25353">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="193" col1="71" line2="193" col2="71" start="25354" end="25354">,</OP-COMMA>
              <expr line1="194" col1="53" line2="194" col2="68" start="25467" end="25482">
                <SYMBOL line1="194" col1="53" line2="194" col2="68" start="25467" end="25482">effective_length</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="194" col1="69" line2="194" col2="69" start="25483" end="25483">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="194" col1="70" line2="194" col2="70" start="25484" end="25484">,</OP-COMMA>
            <SYMBOL_SUB line1="195" col1="26" line2="195" col2="29" start="25571" end="25574">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="195" col1="31" line2="195" col2="31" start="25576" end="25576">=</EQ_SUB>
            <expr line1="195" col1="33" line2="195" col2="56" start="25578" end="25601">
              <expr line1="195" col1="33" line2="195" col2="42" start="25578" end="25587">
                <SYMBOL_FUNCTION_CALL line1="195" col1="33" line2="195" col2="42" start="25578" end="25587">.fpkmToTpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="195" col1="43" line2="195" col2="43" start="25588" end="25588">(</OP-LEFT-PAREN>
              <expr line1="195" col1="44" line2="195" col2="55" start="25589" end="25600">
                <expr line1="195" col1="44" line2="195" col2="47" start="25589" end="25592">
                  <SYMBOL_FUNCTION_CALL line1="195" col1="44" line2="195" col2="47" start="25589" end="25592">fpkm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="195" col1="48" line2="195" col2="48" start="25593" end="25593">(</OP-LEFT-PAREN>
                <expr line1="195" col1="49" line2="195" col2="54" start="25594" end="25599">
                  <SYMBOL line1="195" col1="49" line2="195" col2="54" start="25594" end="25599">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="195" col1="55" line2="195" col2="55" start="25600" end="25600">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="195" col1="56" line2="195" col2="56" start="25601" end="25601">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="195" col1="57" line2="195" col2="57" start="25602" end="25602">,</OP-COMMA>
            <SYMBOL_SUB line1="196" col1="26" line2="196" col2="34" start="25702" end="25710">norm_fpkm</SYMBOL_SUB>
            <EQ_SUB line1="196" col1="36" line2="196" col2="36" start="25712" end="25712">=</EQ_SUB>
            <expr line1="196" col1="38" line2="196" col2="66" start="25714" end="25742">
              <expr line1="196" col1="38" line2="196" col2="47" start="25714" end="25723">
                <SYMBOL_FUNCTION_CALL line1="196" col1="38" line2="196" col2="47" start="25714" end="25723">.fpkmToTpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="196" col1="48" line2="196" col2="48" start="25724" end="25724">(</OP-LEFT-PAREN>
              <expr line1="196" col1="49" line2="196" col2="65" start="25725" end="25741">
                <expr line1="196" col1="49" line2="196" col2="57" start="25725" end="25733">
                  <SYMBOL_FUNCTION_CALL line1="196" col1="49" line2="196" col2="57" start="25725" end="25733">norm_fpkm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="196" col1="58" line2="196" col2="58" start="25734" end="25734">(</OP-LEFT-PAREN>
                <expr line1="196" col1="59" line2="196" col2="64" start="25735" end="25740">
                  <SYMBOL line1="196" col1="59" line2="196" col2="64" start="25735" end="25740">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="196" col1="65" line2="196" col2="65" start="25741" end="25741">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="196" col1="66" line2="196" col2="66" start="25742" end="25742">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="196" col1="67" line2="196" col2="67" start="25743" end="25743">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="198" col1="5" line2="198" col2="24" start="25943" end="25962">## Return TPM values</COMMENT>
        <expr line1="199" col1="5" line2="199" col2="48" start="26074" end="26117">
          <expr line1="199" col1="5" line2="199" col2="24" start="26074" end="26093">
            <expr line1="199" col1="5" line2="199" col2="12" start="26074" end="26081">
              <SYMBOL_FUNCTION_CALL line1="199" col1="5" line2="199" col2="12" start="26074" end="26081">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="199" col1="13" line2="199" col2="13" start="26082" end="26082">(</OP-LEFT-PAREN>
            <expr line1="199" col1="14" line2="199" col2="23" start="26083" end="26092">
              <SYMBOL line1="199" col1="14" line2="199" col2="23" start="26083" end="26092">tpm_to_add</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="199" col1="24" line2="199" col2="24" start="26093" end="26093">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="199" col1="26" line2="199" col2="27" start="26095" end="26096">&lt;-</LEFT_ASSIGN>
          <expr line1="199" col1="29" line2="199" col2="48" start="26098" end="26117">
            <expr line1="199" col1="29" line2="199" col2="40" start="26098" end="26109">
              <SYMBOL_FUNCTION_CALL line1="199" col1="29" line2="199" col2="40" start="26098" end="26109">featureNames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="199" col1="41" line2="199" col2="41" start="26110" end="26110">(</OP-LEFT-PAREN>
            <expr line1="199" col1="42" line2="199" col2="47" start="26111" end="26116">
              <SYMBOL line1="199" col1="42" line2="199" col2="47" start="26111" end="26116">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="199" col1="48" line2="199" col2="48" start="26117" end="26117">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="200" col1="5" line2="200" col2="44" start="26205" end="26244">
          <expr line1="200" col1="5" line2="200" col2="24" start="26205" end="26224">
            <expr line1="200" col1="5" line2="200" col2="12" start="26205" end="26212">
              <SYMBOL_FUNCTION_CALL line1="200" col1="5" line2="200" col2="12" start="26205" end="26212">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="200" col1="13" line2="200" col2="13" start="26213" end="26213">(</OP-LEFT-PAREN>
            <expr line1="200" col1="14" line2="200" col2="23" start="26214" end="26223">
              <SYMBOL line1="200" col1="14" line2="200" col2="23" start="26214" end="26223">tpm_to_add</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="200" col1="24" line2="200" col2="24" start="26224" end="26224">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="200" col1="26" line2="200" col2="27" start="26226" end="26227">&lt;-</LEFT_ASSIGN>
          <expr line1="200" col1="29" line2="200" col2="44" start="26229" end="26244">
            <expr line1="200" col1="29" line2="200" col2="36" start="26229" end="26236">
              <SYMBOL_FUNCTION_CALL line1="200" col1="29" line2="200" col2="36" start="26229" end="26236">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="200" col1="37" line2="200" col2="37" start="26237" end="26237">(</OP-LEFT-PAREN>
            <expr line1="200" col1="38" line2="200" col2="43" start="26238" end="26243">
              <SYMBOL line1="200" col1="38" line2="200" col2="43" start="26238" end="26243">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="200" col1="44" line2="200" col2="44" start="26244" end="26244">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="201" col1="5" line2="201" col2="14" start="26336" end="26345">
          <SYMBOL line1="201" col1="5" line2="201" col2="14" start="26336" end="26345">tpm_to_add</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="202" col1="1" line2="202" col2="1" start="26463" end="26463">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="204" col1="1" line2="214" col2="1" start="26725" end="28035">
    <expr line1="204" col1="1" line2="204" col2="11" start="26725" end="26735">
      <SYMBOL line1="204" col1="1" line2="204" col2="11" start="26725" end="26735">.countToTpm</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="204" col1="13" line2="204" col2="14" start="26737" end="26738">&lt;-</LEFT_ASSIGN>
    <expr line1="204" col1="16" line2="214" col2="1" start="26740" end="28035">
      <FUNCTION line1="204" col1="16" line2="204" col2="23" start="26740" end="26747">function</FUNCTION>
      <OP-LEFT-PAREN line1="204" col1="24" line2="204" col2="24" start="26748" end="26748">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="204" col1="25" line2="204" col2="30" start="26749" end="26754">counts</SYMBOL_FORMALS>
      <OP-COMMA line1="204" col1="31" line2="204" col2="31" start="26755" end="26755">,</OP-COMMA>
      <SYMBOL_FORMALS line1="204" col1="33" line2="204" col2="39" start="26757" end="26763">eff_len</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="204" col1="40" line2="204" col2="40" start="26764" end="26764">)</OP-RIGHT-PAREN>
      <expr line1="204" col1="42" line2="214" col2="1" start="26766" end="28035">
        <OP-LEFT-BRACE line1="204" col1="42" line2="204" col2="42" start="26766" end="26766">{</OP-LEFT-BRACE>
        <COMMENT line1="205" col1="5" line2="205" col2="53" start="26860" end="26908">## Expecting a count matrix of nfeatures x ncells</COMMENT>
        <COMMENT line1="206" col1="5" line2="206" col2="60" start="26991" end="27046">## can't have any zero counts, so expect to apply offset</COMMENT>
        <expr line1="207" col1="5" line2="207" col2="21" start="27122" end="27138">
          <expr line1="207" col1="5" line2="207" col2="11" start="27122" end="27128">
            <SYMBOL line1="207" col1="5" line2="207" col2="11" start="27122" end="27128">counts0</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="207" col1="13" line2="207" col2="14" start="27130" end="27131">&lt;-</LEFT_ASSIGN>
          <expr line1="207" col1="16" line2="207" col2="21" start="27133" end="27138">
            <SYMBOL line1="207" col1="16" line2="207" col2="21" start="27133" end="27138">counts</SYMBOL>
          </expr>
        </expr>
        <expr line1="208" col1="5" line2="208" col2="30" start="27253" end="27278">
          <expr line1="208" col1="5" line2="208" col2="24" start="27253" end="27272">
            <expr line1="208" col1="5" line2="208" col2="11" start="27253" end="27259">
              <SYMBOL line1="208" col1="5" line2="208" col2="11" start="27253" end="27259">counts0</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="208" col1="12" line2="208" col2="12" start="27260" end="27260">[</OP-LEFT-BRACKET>
            <expr line1="208" col1="13" line2="208" col2="23" start="27261" end="27271">
              <expr line1="208" col1="13" line2="208" col2="18" start="27261" end="27266">
                <SYMBOL line1="208" col1="13" line2="208" col2="18" start="27261" end="27266">counts</SYMBOL>
              </expr>
              <EQ line1="208" col1="20" line2="208" col2="21" start="27268" end="27269">==</EQ>
              <expr line1="208" col1="23" line2="208" col2="23" start="27271" end="27271">
                <NUM_CONST line1="208" col1="23" line2="208" col2="23" start="27271" end="27271">0</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-BRACKET line1="208" col1="24" line2="208" col2="24" start="27272" end="27272">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="208" col1="26" line2="208" col2="27" start="27274" end="27275">&lt;-</LEFT_ASSIGN>
          <expr line1="208" col1="29" line2="208" col2="30" start="27277" end="27278">
            <NUM_CONST line1="208" col1="29" line2="208" col2="30" start="27277" end="27278">NA</NUM_CONST>
          </expr>
        </expr>
        <expr line1="209" col1="5" line2="209" col2="39" start="27384" end="27418">
          <expr line1="209" col1="5" line2="209" col2="8" start="27384" end="27387">
            <SYMBOL line1="209" col1="5" line2="209" col2="8" start="27384" end="27387">rate</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="209" col1="10" line2="209" col2="11" start="27389" end="27390">&lt;-</LEFT_ASSIGN>
          <expr line1="209" col1="13" line2="209" col2="39" start="27392" end="27418">
            <expr line1="209" col1="13" line2="209" col2="24" start="27392" end="27403">
              <expr line1="209" col1="13" line2="209" col2="15" start="27392" end="27394">
                <SYMBOL_FUNCTION_CALL line1="209" col1="13" line2="209" col2="15" start="27392" end="27394">log</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="209" col1="16" line2="209" col2="16" start="27395" end="27395">(</OP-LEFT-PAREN>
              <expr line1="209" col1="17" line2="209" col2="23" start="27396" end="27402">
                <SYMBOL line1="209" col1="17" line2="209" col2="23" start="27396" end="27402">counts0</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="209" col1="24" line2="209" col2="24" start="27403" end="27403">)</OP-RIGHT-PAREN>
            </expr>
            <OP-MINUS line1="209" col1="26" line2="209" col2="26" start="27405" end="27405">-</OP-MINUS>
            <expr line1="209" col1="28" line2="209" col2="39" start="27407" end="27418">
              <expr line1="209" col1="28" line2="209" col2="30" start="27407" end="27409">
                <SYMBOL_FUNCTION_CALL line1="209" col1="28" line2="209" col2="30" start="27407" end="27409">log</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="209" col1="31" line2="209" col2="31" start="27410" end="27410">(</OP-LEFT-PAREN>
              <expr line1="209" col1="32" line2="209" col2="38" start="27411" end="27417">
                <SYMBOL line1="209" col1="32" line2="209" col2="38" start="27411" end="27417">eff_len</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="209" col1="39" line2="209" col2="39" start="27418" end="27418">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="210" col1="5" line2="210" col2="50" start="27515" end="27560">
          <expr line1="210" col1="5" line2="210" col2="9" start="27515" end="27519">
            <SYMBOL line1="210" col1="5" line2="210" col2="9" start="27515" end="27519">denom</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="210" col1="11" line2="210" col2="12" start="27521" end="27522">&lt;-</LEFT_ASSIGN>
          <expr line1="210" col1="14" line2="210" col2="50" start="27524" end="27560">
            <expr line1="210" col1="14" line2="210" col2="16" start="27524" end="27526">
              <SYMBOL_FUNCTION_CALL line1="210" col1="14" line2="210" col2="16" start="27524" end="27526">log</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="210" col1="17" line2="210" col2="17" start="27527" end="27527">(</OP-LEFT-PAREN>
            <expr line1="210" col1="18" line2="210" col2="49" start="27528" end="27559">
              <expr line1="210" col1="18" line2="210" col2="24" start="27528" end="27534">
                <SYMBOL_FUNCTION_CALL line1="210" col1="18" line2="210" col2="24" start="27528" end="27534">colSums</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="210" col1="25" line2="210" col2="25" start="27535" end="27535">(</OP-LEFT-PAREN>
              <expr line1="210" col1="26" line2="210" col2="34" start="27536" end="27544">
                <expr line1="210" col1="26" line2="210" col2="28" start="27536" end="27538">
                  <SYMBOL_FUNCTION_CALL line1="210" col1="26" line2="210" col2="28" start="27536" end="27538">exp</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="210" col1="29" line2="210" col2="29" start="27539" end="27539">(</OP-LEFT-PAREN>
                <expr line1="210" col1="30" line2="210" col2="33" start="27540" end="27543">
                  <SYMBOL line1="210" col1="30" line2="210" col2="33" start="27540" end="27543">rate</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="210" col1="34" line2="210" col2="34" start="27544" end="27544">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="210" col1="35" line2="210" col2="35" start="27545" end="27545">,</OP-COMMA>
              <SYMBOL_SUB line1="210" col1="37" line2="210" col2="41" start="27547" end="27551">na.rm</SYMBOL_SUB>
              <EQ_SUB line1="210" col1="43" line2="210" col2="43" start="27553" end="27553">=</EQ_SUB>
              <expr line1="210" col1="45" line2="210" col2="48" start="27555" end="27558">
                <NUM_CONST line1="210" col1="45" line2="210" col2="48" start="27555" end="27558">TRUE</NUM_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="210" col1="49" line2="210" col2="49" start="27559" end="27559">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="210" col1="50" line2="210" col2="50" start="27560" end="27560">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="211" col1="5" line2="211" col2="47" start="27646" end="27688">
          <expr line1="211" col1="5" line2="211" col2="7" start="27646" end="27648">
            <SYMBOL line1="211" col1="5" line2="211" col2="7" start="27646" end="27648">out</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="211" col1="9" line2="211" col2="10" start="27650" end="27651">&lt;-</LEFT_ASSIGN>
          <expr line1="211" col1="12" line2="211" col2="47" start="27653" end="27688">
            <expr line1="211" col1="12" line2="211" col2="14" start="27653" end="27655">
              <SYMBOL_FUNCTION_CALL line1="211" col1="12" line2="211" col2="14" start="27653" end="27655">exp</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="211" col1="15" line2="211" col2="15" start="27656" end="27656">(</OP-LEFT-PAREN>
            <expr line1="211" col1="17" line2="211" col2="45" start="27658" end="27686">
              <expr line1="211" col1="17" line2="211" col2="34" start="27658" end="27675">
                <expr line1="211" col1="17" line2="211" col2="17" start="27658" end="27658">
                  <SYMBOL_FUNCTION_CALL line1="211" col1="17" line2="211" col2="17" start="27658" end="27658">t</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="211" col1="18" line2="211" col2="18" start="27659" end="27659">(</OP-LEFT-PAREN>
                <expr line1="211" col1="19" line2="211" col2="33" start="27660" end="27674">
                  <expr line1="211" col1="19" line2="211" col2="25" start="27660" end="27666">
                    <expr line1="211" col1="19" line2="211" col2="19" start="27660" end="27660">
                      <SYMBOL_FUNCTION_CALL line1="211" col1="19" line2="211" col2="19" start="27660" end="27660">t</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="211" col1="20" line2="211" col2="20" start="27661" end="27661">(</OP-LEFT-PAREN>
                    <expr line1="211" col1="21" line2="211" col2="24" start="27662" end="27665">
                      <SYMBOL line1="211" col1="21" line2="211" col2="24" start="27662" end="27665">rate</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="211" col1="25" line2="211" col2="25" start="27666" end="27666">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-MINUS line1="211" col1="27" line2="211" col2="27" start="27668" end="27668">-</OP-MINUS>
                  <expr line1="211" col1="29" line2="211" col2="33" start="27670" end="27674">
                    <SYMBOL line1="211" col1="29" line2="211" col2="33" start="27670" end="27674">denom</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="211" col1="34" line2="211" col2="34" start="27675" end="27675">)</OP-RIGHT-PAREN>
              </expr>
              <OP-PLUS line1="211" col1="36" line2="211" col2="36" start="27677" end="27677">+</OP-PLUS>
              <expr line1="211" col1="38" line2="211" col2="45" start="27679" end="27686">
                <expr line1="211" col1="38" line2="211" col2="40" start="27679" end="27681">
                  <SYMBOL_FUNCTION_CALL line1="211" col1="38" line2="211" col2="40" start="27679" end="27681">log</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="211" col1="41" line2="211" col2="41" start="27682" end="27682">(</OP-LEFT-PAREN>
                <expr line1="211" col1="42" line2="211" col2="44" start="27683" end="27685">
                  <NUM_CONST line1="211" col1="42" line2="211" col2="44" start="27683" end="27685">1e6</NUM_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="211" col1="45" line2="211" col2="45" start="27686" end="27686">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="211" col1="47" line2="211" col2="47" start="27688" end="27688">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="212" col1="5" line2="212" col2="24" start="27777" end="27796">
          <expr line1="212" col1="5" line2="212" col2="19" start="27777" end="27791">
            <expr line1="212" col1="5" line2="212" col2="7" start="27777" end="27779">
              <SYMBOL line1="212" col1="5" line2="212" col2="7" start="27777" end="27779">out</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="212" col1="8" line2="212" col2="8" start="27780" end="27780">[</OP-LEFT-BRACKET>
            <expr line1="212" col1="9" line2="212" col2="18" start="27781" end="27790">
              <expr line1="212" col1="9" line2="212" col2="13" start="27781" end="27785">
                <SYMBOL_FUNCTION_CALL line1="212" col1="9" line2="212" col2="13" start="27781" end="27785">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="212" col1="14" line2="212" col2="14" start="27786" end="27786">(</OP-LEFT-PAREN>
              <expr line1="212" col1="15" line2="212" col2="17" start="27787" end="27789">
                <SYMBOL line1="212" col1="15" line2="212" col2="17" start="27787" end="27789">out</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="212" col1="18" line2="212" col2="18" start="27790" end="27790">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="212" col1="19" line2="212" col2="19" start="27791" end="27791">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="212" col1="21" line2="212" col2="22" start="27793" end="27794">&lt;-</LEFT_ASSIGN>
          <expr line1="212" col1="24" line2="212" col2="24" start="27796" end="27796">
            <NUM_CONST line1="212" col1="24" line2="212" col2="24" start="27796" end="27796">0</NUM_CONST>
          </expr>
        </expr>
        <expr line1="213" col1="5" line2="213" col2="7" start="27908" end="27910">
          <SYMBOL line1="213" col1="5" line2="213" col2="7" start="27908" end="27910">out</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="214" col1="1" line2="214" col2="1" start="28035" end="28035">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="216" col1="1" line2="227" col2="1" start="28297" end="29738">
    <expr line1="216" col1="1" line2="216" col2="12" start="28297" end="28308">
      <SYMBOL line1="216" col1="1" line2="216" col2="12" start="28297" end="28308">.countToFpkm</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="216" col1="14" line2="216" col2="15" start="28310" end="28311">&lt;-</LEFT_ASSIGN>
    <expr line1="216" col1="17" line2="227" col2="1" start="28313" end="29738">
      <FUNCTION line1="216" col1="17" line2="216" col2="24" start="28313" end="28320">function</FUNCTION>
      <OP-LEFT-PAREN line1="216" col1="25" line2="216" col2="25" start="28321" end="28321">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="216" col1="26" line2="216" col2="31" start="28322" end="28327">counts</SYMBOL_FORMALS>
      <OP-COMMA line1="216" col1="32" line2="216" col2="32" start="28328" end="28328">,</OP-COMMA>
      <SYMBOL_FORMALS line1="216" col1="34" line2="216" col2="40" start="28330" end="28336">eff_len</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="216" col1="41" line2="216" col2="41" start="28337" end="28337">)</OP-RIGHT-PAREN>
      <expr line1="216" col1="43" line2="227" col2="1" start="28339" end="29738">
        <OP-LEFT-BRACE line1="216" col1="43" line2="216" col2="43" start="28339" end="28339">{</OP-LEFT-BRACE>
        <COMMENT line1="217" col1="5" line2="217" col2="53" start="28432" end="28480">## Expecting a count matrix of nfeatures x ncells</COMMENT>
        <COMMENT line1="218" col1="5" line2="218" col2="42" start="28563" end="28600">## Need to be careful with zero counts</COMMENT>
        <expr line1="219" col1="5" line2="219" col2="21" start="28694" end="28710">
          <expr line1="219" col1="5" line2="219" col2="11" start="28694" end="28700">
            <SYMBOL line1="219" col1="5" line2="219" col2="11" start="28694" end="28700">counts0</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="219" col1="13" line2="219" col2="14" start="28702" end="28703">&lt;-</LEFT_ASSIGN>
          <expr line1="219" col1="16" line2="219" col2="21" start="28705" end="28710">
            <SYMBOL line1="219" col1="16" line2="219" col2="21" start="28705" end="28710">counts</SYMBOL>
          </expr>
        </expr>
        <expr line1="220" col1="5" line2="220" col2="30" start="28825" end="28850">
          <expr line1="220" col1="5" line2="220" col2="24" start="28825" end="28844">
            <expr line1="220" col1="5" line2="220" col2="11" start="28825" end="28831">
              <SYMBOL line1="220" col1="5" line2="220" col2="11" start="28825" end="28831">counts0</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="220" col1="12" line2="220" col2="12" start="28832" end="28832">[</OP-LEFT-BRACKET>
            <expr line1="220" col1="13" line2="220" col2="23" start="28833" end="28843">
              <expr line1="220" col1="13" line2="220" col2="18" start="28833" end="28838">
                <SYMBOL line1="220" col1="13" line2="220" col2="18" start="28833" end="28838">counts</SYMBOL>
              </expr>
              <EQ line1="220" col1="20" line2="220" col2="21" start="28840" end="28841">==</EQ>
              <expr line1="220" col1="23" line2="220" col2="23" start="28843" end="28843">
                <NUM_CONST line1="220" col1="23" line2="220" col2="23" start="28843" end="28843">0</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-BRACKET line1="220" col1="24" line2="220" col2="24" start="28844" end="28844">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="220" col1="26" line2="220" col2="27" start="28846" end="28847">&lt;-</LEFT_ASSIGN>
          <expr line1="220" col1="29" line2="220" col2="30" start="28849" end="28850">
            <NUM_CONST line1="220" col1="29" line2="220" col2="30" start="28849" end="28850">NA</NUM_CONST>
          </expr>
        </expr>
        <expr line1="221" col1="5" line2="221" col2="24" start="28956" end="28975">
          <expr line1="221" col1="5" line2="221" col2="5" start="28956" end="28956">
            <SYMBOL line1="221" col1="5" line2="221" col2="5" start="28956" end="28956">N</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="221" col1="7" line2="221" col2="8" start="28958" end="28959">&lt;-</LEFT_ASSIGN>
          <expr line1="221" col1="10" line2="221" col2="24" start="28961" end="28975">
            <expr line1="221" col1="10" line2="221" col2="16" start="28961" end="28967">
              <SYMBOL_FUNCTION_CALL line1="221" col1="10" line2="221" col2="16" start="28961" end="28967">colSums</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="221" col1="17" line2="221" col2="17" start="28968" end="28968">(</OP-LEFT-PAREN>
            <expr line1="221" col1="18" line2="221" col2="23" start="28969" end="28974">
              <SYMBOL line1="221" col1="18" line2="221" col2="23" start="28969" end="28974">counts</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="221" col1="24" line2="221" col2="24" start="28975" end="28975">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="222" col1="5" line2="222" col2="53" start="29087" end="29135">
          <expr line1="222" col1="5" line2="222" col2="11" start="29087" end="29093">
            <SYMBOL line1="222" col1="5" line2="222" col2="11" start="29087" end="29093">logfpkm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="222" col1="13" line2="222" col2="14" start="29095" end="29096">&lt;-</LEFT_ASSIGN>
          <expr line1="222" col1="16" line2="222" col2="53" start="29098" end="29135">
            <expr line1="222" col1="16" line2="222" col2="38" start="29098" end="29120">
              <expr line1="222" col1="16" line2="222" col2="27" start="29098" end="29109">
                <expr line1="222" col1="16" line2="222" col2="18" start="29098" end="29100">
                  <SYMBOL_FUNCTION_CALL line1="222" col1="16" line2="222" col2="18" start="29098" end="29100">log</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="222" col1="19" line2="222" col2="19" start="29101" end="29101">(</OP-LEFT-PAREN>
                <expr line1="222" col1="20" line2="222" col2="26" start="29102" end="29108">
                  <SYMBOL line1="222" col1="20" line2="222" col2="26" start="29102" end="29108">counts0</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="222" col1="27" line2="222" col2="27" start="29109" end="29109">)</OP-RIGHT-PAREN>
              </expr>
              <OP-PLUS line1="222" col1="29" line2="222" col2="29" start="29111" end="29111">+</OP-PLUS>
              <expr line1="222" col1="31" line2="222" col2="38" start="29113" end="29120">
                <expr line1="222" col1="31" line2="222" col2="33" start="29113" end="29115">
                  <SYMBOL_FUNCTION_CALL line1="222" col1="31" line2="222" col2="33" start="29113" end="29115">log</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="222" col1="34" line2="222" col2="34" start="29116" end="29116">(</OP-LEFT-PAREN>
                <expr line1="222" col1="35" line2="222" col2="37" start="29117" end="29119">
                  <NUM_CONST line1="222" col1="35" line2="222" col2="37" start="29117" end="29119">1e9</NUM_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="222" col1="38" line2="222" col2="38" start="29120" end="29120">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-MINUS line1="222" col1="40" line2="222" col2="40" start="29122" end="29122">-</OP-MINUS>
            <expr line1="222" col1="42" line2="222" col2="53" start="29124" end="29135">
              <expr line1="222" col1="42" line2="222" col2="44" start="29124" end="29126">
                <SYMBOL_FUNCTION_CALL line1="222" col1="42" line2="222" col2="44" start="29124" end="29126">log</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="222" col1="45" line2="222" col2="45" start="29127" end="29127">(</OP-LEFT-PAREN>
              <expr line1="222" col1="46" line2="222" col2="52" start="29128" end="29134">
                <SYMBOL line1="222" col1="46" line2="222" col2="52" start="29128" end="29134">eff_len</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="222" col1="53" line2="222" col2="53" start="29135" end="29135">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="223" col1="5" line2="223" col2="37" start="29218" end="29250">
          <expr line1="223" col1="5" line2="223" col2="11" start="29218" end="29224">
            <SYMBOL line1="223" col1="5" line2="223" col2="11" start="29218" end="29224">logfpkm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="223" col1="13" line2="223" col2="14" start="29226" end="29227">&lt;-</LEFT_ASSIGN>
          <expr line1="223" col1="16" line2="223" col2="37" start="29229" end="29250">
            <expr line1="223" col1="16" line2="223" col2="16" start="29229" end="29229">
              <SYMBOL_FUNCTION_CALL line1="223" col1="16" line2="223" col2="16" start="29229" end="29229">t</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="223" col1="17" line2="223" col2="17" start="29230" end="29230">(</OP-LEFT-PAREN>
            <expr line1="223" col1="18" line2="223" col2="36" start="29231" end="29249">
              <expr line1="223" col1="18" line2="223" col2="27" start="29231" end="29240">
                <expr line1="223" col1="18" line2="223" col2="18" start="29231" end="29231">
                  <SYMBOL_FUNCTION_CALL line1="223" col1="18" line2="223" col2="18" start="29231" end="29231">t</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="223" col1="19" line2="223" col2="19" start="29232" end="29232">(</OP-LEFT-PAREN>
                <expr line1="223" col1="20" line2="223" col2="26" start="29233" end="29239">
                  <SYMBOL line1="223" col1="20" line2="223" col2="26" start="29233" end="29239">logfpkm</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="223" col1="27" line2="223" col2="27" start="29240" end="29240">)</OP-RIGHT-PAREN>
              </expr>
              <OP-MINUS line1="223" col1="29" line2="223" col2="29" start="29242" end="29242">-</OP-MINUS>
              <expr line1="223" col1="31" line2="223" col2="36" start="29244" end="29249">
                <expr line1="223" col1="31" line2="223" col2="33" start="29244" end="29246">
                  <SYMBOL_FUNCTION_CALL line1="223" col1="31" line2="223" col2="33" start="29244" end="29246">log</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="223" col1="34" line2="223" col2="34" start="29247" end="29247">(</OP-LEFT-PAREN>
                <expr line1="223" col1="35" line2="223" col2="35" start="29248" end="29248">
                  <SYMBOL line1="223" col1="35" line2="223" col2="35" start="29248" end="29248">N</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="223" col1="36" line2="223" col2="36" start="29249" end="29249">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="223" col1="37" line2="223" col2="37" start="29250" end="29250">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="224" col1="5" line2="224" col2="25" start="29349" end="29369">
          <expr line1="224" col1="5" line2="224" col2="7" start="29349" end="29351">
            <SYMBOL line1="224" col1="5" line2="224" col2="7" start="29349" end="29351">out</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="224" col1="9" line2="224" col2="10" start="29353" end="29354">&lt;-</LEFT_ASSIGN>
          <expr line1="224" col1="12" line2="224" col2="25" start="29356" end="29369">
            <expr line1="224" col1="12" line2="224" col2="14" start="29356" end="29358">
              <SYMBOL_FUNCTION_CALL line1="224" col1="12" line2="224" col2="14" start="29356" end="29358">exp</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="224" col1="15" line2="224" col2="15" start="29359" end="29359">(</OP-LEFT-PAREN>
            <expr line1="224" col1="17" line2="224" col2="23" start="29361" end="29367">
              <SYMBOL line1="224" col1="17" line2="224" col2="23" start="29361" end="29367">logfpkm</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="224" col1="25" line2="224" col2="25" start="29369" end="29369">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="225" col1="5" line2="225" col2="24" start="29480" end="29499">
          <expr line1="225" col1="5" line2="225" col2="19" start="29480" end="29494">
            <expr line1="225" col1="5" line2="225" col2="7" start="29480" end="29482">
              <SYMBOL line1="225" col1="5" line2="225" col2="7" start="29480" end="29482">out</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="225" col1="8" line2="225" col2="8" start="29483" end="29483">[</OP-LEFT-BRACKET>
            <expr line1="225" col1="9" line2="225" col2="18" start="29484" end="29493">
              <expr line1="225" col1="9" line2="225" col2="13" start="29484" end="29488">
                <SYMBOL_FUNCTION_CALL line1="225" col1="9" line2="225" col2="13" start="29484" end="29488">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="225" col1="14" line2="225" col2="14" start="29489" end="29489">(</OP-LEFT-PAREN>
              <expr line1="225" col1="15" line2="225" col2="17" start="29490" end="29492">
                <SYMBOL line1="225" col1="15" line2="225" col2="17" start="29490" end="29492">out</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="225" col1="18" line2="225" col2="18" start="29493" end="29493">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="225" col1="19" line2="225" col2="19" start="29494" end="29494">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="225" col1="21" line2="225" col2="22" start="29496" end="29497">&lt;-</LEFT_ASSIGN>
          <expr line1="225" col1="24" line2="225" col2="24" start="29499" end="29499">
            <NUM_CONST line1="225" col1="24" line2="225" col2="24" start="29499" end="29499">0</NUM_CONST>
          </expr>
        </expr>
        <expr line1="226" col1="5" line2="226" col2="7" start="29611" end="29613">
          <SYMBOL line1="226" col1="5" line2="226" col2="7" start="29611" end="29613">out</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="227" col1="1" line2="227" col2="1" start="29738" end="29738">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="229" col1="1" line2="232" col2="1" start="30000" end="30393">
    <expr line1="229" col1="1" line2="229" col2="10" start="30000" end="30009">
      <SYMBOL line1="229" col1="1" line2="229" col2="10" start="30000" end="30009">.fpkmToTpm</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="229" col1="12" line2="229" col2="13" start="30011" end="30012">&lt;-</LEFT_ASSIGN>
    <expr line1="229" col1="15" line2="232" col2="1" start="30014" end="30393">
      <FUNCTION line1="229" col1="15" line2="229" col2="22" start="30014" end="30021">function</FUNCTION>
      <OP-LEFT-PAREN line1="229" col1="23" line2="229" col2="23" start="30022" end="30022">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="229" col1="24" line2="229" col2="27" start="30023" end="30026">fpkm</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="229" col1="28" line2="229" col2="28" start="30027" end="30027">)</OP-RIGHT-PAREN>
      <expr line1="229" col1="30" line2="232" col2="1" start="30029" end="30393">
        <OP-LEFT-BRACE line1="229" col1="30" line2="229" col2="30" start="30029" end="30029">{</OP-LEFT-BRACE>
        <COMMENT line1="230" col1="5" line2="230" col2="53" start="30135" end="30183">## Expecting an FPKM matrix of nfeatures x ncells</COMMENT>
        <expr line1="231" col1="5" line2="231" col2="58" start="30266" end="30319">
          <expr line1="231" col1="5" line2="231" col2="7" start="30266" end="30268">
            <SYMBOL_FUNCTION_CALL line1="231" col1="5" line2="231" col2="7" start="30266" end="30268">exp</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="231" col1="8" line2="231" col2="8" start="30269" end="30269">(</OP-LEFT-PAREN>
          <expr line1="231" col1="10" line2="231" col2="56" start="30271" end="30317">
            <expr line1="231" col1="10" line2="231" col2="45" start="30271" end="30306">
              <expr line1="231" col1="10" line2="231" col2="10" start="30271" end="30271">
                <SYMBOL_FUNCTION_CALL line1="231" col1="10" line2="231" col2="10" start="30271" end="30271">t</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="231" col1="11" line2="231" col2="11" start="30272" end="30272">(</OP-LEFT-PAREN>
              <expr line1="231" col1="12" line2="231" col2="44" start="30273" end="30305">
                <expr line1="231" col1="12" line2="231" col2="23" start="30273" end="30284">
                  <expr line1="231" col1="12" line2="231" col2="12" start="30273" end="30273">
                    <SYMBOL_FUNCTION_CALL line1="231" col1="12" line2="231" col2="12" start="30273" end="30273">t</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="231" col1="13" line2="231" col2="13" start="30274" end="30274">(</OP-LEFT-PAREN>
                  <expr line1="231" col1="14" line2="231" col2="22" start="30275" end="30283">
                    <expr line1="231" col1="14" line2="231" col2="16" start="30275" end="30277">
                      <SYMBOL_FUNCTION_CALL line1="231" col1="14" line2="231" col2="16" start="30275" end="30277">log</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="231" col1="17" line2="231" col2="17" start="30278" end="30278">(</OP-LEFT-PAREN>
                    <expr line1="231" col1="18" line2="231" col2="21" start="30279" end="30282">
                      <SYMBOL line1="231" col1="18" line2="231" col2="21" start="30279" end="30282">fpkm</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="231" col1="22" line2="231" col2="22" start="30283" end="30283">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="231" col1="23" line2="231" col2="23" start="30284" end="30284">)</OP-RIGHT-PAREN>
                </expr>
                <OP-MINUS line1="231" col1="25" line2="231" col2="25" start="30286" end="30286">-</OP-MINUS>
                <expr line1="231" col1="27" line2="231" col2="44" start="30288" end="30305">
                  <expr line1="231" col1="27" line2="231" col2="29" start="30288" end="30290">
                    <SYMBOL_FUNCTION_CALL line1="231" col1="27" line2="231" col2="29" start="30288" end="30290">log</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="231" col1="30" line2="231" col2="30" start="30291" end="30291">(</OP-LEFT-PAREN>
                  <expr line1="231" col1="31" line2="231" col2="43" start="30292" end="30304">
                    <expr line1="231" col1="31" line2="231" col2="37" start="30292" end="30298">
                      <SYMBOL_FUNCTION_CALL line1="231" col1="31" line2="231" col2="37" start="30292" end="30298">colSums</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="231" col1="38" line2="231" col2="38" start="30299" end="30299">(</OP-LEFT-PAREN>
                    <expr line1="231" col1="39" line2="231" col2="42" start="30300" end="30303">
                      <SYMBOL line1="231" col1="39" line2="231" col2="42" start="30300" end="30303">fpkm</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="231" col1="43" line2="231" col2="43" start="30304" end="30304">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="231" col1="44" line2="231" col2="44" start="30305" end="30305">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="231" col1="45" line2="231" col2="45" start="30306" end="30306">)</OP-RIGHT-PAREN>
            </expr>
            <OP-PLUS line1="231" col1="47" line2="231" col2="47" start="30308" end="30308">+</OP-PLUS>
            <expr line1="231" col1="49" line2="231" col2="56" start="30310" end="30317">
              <expr line1="231" col1="49" line2="231" col2="51" start="30310" end="30312">
                <SYMBOL_FUNCTION_CALL line1="231" col1="49" line2="231" col2="51" start="30310" end="30312">log</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="231" col1="52" line2="231" col2="52" start="30313" end="30313">(</OP-LEFT-PAREN>
              <expr line1="231" col1="53" line2="231" col2="55" start="30314" end="30316">
                <NUM_CONST line1="231" col1="53" line2="231" col2="55" start="30314" end="30316">1e6</NUM_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="231" col1="56" line2="231" col2="56" start="30317" end="30317">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="231" col1="58" line2="231" col2="58" start="30319" end="30319">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="232" col1="1" line2="232" col2="1" start="30393" end="30393">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="234" col1="1" line2="236" col2="1" start="30655" end="30917">
    <expr line1="234" col1="1" line2="234" col2="17" start="30655" end="30671">
      <SYMBOL line1="234" col1="1" line2="234" col2="17" start="30655" end="30671">.countToEffCounts</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="234" col1="19" line2="234" col2="20" start="30673" end="30674">&lt;-</LEFT_ASSIGN>
    <expr line1="234" col1="22" line2="236" col2="1" start="30676" end="30917">
      <FUNCTION line1="234" col1="22" line2="234" col2="29" start="30676" end="30683">function</FUNCTION>
      <OP-LEFT-PAREN line1="234" col1="30" line2="234" col2="30" start="30684" end="30684">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="234" col1="31" line2="234" col2="36" start="30685" end="30690">counts</SYMBOL_FORMALS>
      <OP-COMMA line1="234" col1="37" line2="234" col2="37" start="30691" end="30691">,</OP-COMMA>
      <SYMBOL_FORMALS line1="234" col1="39" line2="234" col2="41" start="30693" end="30695">len</SYMBOL_FORMALS>
      <OP-COMMA line1="234" col1="42" line2="234" col2="42" start="30696" end="30696">,</OP-COMMA>
      <SYMBOL_FORMALS line1="234" col1="44" line2="234" col2="50" start="30698" end="30704">eff_len</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="234" col1="51" line2="234" col2="51" start="30705" end="30705">)</OP-RIGHT-PAREN>
      <expr line1="234" col1="53" line2="236" col2="1" start="30707" end="30917">
        <OP-LEFT-BRACE line1="234" col1="53" line2="234" col2="53" start="30707" end="30707">{</OP-LEFT-BRACE>
        <expr line1="235" col1="5" line2="235" col2="28" start="30790" end="30813">
          <expr line1="235" col1="5" line2="235" col2="10" start="30790" end="30795">
            <SYMBOL line1="235" col1="5" line2="235" col2="10" start="30790" end="30795">counts</SYMBOL>
          </expr>
          <OP-STAR line1="235" col1="12" line2="235" col2="12" start="30797" end="30797">*</OP-STAR>
          <expr line1="235" col1="14" line2="235" col2="28" start="30799" end="30813">
            <OP-LEFT-PAREN line1="235" col1="14" line2="235" col2="14" start="30799" end="30799">(</OP-LEFT-PAREN>
            <expr line1="235" col1="15" line2="235" col2="27" start="30800" end="30812">
              <expr line1="235" col1="15" line2="235" col2="17" start="30800" end="30802">
                <SYMBOL line1="235" col1="15" line2="235" col2="17" start="30800" end="30802">len</SYMBOL>
              </expr>
              <OP-SLASH line1="235" col1="19" line2="235" col2="19" start="30804" end="30804">/</OP-SLASH>
              <expr line1="235" col1="21" line2="235" col2="27" start="30806" end="30812">
                <SYMBOL line1="235" col1="21" line2="235" col2="27" start="30806" end="30812">eff_len</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="235" col1="28" line2="235" col2="28" start="30813" end="30813">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <OP-RIGHT-BRACE line1="236" col1="1" line2="236" col2="1" start="30917" end="30917">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="239" col1="1" line2="239" col2="37" start="31310" end="31346">#' Calculate counts per million (CPM)</COMMENT>
  <COMMENT line1="240" col1="1" line2="240" col2="2" start="31441" end="31442">#'</COMMENT>
  <COMMENT line1="241" col1="1" line2="241" col2="64" start="31572" end="31635">#' Calculate count-per-million (CPM) values from the count data.</COMMENT>
  <COMMENT line1="242" col1="1" line2="242" col2="2" start="31703" end="31704">#'</COMMENT>
  <COMMENT line1="243" col1="1" line2="243" col2="40" start="31834" end="31873">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="244" col1="1" line2="244" col2="62" start="31965" end="32026">#' @param use.size.factors a logical scalar specifying whether</COMMENT>
  <COMMENT line1="245" col1="1" line2="245" col2="65" start="32096" end="32160">#' the size factors should be used to construct effective library</COMMENT>
  <COMMENT line1="246" col1="1" line2="246" col2="62" start="32227" end="32288">#' sizes, or if the library size should be directly defined as</COMMENT>
  <COMMENT line1="247" col1="1" line2="247" col2="35" start="32358" end="32392">#' the sum of counts for each cell.</COMMENT>
  <COMMENT line1="248" col1="1" line2="248" col2="2" start="32489" end="32490">#'</COMMENT>
  <COMMENT line1="249" col1="1" line2="249" col2="32" start="32620" end="32651">#' @return Matrix of CPM values.</COMMENT>
  <COMMENT line1="250" col1="1" line2="250" col2="10" start="32751" end="32760">#' @export</COMMENT>
  <COMMENT line1="251" col1="1" line2="251" col2="12" start="32882" end="32893">#' @examples</COMMENT>
  <COMMENT line1="252" col1="1" line2="252" col2="28" start="33013" end="33040">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="253" col1="1" line2="253" col2="31" start="33144" end="33174">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="254" col1="1" line2="254" col2="61" start="33275" end="33335">#' example_sceset &lt;- newSCESet(countData = sc_example_counts)</COMMENT>
  <COMMENT line1="255" col1="1" line2="255" col2="54" start="33406" end="33459">#' cpm(example_sceset) &lt;- calculateCPM(example_sceset)</COMMENT>
  <COMMENT line1="256" col1="1" line2="256" col2="2" start="33537" end="33538">#'</COMMENT>
  <expr line1="257" col1="1" line2="287" col2="1" start="33668" end="37598">
    <expr line1="257" col1="1" line2="257" col2="12" start="33668" end="33679">
      <SYMBOL line1="257" col1="1" line2="257" col2="12" start="33668" end="33679">calculateCPM</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="257" col1="14" line2="257" col2="15" start="33681" end="33682">&lt;-</LEFT_ASSIGN>
    <expr line1="257" col1="17" line2="287" col2="1" start="33684" end="37598">
      <FUNCTION line1="257" col1="17" line2="257" col2="24" start="33684" end="33691">function</FUNCTION>
      <OP-LEFT-PAREN line1="257" col1="25" line2="257" col2="25" start="33692" end="33692">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="257" col1="26" line2="257" col2="31" start="33693" end="33698">object</SYMBOL_FORMALS>
      <OP-COMMA line1="257" col1="32" line2="257" col2="32" start="33699" end="33699">,</OP-COMMA>
      <SYMBOL_FORMALS line1="257" col1="34" line2="257" col2="49" start="33701" end="33716">use.size.factors</SYMBOL_FORMALS>
      <EQ_FORMALS line1="257" col1="51" line2="257" col2="51" start="33718" end="33718">=</EQ_FORMALS>
      <expr line1="257" col1="53" line2="257" col2="56" start="33720" end="33723">
        <NUM_CONST line1="257" col1="53" line2="257" col2="56" start="33720" end="33723">TRUE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="257" col1="57" line2="257" col2="57" start="33724" end="33724">)</OP-RIGHT-PAREN>
      <expr line1="257" col1="59" line2="287" col2="1" start="33726" end="37598">
        <OP-LEFT-BRACE line1="257" col1="59" line2="257" col2="59" start="33726" end="33726">{</OP-LEFT-BRACE>
        <expr line1="258" col1="5" line2="258" col2="32" start="33803" end="33830">
          <expr line1="258" col1="5" line2="258" col2="14" start="33803" end="33812">
            <SYMBOL line1="258" col1="5" line2="258" col2="14" start="33803" end="33812">counts_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="258" col1="16" line2="258" col2="17" start="33814" end="33815">&lt;-</LEFT_ASSIGN>
          <expr line1="258" col1="19" line2="258" col2="32" start="33817" end="33830">
            <expr line1="258" col1="19" line2="258" col2="24" start="33817" end="33822">
              <SYMBOL_FUNCTION_CALL line1="258" col1="19" line2="258" col2="24" start="33817" end="33822">counts</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="258" col1="25" line2="258" col2="25" start="33823" end="33823">(</OP-LEFT-PAREN>
            <expr line1="258" col1="26" line2="258" col2="31" start="33824" end="33829">
              <SYMBOL line1="258" col1="26" line2="258" col2="31" start="33824" end="33829">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="258" col1="32" line2="258" col2="32" start="33830" end="33830">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="259" col1="5" line2="270" col2="5" start="33934" end="35375">
          <IF line1="259" col1="5" line2="259" col2="6" start="33934" end="33935">if</IF>
          <OP-LEFT-PAREN line1="259" col1="8" line2="259" col2="8" start="33937" end="33937">(</OP-LEFT-PAREN>
          <expr line1="259" col1="9" line2="259" col2="24" start="33938" end="33953">
            <SYMBOL line1="259" col1="9" line2="259" col2="24" start="33938" end="33953">use.size.factors</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="259" col1="25" line2="259" col2="25" start="33954" end="33954">)</OP-RIGHT-PAREN>
          <expr line1="259" col1="27" line2="267" col2="5" start="33956" end="34982">
            <OP-LEFT-BRACE line1="259" col1="27" line2="259" col2="27" start="33956" end="33956">{</OP-LEFT-BRACE>
            <expr line1="260" col1="9" line2="260" col2="33" start="34069" end="34093">
              <expr line1="260" col1="9" line2="260" col2="10" start="34069" end="34070">
                <SYMBOL line1="260" col1="9" line2="260" col2="10" start="34069" end="34070">sf</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="260" col1="12" line2="260" col2="13" start="34072" end="34073">&lt;-</LEFT_ASSIGN>
              <expr line1="260" col1="15" line2="260" col2="33" start="34075" end="34093">
                <expr line1="260" col1="15" line2="260" col2="25" start="34075" end="34085">
                  <SYMBOL_FUNCTION_CALL line1="260" col1="15" line2="260" col2="25" start="34075" end="34085">sizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="260" col1="26" line2="260" col2="26" start="34086" end="34086">(</OP-LEFT-PAREN>
                <expr line1="260" col1="27" line2="260" col2="32" start="34087" end="34092">
                  <SYMBOL line1="260" col1="27" line2="260" col2="32" start="34087" end="34092">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="260" col1="33" line2="260" col2="33" start="34093" end="34093">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="261" col1="9" line2="261" col2="48" start="34200" end="34239">
              <expr line1="261" col1="9" line2="261" col2="20" start="34200" end="34211">
                <SYMBOL line1="261" col1="9" line2="261" col2="20" start="34200" end="34211">control_list</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="261" col1="22" line2="261" col2="23" start="34213" end="34214">&lt;-</LEFT_ASSIGN>
              <expr line1="261" col1="25" line2="261" col2="48" start="34216" end="34239">
                <expr line1="261" col1="25" line2="261" col2="40" start="34216" end="34231">
                  <SYMBOL_FUNCTION_CALL line1="261" col1="25" line2="261" col2="40" start="34216" end="34231">.find_control_SF</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="261" col1="41" line2="261" col2="41" start="34232" end="34232">(</OP-LEFT-PAREN>
                <expr line1="261" col1="42" line2="261" col2="47" start="34233" end="34238">
                  <SYMBOL line1="261" col1="42" line2="261" col2="47" start="34233" end="34238">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="261" col1="48" line2="261" col2="48" start="34239" end="34239">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="262" col1="9" line2="266" col2="9" start="34331" end="34855">
              <IF line1="262" col1="9" line2="262" col2="10" start="34331" end="34332">if</IF>
              <OP-LEFT-PAREN line1="262" col1="12" line2="262" col2="12" start="34334" end="34334">(</OP-LEFT-PAREN>
              <expr line1="262" col1="13" line2="262" col2="23" start="34335" end="34345">
                <expr line1="262" col1="13" line2="262" col2="19" start="34335" end="34341">
                  <SYMBOL_FUNCTION_CALL line1="262" col1="13" line2="262" col2="19" start="34335" end="34341">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="262" col1="20" line2="262" col2="20" start="34342" end="34342">(</OP-LEFT-PAREN>
                <expr line1="262" col1="21" line2="262" col2="22" start="34343" end="34344">
                  <SYMBOL line1="262" col1="21" line2="262" col2="22" start="34343" end="34344">sf</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="262" col1="23" line2="262" col2="23" start="34345" end="34345">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="262" col1="24" line2="262" col2="24" start="34346" end="34346">)</OP-RIGHT-PAREN>
              <expr line1="262" col1="26" line2="266" col2="9" start="34348" end="34855">
                <OP-LEFT-BRACE line1="262" col1="26" line2="262" col2="26" start="34348" end="34348">{</OP-LEFT-BRACE>
                <expr line1="263" col1="13" line2="263" col2="92" start="34466" end="34545">
                  <expr line1="263" col1="13" line2="263" col2="19" start="34466" end="34472">
                    <SYMBOL_FUNCTION_CALL line1="263" col1="13" line2="263" col2="19" start="34466" end="34472">warning</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="263" col1="20" line2="263" col2="20" start="34473" end="34473">(</OP-LEFT-PAREN>
                  <expr line1="263" col1="21" line2="263" col2="91" start="34474" end="34544">
                    <STR_CONST line1="263" col1="21" line2="263" col2="91" start="34474" end="34544">"size factors requested but not specified, using library sizes instead"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="263" col1="92" line2="263" col2="92" start="34545" end="34545">)</OP-RIGHT-PAREN>
                </expr>
                <expr line1="264" col1="13" line2="264" col2="37" start="34597" end="34621">
                  <expr line1="264" col1="13" line2="264" col2="14" start="34597" end="34598">
                    <SYMBOL line1="264" col1="13" line2="264" col2="14" start="34597" end="34598">sf</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="264" col1="16" line2="264" col2="17" start="34600" end="34601">&lt;-</LEFT_ASSIGN>
                  <expr line1="264" col1="19" line2="264" col2="37" start="34603" end="34621">
                    <expr line1="264" col1="19" line2="264" col2="25" start="34603" end="34609">
                      <SYMBOL_FUNCTION_CALL line1="264" col1="19" line2="264" col2="25" start="34603" end="34609">colSums</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="264" col1="26" line2="264" col2="26" start="34610" end="34610">(</OP-LEFT-PAREN>
                    <expr line1="264" col1="27" line2="264" col2="36" start="34611" end="34620">
                      <SYMBOL line1="264" col1="27" line2="264" col2="36" start="34611" end="34620">counts_mat</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="264" col1="37" line2="264" col2="37" start="34621" end="34621">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="265" col1="13" line2="265" col2="34" start="34728" end="34749">
                  <expr line1="265" col1="13" line2="265" col2="24" start="34728" end="34739">
                    <SYMBOL line1="265" col1="13" line2="265" col2="24" start="34728" end="34739">control_list</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="265" col1="26" line2="265" col2="27" start="34741" end="34742">&lt;-</LEFT_ASSIGN>
                  <expr line1="265" col1="29" line2="265" col2="34" start="34744" end="34749">
                    <expr line1="265" col1="29" line2="265" col2="32" start="34744" end="34747">
                      <SYMBOL_FUNCTION_CALL line1="265" col1="29" line2="265" col2="32" start="34744" end="34747">list</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="265" col1="33" line2="265" col2="33" start="34748" end="34748">(</OP-LEFT-PAREN>
                    <OP-RIGHT-PAREN line1="265" col1="34" line2="265" col2="34" start="34749" end="34749">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="266" col1="9" line2="266" col2="9" start="34855" end="34855">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="267" col1="5" line2="267" col2="5" start="34982" end="34982">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="267" col1="7" line2="267" col2="10" start="34984" end="34987">else</ELSE>
          <expr line1="267" col1="12" line2="270" col2="5" start="34989" end="35375">
            <OP-LEFT-BRACE line1="267" col1="12" line2="267" col2="12" start="34989" end="34989">{</OP-LEFT-BRACE>
            <expr line1="268" col1="9" line2="268" col2="33" start="35117" end="35141">
              <expr line1="268" col1="9" line2="268" col2="10" start="35117" end="35118">
                <SYMBOL line1="268" col1="9" line2="268" col2="10" start="35117" end="35118">sf</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="268" col1="12" line2="268" col2="13" start="35120" end="35121">&lt;-</LEFT_ASSIGN>
              <expr line1="268" col1="15" line2="268" col2="33" start="35123" end="35141">
                <expr line1="268" col1="15" line2="268" col2="21" start="35123" end="35129">
                  <SYMBOL_FUNCTION_CALL line1="268" col1="15" line2="268" col2="21" start="35123" end="35129">colSums</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="268" col1="22" line2="268" col2="22" start="35130" end="35130">(</OP-LEFT-PAREN>
                <expr line1="268" col1="23" line2="268" col2="32" start="35131" end="35140">
                  <SYMBOL line1="268" col1="23" line2="268" col2="32" start="35131" end="35140">counts_mat</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="268" col1="33" line2="268" col2="33" start="35141" end="35141">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="269" col1="9" line2="269" col2="30" start="35248" end="35269">
              <expr line1="269" col1="9" line2="269" col2="20" start="35248" end="35259">
                <SYMBOL line1="269" col1="9" line2="269" col2="20" start="35248" end="35259">control_list</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="269" col1="22" line2="269" col2="23" start="35261" end="35262">&lt;-</LEFT_ASSIGN>
              <expr line1="269" col1="25" line2="269" col2="30" start="35264" end="35269">
                <expr line1="269" col1="25" line2="269" col2="28" start="35264" end="35267">
                  <SYMBOL_FUNCTION_CALL line1="269" col1="25" line2="269" col2="28" start="35264" end="35267">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="269" col1="29" line2="269" col2="29" start="35268" end="35268">(</OP-LEFT-PAREN>
                <OP-RIGHT-PAREN line1="269" col1="30" line2="269" col2="30" start="35269" end="35269">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="270" col1="5" line2="270" col2="5" start="35375" end="35375">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="272" col1="5" line2="272" col2="51" start="35637" end="35683"># Scaling the size factors to the library size.</COMMENT>
        <expr line1="273" col1="5" line2="273" col2="35" start="35768" end="35798">
          <expr line1="273" col1="5" line2="273" col2="12" start="35768" end="35775">
            <SYMBOL line1="273" col1="5" line2="273" col2="12" start="35768" end="35775">lib.size</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="273" col1="14" line2="273" col2="15" start="35777" end="35778">&lt;-</LEFT_ASSIGN>
          <expr line1="273" col1="17" line2="273" col2="35" start="35780" end="35798">
            <expr line1="273" col1="17" line2="273" col2="23" start="35780" end="35786">
              <SYMBOL_FUNCTION_CALL line1="273" col1="17" line2="273" col2="23" start="35780" end="35786">colSums</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="273" col1="24" line2="273" col2="24" start="35787" end="35787">(</OP-LEFT-PAREN>
            <expr line1="273" col1="25" line2="273" col2="34" start="35788" end="35797">
              <SYMBOL line1="273" col1="25" line2="273" col2="34" start="35788" end="35797">counts_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="273" col1="35" line2="273" col2="35" start="35798" end="35798">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="274" col1="5" line2="274" col2="45" start="35899" end="35939">
          <expr line1="274" col1="5" line2="274" col2="13" start="35899" end="35907">
            <SYMBOL line1="274" col1="5" line2="274" col2="13" start="35899" end="35907">scaled.sf</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="274" col1="15" line2="274" col2="16" start="35909" end="35910">&lt;-</LEFT_ASSIGN>
          <expr line1="274" col1="18" line2="274" col2="45" start="35912" end="35939">
            <expr line1="274" col1="18" line2="274" col2="28" start="35912" end="35922">
              <expr line1="274" col1="18" line2="274" col2="19" start="35912" end="35913">
                <SYMBOL line1="274" col1="18" line2="274" col2="19" start="35912" end="35913">sf</SYMBOL>
              </expr>
              <OP-SLASH line1="274" col1="20" line2="274" col2="20" start="35914" end="35914">/</OP-SLASH>
              <expr line1="274" col1="21" line2="274" col2="28" start="35915" end="35922">
                <expr line1="274" col1="21" line2="274" col2="24" start="35915" end="35918">
                  <SYMBOL_FUNCTION_CALL line1="274" col1="21" line2="274" col2="24" start="35915" end="35918">mean</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="274" col1="25" line2="274" col2="25" start="35919" end="35919">(</OP-LEFT-PAREN>
                <expr line1="274" col1="26" line2="274" col2="27" start="35920" end="35921">
                  <SYMBOL line1="274" col1="26" line2="274" col2="27" start="35920" end="35921">sf</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="274" col1="28" line2="274" col2="28" start="35922" end="35922">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-STAR line1="274" col1="30" line2="274" col2="30" start="35924" end="35924">*</OP-STAR>
            <expr line1="274" col1="32" line2="274" col2="45" start="35926" end="35939">
              <expr line1="274" col1="32" line2="274" col2="35" start="35926" end="35929">
                <SYMBOL_FUNCTION_CALL line1="274" col1="32" line2="274" col2="35" start="35926" end="35929">mean</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="274" col1="36" line2="274" col2="36" start="35930" end="35930">(</OP-LEFT-PAREN>
              <expr line1="274" col1="37" line2="274" col2="44" start="35931" end="35938">
                <SYMBOL line1="274" col1="37" line2="274" col2="44" start="35931" end="35938">lib.size</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="274" col1="45" line2="274" col2="45" start="35939" end="35939">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="275" col1="5" line2="275" col2="59" start="36030" end="36084">
          <expr line1="275" col1="5" line2="275" col2="11" start="36030" end="36036">
            <SYMBOL line1="275" col1="5" line2="275" col2="11" start="36030" end="36036">cpm_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="275" col1="13" line2="275" col2="14" start="36038" end="36039">&lt;-</LEFT_ASSIGN>
          <expr line1="275" col1="16" line2="275" col2="59" start="36041" end="36084">
            <expr line1="275" col1="16" line2="275" col2="25" start="36041" end="36050">
              <SYMBOL_PACKAGE line1="275" col1="16" line2="275" col2="20" start="36041" end="36045">edgeR</SYMBOL_PACKAGE>
              <NS_GET line1="275" col1="21" line2="275" col2="22" start="36046" end="36047">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="275" col1="23" line2="275" col2="25" start="36048" end="36050">cpm</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="275" col1="26" line2="275" col2="26" start="36051" end="36051">(</OP-LEFT-PAREN>
            <expr line1="275" col1="27" line2="275" col2="36" start="36052" end="36061">
              <SYMBOL line1="275" col1="27" line2="275" col2="36" start="36052" end="36061">counts_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="275" col1="37" line2="275" col2="37" start="36062" end="36062">,</OP-COMMA>
            <SYMBOL_SUB line1="275" col1="39" line2="275" col2="46" start="36064" end="36071">lib.size</SYMBOL_SUB>
            <EQ_SUB line1="275" col1="48" line2="275" col2="48" start="36073" end="36073">=</EQ_SUB>
            <expr line1="275" col1="50" line2="275" col2="58" start="36075" end="36083">
              <SYMBOL line1="275" col1="50" line2="275" col2="58" start="36075" end="36083">scaled.sf</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="275" col1="59" line2="275" col2="59" start="36084" end="36084">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="277" col1="5" line2="281" col2="5" start="36292" end="36816">
          <FOR line1="277" col1="5" line2="277" col2="7" start="36292" end="36294">for</FOR>
          <forcond line1="277" col1="9" line2="277" col2="29" start="36296" end="36316">
            <OP-LEFT-PAREN line1="277" col1="9" line2="277" col2="9" start="36296" end="36296">(</OP-LEFT-PAREN>
            <SYMBOL line1="277" col1="10" line2="277" col2="12" start="36297" end="36299">alt</SYMBOL>
            <IN line1="277" col1="14" line2="277" col2="15" start="36301" end="36302">in</IN>
            <expr line1="277" col1="17" line2="277" col2="28" start="36304" end="36315">
              <SYMBOL line1="277" col1="17" line2="277" col2="28" start="36304" end="36315">control_list</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="277" col1="29" line2="277" col2="29" start="36316" end="36316">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="277" col1="31" line2="281" col2="5" start="36318" end="36816">
            <OP-LEFT-BRACE line1="277" col1="31" line2="277" col2="31" start="36318" end="36318">{</OP-LEFT-BRACE>
            <expr line1="278" col1="9" line2="278" col2="57" start="36427" end="36475">
              <expr line1="278" col1="9" line2="278" col2="17" start="36427" end="36435">
                <SYMBOL line1="278" col1="9" line2="278" col2="17" start="36427" end="36435">scaled.sf</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="278" col1="19" line2="278" col2="20" start="36437" end="36438">&lt;-</LEFT_ASSIGN>
              <expr line1="278" col1="22" line2="278" col2="57" start="36440" end="36475">
                <expr line1="278" col1="22" line2="278" col2="40" start="36440" end="36458">
                  <expr line1="278" col1="22" line2="278" col2="27" start="36440" end="36445">
                    <expr line1="278" col1="22" line2="278" col2="24" start="36440" end="36442">
                      <SYMBOL line1="278" col1="22" line2="278" col2="24" start="36440" end="36442">alt</SYMBOL>
                    </expr>
                    <OP-DOLLAR line1="278" col1="25" line2="278" col2="25" start="36443" end="36443">$</OP-DOLLAR>
                    <SYMBOL line1="278" col1="26" line2="278" col2="27" start="36444" end="36445">SF</SYMBOL>
                  </expr>
                  <OP-SLASH line1="278" col1="28" line2="278" col2="28" start="36446" end="36446">/</OP-SLASH>
                  <expr line1="278" col1="29" line2="278" col2="40" start="36447" end="36458">
                    <expr line1="278" col1="29" line2="278" col2="32" start="36447" end="36450">
                      <SYMBOL_FUNCTION_CALL line1="278" col1="29" line2="278" col2="32" start="36447" end="36450">mean</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="278" col1="33" line2="278" col2="33" start="36451" end="36451">(</OP-LEFT-PAREN>
                    <expr line1="278" col1="34" line2="278" col2="39" start="36452" end="36457">
                      <expr line1="278" col1="34" line2="278" col2="36" start="36452" end="36454">
                        <SYMBOL line1="278" col1="34" line2="278" col2="36" start="36452" end="36454">alt</SYMBOL>
                      </expr>
                      <OP-DOLLAR line1="278" col1="37" line2="278" col2="37" start="36455" end="36455">$</OP-DOLLAR>
                      <SYMBOL line1="278" col1="38" line2="278" col2="39" start="36456" end="36457">SF</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="278" col1="40" line2="278" col2="40" start="36458" end="36458">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-STAR line1="278" col1="42" line2="278" col2="42" start="36460" end="36460">*</OP-STAR>
                <expr line1="278" col1="44" line2="278" col2="57" start="36462" end="36475">
                  <expr line1="278" col1="44" line2="278" col2="47" start="36462" end="36465">
                    <SYMBOL_FUNCTION_CALL line1="278" col1="44" line2="278" col2="47" start="36462" end="36465">mean</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="278" col1="48" line2="278" col2="48" start="36466" end="36466">(</OP-LEFT-PAREN>
                  <expr line1="278" col1="49" line2="278" col2="56" start="36467" end="36474">
                    <SYMBOL line1="278" col1="49" line2="278" col2="56" start="36467" end="36474">lib.size</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="278" col1="57" line2="278" col2="57" start="36475" end="36475">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
            </expr>
            <expr line1="279" col1="9" line2="280" col2="60" start="36558" end="36740">
              <expr line1="279" col1="9" line2="279" col2="24" start="36558" end="36573">
                <expr line1="279" col1="9" line2="279" col2="15" start="36558" end="36564">
                  <SYMBOL line1="279" col1="9" line2="279" col2="15" start="36558" end="36564">cpm_mat</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="279" col1="16" line2="279" col2="16" start="36565" end="36565">[</OP-LEFT-BRACKET>
                <expr line1="279" col1="17" line2="279" col2="22" start="36566" end="36571">
                  <expr line1="279" col1="17" line2="279" col2="19" start="36566" end="36568">
                    <SYMBOL line1="279" col1="17" line2="279" col2="19" start="36566" end="36568">alt</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="279" col1="20" line2="279" col2="20" start="36569" end="36569">$</OP-DOLLAR>
                  <SYMBOL line1="279" col1="21" line2="279" col2="22" start="36570" end="36571">ID</SYMBOL>
                </expr>
                <OP-COMMA line1="279" col1="23" line2="279" col2="23" start="36572" end="36572">,</OP-COMMA>
                <OP-RIGHT-BRACKET line1="279" col1="24" line2="279" col2="24" start="36573" end="36573">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="279" col1="26" line2="279" col2="27" start="36575" end="36576">&lt;-</LEFT_ASSIGN>
              <expr line1="279" col1="29" line2="280" col2="60" start="36578" end="36740">
                <expr line1="279" col1="29" line2="279" col2="38" start="36578" end="36587">
                  <SYMBOL_PACKAGE line1="279" col1="29" line2="279" col2="33" start="36578" end="36582">edgeR</SYMBOL_PACKAGE>
                  <NS_GET line1="279" col1="34" line2="279" col2="35" start="36583" end="36584">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="279" col1="36" line2="279" col2="38" start="36585" end="36587">cpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="279" col1="39" line2="279" col2="39" start="36588" end="36588">(</OP-LEFT-PAREN>
                <expr line1="279" col1="40" line2="279" col2="71" start="36589" end="36620">
                  <expr line1="279" col1="40" line2="279" col2="49" start="36589" end="36598">
                    <SYMBOL line1="279" col1="40" line2="279" col2="49" start="36589" end="36598">counts_mat</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="279" col1="50" line2="279" col2="50" start="36599" end="36599">[</OP-LEFT-BRACKET>
                  <expr line1="279" col1="51" line2="279" col2="56" start="36600" end="36605">
                    <expr line1="279" col1="51" line2="279" col2="53" start="36600" end="36602">
                      <SYMBOL line1="279" col1="51" line2="279" col2="53" start="36600" end="36602">alt</SYMBOL>
                    </expr>
                    <OP-DOLLAR line1="279" col1="54" line2="279" col2="54" start="36603" end="36603">$</OP-DOLLAR>
                    <SYMBOL line1="279" col1="55" line2="279" col2="56" start="36604" end="36605">ID</SYMBOL>
                  </expr>
                  <OP-COMMA line1="279" col1="57" line2="279" col2="57" start="36606" end="36606">,</OP-COMMA>
                  <OP-COMMA line1="279" col1="58" line2="279" col2="58" start="36607" end="36607">,</OP-COMMA>
                  <SYMBOL_SUB line1="279" col1="59" line2="279" col2="62" start="36608" end="36611">drop</SYMBOL_SUB>
                  <EQ_SUB line1="279" col1="64" line2="279" col2="64" start="36613" end="36613">=</EQ_SUB>
                  <expr line1="279" col1="66" line2="279" col2="70" start="36615" end="36619">
                    <NUM_CONST line1="279" col1="66" line2="279" col2="70" start="36615" end="36619">FALSE</NUM_CONST>
                  </expr>
                  <OP-RIGHT-BRACKET line1="279" col1="71" line2="279" col2="71" start="36620" end="36620">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="279" col1="72" line2="279" col2="72" start="36621" end="36621">,</OP-COMMA>
                <SYMBOL_SUB line1="280" col1="40" line2="280" col2="47" start="36720" end="36727">lib.size</SYMBOL_SUB>
                <EQ_SUB line1="280" col1="49" line2="280" col2="49" start="36729" end="36729">=</EQ_SUB>
                <expr line1="280" col1="51" line2="280" col2="59" start="36731" end="36739">
                  <SYMBOL line1="280" col1="51" line2="280" col2="59" start="36731" end="36739">scaled.sf</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="280" col1="60" line2="280" col2="60" start="36740" end="36740">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="281" col1="5" line2="281" col2="5" start="36816" end="36816">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="283" col1="5" line2="283" col2="27" start="37078" end="37100"># Restoring attributes.</COMMENT>
        <expr line1="284" col1="5" line2="284" col2="45" start="37209" end="37249">
          <expr line1="284" col1="5" line2="284" col2="21" start="37209" end="37225">
            <expr line1="284" col1="5" line2="284" col2="12" start="37209" end="37216">
              <SYMBOL_FUNCTION_CALL line1="284" col1="5" line2="284" col2="12" start="37209" end="37216">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="284" col1="13" line2="284" col2="13" start="37217" end="37217">(</OP-LEFT-PAREN>
            <expr line1="284" col1="14" line2="284" col2="20" start="37218" end="37224">
              <SYMBOL line1="284" col1="14" line2="284" col2="20" start="37218" end="37224">cpm_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="284" col1="21" line2="284" col2="21" start="37225" end="37225">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="284" col1="23" line2="284" col2="24" start="37227" end="37228">&lt;-</LEFT_ASSIGN>
          <expr line1="284" col1="26" line2="284" col2="45" start="37230" end="37249">
            <expr line1="284" col1="26" line2="284" col2="37" start="37230" end="37241">
              <SYMBOL_FUNCTION_CALL line1="284" col1="26" line2="284" col2="37" start="37230" end="37241">featureNames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="284" col1="38" line2="284" col2="38" start="37242" end="37242">(</OP-LEFT-PAREN>
            <expr line1="284" col1="39" line2="284" col2="44" start="37243" end="37248">
              <SYMBOL line1="284" col1="39" line2="284" col2="44" start="37243" end="37248">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="284" col1="45" line2="284" col2="45" start="37249" end="37249">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="285" col1="5" line2="285" col2="41" start="37340" end="37376">
          <expr line1="285" col1="5" line2="285" col2="21" start="37340" end="37356">
            <expr line1="285" col1="5" line2="285" col2="12" start="37340" end="37347">
              <SYMBOL_FUNCTION_CALL line1="285" col1="5" line2="285" col2="12" start="37340" end="37347">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="285" col1="13" line2="285" col2="13" start="37348" end="37348">(</OP-LEFT-PAREN>
            <expr line1="285" col1="14" line2="285" col2="20" start="37349" end="37355">
              <SYMBOL line1="285" col1="14" line2="285" col2="20" start="37349" end="37355">cpm_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="285" col1="21" line2="285" col2="21" start="37356" end="37356">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="285" col1="23" line2="285" col2="24" start="37358" end="37359">&lt;-</LEFT_ASSIGN>
          <expr line1="285" col1="26" line2="285" col2="41" start="37361" end="37376">
            <expr line1="285" col1="26" line2="285" col2="33" start="37361" end="37368">
              <SYMBOL_FUNCTION_CALL line1="285" col1="26" line2="285" col2="33" start="37361" end="37368">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="285" col1="34" line2="285" col2="34" start="37369" end="37369">(</OP-LEFT-PAREN>
            <expr line1="285" col1="35" line2="285" col2="40" start="37370" end="37375">
              <SYMBOL line1="285" col1="35" line2="285" col2="40" start="37370" end="37375">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="285" col1="41" line2="285" col2="41" start="37376" end="37376">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="286" col1="5" line2="286" col2="19" start="37471" end="37485">
          <expr line1="286" col1="5" line2="286" col2="10" start="37471" end="37476">
            <SYMBOL_FUNCTION_CALL line1="286" col1="5" line2="286" col2="10" start="37471" end="37476">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="286" col1="11" line2="286" col2="11" start="37477" end="37477">(</OP-LEFT-PAREN>
          <expr line1="286" col1="12" line2="286" col2="18" start="37478" end="37484">
            <SYMBOL line1="286" col1="12" line2="286" col2="18" start="37478" end="37484">cpm_mat</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="286" col1="19" line2="286" col2="19" start="37485" end="37485">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="287" col1="1" line2="287" col2="1" start="37598" end="37598">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="289" col1="1" line2="289" col2="75" start="37860" end="37934">#' Calculate fragments per kilobase of exon per million reads mapped (FPKM)</COMMENT>
  <COMMENT line1="290" col1="1" line2="290" col2="2" start="37991" end="37992">#'</COMMENT>
  <COMMENT line1="291" col1="1" line2="291" col2="75" start="38122" end="38196">#' Calculate fragments per kilobase of exon per million reads mapped (FPKM)</COMMENT>
  <COMMENT line1="292" col1="1" line2="292" col2="59" start="38253" end="38311">#' values for expression from counts for a set of features.</COMMENT>
  <COMMENT line1="293" col1="1" line2="293" col2="2" start="38384" end="38385">#'</COMMENT>
  <COMMENT line1="294" col1="1" line2="294" col2="40" start="38515" end="38554">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="295" col1="1" line2="295" col2="73" start="38646" end="38718">#' @param effective_length vector of class \code{"numeric"} providing the</COMMENT>
  <COMMENT line1="296" col1="1" line2="296" col2="64" start="38777" end="38840">#' effective length for each feature in the \code{SCESet} object</COMMENT>
  <COMMENT line1="297" col1="1" line2="297" col2="75" start="38908" end="38982">#' @param use.size.factors a logical scalar, see \code{\link{calculateCPM}}</COMMENT>
  <COMMENT line1="298" col1="1" line2="298" col2="2" start="39039" end="39040">#'</COMMENT>
  <COMMENT line1="299" col1="1" line2="299" col2="33" start="39170" end="39202">#' @return Matrix of FPKM values.</COMMENT>
  <COMMENT line1="300" col1="1" line2="300" col2="10" start="39301" end="39310">#' @export</COMMENT>
  <COMMENT line1="301" col1="1" line2="301" col2="12" start="39432" end="39443">#' @examples</COMMENT>
  <COMMENT line1="302" col1="1" line2="302" col2="28" start="39563" end="39590">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="303" col1="1" line2="303" col2="31" start="39694" end="39724">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="304" col1="1" line2="304" col2="61" start="39825" end="39885">#' example_sceset &lt;- newSCESet(countData = sc_example_counts)</COMMENT>
  <COMMENT line1="305" col1="1" line2="305" col2="38" start="39956" end="39993">#' effective_length &lt;- rep(1000, 2000)</COMMENT>
  <COMMENT line1="306" col1="1" line2="306" col2="74" start="40087" end="40160">#' fpkm(example_sceset) &lt;- calculateFPKM(example_sceset, effective_length)</COMMENT>
  <COMMENT line1="307" col1="1" line2="307" col2="2" start="40218" end="40219">#'</COMMENT>
  <expr line1="308" col1="1" line2="314" col2="1" start="40349" end="41135">
    <expr line1="308" col1="1" line2="308" col2="13" start="40349" end="40361">
      <SYMBOL line1="308" col1="1" line2="308" col2="13" start="40349" end="40361">calculateFPKM</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="308" col1="15" line2="308" col2="16" start="40363" end="40364">&lt;-</LEFT_ASSIGN>
    <expr line1="308" col1="18" line2="314" col2="1" start="40366" end="41135">
      <FUNCTION line1="308" col1="18" line2="308" col2="25" start="40366" end="40373">function</FUNCTION>
      <OP-LEFT-PAREN line1="308" col1="26" line2="308" col2="26" start="40374" end="40374">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="308" col1="27" line2="308" col2="32" start="40375" end="40380">object</SYMBOL_FORMALS>
      <OP-COMMA line1="308" col1="33" line2="308" col2="33" start="40381" end="40381">,</OP-COMMA>
      <SYMBOL_FORMALS line1="308" col1="35" line2="308" col2="50" start="40383" end="40398">effective_length</SYMBOL_FORMALS>
      <OP-COMMA line1="308" col1="51" line2="308" col2="51" start="40399" end="40399">,</OP-COMMA>
      <SYMBOL_FORMALS line1="308" col1="53" line2="308" col2="68" start="40401" end="40416">use.size.factors</SYMBOL_FORMALS>
      <EQ_FORMALS line1="308" col1="69" line2="308" col2="69" start="40417" end="40417">=</EQ_FORMALS>
      <expr line1="308" col1="70" line2="308" col2="73" start="40418" end="40421">
        <NUM_CONST line1="308" col1="70" line2="308" col2="73" start="40418" end="40421">TRUE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="308" col1="74" line2="308" col2="74" start="40422" end="40422">)</OP-RIGHT-PAREN>
      <expr line1="308" col1="76" line2="314" col2="1" start="40424" end="41135">
        <OP-LEFT-BRACE line1="308" col1="76" line2="308" col2="76" start="40424" end="40424">{</OP-LEFT-BRACE>
        <expr line1="309" col1="5" line2="310" col2="40" start="40484" end="40650">
          <IF line1="309" col1="5" line2="309" col2="6" start="40484" end="40485">if</IF>
          <OP-LEFT-PAREN line1="309" col1="8" line2="309" col2="8" start="40487" end="40487">(</OP-LEFT-PAREN>
          <expr line1="309" col1="10" line2="309" col2="30" start="40489" end="40509">
            <OP-EXCLAMATION line1="309" col1="10" line2="309" col2="10" start="40489" end="40489">!</OP-EXCLAMATION>
            <expr line1="309" col1="11" line2="309" col2="30" start="40490" end="40509">
              <expr line1="309" col1="11" line2="309" col2="12" start="40490" end="40491">
                <SYMBOL_FUNCTION_CALL line1="309" col1="11" line2="309" col2="12" start="40490" end="40491">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="309" col1="13" line2="309" col2="13" start="40492" end="40492">(</OP-LEFT-PAREN>
              <expr line1="309" col1="14" line2="309" col2="19" start="40493" end="40498">
                <SYMBOL line1="309" col1="14" line2="309" col2="19" start="40493" end="40498">object</SYMBOL>
              </expr>
              <OP-COMMA line1="309" col1="20" line2="309" col2="20" start="40499" end="40499">,</OP-COMMA>
              <expr line1="309" col1="22" line2="309" col2="29" start="40501" end="40508">
                <STR_CONST line1="309" col1="22" line2="309" col2="29" start="40501" end="40508">"SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="309" col1="30" line2="309" col2="30" start="40509" end="40509">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="309" col1="32" line2="309" col2="32" start="40511" end="40511">)</OP-RIGHT-PAREN>
          <expr line1="310" col1="9" line2="310" col2="40" start="40619" end="40650">
            <expr line1="310" col1="9" line2="310" col2="12" start="40619" end="40622">
              <SYMBOL_FUNCTION_CALL line1="310" col1="9" line2="310" col2="12" start="40619" end="40622">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="310" col1="13" line2="310" col2="13" start="40623" end="40623">(</OP-LEFT-PAREN>
            <expr line1="310" col1="14" line2="310" col2="39" start="40624" end="40649">
              <STR_CONST line1="310" col1="14" line2="310" col2="39" start="40624" end="40649">"object must be an SCESet"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="310" col1="40" line2="310" col2="40" start="40650" end="40650">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="311" col1="5" line2="311" col2="69" start="40746" end="40810">
          <expr line1="311" col1="5" line2="311" col2="8" start="40746" end="40749">
            <SYMBOL line1="311" col1="5" line2="311" col2="8" start="40746" end="40749">cpms</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="311" col1="10" line2="311" col2="11" start="40751" end="40752">&lt;-</LEFT_ASSIGN>
          <expr line1="311" col1="13" line2="311" col2="69" start="40754" end="40810">
            <expr line1="311" col1="13" line2="311" col2="24" start="40754" end="40765">
              <SYMBOL_FUNCTION_CALL line1="311" col1="13" line2="311" col2="24" start="40754" end="40765">calculateCPM</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="311" col1="25" line2="311" col2="25" start="40766" end="40766">(</OP-LEFT-PAREN>
            <expr line1="311" col1="26" line2="311" col2="31" start="40767" end="40772">
              <SYMBOL line1="311" col1="26" line2="311" col2="31" start="40767" end="40772">object</SYMBOL>
            </expr>
            <OP-COMMA line1="311" col1="32" line2="311" col2="32" start="40773" end="40773">,</OP-COMMA>
            <SYMBOL_SUB line1="311" col1="34" line2="311" col2="49" start="40775" end="40790">use.size.factors</SYMBOL_SUB>
            <EQ_SUB line1="311" col1="51" line2="311" col2="51" start="40792" end="40792">=</EQ_SUB>
            <expr line1="311" col1="53" line2="311" col2="68" start="40794" end="40809">
              <SYMBOL line1="311" col1="53" line2="311" col2="68" start="40794" end="40809">use.size.factors</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="311" col1="69" line2="311" col2="69" start="40810" end="40810">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="312" col1="5" line2="312" col2="46" start="40877" end="40918">
          <expr line1="312" col1="5" line2="312" col2="20" start="40877" end="40892">
            <SYMBOL line1="312" col1="5" line2="312" col2="20" start="40877" end="40892">effective_length</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="312" col1="22" line2="312" col2="23" start="40894" end="40895">&lt;-</LEFT_ASSIGN>
          <expr line1="312" col1="25" line2="312" col2="46" start="40897" end="40918">
            <expr line1="312" col1="25" line2="312" col2="40" start="40897" end="40912">
              <SYMBOL line1="312" col1="25" line2="312" col2="40" start="40897" end="40912">effective_length</SYMBOL>
            </expr>
            <OP-SLASH line1="312" col1="42" line2="312" col2="42" start="40914" end="40914">/</OP-SLASH>
            <expr line1="312" col1="44" line2="312" col2="46" start="40916" end="40918">
              <NUM_CONST line1="312" col1="44" line2="312" col2="46" start="40916" end="40918">1e3</NUM_CONST>
            </expr>
          </expr>
        </expr>
        <expr line1="313" col1="5" line2="313" col2="27" start="41008" end="41030">
          <expr line1="313" col1="5" line2="313" col2="8" start="41008" end="41011">
            <SYMBOL line1="313" col1="5" line2="313" col2="8" start="41008" end="41011">cpms</SYMBOL>
          </expr>
          <OP-SLASH line1="313" col1="10" line2="313" col2="10" start="41013" end="41013">/</OP-SLASH>
          <expr line1="313" col1="12" line2="313" col2="27" start="41015" end="41030">
            <SYMBOL line1="313" col1="12" line2="313" col2="27" start="41015" end="41030">effective_length</SYMBOL>
          </expr>
        </expr>
        <OP-RIGHT-BRACE line1="314" col1="1" line2="314" col2="1" start="41135" end="41135">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="317" col1="1" line2="317" col2="71" start="41528" end="41598">#' Calculate average counts, adjusting for size factors or library size</COMMENT>
  <COMMENT line1="318" col1="1" line2="318" col2="2" start="41659" end="41660">#'</COMMENT>
  <COMMENT line1="319" col1="1" line2="319" col2="78" start="41790" end="41867">#' Calculate average counts per feature, adjusting them as appropriate to take</COMMENT>
  <COMMENT line1="320" col1="1" line2="320" col2="74" start="41921" end="41994">#' into account for size factors for normalization or library sizes (total</COMMENT>
  <COMMENT line1="321" col1="1" line2="321" col2="11" start="42052" end="42062">#' counts).</COMMENT>
  <COMMENT line1="322" col1="1" line2="322" col2="2" start="42183" end="42184">#'</COMMENT>
  <COMMENT line1="323" col1="1" line2="323" col2="40" start="42314" end="42353">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="324" col1="1" line2="324" col2="2" start="42445" end="42446">#'</COMMENT>
  <COMMENT line1="325" col1="1" line2="325" col2="81" start="42576" end="42656">#' @return Vector of average count values with same length as number of features.</COMMENT>
  <COMMENT line1="326" col1="1" line2="326" col2="10" start="42707" end="42716">#' @export</COMMENT>
  <COMMENT line1="327" col1="1" line2="327" col2="12" start="42838" end="42849">#' @examples</COMMENT>
  <COMMENT line1="328" col1="1" line2="328" col2="28" start="42969" end="42996">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="329" col1="1" line2="329" col2="31" start="43100" end="43130">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="330" col1="1" line2="330" col2="63" start="43231" end="43293">#' pd &lt;- new("AnnotatedDataFrame", data = sc_example_cell_info)</COMMENT>
  <COMMENT line1="331" col1="1" line2="331" col2="77" start="43362" end="43438">#' example_sceset &lt;- newSCESet(countData = sc_example_counts, phenoData = pd)</COMMENT>
  <COMMENT line1="332" col1="1" line2="332" col2="2" start="43493" end="43494">#'</COMMENT>
  <COMMENT line1="333" col1="1" line2="333" col2="30" start="43624" end="43653">#' ## calculate average counts</COMMENT>
  <COMMENT line1="334" col1="1" line2="334" col2="44" start="43755" end="43798">#' ave_counts &lt;- calcAverage(example_sceset)</COMMENT>
  <COMMENT line1="335" col1="1" line2="335" col2="2" start="43886" end="43887">#'</COMMENT>
  <expr line1="336" col1="1" line2="352" col2="1" start="44017" end="46113">
    <expr line1="336" col1="1" line2="336" col2="11" start="44017" end="44027">
      <SYMBOL line1="336" col1="1" line2="336" col2="11" start="44017" end="44027">calcAverage</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="336" col1="13" line2="336" col2="14" start="44029" end="44030">&lt;-</LEFT_ASSIGN>
    <expr line1="336" col1="16" line2="352" col2="1" start="44032" end="46113">
      <FUNCTION line1="336" col1="16" line2="336" col2="23" start="44032" end="44039">function</FUNCTION>
      <OP-LEFT-PAREN line1="336" col1="24" line2="336" col2="24" start="44040" end="44040">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="336" col1="25" line2="336" col2="30" start="44041" end="44046">object</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="336" col1="31" line2="336" col2="31" start="44047" end="44047">)</OP-RIGHT-PAREN>
      <expr line1="336" col1="33" line2="352" col2="1" start="44049" end="46113">
        <OP-LEFT-BRACE line1="336" col1="33" line2="336" col2="33" start="44049" end="44049">{</OP-LEFT-BRACE>
        <COMMENT line1="337" col1="5" line2="337" col2="77" start="44152" end="44224"># Computes the average count, adjusting for size factors or library size.</COMMENT>
        <expr line1="338" col1="5" line2="338" col2="44" start="44283" end="44322">
          <expr line1="338" col1="5" line2="338" col2="16" start="44283" end="44294">
            <SYMBOL line1="338" col1="5" line2="338" col2="16" start="44283" end="44294">control_list</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="338" col1="18" line2="338" col2="19" start="44296" end="44297">&lt;-</LEFT_ASSIGN>
          <expr line1="338" col1="21" line2="338" col2="44" start="44299" end="44322">
            <expr line1="338" col1="21" line2="338" col2="36" start="44299" end="44314">
              <SYMBOL_FUNCTION_CALL line1="338" col1="21" line2="338" col2="36" start="44299" end="44314">.find_control_SF</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="338" col1="37" line2="338" col2="37" start="44315" end="44315">(</OP-LEFT-PAREN>
            <expr line1="338" col1="38" line2="338" col2="43" start="44316" end="44321">
              <SYMBOL line1="338" col1="38" line2="338" col2="43" start="44316" end="44321">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="338" col1="44" line2="338" col2="44" start="44322" end="44322">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="339" col1="5" line2="339" col2="47" start="44414" end="44456">
          <expr line1="339" col1="5" line2="339" col2="6" start="44414" end="44415">
            <SYMBOL line1="339" col1="5" line2="339" col2="6" start="44414" end="44415">sf</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="339" col1="8" line2="339" col2="9" start="44417" end="44418">&lt;-</LEFT_ASSIGN>
          <expr line1="339" col1="11" line2="339" col2="47" start="44420" end="44456">
            <expr line1="339" col1="11" line2="339" col2="26" start="44420" end="44435">
              <SYMBOL_FUNCTION_CALL line1="339" col1="11" line2="339" col2="26" start="44420" end="44435">suppressWarnings</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="339" col1="27" line2="339" col2="27" start="44436" end="44436">(</OP-LEFT-PAREN>
            <expr line1="339" col1="28" line2="339" col2="46" start="44437" end="44455">
              <expr line1="339" col1="28" line2="339" col2="38" start="44437" end="44447">
                <SYMBOL_FUNCTION_CALL line1="339" col1="28" line2="339" col2="38" start="44437" end="44447">sizeFactors</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="339" col1="39" line2="339" col2="39" start="44448" end="44448">(</OP-LEFT-PAREN>
              <expr line1="339" col1="40" line2="339" col2="45" start="44449" end="44454">
                <SYMBOL line1="339" col1="40" line2="339" col2="45" start="44449" end="44454">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="339" col1="46" line2="339" col2="46" start="44455" end="44455">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="339" col1="47" line2="339" col2="47" start="44456" end="44456">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="340" col1="5" line2="340" col2="50" start="44545" end="44590">
          <IF line1="340" col1="5" line2="340" col2="6" start="44545" end="44546">if</IF>
          <OP-LEFT-PAREN line1="340" col1="8" line2="340" col2="8" start="44548" end="44548">(</OP-LEFT-PAREN>
          <expr line1="340" col1="9" line2="340" col2="19" start="44549" end="44559">
            <expr line1="340" col1="9" line2="340" col2="15" start="44549" end="44555">
              <SYMBOL_FUNCTION_CALL line1="340" col1="9" line2="340" col2="15" start="44549" end="44555">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="340" col1="16" line2="340" col2="16" start="44556" end="44556">(</OP-LEFT-PAREN>
            <expr line1="340" col1="17" line2="340" col2="18" start="44557" end="44558">
              <SYMBOL line1="340" col1="17" line2="340" col2="18" start="44557" end="44558">sf</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="340" col1="19" line2="340" col2="19" start="44559" end="44559">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="340" col1="20" line2="340" col2="20" start="44560" end="44560">)</OP-RIGHT-PAREN>
          <expr line1="340" col1="22" line2="340" col2="50" start="44562" end="44590">
            <expr line1="340" col1="22" line2="340" col2="23" start="44562" end="44563">
              <SYMBOL line1="340" col1="22" line2="340" col2="23" start="44562" end="44563">sf</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="340" col1="25" line2="340" col2="26" start="44565" end="44566">&lt;-</LEFT_ASSIGN>
            <expr line1="340" col1="28" line2="340" col2="50" start="44568" end="44590">
              <expr line1="340" col1="28" line2="340" col2="34" start="44568" end="44574">
                <SYMBOL_FUNCTION_CALL line1="340" col1="28" line2="340" col2="34" start="44568" end="44574">colSums</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="340" col1="35" line2="340" col2="35" start="44575" end="44575">(</OP-LEFT-PAREN>
              <expr line1="340" col1="36" line2="340" col2="49" start="44576" end="44589">
                <expr line1="340" col1="36" line2="340" col2="41" start="44576" end="44581">
                  <SYMBOL_FUNCTION_CALL line1="340" col1="36" line2="340" col2="41" start="44576" end="44581">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="340" col1="42" line2="340" col2="42" start="44582" end="44582">(</OP-LEFT-PAREN>
                <expr line1="340" col1="43" line2="340" col2="48" start="44583" end="44588">
                  <SYMBOL line1="340" col1="43" line2="340" col2="48" start="44583" end="44588">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="340" col1="49" line2="340" col2="49" start="44589" end="44589">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="340" col1="50" line2="340" col2="50" start="44590" end="44590">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="341" col1="5" line2="341" col2="44" start="44676" end="44715">
          <expr line1="341" col1="5" line2="341" col2="16" start="44676" end="44687">
            <SYMBOL line1="341" col1="5" line2="341" col2="16" start="44676" end="44687">control_list</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="341" col1="18" line2="341" col2="19" start="44689" end="44690">&lt;-</LEFT_ASSIGN>
          <expr line1="341" col1="21" line2="341" col2="44" start="44692" end="44715">
            <expr line1="341" col1="21" line2="341" col2="36" start="44692" end="44707">
              <SYMBOL_FUNCTION_CALL line1="341" col1="21" line2="341" col2="36" start="44692" end="44707">.find_control_SF</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="341" col1="37" line2="341" col2="37" start="44708" end="44708">(</OP-LEFT-PAREN>
            <expr line1="341" col1="38" line2="341" col2="43" start="44709" end="44714">
              <SYMBOL line1="341" col1="38" line2="341" col2="43" start="44709" end="44714">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="341" col1="44" line2="341" col2="44" start="44715" end="44715">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="343" col1="5" line2="343" col2="68" start="44938" end="45001">
          <expr line1="343" col1="5" line2="343" col2="11" start="44938" end="44944">
            <SYMBOL line1="343" col1="5" line2="343" col2="11" start="44938" end="44944">all.ave</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="343" col1="13" line2="343" col2="14" start="44946" end="44947">&lt;-</LEFT_ASSIGN>
          <expr line1="343" col1="16" line2="343" col2="68" start="44949" end="45001">
            <expr line1="343" col1="16" line2="343" col2="33" start="44949" end="44966">
              <SYMBOL_FUNCTION_CALL line1="343" col1="16" line2="343" col2="33" start="44949" end="44966">.compute_ave_count</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="343" col1="34" line2="343" col2="34" start="44967" end="44967">(</OP-LEFT-PAREN>
            <expr line1="343" col1="35" line2="343" col2="48" start="44968" end="44981">
              <expr line1="343" col1="35" line2="343" col2="40" start="44968" end="44973">
                <SYMBOL_FUNCTION_CALL line1="343" col1="35" line2="343" col2="40" start="44968" end="44973">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="343" col1="41" line2="343" col2="41" start="44974" end="44974">(</OP-LEFT-PAREN>
              <expr line1="343" col1="42" line2="343" col2="47" start="44975" end="44980">
                <SYMBOL line1="343" col1="42" line2="343" col2="47" start="44975" end="44980">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="343" col1="48" line2="343" col2="48" start="44981" end="44981">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="343" col1="49" line2="343" col2="49" start="44982" end="44982">,</OP-COMMA>
            <SYMBOL_SUB line1="343" col1="51" line2="343" col2="62" start="44984" end="44995">size_factors</SYMBOL_SUB>
            <EQ_SUB line1="343" col1="64" line2="343" col2="64" start="44997" end="44997">=</EQ_SUB>
            <expr line1="343" col1="66" line2="343" col2="67" start="44999" end="45000">
              <SYMBOL line1="343" col1="66" line2="343" col2="67" start="44999" end="45000">sf</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="343" col1="68" line2="343" col2="68" start="45001" end="45001">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="344" col1="5" line2="348" col2="5" start="45069" end="45593">
          <FOR line1="344" col1="5" line2="344" col2="7" start="45069" end="45071">for</FOR>
          <forcond line1="344" col1="9" line2="344" col2="29" start="45073" end="45093">
            <OP-LEFT-PAREN line1="344" col1="9" line2="344" col2="9" start="45073" end="45073">(</OP-LEFT-PAREN>
            <SYMBOL line1="344" col1="10" line2="344" col2="12" start="45074" end="45076">alt</SYMBOL>
            <IN line1="344" col1="14" line2="344" col2="15" start="45078" end="45079">in</IN>
            <expr line1="344" col1="17" line2="344" col2="28" start="45081" end="45092">
              <SYMBOL line1="344" col1="17" line2="344" col2="28" start="45081" end="45092">control_list</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="344" col1="29" line2="344" col2="29" start="45093" end="45093">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="344" col1="31" line2="348" col2="5" start="45095" end="45593">
            <OP-LEFT-BRACE line1="344" col1="31" line2="344" col2="31" start="45095" end="45095">{</OP-LEFT-BRACE>
            <expr line1="345" col1="9" line2="347" col2="66" start="45204" end="45523">
              <expr line1="345" col1="9" line2="345" col2="23" start="45204" end="45218">
                <expr line1="345" col1="9" line2="345" col2="15" start="45204" end="45210">
                  <SYMBOL line1="345" col1="9" line2="345" col2="15" start="45204" end="45210">all.ave</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="345" col1="16" line2="345" col2="16" start="45211" end="45211">[</OP-LEFT-BRACKET>
                <expr line1="345" col1="17" line2="345" col2="22" start="45212" end="45217">
                  <expr line1="345" col1="17" line2="345" col2="19" start="45212" end="45214">
                    <SYMBOL line1="345" col1="17" line2="345" col2="19" start="45212" end="45214">alt</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="345" col1="20" line2="345" col2="20" start="45215" end="45215">$</OP-DOLLAR>
                  <SYMBOL line1="345" col1="21" line2="345" col2="22" start="45216" end="45217">ID</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="345" col1="23" line2="345" col2="23" start="45218" end="45218">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="345" col1="25" line2="345" col2="26" start="45220" end="45221">&lt;-</LEFT_ASSIGN>
              <expr line1="345" col1="28" line2="347" col2="66" start="45223" end="45523">
                <expr line1="345" col1="28" line2="345" col2="45" start="45223" end="45240">
                  <SYMBOL_FUNCTION_CALL line1="345" col1="28" line2="345" col2="45" start="45223" end="45240">.compute_ave_count</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="345" col1="46" line2="345" col2="46" start="45241" end="45241">(</OP-LEFT-PAREN>
                <expr line1="345" col1="47" line2="345" col2="60" start="45242" end="45255">
                  <expr line1="345" col1="47" line2="345" col2="52" start="45242" end="45247">
                    <SYMBOL_FUNCTION_CALL line1="345" col1="47" line2="345" col2="52" start="45242" end="45247">counts</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="345" col1="53" line2="345" col2="53" start="45248" end="45248">(</OP-LEFT-PAREN>
                  <expr line1="345" col1="54" line2="345" col2="59" start="45249" end="45254">
                    <SYMBOL line1="345" col1="54" line2="345" col2="59" start="45249" end="45254">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="345" col1="60" line2="345" col2="60" start="45255" end="45255">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="345" col1="61" line2="345" col2="61" start="45256" end="45256">,</OP-COMMA>
                <SYMBOL_SUB line1="346" col1="47" line2="346" col2="58" start="45373" end="45384">size_factors</SYMBOL_SUB>
                <EQ_SUB line1="346" col1="60" line2="346" col2="60" start="45386" end="45386">=</EQ_SUB>
                <expr line1="346" col1="62" line2="346" col2="67" start="45388" end="45393">
                  <expr line1="346" col1="62" line2="346" col2="64" start="45388" end="45390">
                    <SYMBOL line1="346" col1="62" line2="346" col2="64" start="45388" end="45390">alt</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="346" col1="65" line2="346" col2="65" start="45391" end="45391">$</OP-DOLLAR>
                  <SYMBOL line1="346" col1="66" line2="346" col2="67" start="45392" end="45393">SF</SYMBOL>
                </expr>
                <OP-COMMA line1="346" col1="68" line2="346" col2="68" start="45394" end="45394">,</OP-COMMA>
                <SYMBOL_SUB line1="347" col1="47" line2="347" col2="56" start="45504" end="45513">subset_row</SYMBOL_SUB>
                <EQ_SUB line1="347" col1="58" line2="347" col2="58" start="45515" end="45515">=</EQ_SUB>
                <expr line1="347" col1="60" line2="347" col2="65" start="45517" end="45522">
                  <expr line1="347" col1="60" line2="347" col2="62" start="45517" end="45519">
                    <SYMBOL line1="347" col1="60" line2="347" col2="62" start="45517" end="45519">alt</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="347" col1="63" line2="347" col2="63" start="45520" end="45520">$</OP-DOLLAR>
                  <SYMBOL line1="347" col1="64" line2="347" col2="65" start="45521" end="45522">ID</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="347" col1="66" line2="347" col2="66" start="45523" end="45523">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="348" col1="5" line2="348" col2="5" start="45593" end="45593">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="350" col1="5" line2="350" col2="38" start="45855" end="45888">
          <expr line1="350" col1="5" line2="350" col2="18" start="45855" end="45868">
            <expr line1="350" col1="5" line2="350" col2="9" start="45855" end="45859">
              <SYMBOL_FUNCTION_CALL line1="350" col1="5" line2="350" col2="9" start="45855" end="45859">names</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="350" col1="10" line2="350" col2="10" start="45860" end="45860">(</OP-LEFT-PAREN>
            <expr line1="350" col1="11" line2="350" col2="17" start="45861" end="45867">
              <SYMBOL line1="350" col1="11" line2="350" col2="17" start="45861" end="45867">all.ave</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="350" col1="18" line2="350" col2="18" start="45868" end="45868">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="350" col1="20" line2="350" col2="21" start="45870" end="45871">&lt;-</LEFT_ASSIGN>
          <expr line1="350" col1="23" line2="350" col2="38" start="45873" end="45888">
            <expr line1="350" col1="23" line2="350" col2="30" start="45873" end="45880">
              <SYMBOL_FUNCTION_CALL line1="350" col1="23" line2="350" col2="30" start="45873" end="45880">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="350" col1="31" line2="350" col2="31" start="45881" end="45881">(</OP-LEFT-PAREN>
            <expr line1="350" col1="32" line2="350" col2="37" start="45882" end="45887">
              <SYMBOL line1="350" col1="32" line2="350" col2="37" start="45882" end="45887">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="350" col1="38" line2="350" col2="38" start="45888" end="45888">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="351" col1="5" line2="351" col2="34" start="45986" end="46015">
          <expr line1="351" col1="5" line2="351" col2="10" start="45986" end="45991">
            <SYMBOL_FUNCTION_CALL line1="351" col1="5" line2="351" col2="10" start="45986" end="45991">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="351" col1="11" line2="351" col2="11" start="45992" end="45992">(</OP-LEFT-PAREN>
          <expr line1="351" col1="12" line2="351" col2="33" start="45993" end="46014">
            <expr line1="351" col1="12" line2="351" col2="18" start="45993" end="45999">
              <SYMBOL line1="351" col1="12" line2="351" col2="18" start="45993" end="45999">all.ave</SYMBOL>
            </expr>
            <OP-SLASH line1="351" col1="20" line2="351" col2="20" start="46001" end="46001">/</OP-SLASH>
            <expr line1="351" col1="22" line2="351" col2="33" start="46003" end="46014">
              <expr line1="351" col1="22" line2="351" col2="25" start="46003" end="46006">
                <SYMBOL_FUNCTION_CALL line1="351" col1="22" line2="351" col2="25" start="46003" end="46006">ncol</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="351" col1="26" line2="351" col2="26" start="46007" end="46007">(</OP-LEFT-PAREN>
              <expr line1="351" col1="27" line2="351" col2="32" start="46008" end="46013">
                <SYMBOL line1="351" col1="27" line2="351" col2="32" start="46008" end="46013">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="351" col1="33" line2="351" col2="33" start="46014" end="46014">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="351" col1="34" line2="351" col2="34" start="46015" end="46015">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="352" col1="1" line2="352" col2="1" start="46113" end="46113">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="355" col1="1" line2="358" col2="1" start="46506" end="46899">
    <expr line1="355" col1="1" line2="355" col2="18" start="46506" end="46523">
      <SYMBOL line1="355" col1="1" line2="355" col2="18" start="46506" end="46523">.compute_ave_count</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="355" col1="20" line2="355" col2="21" start="46525" end="46526">&lt;-</LEFT_ASSIGN>
    <expr line1="355" col1="23" line2="358" col2="1" start="46528" end="46899">
      <FUNCTION line1="355" col1="23" line2="355" col2="30" start="46528" end="46535">function</FUNCTION>
      <OP-LEFT-PAREN line1="355" col1="31" line2="355" col2="31" start="46536" end="46536">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="355" col1="32" line2="355" col2="41" start="46537" end="46546">counts_mat</SYMBOL_FORMALS>
      <OP-COMMA line1="355" col1="42" line2="355" col2="42" start="46547" end="46547">,</OP-COMMA>
      <SYMBOL_FORMALS line1="355" col1="44" line2="355" col2="55" start="46549" end="46560">size_factors</SYMBOL_FORMALS>
      <OP-COMMA line1="355" col1="56" line2="355" col2="56" start="46561" end="46561">,</OP-COMMA>
      <SYMBOL_FORMALS line1="355" col1="58" line2="355" col2="67" start="46563" end="46572">subset_row</SYMBOL_FORMALS>
      <EQ_FORMALS line1="355" col1="69" line2="355" col2="69" start="46574" end="46574">=</EQ_FORMALS>
      <expr line1="355" col1="71" line2="355" col2="74" start="46576" end="46579">
        <NULL_CONST line1="355" col1="71" line2="355" col2="74" start="46576" end="46579">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="355" col1="75" line2="355" col2="75" start="46580" end="46580">)</OP-RIGHT-PAREN>
      <expr line1="355" col1="77" line2="358" col2="1" start="46582" end="46899">
        <OP-LEFT-BRACE line1="355" col1="77" line2="355" col2="77" start="46582" end="46582">{</OP-LEFT-BRACE>
        <expr line1="356" col1="5" line2="357" col2="63" start="46641" end="46830">
          <expr line1="356" col1="5" line2="356" col2="18" start="46641" end="46654">
            <SYMBOL_FUNCTION_CALL line1="356" col1="5" line2="356" col2="18" start="46641" end="46654">.compute_exprs</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="356" col1="19" line2="356" col2="19" start="46655" end="46655">(</OP-LEFT-PAREN>
          <expr line1="356" col1="20" line2="356" col2="29" start="46656" end="46665">
            <SYMBOL line1="356" col1="20" line2="356" col2="29" start="46656" end="46665">counts_mat</SYMBOL>
          </expr>
          <OP-COMMA line1="356" col1="30" line2="356" col2="30" start="46666" end="46666">,</OP-COMMA>
          <expr line1="356" col1="32" line2="356" col2="43" start="46668" end="46679">
            <SYMBOL line1="356" col1="32" line2="356" col2="43" start="46668" end="46679">size_factors</SYMBOL>
          </expr>
          <OP-COMMA line1="356" col1="44" line2="356" col2="44" start="46680" end="46680">,</OP-COMMA>
          <SYMBOL_SUB line1="356" col1="46" line2="356" col2="48" start="46682" end="46684">log</SYMBOL_SUB>
          <EQ_SUB line1="356" col1="50" line2="356" col2="50" start="46686" end="46686">=</EQ_SUB>
          <expr line1="356" col1="52" line2="356" col2="56" start="46688" end="46692">
            <NUM_CONST line1="356" col1="52" line2="356" col2="56" start="46688" end="46692">FALSE</NUM_CONST>
          </expr>
          <OP-COMMA line1="356" col1="57" line2="356" col2="57" start="46693" end="46693">,</OP-COMMA>
          <SYMBOL_SUB line1="356" col1="59" line2="356" col2="61" start="46695" end="46697">sum</SYMBOL_SUB>
          <EQ_SUB line1="356" col1="63" line2="356" col2="63" start="46699" end="46699">=</EQ_SUB>
          <expr line1="356" col1="65" line2="356" col2="68" start="46701" end="46704">
            <NUM_CONST line1="356" col1="65" line2="356" col2="68" start="46701" end="46704">TRUE</NUM_CONST>
          </expr>
          <OP-COMMA line1="356" col1="69" line2="356" col2="69" start="46705" end="46705">,</OP-COMMA>
          <SYMBOL_SUB line1="357" col1="20" line2="357" col2="33" start="46787" end="46800">logExprsOffset</SYMBOL_SUB>
          <EQ_SUB line1="357" col1="35" line2="357" col2="35" start="46802" end="46802">=</EQ_SUB>
          <expr line1="357" col1="37" line2="357" col2="37" start="46804" end="46804">
            <NUM_CONST line1="357" col1="37" line2="357" col2="37" start="46804" end="46804">0</NUM_CONST>
          </expr>
          <OP-COMMA line1="357" col1="38" line2="357" col2="38" start="46805" end="46805">,</OP-COMMA>
          <SYMBOL_SUB line1="357" col1="40" line2="357" col2="49" start="46807" end="46816">subset_row</SYMBOL_SUB>
          <EQ_SUB line1="357" col1="51" line2="357" col2="51" start="46818" end="46818">=</EQ_SUB>
          <expr line1="357" col1="53" line2="357" col2="62" start="46820" end="46829">
            <SYMBOL line1="357" col1="53" line2="357" col2="62" start="46820" end="46829">subset_row</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="357" col1="63" line2="357" col2="63" start="46830" end="46830">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="358" col1="1" line2="358" col2="1" start="46899" end="46899">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

