<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="34" start="159" end="192">## summarise and annotate features</COMMENT>
  <COMMENT line1="2" col1="1" line2="2" col2="17" start="317" end="333">## Davis McCarthy</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="19" start="475" end="493">## 18 November 2015</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="80" start="791" end="870">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="62" start="1107" end="1168">## Function to get feature annotation information from biomaRt</COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="50" start="1423" end="1472">#' Get feature annotation information from Biomart</COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="3" start="1581" end="1583">#' </COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="78" start="1739" end="1816">#' Use the \code{biomaRt} package to add feature annotation information to an </COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="18" start="1897" end="1914">#' \code{SCESet}. </COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="3" start="2055" end="2057">#' </COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="40" start="2213" end="2252">#' @param object an \code{SCESet} object</COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="78" start="2371" end="2448">#' @param filters character vector defining the "filters" terms to pass to the</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="27" start="2529" end="2555">#' biomaRt::getBM function.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="80" start="2687" end="2766">#' @param attributes character vector defining the biomaRt attributes to pass to</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="66" start="2845" end="2910">#' the \code{attributes} argument of \code{\link[biomaRt]{getBM}}.</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="79" start="3003" end="3081">#' @param feature_symbol character string defining the biomaRt attribute to be </COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="79" start="3161" end="3239">#' used to define the symbol to be used for each feature (which appears as the </COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="69" start="3319" end="3387">#' \code{feature_symbol} in fData(object), subsequently). Default is </COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="78" start="3477" end="3554">#' \code{"mgi_symbol"}, gene symbols for mouse. This should be changed if the </COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="32" start="3635" end="3666">#' organism is not Mus musculus!</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="80" start="3793" end="3872">#' @param feature_id character string defining the biomaRt attribute to be used </COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="70" start="3951" end="4020">#' to define the ID to be used for each feature (which appears as the </COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="65" start="4109" end="4173">#' \code{feature_id} in fData(object), subsequently). Default is </COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="80" start="4267" end="4346">#' \code{"ensembl_gene_id"}, Ensembl gene IDs for mouse. This should be changed </COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="39" start="4425" end="4463">#' if the organism is not Mus musculus!</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="79" start="4583" end="4661">#' @param biomart character string defining the biomaRt to be used. Default is </COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="33" start="4741" end="4773">#' \code{"ENSEMBL_MART_ENSEMBL"}.</COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="79" start="4899" end="4977">#' @param dataset character string defining the biomaRt dataset to use. Default</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="79" start="5057" end="5135">#' is \code{"mmusculus_gene_ensembl"}, which should be changed if the organism </COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="20" start="5215" end="5234">#' is not the mouse!</COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="79" start="5373" end="5451">#' @param host optional character string argument which can be used to select a</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="78" start="5531" end="5608">#' particular \code{"host"} from biomaRt to use. Useful for accessing archived</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="92" start="5689" end="5780">#' versions of biomaRt data. Default is \code{"www.ensembl.org"}, in which case the current </COMMENT>
  <COMMENT line1="37" col1="1" line2="37" col2="58" start="5847" end="5904">#' version of the biomaRt (now hosted by Ensembl) is used.</COMMENT>
  <COMMENT line1="38" col1="1" line2="38" col2="3" start="6005" end="6007">#' </COMMENT>
  <COMMENT line1="39" col1="1" line2="39" col2="79" start="6163" end="6241">#' @details See the documentation for the biomaRt package, specifically for the</COMMENT>
  <COMMENT line1="40" col1="1" line2="40" col2="74" start="6321" end="6394">#' functions \code{useMart} and \code{getBM}, for information on what are </COMMENT>
  <COMMENT line1="41" col1="1" line2="41" col2="75" start="6479" end="6553">#' permitted values for the filters, attributes, biomart, dataset and host </COMMENT>
  <COMMENT line1="42" col1="1" line2="42" col2="13" start="6637" end="6649">#' arguments.</COMMENT>
  <COMMENT line1="43" col1="1" line2="43" col2="3" start="6795" end="6797">#' </COMMENT>
  <COMMENT line1="44" col1="1" line2="44" col2="27" start="6953" end="6979">#' @return an SCESet object</COMMENT>
  <COMMENT line1="45" col1="1" line2="45" col2="3" start="7111" end="7113">#' </COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="35" start="7269" end="7303">#' @importFrom Biobase featureNames</COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="30" start="7427" end="7456">#' @importFrom biomaRt useMart</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="10" start="7585" end="7594">#' @export</COMMENT>
  <COMMENT line1="49" col1="1" line2="49" col2="3" start="7743" end="7745">#' </COMMENT>
  <COMMENT line1="50" col1="1" line2="50" col2="12" start="7901" end="7912">#' @examples</COMMENT>
  <COMMENT line1="51" col1="1" line2="51" col2="12" start="8059" end="8070">#' \dontrun{</COMMENT>
  <COMMENT line1="52" col1="1" line2="52" col2="38" start="8217" end="8254">#' object &lt;- getBMFeatureAnnos(object)</COMMENT>
  <COMMENT line1="53" col1="1" line2="53" col2="4" start="8375" end="8378">#' }</COMMENT>
  <COMMENT line1="54" col1="1" line2="54" col2="3" start="8533" end="8535">#' </COMMENT>
  <expr line1="55" col1="1" line2="110" col2="1" start="8691" end="17381">
    <expr line1="55" col1="1" line2="55" col2="17" start="8691" end="8707">
      <SYMBOL line1="55" col1="1" line2="55" col2="17" start="8691" end="8707">getBMFeatureAnnos</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="55" col1="19" line2="55" col2="20" start="8709" end="8710">&lt;-</LEFT_ASSIGN>
    <expr line1="55" col1="22" line2="110" col2="1" start="8712" end="17381">
      <FUNCTION line1="55" col1="22" line2="55" col2="29" start="8712" end="8719">function</FUNCTION>
      <OP-LEFT-PAREN line1="55" col1="30" line2="55" col2="30" start="8720" end="8720">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="55" col1="31" line2="55" col2="36" start="8721" end="8726">object</SYMBOL_FORMALS>
      <OP-COMMA line1="55" col1="37" line2="55" col2="37" start="8727" end="8727">,</OP-COMMA>
      <SYMBOL_FORMALS line1="55" col1="39" line2="55" col2="45" start="8729" end="8735">filters</SYMBOL_FORMALS>
      <EQ_FORMALS line1="55" col1="46" line2="55" col2="46" start="8736" end="8736">=</EQ_FORMALS>
      <expr line1="55" col1="47" line2="55" col2="69" start="8737" end="8759">
        <STR_CONST line1="55" col1="47" line2="55" col2="69" start="8737" end="8759">"ensembl_transcript_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="55" col1="70" line2="55" col2="70" start="8760" end="8760">,</OP-COMMA>
      <SYMBOL_FORMALS line1="56" col1="31" line2="56" col2="40" start="8879" end="8888">attributes</SYMBOL_FORMALS>
      <EQ_FORMALS line1="56" col1="41" line2="56" col2="41" start="8889" end="8889">=</EQ_FORMALS>
      <expr line1="56" col1="42" line2="60" col2="62" start="8890" end="9542">
        <expr line1="56" col1="42" line2="56" col2="42" start="8890" end="8890">
          <SYMBOL_FUNCTION_CALL line1="56" col1="42" line2="56" col2="42" start="8890" end="8890">c</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="56" col1="43" line2="56" col2="43" start="8891" end="8891">(</OP-LEFT-PAREN>
        <expr line1="56" col1="44" line2="56" col2="66" start="8892" end="8914">
          <STR_CONST line1="56" col1="44" line2="56" col2="66" start="8892" end="8914">"ensembl_transcript_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="56" col1="67" line2="56" col2="67" start="8915" end="8915">,</OP-COMMA>
        <expr line1="57" col1="44" line2="57" col2="60" start="9050" end="9066">
          <STR_CONST line1="57" col1="44" line2="57" col2="60" start="9050" end="9066">"ensembl_gene_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="57" col1="61" line2="57" col2="61" start="9067" end="9067">,</OP-COMMA>
        <expr line1="57" col1="63" line2="57" col2="76" start="9069" end="9082">
          <SYMBOL line1="57" col1="63" line2="57" col2="76" start="9069" end="9082">feature_symbol</SYMBOL>
        </expr>
        <OP-COMMA line1="57" col1="77" line2="57" col2="77" start="9083" end="9083">,</OP-COMMA>
        <expr line1="58" col1="44" line2="58" col2="60" start="9208" end="9224">
          <STR_CONST line1="58" col1="44" line2="58" col2="60" start="9208" end="9224">"chromosome_name"</STR_CONST>
        </expr>
        <OP-COMMA line1="58" col1="61" line2="58" col2="61" start="9225" end="9225">,</OP-COMMA>
        <expr line1="58" col1="63" line2="58" col2="82" start="9227" end="9246">
          <STR_CONST line1="58" col1="63" line2="58" col2="82" start="9227" end="9246">"transcript_biotype"</STR_CONST>
        </expr>
        <OP-COMMA line1="58" col1="83" line2="58" col2="83" start="9247" end="9247">,</OP-COMMA>
        <expr line1="59" col1="44" line2="59" col2="61" start="9366" end="9383">
          <STR_CONST line1="59" col1="44" line2="59" col2="61" start="9366" end="9383">"transcript_start"</STR_CONST>
        </expr>
        <OP-COMMA line1="59" col1="62" line2="59" col2="62" start="9384" end="9384">,</OP-COMMA>
        <expr line1="59" col1="64" line2="59" col2="79" start="9386" end="9401">
          <STR_CONST line1="59" col1="64" line2="59" col2="79" start="9386" end="9401">"transcript_end"</STR_CONST>
        </expr>
        <OP-COMMA line1="59" col1="80" line2="59" col2="80" start="9402" end="9402">,</OP-COMMA>
        <expr line1="60" col1="44" line2="60" col2="61" start="9524" end="9541">
          <STR_CONST line1="60" col1="44" line2="60" col2="61" start="9524" end="9541">"transcript_count"</STR_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="60" col1="62" line2="60" col2="62" start="9542" end="9542">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="60" col1="63" line2="60" col2="63" start="9543" end="9543">,</OP-COMMA>
      <SYMBOL_FORMALS line1="61" col1="31" line2="61" col2="44" start="9669" end="9682">feature_symbol</SYMBOL_FORMALS>
      <EQ_FORMALS line1="61" col1="45" line2="61" col2="45" start="9683" end="9683">=</EQ_FORMALS>
      <expr line1="61" col1="46" line2="61" col2="57" start="9684" end="9695">
        <STR_CONST line1="61" col1="46" line2="61" col2="57" start="9684" end="9695">"mgi_symbol"</STR_CONST>
      </expr>
      <OP-COMMA line1="61" col1="58" line2="61" col2="58" start="9696" end="9696">,</OP-COMMA>
      <SYMBOL_FORMALS line1="62" col1="31" line2="62" col2="40" start="9827" end="9836">feature_id</SYMBOL_FORMALS>
      <EQ_FORMALS line1="62" col1="41" line2="62" col2="41" start="9837" end="9837">=</EQ_FORMALS>
      <expr line1="62" col1="42" line2="62" col2="58" start="9838" end="9854">
        <STR_CONST line1="62" col1="42" line2="62" col2="58" start="9838" end="9854">"ensembl_gene_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="62" col1="59" line2="62" col2="59" start="9855" end="9855">,</OP-COMMA>
      <SYMBOL_FORMALS line1="63" col1="31" line2="63" col2="37" start="9985" end="9991">biomart</SYMBOL_FORMALS>
      <EQ_FORMALS line1="63" col1="38" line2="63" col2="38" start="9992" end="9992">=</EQ_FORMALS>
      <expr line1="63" col1="39" line2="63" col2="60" start="9993" end="10014">
        <STR_CONST line1="63" col1="39" line2="63" col2="60" start="9993" end="10014">"ENSEMBL_MART_ENSEMBL"</STR_CONST>
      </expr>
      <OP-COMMA line1="63" col1="61" line2="63" col2="61" start="10015" end="10015">,</OP-COMMA>
      <SYMBOL_FORMALS line1="64" col1="31" line2="64" col2="37" start="10143" end="10149">dataset</SYMBOL_FORMALS>
      <EQ_FORMALS line1="64" col1="38" line2="64" col2="38" start="10150" end="10150">=</EQ_FORMALS>
      <expr line1="64" col1="39" line2="64" col2="62" start="10151" end="10174">
        <STR_CONST line1="64" col1="39" line2="64" col2="62" start="10151" end="10174">"mmusculus_gene_ensembl"</STR_CONST>
      </expr>
      <OP-COMMA line1="64" col1="63" line2="64" col2="63" start="10175" end="10175">,</OP-COMMA>
      <SYMBOL_FORMALS line1="65" col1="31" line2="65" col2="34" start="10301" end="10304">host</SYMBOL_FORMALS>
      <EQ_FORMALS line1="65" col1="35" line2="65" col2="35" start="10305" end="10305">=</EQ_FORMALS>
      <expr line1="65" col1="36" line2="65" col2="52" start="10306" end="10322">
        <STR_CONST line1="65" col1="36" line2="65" col2="52" start="10306" end="10322">"www.ensembl.org"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="65" col1="53" line2="65" col2="53" start="10323" end="10323">)</OP-RIGHT-PAREN>
      <expr line1="65" col1="55" line2="110" col2="1" start="10325" end="17381">
        <OP-LEFT-BRACE line1="65" col1="55" line2="65" col2="55" start="10325" end="10325">{</OP-LEFT-BRACE>
        <COMMENT line1="66" col1="5" line2="66" col2="33" start="10433" end="10461">## Define Biomart Mart to use</COMMENT>
        <expr line1="67" col1="5" line2="71" col2="46" start="10591" end="11264">
          <IF line1="67" col1="5" line2="67" col2="6" start="10591" end="10592">if</IF>
          <OP-LEFT-PAREN line1="67" col1="8" line2="67" col2="8" start="10594" end="10594">(</OP-LEFT-PAREN>
          <expr line1="67" col1="10" line2="67" col2="22" start="10596" end="10608">
            <expr line1="67" col1="10" line2="67" col2="16" start="10596" end="10602">
              <SYMBOL_FUNCTION_CALL line1="67" col1="10" line2="67" col2="16" start="10596" end="10602">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="67" col1="17" line2="67" col2="17" start="10603" end="10603">(</OP-LEFT-PAREN>
            <expr line1="67" col1="18" line2="67" col2="21" start="10604" end="10607">
              <SYMBOL line1="67" col1="18" line2="67" col2="21" start="10604" end="10607">host</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="67" col1="22" line2="67" col2="22" start="10608" end="10608">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="67" col1="24" line2="67" col2="24" start="10610" end="10610">)</OP-RIGHT-PAREN>
          <expr line1="68" col1="9" line2="68" col2="71" start="10753" end="10815">
            <expr line1="68" col1="9" line2="68" col2="13" start="10753" end="10757">
              <SYMBOL line1="68" col1="9" line2="68" col2="13" start="10753" end="10757">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="68" col1="15" line2="68" col2="16" start="10759" end="10760">&lt;-</LEFT_ASSIGN>
            <expr line1="68" col1="18" line2="68" col2="71" start="10762" end="10815">
              <expr line1="68" col1="18" line2="68" col2="33" start="10762" end="10777">
                <SYMBOL_PACKAGE line1="68" col1="18" line2="68" col2="24" start="10762" end="10768">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="68" col1="25" line2="68" col2="26" start="10769" end="10770">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="68" col1="27" line2="68" col2="33" start="10771" end="10777">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="68" col1="34" line2="68" col2="34" start="10778" end="10778">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="68" col1="35" line2="68" col2="41" start="10779" end="10785">biomart</SYMBOL_SUB>
              <EQ_SUB line1="68" col1="43" line2="68" col2="43" start="10787" end="10787">=</EQ_SUB>
              <expr line1="68" col1="45" line2="68" col2="51" start="10789" end="10795">
                <SYMBOL line1="68" col1="45" line2="68" col2="51" start="10789" end="10795">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="68" col1="52" line2="68" col2="52" start="10796" end="10796">,</OP-COMMA>
              <SYMBOL_SUB line1="68" col1="54" line2="68" col2="60" start="10798" end="10804">dataset</SYMBOL_SUB>
              <EQ_SUB line1="68" col1="62" line2="68" col2="62" start="10806" end="10806">=</EQ_SUB>
              <expr line1="68" col1="64" line2="68" col2="70" start="10808" end="10814">
                <SYMBOL line1="68" col1="64" line2="68" col2="70" start="10808" end="10814">dataset</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="68" col1="71" line2="68" col2="71" start="10815" end="10815">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <ELSE line1="69" col1="5" line2="69" col2="8" start="10907" end="10910">else</ELSE>
          <expr line1="70" col1="9" line2="71" col2="46" start="11069" end="11264">
            <expr line1="70" col1="9" line2="70" col2="13" start="11069" end="11073">
              <SYMBOL line1="70" col1="9" line2="70" col2="13" start="11069" end="11073">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="70" col1="15" line2="70" col2="16" start="11075" end="11076">&lt;-</LEFT_ASSIGN>
            <expr line1="70" col1="18" line2="71" col2="46" start="11078" end="11264">
              <expr line1="70" col1="18" line2="70" col2="33" start="11078" end="11093">
                <SYMBOL_PACKAGE line1="70" col1="18" line2="70" col2="24" start="11078" end="11084">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="70" col1="25" line2="70" col2="26" start="11085" end="11086">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="70" col1="27" line2="70" col2="33" start="11087" end="11093">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="70" col1="34" line2="70" col2="34" start="11094" end="11094">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="70" col1="35" line2="70" col2="41" start="11095" end="11101">biomart</SYMBOL_SUB>
              <EQ_SUB line1="70" col1="43" line2="70" col2="43" start="11103" end="11103">=</EQ_SUB>
              <expr line1="70" col1="45" line2="70" col2="51" start="11105" end="11111">
                <SYMBOL line1="70" col1="45" line2="70" col2="51" start="11105" end="11111">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="70" col1="52" line2="70" col2="52" start="11112" end="11112">,</OP-COMMA>
              <SYMBOL_SUB line1="70" col1="54" line2="70" col2="60" start="11114" end="11120">dataset</SYMBOL_SUB>
              <EQ_SUB line1="70" col1="62" line2="70" col2="62" start="11122" end="11122">=</EQ_SUB>
              <expr line1="70" col1="64" line2="70" col2="70" start="11124" end="11130">
                <SYMBOL line1="70" col1="64" line2="70" col2="70" start="11124" end="11130">dataset</SYMBOL>
              </expr>
              <OP-COMMA line1="70" col1="71" line2="70" col2="71" start="11131" end="11131">,</OP-COMMA>
              <SYMBOL_SUB line1="71" col1="35" line2="71" col2="38" start="11253" end="11256">host</SYMBOL_SUB>
              <EQ_SUB line1="71" col1="40" line2="71" col2="40" start="11258" end="11258">=</EQ_SUB>
              <expr line1="71" col1="42" line2="71" col2="45" start="11260" end="11263">
                <SYMBOL line1="71" col1="42" line2="71" col2="45" start="11260" end="11263">host</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="71" col1="46" line2="71" col2="46" start="11264" end="11264">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="72" col1="5" line2="72" col2="44" start="11381" end="11420">## Define feature IDs from SCESet object</COMMENT>
        <expr line1="73" col1="5" line2="73" col2="39" start="11539" end="11573">
          <expr line1="73" col1="5" line2="73" col2="15" start="11539" end="11549">
            <SYMBOL line1="73" col1="5" line2="73" col2="15" start="11539" end="11549">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="73" col1="17" line2="73" col2="18" start="11551" end="11552">&lt;-</LEFT_ASSIGN>
          <expr line1="73" col1="20" line2="73" col2="39" start="11554" end="11573">
            <expr line1="73" col1="20" line2="73" col2="31" start="11554" end="11565">
              <SYMBOL_FUNCTION_CALL line1="73" col1="20" line2="73" col2="31" start="11554" end="11565">featureNames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="73" col1="32" line2="73" col2="32" start="11566" end="11566">(</OP-LEFT-PAREN>
            <expr line1="73" col1="33" line2="73" col2="38" start="11567" end="11572">
              <SYMBOL line1="73" col1="33" line2="73" col2="38" start="11567" end="11572">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="73" col1="39" line2="73" col2="39" start="11573" end="11573">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="74" col1="5" line2="74" col2="104" start="11697" end="11796">## Remove transcript ID artifacts from runKallisto (eg. ENSMUST00000201087.11 -&gt; ENSMUST00000201087)</COMMENT>
        <expr line1="75" col1="5" line2="75" col2="81" start="11855" end="11931">
          <expr line1="75" col1="5" line2="75" col2="15" start="11855" end="11865">
            <SYMBOL line1="75" col1="5" line2="75" col2="15" start="11855" end="11865">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="75" col1="17" line2="75" col2="18" start="11867" end="11868">&lt;-</LEFT_ASSIGN>
          <expr line1="75" col1="20" line2="75" col2="81" start="11870" end="11931">
            <expr line1="75" col1="20" line2="75" col2="23" start="11870" end="11873">
              <SYMBOL_FUNCTION_CALL line1="75" col1="20" line2="75" col2="23" start="11870" end="11873">gsub</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="75" col1="24" line2="75" col2="24" start="11874" end="11874">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="75" col1="25" line2="75" col2="31" start="11875" end="11881">pattern</SYMBOL_SUB>
            <EQ_SUB line1="75" col1="33" line2="75" col2="33" start="11883" end="11883">=</EQ_SUB>
            <expr line1="75" col1="35" line2="75" col2="45" start="11885" end="11895">
              <STR_CONST line1="75" col1="35" line2="75" col2="45" start="11885" end="11895">"\\.[0-9]+"</STR_CONST>
            </expr>
            <OP-COMMA line1="75" col1="46" line2="75" col2="46" start="11896" end="11896">,</OP-COMMA>
            <SYMBOL_SUB line1="75" col1="48" line2="75" col2="58" start="11898" end="11908">replacement</SYMBOL_SUB>
            <EQ_SUB line1="75" col1="60" line2="75" col2="60" start="11910" end="11910">=</EQ_SUB>
            <expr line1="75" col1="62" line2="75" col2="63" start="11912" end="11913">
              <STR_CONST line1="75" col1="62" line2="75" col2="63" start="11912" end="11913">""</STR_CONST>
            </expr>
            <OP-COMMA line1="75" col1="64" line2="75" col2="64" start="11914" end="11914">,</OP-COMMA>
            <SYMBOL_SUB line1="75" col1="66" line2="75" col2="66" start="11916" end="11916">x</SYMBOL_SUB>
            <EQ_SUB line1="75" col1="68" line2="75" col2="68" start="11918" end="11918">=</EQ_SUB>
            <expr line1="75" col1="70" line2="75" col2="80" start="11920" end="11930">
              <SYMBOL line1="75" col1="70" line2="75" col2="80" start="11920" end="11930">feature_ids</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="75" col1="81" line2="75" col2="81" start="11931" end="11931">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="76" col1="5" line2="76" col2="35" start="12013" end="12043">## Get annotations from biomaRt</COMMENT>
        <expr line1="77" col1="5" line2="79" col2="70" start="12171" end="12552">
          <expr line1="77" col1="5" line2="77" col2="16" start="12171" end="12182">
            <SYMBOL line1="77" col1="5" line2="77" col2="16" start="12171" end="12182">feature_info</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="77" col1="18" line2="77" col2="19" start="12184" end="12185">&lt;-</LEFT_ASSIGN>
          <expr line1="77" col1="21" line2="79" col2="70" start="12187" end="12552">
            <expr line1="77" col1="21" line2="77" col2="34" start="12187" end="12200">
              <SYMBOL_PACKAGE line1="77" col1="21" line2="77" col2="27" start="12187" end="12193">biomaRt</SYMBOL_PACKAGE>
              <NS_GET line1="77" col1="28" line2="77" col2="29" start="12194" end="12195">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="77" col1="30" line2="77" col2="34" start="12196" end="12200">getBM</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="77" col1="35" line2="77" col2="35" start="12201" end="12201">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="77" col1="36" line2="77" col2="45" start="12202" end="12211">attributes</SYMBOL_SUB>
            <EQ_SUB line1="77" col1="47" line2="77" col2="47" start="12213" end="12213">=</EQ_SUB>
            <expr line1="77" col1="49" line2="77" col2="58" start="12215" end="12224">
              <SYMBOL line1="77" col1="49" line2="77" col2="58" start="12215" end="12224">attributes</SYMBOL>
            </expr>
            <OP-COMMA line1="77" col1="59" line2="77" col2="59" start="12225" end="12225">,</OP-COMMA>
            <SYMBOL_SUB line1="78" col1="36" line2="78" col2="42" start="12360" end="12366">filters</SYMBOL_SUB>
            <EQ_SUB line1="78" col1="44" line2="78" col2="44" start="12368" end="12368">=</EQ_SUB>
            <expr line1="78" col1="46" line2="78" col2="52" start="12370" end="12376">
              <SYMBOL line1="78" col1="46" line2="78" col2="52" start="12370" end="12376">filters</SYMBOL>
            </expr>
            <OP-COMMA line1="78" col1="53" line2="78" col2="53" start="12377" end="12377">,</OP-COMMA>
            <SYMBOL_SUB line1="79" col1="36" line2="79" col2="41" start="12518" end="12523">values</SYMBOL_SUB>
            <EQ_SUB line1="79" col1="43" line2="79" col2="43" start="12525" end="12525">=</EQ_SUB>
            <expr line1="79" col1="45" line2="79" col2="55" start="12527" end="12537">
              <SYMBOL line1="79" col1="45" line2="79" col2="55" start="12527" end="12537">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="79" col1="56" line2="79" col2="56" start="12538" end="12538">,</OP-COMMA>
            <SYMBOL_SUB line1="79" col1="58" line2="79" col2="61" start="12540" end="12543">mart</SYMBOL_SUB>
            <EQ_SUB line1="79" col1="63" line2="79" col2="63" start="12545" end="12545">=</EQ_SUB>
            <expr line1="79" col1="65" line2="79" col2="69" start="12547" end="12551">
              <SYMBOL line1="79" col1="65" line2="79" col2="69" start="12547" end="12551">bmart</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="79" col1="70" line2="79" col2="70" start="12552" end="12552">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="80" col1="5" line2="80" col2="77" start="12645" end="12717">## Match the feature ids to the filters ids used to get info from biomaRt</COMMENT>
        <expr line1="81" col1="5" line2="81" col2="53" start="12803" end="12851">
          <expr line1="81" col1="5" line2="81" col2="6" start="12803" end="12804">
            <SYMBOL line1="81" col1="5" line2="81" col2="6" start="12803" end="12804">mm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="81" col1="8" line2="81" col2="9" start="12806" end="12807">&lt;-</LEFT_ASSIGN>
          <expr line1="81" col1="11" line2="81" col2="53" start="12809" end="12851">
            <expr line1="81" col1="11" line2="81" col2="15" start="12809" end="12813">
              <SYMBOL_FUNCTION_CALL line1="81" col1="11" line2="81" col2="15" start="12809" end="12813">match</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="81" col1="16" line2="81" col2="16" start="12814" end="12814">(</OP-LEFT-PAREN>
            <expr line1="81" col1="17" line2="81" col2="27" start="12815" end="12825">
              <SYMBOL line1="81" col1="17" line2="81" col2="27" start="12815" end="12825">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="81" col1="28" line2="81" col2="28" start="12826" end="12826">,</OP-COMMA>
            <expr line1="81" col1="30" line2="81" col2="52" start="12828" end="12850">
              <expr line1="81" col1="30" line2="81" col2="41" start="12828" end="12839">
                <SYMBOL line1="81" col1="30" line2="81" col2="41" start="12828" end="12839">feature_info</SYMBOL>
              </expr>
              <LBB line1="81" col1="42" line2="81" col2="43" start="12840" end="12841">[[</LBB>
              <expr line1="81" col1="44" line2="81" col2="50" start="12842" end="12848">
                <SYMBOL line1="81" col1="44" line2="81" col2="50" start="12842" end="12848">filters</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="81" col1="51" line2="81" col2="51" start="12849" end="12849">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="81" col1="52" line2="81" col2="52" start="12850" end="12850">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="81" col1="53" line2="81" col2="53" start="12851" end="12851">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="82" col1="5" line2="82" col2="43" start="12961" end="12999">
          <expr line1="82" col1="5" line2="82" col2="21" start="12961" end="12977">
            <SYMBOL line1="82" col1="5" line2="82" col2="21" start="12961" end="12977">feature_info_full</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="82" col1="23" line2="82" col2="24" start="12979" end="12980">&lt;-</LEFT_ASSIGN>
          <expr line1="82" col1="26" line2="82" col2="43" start="12982" end="12999">
            <expr line1="82" col1="26" line2="82" col2="37" start="12982" end="12993">
              <SYMBOL line1="82" col1="26" line2="82" col2="37" start="12982" end="12993">feature_info</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="82" col1="38" line2="82" col2="38" start="12994" end="12994">[</OP-LEFT-BRACKET>
            <expr line1="82" col1="39" line2="82" col2="40" start="12995" end="12996">
              <SYMBOL line1="82" col1="39" line2="82" col2="40" start="12995" end="12996">mm</SYMBOL>
            </expr>
            <OP-COMMA line1="82" col1="41" line2="82" col2="41" start="12997" end="12997">,</OP-COMMA>
            <OP-RIGHT-BRACKET line1="82" col1="43" line2="82" col2="43" start="12999" end="12999">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="83" col1="5" line2="83" col2="46" start="13119" end="13160">
          <expr line1="83" col1="5" line2="83" col2="31" start="13119" end="13145">
            <expr line1="83" col1="5" line2="83" col2="12" start="13119" end="13126">
              <SYMBOL_FUNCTION_CALL line1="83" col1="5" line2="83" col2="12" start="13119" end="13126">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="83" col1="13" line2="83" col2="13" start="13127" end="13127">(</OP-LEFT-PAREN>
            <expr line1="83" col1="14" line2="83" col2="30" start="13128" end="13144">
              <SYMBOL line1="83" col1="14" line2="83" col2="30" start="13128" end="13144">feature_info_full</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="83" col1="31" line2="83" col2="31" start="13145" end="13145">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="83" col1="33" line2="83" col2="34" start="13147" end="13148">&lt;-</LEFT_ASSIGN>
          <expr line1="83" col1="36" line2="83" col2="46" start="13150" end="13160">
            <SYMBOL line1="83" col1="36" line2="83" col2="46" start="13150" end="13160">feature_ids</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="84" col1="5" line2="84" col2="37" start="13277" end="13309">## Define gene symbol and gene id</COMMENT>
        <expr line1="85" col1="5" line2="85" col2="75" start="13435" end="13505">
          <expr line1="85" col1="5" line2="85" col2="36" start="13435" end="13466">
            <expr line1="85" col1="5" line2="85" col2="21" start="13435" end="13451">
              <SYMBOL line1="85" col1="5" line2="85" col2="21" start="13435" end="13451">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="85" col1="22" line2="85" col2="22" start="13452" end="13452">$</OP-DOLLAR>
            <SYMBOL line1="85" col1="23" line2="85" col2="36" start="13453" end="13466">feature_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="85" col1="38" line2="85" col2="39" start="13468" end="13469">&lt;-</LEFT_ASSIGN>
          <expr line1="85" col1="41" line2="85" col2="75" start="13471" end="13505">
            <expr line1="85" col1="41" line2="85" col2="57" start="13471" end="13487">
              <SYMBOL line1="85" col1="41" line2="85" col2="57" start="13471" end="13487">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="85" col1="58" line2="85" col2="59" start="13488" end="13489">[[</LBB>
            <expr line1="85" col1="60" line2="85" col2="73" start="13490" end="13503">
              <SYMBOL line1="85" col1="60" line2="85" col2="73" start="13490" end="13503">feature_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="85" col1="74" line2="85" col2="74" start="13504" end="13504">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="85" col1="75" line2="85" col2="75" start="13505" end="13505">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="86" col1="5" line2="86" col2="67" start="13593" end="13655">
          <expr line1="86" col1="5" line2="86" col2="32" start="13593" end="13620">
            <expr line1="86" col1="5" line2="86" col2="21" start="13593" end="13609">
              <SYMBOL line1="86" col1="5" line2="86" col2="21" start="13593" end="13609">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="86" col1="22" line2="86" col2="22" start="13610" end="13610">$</OP-DOLLAR>
            <SYMBOL line1="86" col1="23" line2="86" col2="32" start="13611" end="13620">feature_id</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="86" col1="34" line2="86" col2="35" start="13622" end="13623">&lt;-</LEFT_ASSIGN>
          <expr line1="86" col1="37" line2="86" col2="67" start="13625" end="13655">
            <expr line1="86" col1="37" line2="86" col2="53" start="13625" end="13641">
              <SYMBOL line1="86" col1="37" line2="86" col2="53" start="13625" end="13641">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="86" col1="54" line2="86" col2="55" start="13642" end="13643">[[</LBB>
            <expr line1="86" col1="56" line2="86" col2="65" start="13644" end="13653">
              <SYMBOL line1="86" col1="56" line2="86" col2="65" start="13644" end="13653">feature_id</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="86" col1="66" line2="86" col2="66" start="13654" end="13654">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="86" col1="67" line2="86" col2="67" start="13655" end="13655">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="87" col1="5" line2="87" col2="61" start="13751" end="13807">## Use rownames for gene symbol if gene symbol is missing</COMMENT>
        <expr line1="88" col1="5" line2="89" col2="61" start="13909" end="14123">
          <expr line1="88" col1="5" line2="88" col2="13" start="13909" end="13917">
            <SYMBOL line1="88" col1="5" line2="88" col2="13" start="13909" end="13917">na_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="88" col1="15" line2="88" col2="16" start="13919" end="13920">&lt;-</LEFT_ASSIGN>
          <expr line1="88" col1="18" line2="89" col2="61" start="13922" end="14123">
            <OP-LEFT-PAREN line1="88" col1="18" line2="88" col2="18" start="13922" end="13922">(</OP-LEFT-PAREN>
            <expr line1="88" col1="19" line2="89" col2="60" start="13923" end="14122">
              <expr line1="88" col1="19" line2="88" col2="57" start="13923" end="13961">
                <expr line1="88" col1="19" line2="88" col2="23" start="13923" end="13927">
                  <SYMBOL_FUNCTION_CALL line1="88" col1="19" line2="88" col2="23" start="13923" end="13927">is.na</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="88" col1="24" line2="88" col2="24" start="13928" end="13928">(</OP-LEFT-PAREN>
                <expr line1="88" col1="25" line2="88" col2="56" start="13929" end="13960">
                  <expr line1="88" col1="25" line2="88" col2="41" start="13929" end="13945">
                    <SYMBOL line1="88" col1="25" line2="88" col2="41" start="13929" end="13945">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="88" col1="42" line2="88" col2="42" start="13946" end="13946">$</OP-DOLLAR>
                  <SYMBOL line1="88" col1="43" line2="88" col2="56" start="13947" end="13960">feature_symbol</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="88" col1="57" line2="88" col2="57" start="13961" end="13961">)</OP-RIGHT-PAREN>
              </expr>
              <OR line1="88" col1="59" line2="88" col2="59" start="13963" end="13963">|</OR>
              <expr line1="89" col1="23" line2="89" col2="60" start="14085" end="14122">
                <expr line1="89" col1="23" line2="89" col2="54" start="14085" end="14116">
                  <expr line1="89" col1="23" line2="89" col2="39" start="14085" end="14101">
                    <SYMBOL line1="89" col1="23" line2="89" col2="39" start="14085" end="14101">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="89" col1="40" line2="89" col2="40" start="14102" end="14102">$</OP-DOLLAR>
                  <SYMBOL line1="89" col1="41" line2="89" col2="54" start="14103" end="14116">feature_symbol</SYMBOL>
                </expr>
                <EQ line1="89" col1="56" line2="89" col2="57" start="14118" end="14119">==</EQ>
                <expr line1="89" col1="59" line2="89" col2="60" start="14121" end="14122">
                  <STR_CONST line1="89" col1="59" line2="89" col2="60" start="14121" end="14122">""</STR_CONST>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="89" col1="61" line2="89" col2="61" start="14123" end="14123">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="90" col1="5" line2="91" col2="46" start="14225" end="14424">
          <expr line1="90" col1="5" line2="90" col2="47" start="14225" end="14267">
            <expr line1="90" col1="5" line2="90" col2="36" start="14225" end="14256">
              <expr line1="90" col1="5" line2="90" col2="21" start="14225" end="14241">
                <SYMBOL line1="90" col1="5" line2="90" col2="21" start="14225" end="14241">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="90" col1="22" line2="90" col2="22" start="14242" end="14242">$</OP-DOLLAR>
              <SYMBOL line1="90" col1="23" line2="90" col2="36" start="14243" end="14256">feature_symbol</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="90" col1="37" line2="90" col2="37" start="14257" end="14257">[</OP-LEFT-BRACKET>
            <expr line1="90" col1="38" line2="90" col2="46" start="14258" end="14266">
              <SYMBOL line1="90" col1="38" line2="90" col2="46" start="14258" end="14266">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="90" col1="47" line2="90" col2="47" start="14267" end="14267">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="90" col1="49" line2="90" col2="50" start="14269" end="14270">&lt;-</LEFT_ASSIGN>
          <expr line1="91" col1="9" line2="91" col2="46" start="14387" end="14424">
            <expr line1="91" col1="9" line2="91" col2="35" start="14387" end="14413">
              <expr line1="91" col1="9" line2="91" col2="16" start="14387" end="14394">
                <SYMBOL_FUNCTION_CALL line1="91" col1="9" line2="91" col2="16" start="14387" end="14394">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="91" col1="17" line2="91" col2="17" start="14395" end="14395">(</OP-LEFT-PAREN>
              <expr line1="91" col1="18" line2="91" col2="34" start="14396" end="14412">
                <SYMBOL line1="91" col1="18" line2="91" col2="34" start="14396" end="14412">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="91" col1="35" line2="91" col2="35" start="14413" end="14413">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="91" col1="36" line2="91" col2="36" start="14414" end="14414">[</OP-LEFT-BRACKET>
            <expr line1="91" col1="37" line2="91" col2="45" start="14415" end="14423">
              <SYMBOL line1="91" col1="37" line2="91" col2="45" start="14415" end="14423">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="91" col1="46" line2="91" col2="46" start="14424" end="14424">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="92" col1="5" line2="92" col2="73" start="14541" end="14609">## Use rownames from SCESet object (feature IDs) for feature_id if na</COMMENT>
        <expr line1="93" col1="5" line2="94" col2="72" start="14699" end="14924">
          <expr line1="93" col1="5" line2="93" col2="69" start="14699" end="14763">
            <expr line1="93" col1="5" line2="93" col2="32" start="14699" end="14726">
              <expr line1="93" col1="5" line2="93" col2="21" start="14699" end="14715">
                <SYMBOL line1="93" col1="5" line2="93" col2="21" start="14699" end="14715">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="93" col1="22" line2="93" col2="22" start="14716" end="14716">$</OP-DOLLAR>
              <SYMBOL line1="93" col1="23" line2="93" col2="32" start="14717" end="14726">feature_id</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="93" col1="33" line2="93" col2="33" start="14727" end="14727">[</OP-LEFT-BRACKET>
            <expr line1="93" col1="34" line2="93" col2="68" start="14728" end="14762">
              <expr line1="93" col1="34" line2="93" col2="38" start="14728" end="14732">
                <SYMBOL_FUNCTION_CALL line1="93" col1="34" line2="93" col2="38" start="14728" end="14732">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="93" col1="39" line2="93" col2="39" start="14733" end="14733">(</OP-LEFT-PAREN>
              <expr line1="93" col1="40" line2="93" col2="67" start="14734" end="14761">
                <expr line1="93" col1="40" line2="93" col2="56" start="14734" end="14750">
                  <SYMBOL line1="93" col1="40" line2="93" col2="56" start="14734" end="14750">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="93" col1="57" line2="93" col2="57" start="14751" end="14751">$</OP-DOLLAR>
                <SYMBOL line1="93" col1="58" line2="93" col2="67" start="14752" end="14761">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="93" col1="68" line2="93" col2="68" start="14762" end="14762">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="93" col1="69" line2="93" col2="69" start="14763" end="14763">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="93" col1="71" line2="93" col2="72" start="14765" end="14766">&lt;-</LEFT_ASSIGN>
          <expr line1="94" col1="9" line2="94" col2="72" start="14861" end="14924">
            <expr line1="94" col1="9" line2="94" col2="35" start="14861" end="14887">
              <expr line1="94" col1="9" line2="94" col2="16" start="14861" end="14868">
                <SYMBOL_FUNCTION_CALL line1="94" col1="9" line2="94" col2="16" start="14861" end="14868">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="94" col1="17" line2="94" col2="17" start="14869" end="14869">(</OP-LEFT-PAREN>
              <expr line1="94" col1="18" line2="94" col2="34" start="14870" end="14886">
                <SYMBOL line1="94" col1="18" line2="94" col2="34" start="14870" end="14886">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="94" col1="35" line2="94" col2="35" start="14887" end="14887">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="94" col1="36" line2="94" col2="36" start="14888" end="14888">[</OP-LEFT-BRACKET>
            <expr line1="94" col1="37" line2="94" col2="71" start="14889" end="14923">
              <expr line1="94" col1="37" line2="94" col2="41" start="14889" end="14893">
                <SYMBOL_FUNCTION_CALL line1="94" col1="37" line2="94" col2="41" start="14889" end="14893">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="94" col1="42" line2="94" col2="42" start="14894" end="14894">(</OP-LEFT-PAREN>
              <expr line1="94" col1="43" line2="94" col2="70" start="14895" end="14922">
                <expr line1="94" col1="43" line2="94" col2="59" start="14895" end="14911">
                  <SYMBOL line1="94" col1="43" line2="94" col2="59" start="14895" end="14911">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="94" col1="60" line2="94" col2="60" start="14912" end="14912">$</OP-DOLLAR>
                <SYMBOL line1="94" col1="61" line2="94" col2="70" start="14913" end="14922">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="94" col1="71" line2="94" col2="71" start="14923" end="14923">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="94" col1="72" line2="94" col2="72" start="14924" end="14924">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="95" col1="5" line2="95" col2="66" start="15015" end="15076">## Need to drop any duplicated columns that we want to replace</COMMENT>
        <expr line1="96" col1="5" line2="96" col2="30" start="15173" end="15198">
          <expr line1="96" col1="5" line2="96" col2="13" start="15173" end="15181">
            <SYMBOL line1="96" col1="5" line2="96" col2="13" start="15173" end="15181">old_fdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="96" col1="15" line2="96" col2="16" start="15183" end="15184">&lt;-</LEFT_ASSIGN>
          <expr line1="96" col1="18" line2="96" col2="30" start="15186" end="15198">
            <expr line1="96" col1="18" line2="96" col2="22" start="15186" end="15190">
              <SYMBOL_FUNCTION_CALL line1="96" col1="18" line2="96" col2="22" start="15186" end="15190">fData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="96" col1="23" line2="96" col2="23" start="15191" end="15191">(</OP-LEFT-PAREN>
            <expr line1="96" col1="24" line2="96" col2="29" start="15192" end="15197">
              <SYMBOL line1="96" col1="24" line2="96" col2="29" start="15192" end="15197">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="96" col1="30" line2="96" col2="30" start="15198" end="15198">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="97" col1="5" line2="98" col2="69" start="15331" end="15553">
          <expr line1="97" col1="5" line2="97" col2="13" start="15331" end="15339">
            <SYMBOL line1="97" col1="5" line2="97" col2="13" start="15331" end="15339">keep_cols</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="97" col1="15" line2="97" col2="16" start="15341" end="15342">&lt;-</LEFT_ASSIGN>
          <expr line1="97" col1="18" line2="98" col2="69" start="15344" end="15553">
            <OP-EXCLAMATION line1="97" col1="18" line2="97" col2="18" start="15344" end="15344">!</OP-EXCLAMATION>
            <expr line1="97" col1="19" line2="98" col2="69" start="15345" end="15553">
              <OP-LEFT-PAREN line1="97" col1="19" line2="97" col2="19" start="15345" end="15345">(</OP-LEFT-PAREN>
              <expr line1="97" col1="20" line2="98" col2="68" start="15346" end="15552">
                <expr line1="97" col1="20" line2="97" col2="38" start="15346" end="15364">
                  <expr line1="97" col1="20" line2="97" col2="27" start="15346" end="15353">
                    <SYMBOL_FUNCTION_CALL line1="97" col1="20" line2="97" col2="27" start="15346" end="15353">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="97" col1="28" line2="97" col2="28" start="15354" end="15354">(</OP-LEFT-PAREN>
                  <expr line1="97" col1="29" line2="97" col2="37" start="15355" end="15363">
                    <SYMBOL line1="97" col1="29" line2="97" col2="37" start="15355" end="15363">old_fdata</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="97" col1="38" line2="97" col2="38" start="15364" end="15364">)</OP-RIGHT-PAREN>
                </expr>
                <SPECIAL line1="97" col1="40" line2="97" col2="43" start="15366" end="15369">%in%</SPECIAL>
                <expr line1="98" col1="24" line2="98" col2="68" start="15508" end="15552">
                  <expr line1="98" col1="24" line2="98" col2="24" start="15508" end="15508">
                    <SYMBOL_FUNCTION_CALL line1="98" col1="24" line2="98" col2="24" start="15508" end="15508">c</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="98" col1="25" line2="98" col2="25" start="15509" end="15509">(</OP-LEFT-PAREN>
                  <expr line1="98" col1="26" line2="98" col2="41" start="15510" end="15525">
                    <STR_CONST line1="98" col1="26" line2="98" col2="41" start="15510" end="15525">"feature_symbol"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="98" col1="42" line2="98" col2="42" start="15526" end="15526">,</OP-COMMA>
                  <expr line1="98" col1="44" line2="98" col2="55" start="15528" end="15539">
                    <STR_CONST line1="98" col1="44" line2="98" col2="55" start="15528" end="15539">"feature_id"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="98" col1="56" line2="98" col2="56" start="15540" end="15540">,</OP-COMMA>
                  <expr line1="98" col1="58" line2="98" col2="67" start="15542" end="15551">
                    <SYMBOL line1="98" col1="58" line2="98" col2="67" start="15542" end="15551">attributes</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="98" col1="68" line2="98" col2="68" start="15552" end="15552">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="98" col1="69" line2="98" col2="69" start="15553" end="15553">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="99" col1="5" line2="105" col2="38" start="15647" end="16628">
          <IF line1="99" col1="5" line2="99" col2="6" start="15647" end="15648">if</IF>
          <OP-LEFT-PAREN line1="99" col1="7" line2="99" col2="7" start="15649" end="15649">(</OP-LEFT-PAREN>
          <expr line1="99" col1="9" line2="99" col2="26" start="15651" end="15668">
            <expr line1="99" col1="9" line2="99" col2="22" start="15651" end="15664">
              <expr line1="99" col1="9" line2="99" col2="11" start="15651" end="15653">
                <SYMBOL_FUNCTION_CALL line1="99" col1="9" line2="99" col2="11" start="15651" end="15653">sum</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="99" col1="12" line2="99" col2="12" start="15654" end="15654">(</OP-LEFT-PAREN>
              <expr line1="99" col1="13" line2="99" col2="21" start="15655" end="15663">
                <SYMBOL line1="99" col1="13" line2="99" col2="21" start="15655" end="15663">keep_cols</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="99" col1="22" line2="99" col2="22" start="15664" end="15664">)</OP-RIGHT-PAREN>
            </expr>
            <GT line1="99" col1="24" line2="99" col2="24" start="15666" end="15666">&gt;</GT>
            <expr line1="99" col1="26" line2="99" col2="26" start="15668" end="15668">
              <NUM_CONST line1="99" col1="26" line2="99" col2="26" start="15668" end="15668">0</NUM_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="99" col1="27" line2="99" col2="27" start="15669" end="15669">)</OP-RIGHT-PAREN>
          <expr line1="99" col1="29" line2="104" col2="5" start="15671" end="16437">
            <OP-LEFT-BRACE line1="99" col1="29" line2="99" col2="29" start="15671" end="15671">{</OP-LEFT-BRACE>
            <expr line1="100" col1="9" line2="100" col2="49" start="15809" end="15849">
              <expr line1="100" col1="9" line2="100" col2="26" start="15809" end="15826">
                <SYMBOL line1="100" col1="9" line2="100" col2="26" start="15809" end="15826">colnames_old_fdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="100" col1="28" line2="100" col2="29" start="15828" end="15829">&lt;-</LEFT_ASSIGN>
              <expr line1="100" col1="31" line2="100" col2="49" start="15831" end="15849">
                <expr line1="100" col1="31" line2="100" col2="38" start="15831" end="15838">
                  <SYMBOL_FUNCTION_CALL line1="100" col1="31" line2="100" col2="38" start="15831" end="15838">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="100" col1="39" line2="100" col2="39" start="15839" end="15839">(</OP-LEFT-PAREN>
                <expr line1="100" col1="40" line2="100" col2="48" start="15840" end="15848">
                  <SYMBOL line1="100" col1="40" line2="100" col2="48" start="15840" end="15848">old_fdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="100" col1="49" line2="100" col2="49" start="15849" end="15849">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="101" col1="9" line2="101" col2="58" start="15967" end="16016">
              <expr line1="101" col1="9" line2="101" col2="17" start="15967" end="15975">
                <SYMBOL line1="101" col1="9" line2="101" col2="17" start="15967" end="15975">old_fdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="101" col1="19" line2="101" col2="20" start="15977" end="15978">&lt;-</LEFT_ASSIGN>
              <expr line1="101" col1="22" line2="101" col2="58" start="15980" end="16016">
                <expr line1="101" col1="22" line2="101" col2="34" start="15980" end="15992">
                  <SYMBOL_FUNCTION_CALL line1="101" col1="22" line2="101" col2="34" start="15980" end="15992">as.data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="101" col1="35" line2="101" col2="35" start="15993" end="15993">(</OP-LEFT-PAREN>
                <expr line1="101" col1="36" line2="101" col2="57" start="15994" end="16015">
                  <expr line1="101" col1="36" line2="101" col2="44" start="15994" end="16002">
                    <SYMBOL line1="101" col1="36" line2="101" col2="44" start="15994" end="16002">old_fdata</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="101" col1="45" line2="101" col2="45" start="16003" end="16003">[</OP-LEFT-BRACKET>
                  <OP-COMMA line1="101" col1="46" line2="101" col2="46" start="16004" end="16004">,</OP-COMMA>
                  <expr line1="101" col1="48" line2="101" col2="56" start="16006" end="16014">
                    <SYMBOL line1="101" col1="48" line2="101" col2="56" start="16006" end="16014">keep_cols</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="101" col1="57" line2="101" col2="57" start="16015" end="16015">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="101" col1="58" line2="101" col2="58" start="16016" end="16016">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="102" col1="9" line2="102" col2="60" start="16125" end="16176">
              <expr line1="102" col1="9" line2="102" col2="27" start="16125" end="16143">
                <expr line1="102" col1="9" line2="102" col2="16" start="16125" end="16132">
                  <SYMBOL_FUNCTION_CALL line1="102" col1="9" line2="102" col2="16" start="16125" end="16132">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="102" col1="17" line2="102" col2="17" start="16133" end="16133">(</OP-LEFT-PAREN>
                <expr line1="102" col1="18" line2="102" col2="26" start="16134" end="16142">
                  <SYMBOL line1="102" col1="18" line2="102" col2="26" start="16134" end="16142">old_fdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="102" col1="27" line2="102" col2="27" start="16143" end="16143">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="102" col1="29" line2="102" col2="30" start="16145" end="16146">&lt;-</LEFT_ASSIGN>
              <expr line1="102" col1="32" line2="102" col2="60" start="16148" end="16176">
                <expr line1="102" col1="32" line2="102" col2="49" start="16148" end="16165">
                  <SYMBOL line1="102" col1="32" line2="102" col2="49" start="16148" end="16165">colnames_old_fdata</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="102" col1="50" line2="102" col2="50" start="16166" end="16166">[</OP-LEFT-BRACKET>
                <expr line1="102" col1="51" line2="102" col2="59" start="16167" end="16175">
                  <SYMBOL line1="102" col1="51" line2="102" col2="59" start="16167" end="16175">keep_cols</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="102" col1="60" line2="102" col2="60" start="16176" end="16176">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="103" col1="9" line2="103" col2="56" start="16283" end="16330">
              <expr line1="103" col1="9" line2="103" col2="17" start="16283" end="16291">
                <SYMBOL line1="103" col1="9" line2="103" col2="17" start="16283" end="16291">new_fdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="103" col1="19" line2="103" col2="20" start="16293" end="16294">&lt;-</LEFT_ASSIGN>
              <expr line1="103" col1="22" line2="103" col2="56" start="16296" end="16330">
                <expr line1="103" col1="22" line2="103" col2="26" start="16296" end="16300">
                  <SYMBOL_FUNCTION_CALL line1="103" col1="22" line2="103" col2="26" start="16296" end="16300">cbind</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="103" col1="27" line2="103" col2="27" start="16301" end="16301">(</OP-LEFT-PAREN>
                <expr line1="103" col1="28" line2="103" col2="36" start="16302" end="16310">
                  <SYMBOL line1="103" col1="28" line2="103" col2="36" start="16302" end="16310">old_fdata</SYMBOL>
                </expr>
                <OP-COMMA line1="103" col1="37" line2="103" col2="37" start="16311" end="16311">,</OP-COMMA>
                <expr line1="103" col1="39" line2="103" col2="55" start="16313" end="16329">
                  <SYMBOL line1="103" col1="39" line2="103" col2="55" start="16313" end="16329">feature_info_full</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="103" col1="56" line2="103" col2="56" start="16330" end="16330">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="104" col1="5" line2="104" col2="5" start="16437" end="16437">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="104" col1="7" line2="104" col2="10" start="16439" end="16442">else</ELSE>
          <expr line1="105" col1="9" line2="105" col2="38" start="16599" end="16628">
            <expr line1="105" col1="9" line2="105" col2="17" start="16599" end="16607">
              <SYMBOL line1="105" col1="9" line2="105" col2="17" start="16599" end="16607">new_fdata</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="105" col1="19" line2="105" col2="20" start="16609" end="16610">&lt;-</LEFT_ASSIGN>
            <expr line1="105" col1="22" line2="105" col2="38" start="16612" end="16628">
              <SYMBOL line1="105" col1="22" line2="105" col2="38" start="16612" end="16628">feature_info_full</SYMBOL>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="106" col1="5" line2="106" col2="51" start="16753" end="16799">## Add new feature annotations to SCESet object</COMMENT>
        <expr line1="107" col1="5" line2="107" col2="30" start="16911" end="16936">
          <expr line1="107" col1="5" line2="107" col2="17" start="16911" end="16923">
            <expr line1="107" col1="5" line2="107" col2="9" start="16911" end="16915">
              <SYMBOL_FUNCTION_CALL line1="107" col1="5" line2="107" col2="9" start="16911" end="16915">fData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="107" col1="10" line2="107" col2="10" start="16916" end="16916">(</OP-LEFT-PAREN>
            <expr line1="107" col1="11" line2="107" col2="16" start="16917" end="16922">
              <SYMBOL line1="107" col1="11" line2="107" col2="16" start="16917" end="16922">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="107" col1="17" line2="107" col2="17" start="16923" end="16923">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="107" col1="19" line2="107" col2="20" start="16925" end="16926">&lt;-</LEFT_ASSIGN>
          <expr line1="107" col1="22" line2="107" col2="30" start="16928" end="16936">
            <SYMBOL line1="107" col1="22" line2="107" col2="30" start="16928" end="16936">new_fdata</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="108" col1="5" line2="108" col2="27" start="17069" end="17091">## Return SCESet object</COMMENT>
        <expr line1="109" col1="5" line2="109" col2="10" start="17227" end="17232">
          <SYMBOL line1="109" col1="5" line2="109" col2="10" start="17227" end="17232">object</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="110" col1="1" line2="110" col2="1" start="17381" end="17381">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="112" col1="1" line2="112" col2="80" start="17697" end="17776">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="114" col1="1" line2="114" col2="51" start="18013" end="18063">## Function to summarise expression across features</COMMENT>
  <COMMENT line1="116" col1="1" line2="116" col2="45" start="18329" end="18373">#' Summarise expression values across feature</COMMENT>
  <COMMENT line1="117" col1="1" line2="117" col2="3" start="18487" end="18489">#' </COMMENT>
  <COMMENT line1="118" col1="1" line2="118" col2="76" start="18645" end="18720">#' Create a new \code{SCESet} with counts summarised at a different feature </COMMENT>
  <COMMENT line1="119" col1="1" line2="119" col2="77" start="18803" end="18879">#' level. A typical use would be to summarise transcript-level counts at gene</COMMENT>
  <COMMENT line1="120" col1="1" line2="120" col2="9" start="18961" end="18969">#' level.</COMMENT>
  <COMMENT line1="121" col1="1" line2="121" col2="3" start="19119" end="19121">#' </COMMENT>
  <COMMENT line1="122" col1="1" line2="122" col2="41" start="19277" end="19317">#' @param object an \code{SCESet} object.</COMMENT>
  <COMMENT line1="123" col1="1" line2="123" col2="69" start="19435" end="19503">#' @param exprs_values character string indicating which slot of the </COMMENT>
  <COMMENT line1="124" col1="1" line2="124" col2="80" start="19593" end="19672">#' assayData from the \code{SCESet} object should be used as expression values. </COMMENT>
  <COMMENT line1="125" col1="1" line2="125" col2="74" start="19751" end="19824">#' Valid options are \code{'exprs'} the expression slot, \code{'tpm'} the </COMMENT>
  <COMMENT line1="126" col1="1" line2="126" col2="63" start="19909" end="19971">#' transcripts-per-million slot or \code{'fpkm'} the FPKM slot.</COMMENT>
  <COMMENT line1="127" col1="1" line2="127" col2="81" start="20067" end="20147">#' @param summarise_by character string giving the column of \code{fData(object)}</COMMENT>
  <COMMENT line1="128" col1="1" line2="128" col2="80" start="20225" end="20304">#' that will be used as the features for which summarised expression levels are </COMMENT>
  <COMMENT line1="129" col1="1" line2="129" col2="50" start="20383" end="20432">#' to be produced. Default is \code{'feature_id'}.</COMMENT>
  <COMMENT line1="130" col1="1" line2="130" col2="73" start="20541" end="20613">#' @param scaled_tpm_counts logical, should feature-summarised counts be </COMMENT>
  <COMMENT line1="131" col1="1" line2="131" col2="78" start="20699" end="20776">#' computed from summed TPM values scaled by total library size? This approach</COMMENT>
  <COMMENT line1="132" col1="1" line2="132" col2="78" start="20857" end="20934">#' is recommended (see \url{https://f1000research.com/articles/4-1521/v2}), so</COMMENT>
  <COMMENT line1="133" col1="1" line2="133" col2="78" start="21015" end="21092">#' the default is \code{TRUE} and it is applied if TPM values are available in</COMMENT>
  <COMMENT line1="134" col1="1" line2="134" col2="14" start="21173" end="21186">#' the object.</COMMENT>
  <COMMENT line1="135" col1="1" line2="135" col2="75" start="21331" end="21405">#' @param lib_size optional vector of numeric values of same length as the </COMMENT>
  <COMMENT line1="136" col1="1" line2="136" col2="77" start="21489" end="21565">#' number of columns in the \code{SCESet} object providing the total library </COMMENT>
  <COMMENT line1="137" col1="1" line2="137" col2="60" start="21647" end="21706">#' size (e.g. "count of mapped reads") for each cell/sample.</COMMENT>
  <COMMENT line1="138" col1="1" line2="138" col2="3" start="21805" end="21807">#' </COMMENT>
  <COMMENT line1="139" col1="1" line2="139" col2="77" start="21963" end="22039">#' @details Only transcripts-per-million (TPM) and fragments per kilobase of </COMMENT>
  <COMMENT line1="140" col1="1" line2="140" col2="79" start="22121" end="22199">#' exon per million reads mapped (FPKM) expression values should be aggregated </COMMENT>
  <COMMENT line1="141" col1="1" line2="141" col2="78" start="22279" end="22356">#' across features. Since counts are not scaled by the length of the feature, </COMMENT>
  <COMMENT line1="142" col1="1" line2="142" col2="73" start="22437" end="22509">#' expression in counts units are not comparable within a sample without </COMMENT>
  <COMMENT line1="143" col1="1" line2="143" col2="74" start="22595" end="22668">#' adjusting for feature length. Thus, we cannot sum counts over a set of </COMMENT>
  <COMMENT line1="144" col1="1" line2="144" col2="80" start="22753" end="22832">#' features to get the expression of that set (for example, we cannot sum counts</COMMENT>
  <COMMENT line1="145" col1="1" line2="145" col2="78" start="22911" end="22988">#' over transcripts to get accurate expression estimates for a gene). See the </COMMENT>
  <COMMENT line1="146" col1="1" line2="146" col2="82" start="23069" end="23150">#' following link for a discussion of RNA-seq expression units by Harold Pimentel:</COMMENT>
  <COMMENT line1="147" col1="1" line2="147" col2="157" start="23227" end="23383">#' \url{https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/}. For more details about the effects of summarising </COMMENT>
  <COMMENT line1="148" col1="1" line2="148" col2="74" start="23385" end="23458">#' transcript expression values at the gene level see Sonesen et al, 2016 </COMMENT>
  <COMMENT line1="149" col1="1" line2="149" col2="56" start="23543" end="23598">#' (\url{https://f1000research.com/articles/4-1521/v2}).</COMMENT>
  <COMMENT line1="150" col1="1" line2="150" col2="3" start="23701" end="23703">#' </COMMENT>
  <COMMENT line1="151" col1="1" line2="151" col2="27" start="23859" end="23885">#' @return an SCESet object</COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="3" start="24017" end="24019">#' </COMMENT>
  <COMMENT line1="153" col1="1" line2="153" col2="10" start="24175" end="24184">#' @export</COMMENT>
  <COMMENT line1="154" col1="1" line2="154" col2="3" start="24333" end="24335">#' </COMMENT>
  <COMMENT line1="155" col1="1" line2="155" col2="12" start="24491" end="24502">#' @examples</COMMENT>
  <COMMENT line1="156" col1="1" line2="156" col2="28" start="24649" end="24676">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="157" col1="1" line2="157" col2="31" start="24807" end="24837">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="158" col1="1" line2="158" col2="63" start="24965" end="25027">#' pd &lt;- new("AnnotatedDataFrame", data = sc_example_cell_info)</COMMENT>
  <COMMENT line1="159" col1="1" line2="159" col2="77" start="25123" end="25199">#' example_sceset &lt;- newSCESet(countData = sc_example_counts, phenoData = pd)</COMMENT>
  <COMMENT line1="160" col1="1" line2="160" col2="42" start="25281" end="25322">#' fd &lt;- new("AnnotatedDataFrame", data = </COMMENT>
  <COMMENT line1="161" col1="1" line2="161" col2="54" start="25439" end="25492">#' data.frame(gene_id = featureNames(example_sceset), </COMMENT>
  <COMMENT line1="162" col1="1" line2="162" col2="67" start="25597" end="25663">#' feature_id = paste("feature", rep(1:500, each = 4), sep = "_")))</COMMENT>
  <COMMENT line1="163" col1="1" line2="163" col2="47" start="25755" end="25801">#' rownames(fd) &lt;- featureNames(example_sceset)</COMMENT>
  <COMMENT line1="164" col1="1" line2="164" col2="30" start="25913" end="25942">#' fData(example_sceset) &lt;- fd</COMMENT>
  <COMMENT line1="165" col1="1" line2="165" col2="55" start="26071" end="26125">#' effective_length &lt;- rep(c(1000, 2000), times = 1000)</COMMENT>
  <COMMENT line1="166" col1="1" line2="166" col2="94" start="26229" end="26322">#' tpm(example_sceset) &lt;- calculateTPM(example_sceset, effective_length, calc_from = "counts")</COMMENT>
  <COMMENT line1="167" col1="1" line2="167" col2="3" start="26387" end="26389">#' </COMMENT>
  <COMMENT line1="168" col1="1" line2="168" col2="32" start="26545" end="26576">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="169" col1="1" line2="169" col2="69" start="26703" end="26771">#' summariseExprsAcrossFeatures(example_sceset, exprs_values = "tpm")</COMMENT>
  <COMMENT line1="170" col1="1" line2="170" col2="32" start="26861" end="26892">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="171" col1="1" line2="171" col2="72" start="27019" end="27090">#' summariseExprsAcrossFeatures(example_sceset, exprs_values = "counts")</COMMENT>
  <COMMENT line1="172" col1="1" line2="172" col2="32" start="27177" end="27208">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="173" col1="1" line2="173" col2="71" start="27335" end="27405">#' summariseExprsAcrossFeatures(example_sceset, exprs_values = "exprs")</COMMENT>
  <COMMENT line1="174" col1="1" line2="174" col2="3" start="27493" end="27495">#' </COMMENT>
  <expr line1="175" col1="1" line2="280" col2="1" start="27651" end="44241">
    <expr line1="175" col1="1" line2="175" col2="28" start="27651" end="27678">
      <SYMBOL line1="175" col1="1" line2="175" col2="28" start="27651" end="27678">summariseExprsAcrossFeatures</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="175" col1="30" line2="175" col2="31" start="27680" end="27681">&lt;-</LEFT_ASSIGN>
    <expr line1="175" col1="33" line2="280" col2="1" start="27683" end="44241">
      <FUNCTION line1="175" col1="33" line2="175" col2="40" start="27683" end="27690">function</FUNCTION>
      <OP-LEFT-PAREN line1="175" col1="41" line2="175" col2="41" start="27691" end="27691">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="175" col1="42" line2="175" col2="47" start="27692" end="27697">object</SYMBOL_FORMALS>
      <OP-COMMA line1="175" col1="48" line2="175" col2="48" start="27698" end="27698">,</OP-COMMA>
      <SYMBOL_FORMALS line1="175" col1="50" line2="175" col2="61" start="27700" end="27711">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="175" col1="63" line2="175" col2="63" start="27713" end="27713">=</EQ_FORMALS>
      <expr line1="175" col1="65" line2="175" col2="69" start="27715" end="27719">
        <STR_CONST line1="175" col1="65" line2="175" col2="69" start="27715" end="27719">"tpm"</STR_CONST>
      </expr>
      <OP-COMMA line1="175" col1="70" line2="175" col2="70" start="27720" end="27720">,</OP-COMMA>
      <SYMBOL_FORMALS line1="176" col1="42" line2="176" col2="53" start="27850" end="27861">summarise_by</SYMBOL_FORMALS>
      <EQ_FORMALS line1="176" col1="55" line2="176" col2="55" start="27863" end="27863">=</EQ_FORMALS>
      <expr line1="176" col1="57" line2="176" col2="68" start="27865" end="27876">
        <STR_CONST line1="176" col1="57" line2="176" col2="68" start="27865" end="27876">"feature_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="176" col1="69" line2="176" col2="69" start="27877" end="27877">,</OP-COMMA>
      <SYMBOL_FORMALS line1="177" col1="42" line2="177" col2="58" start="28008" end="28024">scaled_tpm_counts</SYMBOL_FORMALS>
      <EQ_FORMALS line1="177" col1="60" line2="177" col2="60" start="28026" end="28026">=</EQ_FORMALS>
      <expr line1="177" col1="62" line2="177" col2="65" start="28028" end="28031">
        <NUM_CONST line1="177" col1="62" line2="177" col2="65" start="28028" end="28031">TRUE</NUM_CONST>
      </expr>
      <OP-COMMA line1="177" col1="66" line2="177" col2="66" start="28032" end="28032">,</OP-COMMA>
      <SYMBOL_FORMALS line1="178" col1="42" line2="178" col2="49" start="28166" end="28173">lib_size</SYMBOL_FORMALS>
      <EQ_FORMALS line1="178" col1="51" line2="178" col2="51" start="28175" end="28175">=</EQ_FORMALS>
      <expr line1="178" col1="53" line2="178" col2="56" start="28177" end="28180">
        <NULL_CONST line1="178" col1="53" line2="178" col2="56" start="28177" end="28180">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="178" col1="57" line2="178" col2="57" start="28181" end="28181">)</OP-RIGHT-PAREN>
      <expr line1="178" col1="59" line2="280" col2="1" start="28183" end="44241">
        <OP-LEFT-BRACE line1="178" col1="59" line2="178" col2="59" start="28183" end="28183">{</OP-LEFT-BRACE>
        <expr line1="179" col1="5" line2="180" col2="40" start="28287" end="28480">
          <IF line1="179" col1="5" line2="179" col2="6" start="28287" end="28288">if</IF>
          <OP-LEFT-PAREN line1="179" col1="8" line2="179" col2="8" start="28290" end="28290">(</OP-LEFT-PAREN>
          <expr line1="179" col1="10" line2="179" col2="30" start="28292" end="28312">
            <OP-EXCLAMATION line1="179" col1="10" line2="179" col2="10" start="28292" end="28292">!</OP-EXCLAMATION>
            <expr line1="179" col1="11" line2="179" col2="30" start="28293" end="28312">
              <expr line1="179" col1="11" line2="179" col2="12" start="28293" end="28294">
                <SYMBOL_FUNCTION_CALL line1="179" col1="11" line2="179" col2="12" start="28293" end="28294">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="179" col1="13" line2="179" col2="13" start="28295" end="28295">(</OP-LEFT-PAREN>
              <expr line1="179" col1="14" line2="179" col2="19" start="28296" end="28301">
                <SYMBOL line1="179" col1="14" line2="179" col2="19" start="28296" end="28301">object</SYMBOL>
              </expr>
              <OP-COMMA line1="179" col1="20" line2="179" col2="20" start="28302" end="28302">,</OP-COMMA>
              <expr line1="179" col1="22" line2="179" col2="29" start="28304" end="28311">
                <STR_CONST line1="179" col1="22" line2="179" col2="29" start="28304" end="28311">"SCESet"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="179" col1="30" line2="179" col2="30" start="28312" end="28312">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="179" col1="32" line2="179" col2="32" start="28314" end="28314">)</OP-RIGHT-PAREN>
          <expr line1="180" col1="9" line2="180" col2="40" start="28449" end="28480">
            <expr line1="180" col1="9" line2="180" col2="12" start="28449" end="28452">
              <SYMBOL_FUNCTION_CALL line1="180" col1="9" line2="180" col2="12" start="28449" end="28452">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="180" col1="13" line2="180" col2="13" start="28453" end="28453">(</OP-LEFT-PAREN>
            <expr line1="180" col1="14" line2="180" col2="39" start="28454" end="28479">
              <STR_CONST line1="180" col1="14" line2="180" col2="39" start="28454" end="28479">"Object must be an SCESet"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="180" col1="40" line2="180" col2="40" start="28480" end="28480">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="181" col1="5" line2="182" col2="75" start="28603" end="28831">
          <IF line1="181" col1="5" line2="181" col2="6" start="28603" end="28604">if</IF>
          <OP-LEFT-PAREN line1="181" col1="8" line2="181" col2="8" start="28606" end="28606">(</OP-LEFT-PAREN>
          <expr line1="181" col1="10" line2="181" col2="53" start="28608" end="28651">
            <OP-EXCLAMATION line1="181" col1="10" line2="181" col2="10" start="28608" end="28608">!</OP-EXCLAMATION>
            <expr line1="181" col1="11" line2="181" col2="53" start="28609" end="28651">
              <OP-LEFT-PAREN line1="181" col1="11" line2="181" col2="11" start="28609" end="28609">(</OP-LEFT-PAREN>
              <expr line1="181" col1="12" line2="181" col2="52" start="28610" end="28650">
                <expr line1="181" col1="12" line2="181" col2="23" start="28610" end="28621">
                  <SYMBOL line1="181" col1="12" line2="181" col2="23" start="28610" end="28621">summarise_by</SYMBOL>
                </expr>
                <SPECIAL line1="181" col1="25" line2="181" col2="28" start="28623" end="28626">%in%</SPECIAL>
                <expr line1="181" col1="30" line2="181" col2="52" start="28628" end="28650">
                  <expr line1="181" col1="30" line2="181" col2="37" start="28628" end="28635">
                    <SYMBOL_FUNCTION_CALL line1="181" col1="30" line2="181" col2="37" start="28628" end="28635">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="181" col1="38" line2="181" col2="38" start="28636" end="28636">(</OP-LEFT-PAREN>
                  <expr line1="181" col1="39" line2="181" col2="51" start="28637" end="28649">
                    <expr line1="181" col1="39" line2="181" col2="43" start="28637" end="28641">
                      <SYMBOL_FUNCTION_CALL line1="181" col1="39" line2="181" col2="43" start="28637" end="28641">fData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="181" col1="44" line2="181" col2="44" start="28642" end="28642">(</OP-LEFT-PAREN>
                    <expr line1="181" col1="45" line2="181" col2="50" start="28643" end="28648">
                      <SYMBOL line1="181" col1="45" line2="181" col2="50" start="28643" end="28648">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="181" col1="51" line2="181" col2="51" start="28649" end="28649">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="181" col1="52" line2="181" col2="52" start="28650" end="28650">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="181" col1="53" line2="181" col2="53" start="28651" end="28651">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="181" col1="55" line2="181" col2="55" start="28653" end="28653">)</OP-RIGHT-PAREN>
          <expr line1="182" col1="9" line2="182" col2="75" start="28765" end="28831">
            <expr line1="182" col1="9" line2="182" col2="12" start="28765" end="28768">
              <SYMBOL_FUNCTION_CALL line1="182" col1="9" line2="182" col2="12" start="28765" end="28768">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="182" col1="13" line2="182" col2="13" start="28769" end="28769">(</OP-LEFT-PAREN>
            <expr line1="182" col1="14" line2="182" col2="74" start="28770" end="28830">
              <STR_CONST line1="182" col1="14" line2="182" col2="74" start="28770" end="28830">"The summarise_by argument is not a column of fData(object)."</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="182" col1="75" line2="182" col2="75" start="28831" end="28831">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="183" col1="5" line2="183" col2="72" start="28919" end="28986">## Define an expression matrix depending on which values we're using</COMMENT>
        <expr line1="184" col1="5" line2="184" col2="80" start="29077" end="29152">
          <expr line1="184" col1="5" line2="184" col2="16" start="29077" end="29088">
            <SYMBOL line1="184" col1="5" line2="184" col2="16" start="29077" end="29088">exprs_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="184" col1="18" line2="184" col2="19" start="29090" end="29091">&lt;-</LEFT_ASSIGN>
          <expr line1="184" col1="21" line2="184" col2="80" start="29093" end="29152">
            <expr line1="184" col1="21" line2="184" col2="29" start="29093" end="29101">
              <SYMBOL_FUNCTION_CALL line1="184" col1="21" line2="184" col2="29" start="29093" end="29101">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="184" col1="30" line2="184" col2="30" start="29102" end="29102">(</OP-LEFT-PAREN>
            <expr line1="184" col1="31" line2="184" col2="42" start="29103" end="29114">
              <SYMBOL line1="184" col1="31" line2="184" col2="42" start="29103" end="29114">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="184" col1="43" line2="184" col2="43" start="29115" end="29115">,</OP-COMMA>
            <expr line1="184" col1="45" line2="184" col2="79" start="29117" end="29151">
              <expr line1="184" col1="45" line2="184" col2="45" start="29117" end="29117">
                <SYMBOL_FUNCTION_CALL line1="184" col1="45" line2="184" col2="45" start="29117" end="29117">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="184" col1="46" line2="184" col2="46" start="29118" end="29118">(</OP-LEFT-PAREN>
              <expr line1="184" col1="47" line2="184" col2="53" start="29119" end="29125">
                <STR_CONST line1="184" col1="47" line2="184" col2="53" start="29119" end="29125">"exprs"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="54" line2="184" col2="54" start="29126" end="29126">,</OP-COMMA>
              <expr line1="184" col1="56" line2="184" col2="60" start="29128" end="29132">
                <STR_CONST line1="184" col1="56" line2="184" col2="60" start="29128" end="29132">"tpm"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="61" line2="184" col2="61" start="29133" end="29133">,</OP-COMMA>
              <expr line1="184" col1="63" line2="184" col2="68" start="29135" end="29140">
                <STR_CONST line1="184" col1="63" line2="184" col2="68" start="29135" end="29140">"fpkm"</STR_CONST>
              </expr>
              <OP-COMMA line1="184" col1="69" line2="184" col2="69" start="29141" end="29141">,</OP-COMMA>
              <expr line1="184" col1="71" line2="184" col2="78" start="29143" end="29150">
                <STR_CONST line1="184" col1="71" line2="184" col2="78" start="29143" end="29150">"counts"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="184" col1="79" line2="184" col2="79" start="29151" end="29151">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="184" col1="80" line2="184" col2="80" start="29152" end="29152">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="185" col1="5" line2="189" col2="48" start="29235" end="29910">
          <expr line1="185" col1="5" line2="185" col2="13" start="29235" end="29243">
            <SYMBOL line1="185" col1="5" line2="185" col2="13" start="29235" end="29243">exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="185" col1="15" line2="185" col2="16" start="29245" end="29246">&lt;-</LEFT_ASSIGN>
          <expr line1="185" col1="18" line2="189" col2="48" start="29248" end="29910">
            <expr line1="185" col1="18" line2="185" col2="23" start="29248" end="29253">
              <SYMBOL_FUNCTION_CALL line1="185" col1="18" line2="185" col2="23" start="29248" end="29253">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="185" col1="24" line2="185" col2="24" start="29254" end="29254">(</OP-LEFT-PAREN>
            <expr line1="185" col1="25" line2="185" col2="36" start="29255" end="29266">
              <SYMBOL line1="185" col1="25" line2="185" col2="36" start="29255" end="29266">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="185" col1="37" line2="185" col2="37" start="29267" end="29267">,</OP-COMMA>
            <SYMBOL_SUB line1="186" col1="25" line2="186" col2="29" start="29413" end="29417">exprs</SYMBOL_SUB>
            <EQ_SUB line1="186" col1="31" line2="186" col2="31" start="29419" end="29419">=</EQ_SUB>
            <expr line1="186" col1="33" line2="186" col2="45" start="29421" end="29433">
              <expr line1="186" col1="33" line2="186" col2="37" start="29421" end="29425">
                <SYMBOL_FUNCTION_CALL line1="186" col1="33" line2="186" col2="37" start="29421" end="29425">exprs</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="186" col1="38" line2="186" col2="38" start="29426" end="29426">(</OP-LEFT-PAREN>
              <expr line1="186" col1="39" line2="186" col2="44" start="29427" end="29432">
                <SYMBOL line1="186" col1="39" line2="186" col2="44" start="29427" end="29432">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="186" col1="45" line2="186" col2="45" start="29433" end="29433">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="186" col1="46" line2="186" col2="46" start="29434" end="29434">,</OP-COMMA>
            <SYMBOL_SUB line1="187" col1="25" line2="187" col2="27" start="29571" end="29573">tpm</SYMBOL_SUB>
            <EQ_SUB line1="187" col1="29" line2="187" col2="29" start="29575" end="29575">=</EQ_SUB>
            <expr line1="187" col1="31" line2="187" col2="41" start="29577" end="29587">
              <expr line1="187" col1="31" line2="187" col2="33" start="29577" end="29579">
                <SYMBOL_FUNCTION_CALL line1="187" col1="31" line2="187" col2="33" start="29577" end="29579">tpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="187" col1="34" line2="187" col2="34" start="29580" end="29580">(</OP-LEFT-PAREN>
              <expr line1="187" col1="35" line2="187" col2="40" start="29581" end="29586">
                <SYMBOL line1="187" col1="35" line2="187" col2="40" start="29581" end="29586">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="187" col1="41" line2="187" col2="41" start="29587" end="29587">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="187" col1="42" line2="187" col2="42" start="29588" end="29588">,</OP-COMMA>
            <SYMBOL_SUB line1="188" col1="25" line2="188" col2="28" start="29729" end="29732">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="188" col1="30" line2="188" col2="30" start="29734" end="29734">=</EQ_SUB>
            <expr line1="188" col1="32" line2="188" col2="43" start="29736" end="29747">
              <expr line1="188" col1="32" line2="188" col2="35" start="29736" end="29739">
                <SYMBOL_FUNCTION_CALL line1="188" col1="32" line2="188" col2="35" start="29736" end="29739">fpkm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="188" col1="36" line2="188" col2="36" start="29740" end="29740">(</OP-LEFT-PAREN>
              <expr line1="188" col1="37" line2="188" col2="42" start="29741" end="29746">
                <SYMBOL line1="188" col1="37" line2="188" col2="42" start="29741" end="29746">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="188" col1="43" line2="188" col2="43" start="29747" end="29747">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="188" col1="44" line2="188" col2="44" start="29748" end="29748">,</OP-COMMA>
            <SYMBOL_SUB line1="189" col1="25" line2="189" col2="30" start="29887" end="29892">counts</SYMBOL_SUB>
            <EQ_SUB line1="189" col1="32" line2="189" col2="32" start="29894" end="29894">=</EQ_SUB>
            <expr line1="189" col1="34" line2="189" col2="47" start="29896" end="29909">
              <expr line1="189" col1="34" line2="189" col2="39" start="29896" end="29901">
                <SYMBOL_FUNCTION_CALL line1="189" col1="34" line2="189" col2="39" start="29896" end="29901">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="189" col1="40" line2="189" col2="40" start="29902" end="29902">(</OP-LEFT-PAREN>
              <expr line1="189" col1="41" line2="189" col2="46" start="29903" end="29908">
                <SYMBOL line1="189" col1="41" line2="189" col2="46" start="29903" end="29908">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="189" col1="47" line2="189" col2="47" start="29909" end="29909">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="189" col1="48" line2="189" col2="48" start="29910" end="29910">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="190" col1="5" line2="191" col2="58" start="30025" end="30236">
          <IF line1="190" col1="5" line2="190" col2="6" start="30025" end="30026">if</IF>
          <OP-LEFT-PAREN line1="190" col1="8" line2="190" col2="8" start="30028" end="30028">(</OP-LEFT-PAREN>
          <expr line1="190" col1="10" line2="190" col2="32" start="30030" end="30052">
            <expr line1="190" col1="10" line2="190" col2="21" start="30030" end="30041">
              <SYMBOL line1="190" col1="10" line2="190" col2="21" start="30030" end="30041">exprs_values</SYMBOL>
            </expr>
            <EQ line1="190" col1="23" line2="190" col2="24" start="30043" end="30044">==</EQ>
            <expr line1="190" col1="26" line2="190" col2="32" start="30046" end="30052">
              <STR_CONST line1="190" col1="26" line2="190" col2="32" start="30046" end="30052">"exprs"</STR_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="190" col1="34" line2="190" col2="34" start="30054" end="30054">)</OP-RIGHT-PAREN>
          <expr line1="191" col1="9" line2="191" col2="58" start="30187" end="30236">
            <expr line1="191" col1="9" line2="191" col2="17" start="30187" end="30195">
              <SYMBOL line1="191" col1="9" line2="191" col2="17" start="30187" end="30195">exprs_mat</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="191" col1="19" line2="191" col2="20" start="30197" end="30198">&lt;-</LEFT_ASSIGN>
            <expr line1="191" col1="22" line2="191" col2="58" start="30200" end="30236">
              <expr line1="191" col1="22" line2="191" col2="34" start="30200" end="30212">
                <expr line1="191" col1="22" line2="191" col2="22" start="30200" end="30200">
                  <NUM_CONST line1="191" col1="22" line2="191" col2="22" start="30200" end="30200">2</NUM_CONST>
                </expr>
                <OP-CARET line1="191" col1="24" line2="191" col2="24" start="30202" end="30202">^</OP-CARET>
                <expr line1="191" col1="26" line2="191" col2="34" start="30204" end="30212">
                  <SYMBOL line1="191" col1="26" line2="191" col2="34" start="30204" end="30212">exprs_mat</SYMBOL>
                </expr>
              </expr>
              <OP-MINUS line1="191" col1="36" line2="191" col2="36" start="30214" end="30214">-</OP-MINUS>
              <expr line1="191" col1="38" line2="191" col2="58" start="30216" end="30236">
                <expr line1="191" col1="38" line2="191" col2="43" start="30216" end="30221">
                  <SYMBOL line1="191" col1="38" line2="191" col2="43" start="30216" end="30221">object</SYMBOL>
                </expr>
                <OP-AT line1="191" col1="44" line2="191" col2="44" start="30222" end="30222">@</OP-AT>
                <SLOT line1="191" col1="45" line2="191" col2="58" start="30223" end="30236">logExprsOffset</SLOT>
              </expr>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="193" col1="5" line2="193" col2="67" start="30499" end="30561">## Use reshape2 to make a long version of the expression matrix</COMMENT>
        <expr line1="194" col1="5" line2="194" col2="79" start="30657" end="30731">
          <expr line1="194" col1="5" line2="194" col2="13" start="30657" end="30665">
            <SYMBOL line1="194" col1="5" line2="194" col2="13" start="30657" end="30665">tmp_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="194" col1="15" line2="194" col2="16" start="30667" end="30668">&lt;-</LEFT_ASSIGN>
          <expr line1="194" col1="18" line2="194" col2="79" start="30670" end="30731">
            <expr line1="194" col1="18" line2="194" col2="27" start="30670" end="30679">
              <SYMBOL_FUNCTION_CALL line1="194" col1="18" line2="194" col2="27" start="30670" end="30679">data.frame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="194" col1="28" line2="194" col2="28" start="30680" end="30680">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="194" col1="29" line2="194" col2="35" start="30681" end="30687">feature</SYMBOL_SUB>
            <EQ_SUB line1="194" col1="37" line2="194" col2="37" start="30689" end="30689">=</EQ_SUB>
            <expr line1="194" col1="39" line2="194" col2="67" start="30691" end="30719">
              <expr line1="194" col1="39" line2="194" col2="51" start="30691" end="30703">
                <expr line1="194" col1="39" line2="194" col2="43" start="30691" end="30695">
                  <SYMBOL_FUNCTION_CALL line1="194" col1="39" line2="194" col2="43" start="30691" end="30695">fData</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="194" col1="44" line2="194" col2="44" start="30696" end="30696">(</OP-LEFT-PAREN>
                <expr line1="194" col1="45" line2="194" col2="50" start="30697" end="30702">
                  <SYMBOL line1="194" col1="45" line2="194" col2="50" start="30697" end="30702">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="194" col1="51" line2="194" col2="51" start="30703" end="30703">)</OP-RIGHT-PAREN>
              </expr>
              <LBB line1="194" col1="52" line2="194" col2="53" start="30704" end="30705">[[</LBB>
              <expr line1="194" col1="54" line2="194" col2="65" start="30706" end="30717">
                <SYMBOL line1="194" col1="54" line2="194" col2="65" start="30706" end="30717">summarise_by</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="194" col1="66" line2="194" col2="66" start="30718" end="30718">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="194" col1="67" line2="194" col2="67" start="30719" end="30719">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-COMMA line1="194" col1="68" line2="194" col2="68" start="30720" end="30720">,</OP-COMMA>
            <expr line1="194" col1="70" line2="194" col2="78" start="30722" end="30730">
              <SYMBOL line1="194" col1="70" line2="194" col2="78" start="30722" end="30730">exprs_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="194" col1="79" line2="194" col2="79" start="30731" end="30731">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="195" col1="5" line2="195" col2="65" start="30815" end="30875">
          <expr line1="195" col1="5" line2="195" col2="18" start="30815" end="30828">
            <SYMBOL line1="195" col1="5" line2="195" col2="18" start="30815" end="30828">tmp_exprs_long</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="195" col1="20" line2="195" col2="21" start="30830" end="30831">&lt;-</LEFT_ASSIGN>
          <expr line1="195" col1="23" line2="195" col2="65" start="30833" end="30875">
            <expr line1="195" col1="23" line2="195" col2="38" start="30833" end="30848">
              <SYMBOL_FUNCTION_CALL line1="195" col1="23" line2="195" col2="38" start="30833" end="30848">suppressMessages</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="195" col1="39" line2="195" col2="39" start="30849" end="30849">(</OP-LEFT-PAREN>
            <expr line1="195" col1="40" line2="195" col2="64" start="30850" end="30874">
              <expr line1="195" col1="40" line2="195" col2="53" start="30850" end="30863">
                <SYMBOL_PACKAGE line1="195" col1="40" line2="195" col2="47" start="30850" end="30857">reshape2</SYMBOL_PACKAGE>
                <NS_GET line1="195" col1="48" line2="195" col2="49" start="30858" end="30859">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="195" col1="50" line2="195" col2="53" start="30860" end="30863">melt</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="195" col1="54" line2="195" col2="54" start="30864" end="30864">(</OP-LEFT-PAREN>
              <expr line1="195" col1="55" line2="195" col2="63" start="30865" end="30873">
                <SYMBOL line1="195" col1="55" line2="195" col2="63" start="30865" end="30873">tmp_exprs</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="195" col1="64" line2="195" col2="64" start="30874" end="30874">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="195" col1="65" line2="195" col2="65" start="30875" end="30875">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="196" col1="5" line2="196" col2="73" start="30973" end="31041">
          <expr line1="196" col1="5" line2="196" col2="13" start="30973" end="30981">
            <SYMBOL line1="196" col1="5" line2="196" col2="13" start="30973" end="30981">exprs_new</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="196" col1="15" line2="196" col2="16" start="30983" end="30984">&lt;-</LEFT_ASSIGN>
          <expr line1="196" col1="18" line2="196" col2="73" start="30986" end="31041">
            <expr line1="196" col1="18" line2="196" col2="32" start="30986" end="31000">
              <SYMBOL_PACKAGE line1="196" col1="18" line2="196" col2="25" start="30986" end="30993">reshape2</SYMBOL_PACKAGE>
              <NS_GET line1="196" col1="26" line2="196" col2="27" start="30994" end="30995">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="196" col1="28" line2="196" col2="32" start="30996" end="31000">acast</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="196" col1="33" line2="196" col2="33" start="31001" end="31001">(</OP-LEFT-PAREN>
            <expr line1="196" col1="34" line2="196" col2="47" start="31002" end="31015">
              <SYMBOL line1="196" col1="34" line2="196" col2="47" start="31002" end="31015">tmp_exprs_long</SYMBOL>
            </expr>
            <OP-COMMA line1="196" col1="48" line2="196" col2="48" start="31016" end="31016">,</OP-COMMA>
            <expr line1="196" col1="50" line2="196" col2="67" start="31018" end="31035">
              <expr line1="196" col1="50" line2="196" col2="56" start="31018" end="31024">
                <SYMBOL line1="196" col1="50" line2="196" col2="56" start="31018" end="31024">feature</SYMBOL>
              </expr>
              <OP-TILDE line1="196" col1="58" line2="196" col2="58" start="31026" end="31026">~</OP-TILDE>
              <expr line1="196" col1="60" line2="196" col2="67" start="31028" end="31035">
                <SYMBOL line1="196" col1="60" line2="196" col2="67" start="31028" end="31035">variable</SYMBOL>
              </expr>
            </expr>
            <OP-COMMA line1="196" col1="68" line2="196" col2="68" start="31036" end="31036">,</OP-COMMA>
            <expr line1="196" col1="70" line2="196" col2="72" start="31038" end="31040">
              <SYMBOL line1="196" col1="70" line2="196" col2="72" start="31038" end="31040">sum</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="196" col1="73" line2="196" col2="73" start="31041" end="31041">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="197" col1="5" line2="197" col2="65" start="31131" end="31191">
          <expr line1="197" col1="5" line2="197" col2="7" start="31131" end="31133">
            <SYMBOL_FUNCTION_CALL line1="197" col1="5" line2="197" col2="7" start="31131" end="31133">cat</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="197" col1="8" line2="197" col2="8" start="31134" end="31134">(</OP-LEFT-PAREN>
          <expr line1="197" col1="9" line2="197" col2="34" start="31135" end="31160">
            <STR_CONST line1="197" col1="9" line2="197" col2="34" start="31135" end="31160">"Collapsing expression to"</STR_CONST>
          </expr>
          <OP-COMMA line1="197" col1="35" line2="197" col2="35" start="31161" end="31161">,</OP-COMMA>
          <expr line1="197" col1="37" line2="197" col2="51" start="31163" end="31177">
            <expr line1="197" col1="37" line2="197" col2="40" start="31163" end="31166">
              <SYMBOL_FUNCTION_CALL line1="197" col1="37" line2="197" col2="40" start="31163" end="31166">nrow</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="197" col1="41" line2="197" col2="41" start="31167" end="31167">(</OP-LEFT-PAREN>
            <expr line1="197" col1="42" line2="197" col2="50" start="31168" end="31176">
              <SYMBOL line1="197" col1="42" line2="197" col2="50" start="31168" end="31176">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="197" col1="51" line2="197" col2="51" start="31177" end="31177">)</OP-RIGHT-PAREN>
          </expr>
          <OP-COMMA line1="197" col1="52" line2="197" col2="52" start="31178" end="31178">,</OP-COMMA>
          <expr line1="197" col1="54" line2="197" col2="64" start="31180" end="31190">
            <STR_CONST line1="197" col1="54" line2="197" col2="64" start="31180" end="31190">"features."</STR_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="197" col1="65" line2="197" col2="65" start="31191" end="31191">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="199" col1="5" line2="199" col2="49" start="31447" end="31491">## ensure sample names haven't been corrupted</COMMENT>
        <expr line1="200" col1="5" line2="200" col2="46" start="31605" end="31646">
          <expr line1="200" col1="5" line2="200" col2="23" start="31605" end="31623">
            <expr line1="200" col1="5" line2="200" col2="12" start="31605" end="31612">
              <SYMBOL_FUNCTION_CALL line1="200" col1="5" line2="200" col2="12" start="31605" end="31612">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="200" col1="13" line2="200" col2="13" start="31613" end="31613">(</OP-LEFT-PAREN>
            <expr line1="200" col1="14" line2="200" col2="22" start="31614" end="31622">
              <SYMBOL line1="200" col1="14" line2="200" col2="22" start="31614" end="31622">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="200" col1="23" line2="200" col2="23" start="31623" end="31623">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="200" col1="25" line2="200" col2="26" start="31625" end="31626">&lt;-</LEFT_ASSIGN>
          <expr line1="200" col1="28" line2="200" col2="46" start="31628" end="31646">
            <expr line1="200" col1="28" line2="200" col2="38" start="31628" end="31638">
              <SYMBOL_FUNCTION_CALL line1="200" col1="28" line2="200" col2="38" start="31628" end="31638">sampleNames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="200" col1="39" line2="200" col2="39" start="31639" end="31639">(</OP-LEFT-PAREN>
            <expr line1="200" col1="40" line2="200" col2="45" start="31640" end="31645">
              <SYMBOL line1="200" col1="40" line2="200" col2="45" start="31640" end="31645">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="200" col1="46" line2="200" col2="46" start="31646" end="31646">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="202" col1="5" line2="202" col2="33" start="31921" end="31949">## Create a new SCESet object</COMMENT>
        <expr line1="203" col1="5" line2="203" col2="50" start="32079" end="32124">
          <expr line1="203" col1="5" line2="203" col2="6" start="32079" end="32080">
            <SYMBOL line1="203" col1="5" line2="203" col2="6" start="32079" end="32080">pd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="203" col1="8" line2="203" col2="9" start="32082" end="32083">&lt;-</LEFT_ASSIGN>
          <expr line1="203" col1="11" line2="203" col2="50" start="32085" end="32124">
            <expr line1="203" col1="11" line2="203" col2="13" start="32085" end="32087">
              <SYMBOL_FUNCTION_CALL line1="203" col1="11" line2="203" col2="13" start="32085" end="32087">new</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="203" col1="14" line2="203" col2="14" start="32088" end="32088">(</OP-LEFT-PAREN>
            <expr line1="203" col1="15" line2="203" col2="34" start="32089" end="32108">
              <STR_CONST line1="203" col1="15" line2="203" col2="34" start="32089" end="32108">"AnnotatedDataFrame"</STR_CONST>
            </expr>
            <OP-COMMA line1="203" col1="35" line2="203" col2="35" start="32109" end="32109">,</OP-COMMA>
            <expr line1="203" col1="37" line2="203" col2="49" start="32111" end="32123">
              <expr line1="203" col1="37" line2="203" col2="41" start="32111" end="32115">
                <SYMBOL_FUNCTION_CALL line1="203" col1="37" line2="203" col2="41" start="32111" end="32115">pData</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="203" col1="42" line2="203" col2="42" start="32116" end="32116">(</OP-LEFT-PAREN>
              <expr line1="203" col1="43" line2="203" col2="48" start="32117" end="32122">
                <SYMBOL line1="203" col1="43" line2="203" col2="48" start="32117" end="32122">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="203" col1="49" line2="203" col2="49" start="32123" end="32123">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="203" col1="50" line2="203" col2="50" start="32124" end="32124">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="204" col1="5" line2="205" col2="67" start="32237" end="32457">
          <expr line1="204" col1="5" line2="204" col2="6" start="32237" end="32238">
            <SYMBOL line1="204" col1="5" line2="204" col2="6" start="32237" end="32238">fd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="204" col1="8" line2="204" col2="9" start="32240" end="32241">&lt;-</LEFT_ASSIGN>
          <expr line1="204" col1="11" line2="205" col2="67" start="32243" end="32457">
            <expr line1="204" col1="11" line2="204" col2="13" start="32243" end="32245">
              <SYMBOL_FUNCTION_CALL line1="204" col1="11" line2="204" col2="13" start="32243" end="32245">new</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="204" col1="14" line2="204" col2="14" start="32246" end="32246">(</OP-LEFT-PAREN>
            <expr line1="204" col1="15" line2="204" col2="34" start="32247" end="32266">
              <STR_CONST line1="204" col1="15" line2="204" col2="34" start="32247" end="32266">"AnnotatedDataFrame"</STR_CONST>
            </expr>
            <OP-COMMA line1="204" col1="35" line2="204" col2="35" start="32267" end="32267">,</OP-COMMA>
            <expr line1="205" col1="15" line2="205" col2="66" start="32405" end="32456">
              <expr line1="205" col1="15" line2="205" col2="24" start="32405" end="32414">
                <SYMBOL_FUNCTION_CALL line1="205" col1="15" line2="205" col2="24" start="32405" end="32414">data.frame</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="205" col1="25" line2="205" col2="25" start="32415" end="32415">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="205" col1="26" line2="205" col2="43" start="32416" end="32433">exprs_collapsed_to</SYMBOL_SUB>
              <EQ_SUB line1="205" col1="45" line2="205" col2="45" start="32435" end="32435">=</EQ_SUB>
              <expr line1="205" col1="47" line2="205" col2="65" start="32437" end="32455">
                <expr line1="205" col1="47" line2="205" col2="54" start="32437" end="32444">
                  <SYMBOL_FUNCTION_CALL line1="205" col1="47" line2="205" col2="54" start="32437" end="32444">rownames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="205" col1="55" line2="205" col2="55" start="32445" end="32445">(</OP-LEFT-PAREN>
                <expr line1="205" col1="56" line2="205" col2="64" start="32446" end="32454">
                  <SYMBOL line1="205" col1="56" line2="205" col2="64" start="32446" end="32454">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="205" col1="65" line2="205" col2="65" start="32455" end="32455">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="205" col1="66" line2="205" col2="66" start="32456" end="32456">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="205" col1="67" line2="205" col2="67" start="32457" end="32457">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="206" col1="5" line2="206" col2="39" start="32553" end="32587">
          <expr line1="206" col1="5" line2="206" col2="16" start="32553" end="32564">
            <expr line1="206" col1="5" line2="206" col2="12" start="32553" end="32560">
              <SYMBOL_FUNCTION_CALL line1="206" col1="5" line2="206" col2="12" start="32553" end="32560">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="206" col1="13" line2="206" col2="13" start="32561" end="32561">(</OP-LEFT-PAREN>
            <expr line1="206" col1="14" line2="206" col2="15" start="32562" end="32563">
              <SYMBOL line1="206" col1="14" line2="206" col2="15" start="32562" end="32563">fd</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="206" col1="16" line2="206" col2="16" start="32564" end="32564">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="206" col1="18" line2="206" col2="19" start="32566" end="32567">&lt;-</LEFT_ASSIGN>
          <expr line1="206" col1="21" line2="206" col2="39" start="32569" end="32587">
            <expr line1="206" col1="21" line2="206" col2="28" start="32569" end="32576">
              <SYMBOL_FUNCTION_CALL line1="206" col1="21" line2="206" col2="28" start="32569" end="32576">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="206" col1="29" line2="206" col2="29" start="32577" end="32577">(</OP-LEFT-PAREN>
            <expr line1="206" col1="30" line2="206" col2="38" start="32578" end="32586">
              <SYMBOL line1="206" col1="30" line2="206" col2="38" start="32578" end="32586">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="206" col1="39" line2="206" col2="39" start="32587" end="32587">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="207" col1="5" line2="208" col2="60" start="32711" end="32924">
          <IF line1="207" col1="5" line2="207" col2="6" start="32711" end="32712">if</IF>
          <OP-LEFT-PAREN line1="207" col1="8" line2="207" col2="8" start="32714" end="32714">(</OP-LEFT-PAREN>
          <expr line1="207" col1="10" line2="207" col2="32" start="32716" end="32738">
            <expr line1="207" col1="10" line2="207" col2="21" start="32716" end="32727">
              <SYMBOL line1="207" col1="10" line2="207" col2="21" start="32716" end="32727">exprs_values</SYMBOL>
            </expr>
            <EQ line1="207" col1="23" line2="207" col2="24" start="32729" end="32730">==</EQ>
            <expr line1="207" col1="26" line2="207" col2="32" start="32732" end="32738">
              <STR_CONST line1="207" col1="26" line2="207" col2="32" start="32732" end="32738">"exprs"</STR_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="207" col1="34" line2="207" col2="34" start="32740" end="32740">)</OP-RIGHT-PAREN>
          <expr line1="208" col1="9" line2="208" col2="60" start="32873" end="32924">
            <expr line1="208" col1="9" line2="208" col2="17" start="32873" end="32881">
              <SYMBOL line1="208" col1="9" line2="208" col2="17" start="32873" end="32881">exprs_new</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="208" col1="19" line2="208" col2="20" start="32883" end="32884">&lt;-</LEFT_ASSIGN>
            <expr line1="208" col1="22" line2="208" col2="60" start="32886" end="32924">
              <expr line1="208" col1="22" line2="208" col2="25" start="32886" end="32889">
                <SYMBOL_FUNCTION_CALL line1="208" col1="22" line2="208" col2="25" start="32886" end="32889">log2</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="208" col1="26" line2="208" col2="26" start="32890" end="32890">(</OP-LEFT-PAREN>
              <expr line1="208" col1="27" line2="208" col2="59" start="32891" end="32923">
                <expr line1="208" col1="27" line2="208" col2="35" start="32891" end="32899">
                  <SYMBOL line1="208" col1="27" line2="208" col2="35" start="32891" end="32899">exprs_new</SYMBOL>
                </expr>
                <OP-PLUS line1="208" col1="37" line2="208" col2="37" start="32901" end="32901">+</OP-PLUS>
                <expr line1="208" col1="39" line2="208" col2="59" start="32903" end="32923">
                  <expr line1="208" col1="39" line2="208" col2="44" start="32903" end="32908">
                    <SYMBOL line1="208" col1="39" line2="208" col2="44" start="32903" end="32908">object</SYMBOL>
                  </expr>
                  <OP-AT line1="208" col1="45" line2="208" col2="45" start="32909" end="32909">@</OP-AT>
                  <SLOT line1="208" col1="46" line2="208" col2="59" start="32910" end="32923">logExprsOffset</SLOT>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="208" col1="60" line2="208" col2="60" start="32924" end="32924">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="210" col1="5" line2="218" col2="59" start="33185" end="34503">
          <expr line1="210" col1="5" line2="210" col2="11" start="33185" end="33191">
            <SYMBOL line1="210" col1="5" line2="210" col2="11" start="33185" end="33191">sce_out</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="210" col1="13" line2="210" col2="14" start="33193" end="33194">&lt;-</LEFT_ASSIGN>
          <expr line1="210" col1="16" line2="218" col2="59" start="33196" end="34503">
            <expr line1="210" col1="16" line2="210" col2="21" start="33196" end="33201">
              <SYMBOL_FUNCTION_CALL line1="210" col1="16" line2="210" col2="21" start="33196" end="33201">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="210" col1="22" line2="210" col2="22" start="33202" end="33202">(</OP-LEFT-PAREN>
            <expr line1="210" col1="23" line2="210" col2="34" start="33203" end="33214">
              <SYMBOL line1="210" col1="23" line2="210" col2="34" start="33203" end="33214">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="210" col1="35" line2="210" col2="35" start="33215" end="33215">,</OP-COMMA>
            <SYMBOL_SUB line1="211" col1="23" line2="211" col2="27" start="33361" end="33365">exprs</SYMBOL_SUB>
            <EQ_SUB line1="211" col1="29" line2="211" col2="29" start="33367" end="33367">=</EQ_SUB>
            <expr line1="211" col1="31" line2="212" col2="57" start="33369" end="33553">
              <expr line1="211" col1="31" line2="211" col2="39" start="33369" end="33377">
                <SYMBOL_FUNCTION_CALL line1="211" col1="31" line2="211" col2="39" start="33369" end="33377">newSCESet</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="211" col1="40" line2="211" col2="40" start="33378" end="33378">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="211" col1="41" line2="211" col2="49" start="33379" end="33387">exprsData</SYMBOL_SUB>
              <EQ_SUB line1="211" col1="51" line2="211" col2="51" start="33389" end="33389">=</EQ_SUB>
              <expr line1="211" col1="53" line2="211" col2="61" start="33391" end="33399">
                <SYMBOL line1="211" col1="53" line2="211" col2="61" start="33391" end="33399">exprs_new</SYMBOL>
              </expr>
              <OP-COMMA line1="211" col1="62" line2="211" col2="62" start="33400" end="33400">,</OP-COMMA>
              <SYMBOL_SUB line1="211" col1="64" line2="211" col2="72" start="33402" end="33410">phenoData</SYMBOL_SUB>
              <EQ_SUB line1="211" col1="74" line2="211" col2="74" start="33412" end="33412">=</EQ_SUB>
              <expr line1="211" col1="76" line2="211" col2="77" start="33414" end="33415">
                <SYMBOL line1="211" col1="76" line2="211" col2="77" start="33414" end="33415">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="211" col1="78" line2="211" col2="78" start="33416" end="33416">,</OP-COMMA>
              <SYMBOL_SUB line1="212" col1="41" line2="212" col2="51" start="33537" end="33547">featureData</SYMBOL_SUB>
              <EQ_SUB line1="212" col1="53" line2="212" col2="53" start="33549" end="33549">=</EQ_SUB>
              <expr line1="212" col1="55" line2="212" col2="56" start="33551" end="33552">
                <SYMBOL line1="212" col1="55" line2="212" col2="56" start="33551" end="33552">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="212" col1="57" line2="212" col2="57" start="33553" end="33553">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="212" col1="58" line2="212" col2="58" start="33554" end="33554">,</OP-COMMA>
            <SYMBOL_SUB line1="213" col1="23" line2="213" col2="25" start="33677" end="33679">tpm</SYMBOL_SUB>
            <EQ_SUB line1="213" col1="27" line2="213" col2="27" start="33681" end="33681">=</EQ_SUB>
            <expr line1="213" col1="29" line2="214" col2="55" start="33683" end="33867">
              <expr line1="213" col1="29" line2="213" col2="37" start="33683" end="33691">
                <SYMBOL_FUNCTION_CALL line1="213" col1="29" line2="213" col2="37" start="33683" end="33691">newSCESet</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="213" col1="38" line2="213" col2="38" start="33692" end="33692">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="213" col1="39" line2="213" col2="45" start="33693" end="33699">tpmData</SYMBOL_SUB>
              <EQ_SUB line1="213" col1="47" line2="213" col2="47" start="33701" end="33701">=</EQ_SUB>
              <expr line1="213" col1="49" line2="213" col2="57" start="33703" end="33711">
                <SYMBOL line1="213" col1="49" line2="213" col2="57" start="33703" end="33711">exprs_new</SYMBOL>
              </expr>
              <OP-COMMA line1="213" col1="58" line2="213" col2="58" start="33712" end="33712">,</OP-COMMA>
              <SYMBOL_SUB line1="213" col1="60" line2="213" col2="68" start="33714" end="33722">phenoData</SYMBOL_SUB>
              <EQ_SUB line1="213" col1="70" line2="213" col2="70" start="33724" end="33724">=</EQ_SUB>
              <expr line1="213" col1="72" line2="213" col2="73" start="33726" end="33727">
                <SYMBOL line1="213" col1="72" line2="213" col2="73" start="33726" end="33727">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="213" col1="74" line2="213" col2="74" start="33728" end="33728">,</OP-COMMA>
              <SYMBOL_SUB line1="214" col1="39" line2="214" col2="49" start="33851" end="33861">featureData</SYMBOL_SUB>
              <EQ_SUB line1="214" col1="51" line2="214" col2="51" start="33863" end="33863">=</EQ_SUB>
              <expr line1="214" col1="53" line2="214" col2="54" start="33865" end="33866">
                <SYMBOL line1="214" col1="53" line2="214" col2="54" start="33865" end="33866">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="214" col1="55" line2="214" col2="55" start="33867" end="33867">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="214" col1="56" line2="214" col2="56" start="33868" end="33868">,</OP-COMMA>
            <SYMBOL_SUB line1="215" col1="23" line2="215" col2="26" start="33993" end="33996">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="215" col1="28" line2="215" col2="28" start="33998" end="33998">=</EQ_SUB>
            <expr line1="215" col1="30" line2="216" col2="56" start="34000" end="34184">
              <expr line1="215" col1="30" line2="215" col2="38" start="34000" end="34008">
                <SYMBOL_FUNCTION_CALL line1="215" col1="30" line2="215" col2="38" start="34000" end="34008">newSCESet</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="215" col1="39" line2="215" col2="39" start="34009" end="34009">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="215" col1="40" line2="215" col2="47" start="34010" end="34017">fpkmData</SYMBOL_SUB>
              <EQ_SUB line1="215" col1="49" line2="215" col2="49" start="34019" end="34019">=</EQ_SUB>
              <expr line1="215" col1="51" line2="215" col2="59" start="34021" end="34029">
                <SYMBOL line1="215" col1="51" line2="215" col2="59" start="34021" end="34029">exprs_new</SYMBOL>
              </expr>
              <OP-COMMA line1="215" col1="60" line2="215" col2="60" start="34030" end="34030">,</OP-COMMA>
              <SYMBOL_SUB line1="215" col1="62" line2="215" col2="70" start="34032" end="34040">phenoData</SYMBOL_SUB>
              <EQ_SUB line1="215" col1="72" line2="215" col2="72" start="34042" end="34042">=</EQ_SUB>
              <expr line1="215" col1="74" line2="215" col2="75" start="34044" end="34045">
                <SYMBOL line1="215" col1="74" line2="215" col2="75" start="34044" end="34045">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="215" col1="76" line2="215" col2="76" start="34046" end="34046">,</OP-COMMA>
              <SYMBOL_SUB line1="216" col1="40" line2="216" col2="50" start="34168" end="34178">featureData</SYMBOL_SUB>
              <EQ_SUB line1="216" col1="52" line2="216" col2="52" start="34180" end="34180">=</EQ_SUB>
              <expr line1="216" col1="54" line2="216" col2="55" start="34182" end="34183">
                <SYMBOL line1="216" col1="54" line2="216" col2="55" start="34182" end="34183">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="216" col1="56" line2="216" col2="56" start="34184" end="34184">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="216" col1="57" line2="216" col2="57" start="34185" end="34185">,</OP-COMMA>
            <SYMBOL_SUB line1="217" col1="23" line2="217" col2="28" start="34309" end="34314">counts</SYMBOL_SUB>
            <EQ_SUB line1="217" col1="30" line2="217" col2="30" start="34316" end="34316">=</EQ_SUB>
            <expr line1="217" col1="32" line2="218" col2="58" start="34318" end="34502">
              <expr line1="217" col1="32" line2="217" col2="40" start="34318" end="34326">
                <SYMBOL_FUNCTION_CALL line1="217" col1="32" line2="217" col2="40" start="34318" end="34326">newSCESet</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="217" col1="41" line2="217" col2="41" start="34327" end="34327">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="217" col1="42" line2="217" col2="50" start="34328" end="34336">countData</SYMBOL_SUB>
              <EQ_SUB line1="217" col1="52" line2="217" col2="52" start="34338" end="34338">=</EQ_SUB>
              <expr line1="217" col1="54" line2="217" col2="62" start="34340" end="34348">
                <SYMBOL line1="217" col1="54" line2="217" col2="62" start="34340" end="34348">exprs_new</SYMBOL>
              </expr>
              <OP-COMMA line1="217" col1="63" line2="217" col2="63" start="34349" end="34349">,</OP-COMMA>
              <SYMBOL_SUB line1="217" col1="65" line2="217" col2="73" start="34351" end="34359">phenoData</SYMBOL_SUB>
              <EQ_SUB line1="217" col1="75" line2="217" col2="75" start="34361" end="34361">=</EQ_SUB>
              <expr line1="217" col1="77" line2="217" col2="78" start="34363" end="34364">
                <SYMBOL line1="217" col1="77" line2="217" col2="78" start="34363" end="34364">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="217" col1="79" line2="217" col2="79" start="34365" end="34365">,</OP-COMMA>
              <SYMBOL_SUB line1="218" col1="42" line2="218" col2="52" start="34486" end="34496">featureData</SYMBOL_SUB>
              <EQ_SUB line1="218" col1="54" line2="218" col2="54" start="34498" end="34498">=</EQ_SUB>
              <expr line1="218" col1="56" line2="218" col2="57" start="34500" end="34501">
                <SYMBOL line1="218" col1="56" line2="218" col2="57" start="34500" end="34501">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="218" col1="58" line2="218" col2="58" start="34502" end="34502">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="218" col1="59" line2="218" col2="59" start="34503" end="34503">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="219" col1="5" line2="219" col2="52" start="34607" end="34654">## Summarise other data in the object if present</COMMENT>
        <COMMENT line1="220" col1="5" line2="220" col2="13" start="34765" end="34773">## counts</COMMENT>
        <expr line1="221" col1="5" line2="250" col2="5" start="34923" end="39505">
          <IF line1="221" col1="5" line2="221" col2="6" start="34923" end="34924">if</IF>
          <OP-LEFT-PAREN line1="221" col1="8" line2="221" col2="8" start="34926" end="34926">(</OP-LEFT-PAREN>
          <expr line1="221" col1="10" line2="221" col2="51" start="34928" end="34969">
            <expr line1="221" col1="10" line2="221" col2="30" start="34928" end="34948">
              <OP-EXCLAMATION line1="221" col1="10" line2="221" col2="10" start="34928" end="34928">!</OP-EXCLAMATION>
              <expr line1="221" col1="11" line2="221" col2="30" start="34929" end="34948">
                <expr line1="221" col1="11" line2="221" col2="17" start="34929" end="34935">
                  <SYMBOL_FUNCTION_CALL line1="221" col1="11" line2="221" col2="17" start="34929" end="34935">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="221" col1="18" line2="221" col2="18" start="34936" end="34936">(</OP-LEFT-PAREN>
                <expr line1="221" col1="19" line2="221" col2="29" start="34937" end="34947">
                  <expr line1="221" col1="19" line2="221" col2="21" start="34937" end="34939">
                    <SYMBOL_FUNCTION_CALL line1="221" col1="19" line2="221" col2="21" start="34937" end="34939">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="221" col1="22" line2="221" col2="22" start="34940" end="34940">(</OP-LEFT-PAREN>
                  <expr line1="221" col1="23" line2="221" col2="28" start="34941" end="34946">
                    <SYMBOL line1="221" col1="23" line2="221" col2="28" start="34941" end="34946">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="221" col1="29" line2="221" col2="29" start="34947" end="34947">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="221" col1="30" line2="221" col2="30" start="34948" end="34948">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <AND2 line1="221" col1="32" line2="221" col2="33" start="34950" end="34951">&amp;&amp;</AND2>
            <expr line1="221" col1="35" line2="221" col2="51" start="34953" end="34969">
              <SYMBOL line1="221" col1="35" line2="221" col2="51" start="34953" end="34969">scaled_tpm_counts</SYMBOL>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="221" col1="53" line2="221" col2="53" start="34971" end="34971">)</OP-RIGHT-PAREN>
          <expr line1="221" col1="55" line2="240" col2="5" start="34973" end="37925">
            <OP-LEFT-BRACE line1="221" col1="55" line2="221" col2="55" start="34973" end="34973">{</OP-LEFT-BRACE>
            <expr line1="222" col1="9" line2="230" col2="9" start="35085" end="36349">
              <IF line1="222" col1="9" line2="222" col2="10" start="35085" end="35086">if</IF>
              <OP-LEFT-PAREN line1="222" col1="12" line2="222" col2="12" start="35088" end="35088">(</OP-LEFT-PAREN>
              <expr line1="222" col1="14" line2="222" col2="30" start="35090" end="35106">
                <expr line1="222" col1="14" line2="222" col2="20" start="35090" end="35096">
                  <SYMBOL_FUNCTION_CALL line1="222" col1="14" line2="222" col2="20" start="35090" end="35096">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="222" col1="21" line2="222" col2="21" start="35097" end="35097">(</OP-LEFT-PAREN>
                <expr line1="222" col1="22" line2="222" col2="29" start="35098" end="35105">
                  <SYMBOL line1="222" col1="22" line2="222" col2="29" start="35098" end="35105">lib_size</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="222" col1="30" line2="222" col2="30" start="35106" end="35106">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="222" col1="32" line2="222" col2="32" start="35108" end="35108">)</OP-RIGHT-PAREN>
              <expr line1="222" col1="34" line2="227" col2="9" start="35110" end="35875">
                <OP-LEFT-BRACE line1="222" col1="34" line2="222" col2="34" start="35110" end="35110">{</OP-LEFT-BRACE>
                <expr line1="223" col1="13" line2="226" col2="51" start="35247" end="35759">
                  <IF line1="223" col1="13" line2="223" col2="14" start="35247" end="35248">if</IF>
                  <OP-LEFT-PAREN line1="223" col1="16" line2="223" col2="16" start="35250" end="35250">(</OP-LEFT-PAREN>
                  <expr line1="223" col1="18" line2="223" col2="40" start="35252" end="35274">
                    <expr line1="223" col1="18" line2="223" col2="24" start="35252" end="35258">
                      <SYMBOL_FUNCTION_CALL line1="223" col1="18" line2="223" col2="24" start="35252" end="35258">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="223" col1="25" line2="223" col2="25" start="35259" end="35259">(</OP-LEFT-PAREN>
                    <expr line1="223" col1="26" line2="223" col2="39" start="35260" end="35273">
                      <expr line1="223" col1="26" line2="223" col2="31" start="35260" end="35265">
                        <SYMBOL_FUNCTION_CALL line1="223" col1="26" line2="223" col2="31" start="35260" end="35265">counts</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="223" col1="32" line2="223" col2="32" start="35266" end="35266">(</OP-LEFT-PAREN>
                      <expr line1="223" col1="33" line2="223" col2="38" start="35267" end="35272">
                        <SYMBOL line1="223" col1="33" line2="223" col2="38" start="35267" end="35272">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="223" col1="39" line2="223" col2="39" start="35273" end="35273">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="223" col1="40" line2="223" col2="40" start="35274" end="35274">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="223" col1="42" line2="223" col2="42" start="35276" end="35276">)</OP-RIGHT-PAREN>
                  <expr line1="224" col1="17" line2="224" col2="100" start="35409" end="35492">
                    <expr line1="224" col1="17" line2="224" col2="20" start="35409" end="35412">
                      <SYMBOL_FUNCTION_CALL line1="224" col1="17" line2="224" col2="20" start="35409" end="35412">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="224" col1="21" line2="224" col2="21" start="35413" end="35413">(</OP-LEFT-PAREN>
                    <expr line1="224" col1="22" line2="224" col2="99" start="35414" end="35491">
                      <STR_CONST line1="224" col1="22" line2="224" col2="99" start="35414" end="35491">"If object does not contain count values, lib_size argument must be provided."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="224" col1="100" line2="224" col2="100" start="35492" end="35492">)</OP-RIGHT-PAREN>
                  </expr>
                  <ELSE line1="225" col1="13" line2="225" col2="16" start="35563" end="35566">else</ELSE>
                  <expr line1="226" col1="17" line2="226" col2="51" start="35725" end="35759">
                    <expr line1="226" col1="17" line2="226" col2="24" start="35725" end="35732">
                      <SYMBOL line1="226" col1="17" line2="226" col2="24" start="35725" end="35732">lib_size</SYMBOL>
                    </expr>
                    <LEFT_ASSIGN line1="226" col1="26" line2="226" col2="27" start="35734" end="35735">&lt;-</LEFT_ASSIGN>
                    <expr line1="226" col1="29" line2="226" col2="51" start="35737" end="35759">
                      <expr line1="226" col1="29" line2="226" col2="35" start="35737" end="35743">
                        <SYMBOL_FUNCTION_CALL line1="226" col1="29" line2="226" col2="35" start="35737" end="35743">colSums</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="226" col1="36" line2="226" col2="36" start="35744" end="35744">(</OP-LEFT-PAREN>
                      <expr line1="226" col1="37" line2="226" col2="50" start="35745" end="35758">
                        <expr line1="226" col1="37" line2="226" col2="42" start="35745" end="35750">
                          <SYMBOL_FUNCTION_CALL line1="226" col1="37" line2="226" col2="42" start="35745" end="35750">counts</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="226" col1="43" line2="226" col2="43" start="35751" end="35751">(</OP-LEFT-PAREN>
                        <expr line1="226" col1="44" line2="226" col2="49" start="35752" end="35757">
                          <SYMBOL line1="226" col1="44" line2="226" col2="49" start="35752" end="35757">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="226" col1="50" line2="226" col2="50" start="35758" end="35758">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="226" col1="51" line2="226" col2="51" start="35759" end="35759">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="227" col1="9" line2="227" col2="9" start="35875" end="35875">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="227" col1="11" line2="227" col2="14" start="35877" end="35880">else</ELSE>
              <expr line1="227" col1="16" line2="230" col2="9" start="35882" end="36349">
                <OP-LEFT-BRACE line1="227" col1="16" line2="227" col2="16" start="35882" end="35882">{</OP-LEFT-BRACE>
                <expr line1="228" col1="13" line2="229" col2="96" start="36037" end="36278">
                  <IF line1="228" col1="13" line2="228" col2="14" start="36037" end="36038">if</IF>
                  <OP-LEFT-PAREN line1="228" col1="16" line2="228" col2="16" start="36040" end="36040">(</OP-LEFT-PAREN>
                  <expr line1="228" col1="18" line2="228" col2="49" start="36042" end="36073">
                    <expr line1="228" col1="18" line2="228" col2="33" start="36042" end="36057">
                      <expr line1="228" col1="18" line2="228" col2="23" start="36042" end="36047">
                        <SYMBOL_FUNCTION_CALL line1="228" col1="18" line2="228" col2="23" start="36042" end="36047">length</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="228" col1="24" line2="228" col2="24" start="36048" end="36048">(</OP-LEFT-PAREN>
                      <expr line1="228" col1="25" line2="228" col2="32" start="36049" end="36056">
                        <SYMBOL line1="228" col1="25" line2="228" col2="32" start="36049" end="36056">lib_size</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="228" col1="33" line2="228" col2="33" start="36057" end="36057">)</OP-RIGHT-PAREN>
                    </expr>
                    <NE line1="228" col1="35" line2="228" col2="36" start="36059" end="36060">!=</NE>
                    <expr line1="228" col1="38" line2="228" col2="49" start="36062" end="36073">
                      <expr line1="228" col1="38" line2="228" col2="41" start="36062" end="36065">
                        <SYMBOL_FUNCTION_CALL line1="228" col1="38" line2="228" col2="41" start="36062" end="36065">ncol</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="228" col1="42" line2="228" col2="42" start="36066" end="36066">(</OP-LEFT-PAREN>
                      <expr line1="228" col1="43" line2="228" col2="48" start="36067" end="36072">
                        <SYMBOL line1="228" col1="43" line2="228" col2="48" start="36067" end="36072">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="228" col1="49" line2="228" col2="49" start="36073" end="36073">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="228" col1="50" line2="228" col2="50" start="36074" end="36074">)</OP-RIGHT-PAREN>
                  <expr line1="229" col1="17" line2="229" col2="96" start="36199" end="36278">
                    <expr line1="229" col1="17" line2="229" col2="20" start="36199" end="36202">
                      <SYMBOL_FUNCTION_CALL line1="229" col1="17" line2="229" col2="20" start="36199" end="36202">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="229" col1="21" line2="229" col2="21" start="36203" end="36203">(</OP-LEFT-PAREN>
                    <expr line1="229" col1="22" line2="229" col2="95" start="36204" end="36277">
                      <STR_CONST line1="229" col1="22" line2="229" col2="95" start="36204" end="36277">"lib_size argument must have length equal to number of columns of object."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="229" col1="96" line2="229" col2="96" start="36278" end="36278">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="230" col1="9" line2="230" col2="9" start="36349" end="36349">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="231" col1="9" line2="232" col2="44" start="36507" end="36700">
              <expr line1="231" col1="9" line2="231" col2="17" start="36507" end="36515">
                <SYMBOL line1="231" col1="9" line2="231" col2="17" start="36507" end="36515">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="231" col1="19" line2="231" col2="20" start="36517" end="36518">&lt;-</LEFT_ASSIGN>
              <expr line1="231" col1="22" line2="232" col2="44" start="36520" end="36700">
                <expr line1="231" col1="22" line2="231" col2="31" start="36520" end="36529">
                  <SYMBOL_FUNCTION_CALL line1="231" col1="22" line2="231" col2="31" start="36520" end="36529">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="231" col1="32" line2="231" col2="32" start="36530" end="36530">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="231" col1="33" line2="231" col2="39" start="36531" end="36537">feature</SYMBOL_SUB>
                <EQ_SUB line1="231" col1="41" line2="231" col2="41" start="36539" end="36539">=</EQ_SUB>
                <expr line1="231" col1="43" line2="231" col2="71" start="36541" end="36569">
                  <expr line1="231" col1="43" line2="231" col2="55" start="36541" end="36553">
                    <expr line1="231" col1="43" line2="231" col2="47" start="36541" end="36545">
                      <SYMBOL_FUNCTION_CALL line1="231" col1="43" line2="231" col2="47" start="36541" end="36545">fData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="231" col1="48" line2="231" col2="48" start="36546" end="36546">(</OP-LEFT-PAREN>
                    <expr line1="231" col1="49" line2="231" col2="54" start="36547" end="36552">
                      <SYMBOL line1="231" col1="49" line2="231" col2="54" start="36547" end="36552">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="231" col1="55" line2="231" col2="55" start="36553" end="36553">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="231" col1="56" line2="231" col2="57" start="36554" end="36555">[[</LBB>
                  <expr line1="231" col1="58" line2="231" col2="69" start="36556" end="36567">
                    <SYMBOL line1="231" col1="58" line2="231" col2="69" start="36556" end="36567">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="231" col1="70" line2="231" col2="70" start="36568" end="36568">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="231" col1="71" line2="231" col2="71" start="36569" end="36569">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="231" col1="72" line2="231" col2="72" start="36570" end="36570">,</OP-COMMA>
                <expr line1="232" col1="33" line2="232" col2="43" start="36689" end="36699">
                  <expr line1="232" col1="33" line2="232" col2="35" start="36689" end="36691">
                    <SYMBOL_FUNCTION_CALL line1="232" col1="33" line2="232" col2="35" start="36689" end="36691">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="232" col1="36" line2="232" col2="36" start="36692" end="36692">(</OP-LEFT-PAREN>
                  <expr line1="232" col1="37" line2="232" col2="42" start="36693" end="36698">
                    <SYMBOL line1="232" col1="37" line2="232" col2="42" start="36693" end="36698">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="232" col1="43" line2="232" col2="43" start="36699" end="36699">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="232" col1="44" line2="232" col2="44" start="36700" end="36700">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="233" col1="9" line2="233" col2="51" start="36823" end="36865">
              <expr line1="233" col1="9" line2="233" col2="22" start="36823" end="36836">
                <SYMBOL line1="233" col1="9" line2="233" col2="22" start="36823" end="36836">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="233" col1="24" line2="233" col2="25" start="36838" end="36839">&lt;-</LEFT_ASSIGN>
              <expr line1="233" col1="27" line2="233" col2="51" start="36841" end="36865">
                <expr line1="233" col1="27" line2="233" col2="40" start="36841" end="36854">
                  <SYMBOL_PACKAGE line1="233" col1="27" line2="233" col2="34" start="36841" end="36848">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="233" col1="35" line2="233" col2="36" start="36849" end="36850">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="233" col1="37" line2="233" col2="40" start="36851" end="36854">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="233" col1="41" line2="233" col2="41" start="36855" end="36855">(</OP-LEFT-PAREN>
                <expr line1="233" col1="42" line2="233" col2="50" start="36856" end="36864">
                  <SYMBOL line1="233" col1="42" line2="233" col2="50" start="36856" end="36864">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="233" col1="51" line2="233" col2="51" start="36865" end="36865">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="234" col1="9" line2="234" col2="78" start="36981" end="37050">
              <expr line1="234" col1="9" line2="234" col2="18" start="36981" end="36990">
                <SYMBOL line1="234" col1="9" line2="234" col2="18" start="36981" end="36990">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="234" col1="20" line2="234" col2="21" start="36992" end="36993">&lt;-</LEFT_ASSIGN>
              <expr line1="234" col1="23" line2="234" col2="78" start="36995" end="37050">
                <expr line1="234" col1="23" line2="234" col2="37" start="36995" end="37009">
                  <SYMBOL_PACKAGE line1="234" col1="23" line2="234" col2="30" start="36995" end="37002">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="234" col1="31" line2="234" col2="32" start="37003" end="37004">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="234" col1="33" line2="234" col2="37" start="37005" end="37009">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="234" col1="38" line2="234" col2="38" start="37010" end="37010">(</OP-LEFT-PAREN>
                <expr line1="234" col1="39" line2="234" col2="52" start="37011" end="37024">
                  <SYMBOL line1="234" col1="39" line2="234" col2="52" start="37011" end="37024">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="234" col1="53" line2="234" col2="53" start="37025" end="37025">,</OP-COMMA>
                <expr line1="234" col1="55" line2="234" col2="72" start="37027" end="37044">
                  <expr line1="234" col1="55" line2="234" col2="61" start="37027" end="37033">
                    <SYMBOL line1="234" col1="55" line2="234" col2="61" start="37027" end="37033">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="234" col1="63" line2="234" col2="63" start="37035" end="37035">~</OP-TILDE>
                  <expr line1="234" col1="65" line2="234" col2="72" start="37037" end="37044">
                    <SYMBOL line1="234" col1="65" line2="234" col2="72" start="37037" end="37044">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="234" col1="73" line2="234" col2="73" start="37045" end="37045">,</OP-COMMA>
                <expr line1="234" col1="75" line2="234" col2="77" start="37047" end="37049">
                  <SYMBOL line1="234" col1="75" line2="234" col2="77" start="37047" end="37049">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="234" col1="78" line2="234" col2="78" start="37050" end="37050">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <COMMENT line1="235" col1="9" line2="235" col2="63" start="37139" end="37193">## scale TPM by total library size to get scaled counts</COMMENT>
            <expr line1="236" col1="9" line2="236" col2="57" start="37297" end="37345">
              <expr line1="236" col1="9" line2="236" col2="18" start="37297" end="37306">
                <SYMBOL line1="236" col1="9" line2="236" col2="18" start="37297" end="37306">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="236" col1="20" line2="236" col2="21" start="37308" end="37309">&lt;-</LEFT_ASSIGN>
              <expr line1="236" col1="23" line2="236" col2="57" start="37311" end="37345">
                <expr line1="236" col1="23" line2="236" col2="23" start="37311" end="37311">
                  <SYMBOL_FUNCTION_CALL line1="236" col1="23" line2="236" col2="23" start="37311" end="37311">t</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="236" col1="24" line2="236" col2="24" start="37312" end="37312">(</OP-LEFT-PAREN>
                <expr line1="236" col1="25" line2="236" col2="56" start="37313" end="37344">
                  <expr line1="236" col1="25" line2="236" col2="48" start="37313" end="37336">
                    <expr line1="236" col1="25" line2="236" col2="37" start="37313" end="37325">
                      <expr line1="236" col1="25" line2="236" col2="25" start="37313" end="37313">
                        <SYMBOL_FUNCTION_CALL line1="236" col1="25" line2="236" col2="25" start="37313" end="37313">t</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="236" col1="26" line2="236" col2="26" start="37314" end="37314">(</OP-LEFT-PAREN>
                      <expr line1="236" col1="27" line2="236" col2="36" start="37315" end="37324">
                        <SYMBOL line1="236" col1="27" line2="236" col2="36" start="37315" end="37324">counts_new</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="236" col1="37" line2="236" col2="37" start="37325" end="37325">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-STAR line1="236" col1="39" line2="236" col2="39" start="37327" end="37327">*</OP-STAR>
                    <expr line1="236" col1="41" line2="236" col2="48" start="37329" end="37336">
                      <SYMBOL line1="236" col1="41" line2="236" col2="48" start="37329" end="37336">lib_size</SYMBOL>
                    </expr>
                  </expr>
                  <OP-STAR line1="236" col1="50" line2="236" col2="50" start="37338" end="37338">*</OP-STAR>
                  <expr line1="236" col1="52" line2="236" col2="56" start="37340" end="37344">
                    <NUM_CONST line1="236" col1="52" line2="236" col2="56" start="37340" end="37344">1e-06</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="236" col1="57" line2="236" col2="57" start="37345" end="37345">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="237" col1="9" line2="237" col2="51" start="37455" end="37497">
              <expr line1="237" col1="9" line2="237" col2="28" start="37455" end="37474">
                <expr line1="237" col1="9" line2="237" col2="16" start="37455" end="37462">
                  <SYMBOL_FUNCTION_CALL line1="237" col1="9" line2="237" col2="16" start="37455" end="37462">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="237" col1="17" line2="237" col2="17" start="37463" end="37463">(</OP-LEFT-PAREN>
                <expr line1="237" col1="18" line2="237" col2="27" start="37464" end="37473">
                  <SYMBOL line1="237" col1="18" line2="237" col2="27" start="37464" end="37473">counts_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="237" col1="28" line2="237" col2="28" start="37474" end="37474">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="237" col1="30" line2="237" col2="31" start="37476" end="37477">&lt;-</LEFT_ASSIGN>
              <expr line1="237" col1="33" line2="237" col2="51" start="37479" end="37497">
                <expr line1="237" col1="33" line2="237" col2="43" start="37479" end="37489">
                  <SYMBOL_FUNCTION_CALL line1="237" col1="33" line2="237" col2="43" start="37479" end="37489">sampleNames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="237" col1="44" line2="237" col2="44" start="37490" end="37490">(</OP-LEFT-PAREN>
                <expr line1="237" col1="45" line2="237" col2="50" start="37491" end="37496">
                  <SYMBOL line1="237" col1="45" line2="237" col2="50" start="37491" end="37496">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="237" col1="51" line2="237" col2="51" start="37497" end="37497">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="238" col1="9" line2="238" col2="37" start="37613" end="37641">
              <expr line1="238" col1="9" line2="238" col2="23" start="37613" end="37627">
                <expr line1="238" col1="9" line2="238" col2="14" start="37613" end="37618">
                  <SYMBOL_FUNCTION_CALL line1="238" col1="9" line2="238" col2="14" start="37613" end="37618">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="238" col1="15" line2="238" col2="15" start="37619" end="37619">(</OP-LEFT-PAREN>
                <expr line1="238" col1="16" line2="238" col2="22" start="37620" end="37626">
                  <SYMBOL line1="238" col1="16" line2="238" col2="22" start="37620" end="37626">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="238" col1="23" line2="238" col2="23" start="37627" end="37627">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="238" col1="25" line2="238" col2="26" start="37629" end="37630">&lt;-</LEFT_ASSIGN>
              <expr line1="238" col1="28" line2="238" col2="37" start="37632" end="37641">
                <SYMBOL line1="238" col1="28" line2="238" col2="37" start="37632" end="37641">counts_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="239" col1="9" line2="239" col2="22" start="37771" end="37784">
              <expr line1="239" col1="9" line2="239" col2="10" start="37771" end="37772">
                <SYMBOL_FUNCTION_CALL line1="239" col1="9" line2="239" col2="10" start="37771" end="37772">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="239" col1="11" line2="239" col2="11" start="37773" end="37773">(</OP-LEFT-PAREN>
              <expr line1="239" col1="12" line2="239" col2="21" start="37774" end="37783">
                <SYMBOL line1="239" col1="12" line2="239" col2="21" start="37774" end="37783">counts_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="239" col1="22" line2="239" col2="22" start="37784" end="37784">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="240" col1="5" line2="240" col2="5" start="37925" end="37925">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="240" col1="7" line2="240" col2="10" start="37927" end="37930">else</ELSE>
          <expr line1="240" col1="12" line2="250" col2="5" start="37932" end="39505">
            <OP-LEFT-BRACE line1="240" col1="12" line2="240" col2="12" start="37932" end="37932">{</OP-LEFT-BRACE>
            <expr line1="241" col1="9" line2="249" col2="9" start="38087" end="39351">
              <IF line1="241" col1="9" line2="241" col2="10" start="38087" end="38088">if</IF>
              <OP-LEFT-PAREN line1="241" col1="12" line2="241" col2="12" start="38090" end="38090">(</OP-LEFT-PAREN>
              <expr line1="241" col1="14" line2="241" col2="65" start="38092" end="38143">
                <expr line1="241" col1="14" line2="241" col2="37" start="38092" end="38115">
                  <expr line1="241" col1="14" line2="241" col2="25" start="38092" end="38103">
                    <SYMBOL line1="241" col1="14" line2="241" col2="25" start="38092" end="38103">exprs_values</SYMBOL>
                  </expr>
                  <NE line1="241" col1="27" line2="241" col2="28" start="38105" end="38106">!=</NE>
                  <expr line1="241" col1="30" line2="241" col2="37" start="38108" end="38115">
                    <STR_CONST line1="241" col1="30" line2="241" col2="37" start="38108" end="38115">"counts"</STR_CONST>
                  </expr>
                </expr>
                <AND2 line1="241" col1="39" line2="241" col2="40" start="38117" end="38118">&amp;&amp;</AND2>
                <expr line1="241" col1="42" line2="241" col2="65" start="38120" end="38143">
                  <OP-EXCLAMATION line1="241" col1="42" line2="241" col2="42" start="38120" end="38120">!</OP-EXCLAMATION>
                  <expr line1="241" col1="43" line2="241" col2="65" start="38121" end="38143">
                    <expr line1="241" col1="43" line2="241" col2="49" start="38121" end="38127">
                      <SYMBOL_FUNCTION_CALL line1="241" col1="43" line2="241" col2="49" start="38121" end="38127">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="241" col1="50" line2="241" col2="50" start="38128" end="38128">(</OP-LEFT-PAREN>
                    <expr line1="241" col1="51" line2="241" col2="64" start="38129" end="38142">
                      <expr line1="241" col1="51" line2="241" col2="56" start="38129" end="38134">
                        <SYMBOL_FUNCTION_CALL line1="241" col1="51" line2="241" col2="56" start="38129" end="38134">counts</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="241" col1="57" line2="241" col2="57" start="38135" end="38135">(</OP-LEFT-PAREN>
                      <expr line1="241" col1="58" line2="241" col2="63" start="38136" end="38141">
                        <SYMBOL line1="241" col1="58" line2="241" col2="63" start="38136" end="38141">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="241" col1="64" line2="241" col2="64" start="38142" end="38142">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="241" col1="65" line2="241" col2="65" start="38143" end="38143">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="241" col1="67" line2="241" col2="67" start="38145" end="38145">)</OP-RIGHT-PAREN>
              <expr line1="241" col1="69" line2="249" col2="9" start="38147" end="39351">
                <OP-LEFT-BRACE line1="241" col1="69" line2="241" col2="69" start="38147" end="38147">{</OP-LEFT-BRACE>
                <expr line1="242" col1="13" line2="243" col2="51" start="38249" end="38445">
                  <expr line1="242" col1="13" line2="242" col2="21" start="38249" end="38257">
                    <SYMBOL line1="242" col1="13" line2="242" col2="21" start="38249" end="38257">tmp_exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="242" col1="23" line2="242" col2="24" start="38259" end="38260">&lt;-</LEFT_ASSIGN>
                  <expr line1="242" col1="26" line2="243" col2="51" start="38262" end="38445">
                    <expr line1="242" col1="26" line2="242" col2="35" start="38262" end="38271">
                      <SYMBOL_FUNCTION_CALL line1="242" col1="26" line2="242" col2="35" start="38262" end="38271">data.frame</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="242" col1="36" line2="242" col2="36" start="38272" end="38272">(</OP-LEFT-PAREN>
                    <SYMBOL_SUB line1="242" col1="37" line2="242" col2="43" start="38273" end="38279">feature</SYMBOL_SUB>
                    <EQ_SUB line1="242" col1="45" line2="242" col2="45" start="38281" end="38281">=</EQ_SUB>
                    <expr line1="242" col1="47" line2="242" col2="75" start="38283" end="38311">
                      <expr line1="242" col1="47" line2="242" col2="59" start="38283" end="38295">
                        <expr line1="242" col1="47" line2="242" col2="51" start="38283" end="38287">
                          <SYMBOL_FUNCTION_CALL line1="242" col1="47" line2="242" col2="51" start="38283" end="38287">fData</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="242" col1="52" line2="242" col2="52" start="38288" end="38288">(</OP-LEFT-PAREN>
                        <expr line1="242" col1="53" line2="242" col2="58" start="38289" end="38294">
                          <SYMBOL line1="242" col1="53" line2="242" col2="58" start="38289" end="38294">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="242" col1="59" line2="242" col2="59" start="38295" end="38295">)</OP-RIGHT-PAREN>
                      </expr>
                      <LBB line1="242" col1="60" line2="242" col2="61" start="38296" end="38297">[[</LBB>
                      <expr line1="242" col1="62" line2="242" col2="73" start="38298" end="38309">
                        <SYMBOL line1="242" col1="62" line2="242" col2="73" start="38298" end="38309">summarise_by</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="242" col1="74" line2="242" col2="74" start="38310" end="38310">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="242" col1="75" line2="242" col2="75" start="38311" end="38311">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="242" col1="76" line2="242" col2="76" start="38312" end="38312">,</OP-COMMA>
                    <expr line1="243" col1="37" line2="243" col2="50" start="38431" end="38444">
                      <expr line1="243" col1="37" line2="243" col2="42" start="38431" end="38436">
                        <SYMBOL_FUNCTION_CALL line1="243" col1="37" line2="243" col2="42" start="38431" end="38436">counts</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="243" col1="43" line2="243" col2="43" start="38437" end="38437">(</OP-LEFT-PAREN>
                      <expr line1="243" col1="44" line2="243" col2="49" start="38438" end="38443">
                        <SYMBOL line1="243" col1="44" line2="243" col2="49" start="38438" end="38443">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="243" col1="50" line2="243" col2="50" start="38444" end="38444">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="243" col1="51" line2="243" col2="51" start="38445" end="38445">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="244" col1="13" line2="244" col2="55" start="38565" end="38607">
                  <expr line1="244" col1="13" line2="244" col2="26" start="38565" end="38578">
                    <SYMBOL line1="244" col1="13" line2="244" col2="26" start="38565" end="38578">tmp_exprs_long</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="244" col1="28" line2="244" col2="29" start="38580" end="38581">&lt;-</LEFT_ASSIGN>
                  <expr line1="244" col1="31" line2="244" col2="55" start="38583" end="38607">
                    <expr line1="244" col1="31" line2="244" col2="44" start="38583" end="38596">
                      <SYMBOL_PACKAGE line1="244" col1="31" line2="244" col2="38" start="38583" end="38590">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="244" col1="39" line2="244" col2="40" start="38591" end="38592">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="244" col1="41" line2="244" col2="44" start="38593" end="38596">melt</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="244" col1="45" line2="244" col2="45" start="38597" end="38597">(</OP-LEFT-PAREN>
                    <expr line1="244" col1="46" line2="244" col2="54" start="38598" end="38606">
                      <SYMBOL line1="244" col1="46" line2="244" col2="54" start="38598" end="38606">tmp_exprs</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="244" col1="55" line2="244" col2="55" start="38607" end="38607">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="245" col1="13" line2="245" col2="82" start="38723" end="38792">
                  <expr line1="245" col1="13" line2="245" col2="22" start="38723" end="38732">
                    <SYMBOL line1="245" col1="13" line2="245" col2="22" start="38723" end="38732">counts_new</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="245" col1="24" line2="245" col2="25" start="38734" end="38735">&lt;-</LEFT_ASSIGN>
                  <expr line1="245" col1="27" line2="245" col2="82" start="38737" end="38792">
                    <expr line1="245" col1="27" line2="245" col2="41" start="38737" end="38751">
                      <SYMBOL_PACKAGE line1="245" col1="27" line2="245" col2="34" start="38737" end="38744">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="245" col1="35" line2="245" col2="36" start="38745" end="38746">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="245" col1="37" line2="245" col2="41" start="38747" end="38751">acast</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="245" col1="42" line2="245" col2="42" start="38752" end="38752">(</OP-LEFT-PAREN>
                    <expr line1="245" col1="43" line2="245" col2="56" start="38753" end="38766">
                      <SYMBOL line1="245" col1="43" line2="245" col2="56" start="38753" end="38766">tmp_exprs_long</SYMBOL>
                    </expr>
                    <OP-COMMA line1="245" col1="57" line2="245" col2="57" start="38767" end="38767">,</OP-COMMA>
                    <expr line1="245" col1="59" line2="245" col2="76" start="38769" end="38786">
                      <expr line1="245" col1="59" line2="245" col2="65" start="38769" end="38775">
                        <SYMBOL line1="245" col1="59" line2="245" col2="65" start="38769" end="38775">feature</SYMBOL>
                      </expr>
                      <OP-TILDE line1="245" col1="67" line2="245" col2="67" start="38777" end="38777">~</OP-TILDE>
                      <expr line1="245" col1="69" line2="245" col2="76" start="38779" end="38786">
                        <SYMBOL line1="245" col1="69" line2="245" col2="76" start="38779" end="38786">variable</SYMBOL>
                      </expr>
                    </expr>
                    <OP-COMMA line1="245" col1="77" line2="245" col2="77" start="38787" end="38787">,</OP-COMMA>
                    <expr line1="245" col1="79" line2="245" col2="81" start="38789" end="38791">
                      <SYMBOL line1="245" col1="79" line2="245" col2="81" start="38789" end="38791">sum</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="245" col1="82" line2="245" col2="82" start="38792" end="38792">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="246" col1="13" line2="246" col2="55" start="38881" end="38923">
                  <expr line1="246" col1="13" line2="246" col2="32" start="38881" end="38900">
                    <expr line1="246" col1="13" line2="246" col2="20" start="38881" end="38888">
                      <SYMBOL_FUNCTION_CALL line1="246" col1="13" line2="246" col2="20" start="38881" end="38888">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="246" col1="21" line2="246" col2="21" start="38889" end="38889">(</OP-LEFT-PAREN>
                    <expr line1="246" col1="22" line2="246" col2="31" start="38890" end="38899">
                      <SYMBOL line1="246" col1="22" line2="246" col2="31" start="38890" end="38899">counts_new</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="246" col1="32" line2="246" col2="32" start="38900" end="38900">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="246" col1="34" line2="246" col2="35" start="38902" end="38903">&lt;-</LEFT_ASSIGN>
                  <expr line1="246" col1="37" line2="246" col2="55" start="38905" end="38923">
                    <expr line1="246" col1="37" line2="246" col2="47" start="38905" end="38915">
                      <SYMBOL_FUNCTION_CALL line1="246" col1="37" line2="246" col2="47" start="38905" end="38915">sampleNames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="246" col1="48" line2="246" col2="48" start="38916" end="38916">(</OP-LEFT-PAREN>
                    <expr line1="246" col1="49" line2="246" col2="54" start="38917" end="38922">
                      <SYMBOL line1="246" col1="49" line2="246" col2="54" start="38917" end="38922">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="246" col1="55" line2="246" col2="55" start="38923" end="38923">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="247" col1="13" line2="247" col2="41" start="39039" end="39067">
                  <expr line1="247" col1="13" line2="247" col2="27" start="39039" end="39053">
                    <expr line1="247" col1="13" line2="247" col2="18" start="39039" end="39044">
                      <SYMBOL_FUNCTION_CALL line1="247" col1="13" line2="247" col2="18" start="39039" end="39044">counts</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="247" col1="19" line2="247" col2="19" start="39045" end="39045">(</OP-LEFT-PAREN>
                    <expr line1="247" col1="20" line2="247" col2="26" start="39046" end="39052">
                      <SYMBOL line1="247" col1="20" line2="247" col2="26" start="39046" end="39052">sce_out</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="247" col1="27" line2="247" col2="27" start="39053" end="39053">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="247" col1="29" line2="247" col2="30" start="39055" end="39056">&lt;-</LEFT_ASSIGN>
                  <expr line1="247" col1="32" line2="247" col2="41" start="39058" end="39067">
                    <SYMBOL line1="247" col1="32" line2="247" col2="41" start="39058" end="39067">counts_new</SYMBOL>
                  </expr>
                </expr>
                <expr line1="248" col1="13" line2="248" col2="26" start="39197" end="39210">
                  <expr line1="248" col1="13" line2="248" col2="14" start="39197" end="39198">
                    <SYMBOL_FUNCTION_CALL line1="248" col1="13" line2="248" col2="14" start="39197" end="39198">rm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="248" col1="15" line2="248" col2="15" start="39199" end="39199">(</OP-LEFT-PAREN>
                  <expr line1="248" col1="16" line2="248" col2="25" start="39200" end="39209">
                    <SYMBOL line1="248" col1="16" line2="248" col2="25" start="39200" end="39209">counts_new</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="248" col1="26" line2="248" col2="26" start="39210" end="39210">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="249" col1="9" line2="249" col2="9" start="39351" end="39351">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="250" col1="5" line2="250" col2="5" start="39505" end="39505">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="251" col1="5" line2="259" col2="5" start="39663" end="40927">
          <IF line1="251" col1="5" line2="251" col2="6" start="39663" end="39664">if</IF>
          <OP-LEFT-PAREN line1="251" col1="8" line2="251" col2="8" start="39666" end="39666">(</OP-LEFT-PAREN>
          <expr line1="251" col1="10" line2="251" col2="55" start="39668" end="39713">
            <expr line1="251" col1="10" line2="251" col2="30" start="39668" end="39688">
              <expr line1="251" col1="10" line2="251" col2="21" start="39668" end="39679">
                <SYMBOL line1="251" col1="10" line2="251" col2="21" start="39668" end="39679">exprs_values</SYMBOL>
              </expr>
              <NE line1="251" col1="23" line2="251" col2="24" start="39681" end="39682">!=</NE>
              <expr line1="251" col1="26" line2="251" col2="30" start="39684" end="39688">
                <STR_CONST line1="251" col1="26" line2="251" col2="30" start="39684" end="39688">"tpm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="251" col1="32" line2="251" col2="33" start="39690" end="39691">&amp;&amp;</AND2>
            <expr line1="251" col1="35" line2="251" col2="55" start="39693" end="39713">
              <OP-EXCLAMATION line1="251" col1="35" line2="251" col2="35" start="39693" end="39693">!</OP-EXCLAMATION>
              <expr line1="251" col1="36" line2="251" col2="55" start="39694" end="39713">
                <expr line1="251" col1="36" line2="251" col2="42" start="39694" end="39700">
                  <SYMBOL_FUNCTION_CALL line1="251" col1="36" line2="251" col2="42" start="39694" end="39700">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="251" col1="43" line2="251" col2="43" start="39701" end="39701">(</OP-LEFT-PAREN>
                <expr line1="251" col1="44" line2="251" col2="54" start="39702" end="39712">
                  <expr line1="251" col1="44" line2="251" col2="46" start="39702" end="39704">
                    <SYMBOL_FUNCTION_CALL line1="251" col1="44" line2="251" col2="46" start="39702" end="39704">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="251" col1="47" line2="251" col2="47" start="39705" end="39705">(</OP-LEFT-PAREN>
                  <expr line1="251" col1="48" line2="251" col2="53" start="39706" end="39711">
                    <SYMBOL line1="251" col1="48" line2="251" col2="53" start="39706" end="39711">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="251" col1="54" line2="251" col2="54" start="39712" end="39712">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="251" col1="55" line2="251" col2="55" start="39713" end="39713">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="251" col1="57" line2="251" col2="57" start="39715" end="39715">)</OP-RIGHT-PAREN>
          <expr line1="251" col1="59" line2="259" col2="5" start="39717" end="40927">
            <OP-LEFT-BRACE line1="251" col1="59" line2="251" col2="59" start="39717" end="39717">{</OP-LEFT-BRACE>
            <expr line1="252" col1="9" line2="253" col2="44" start="39825" end="40018">
              <expr line1="252" col1="9" line2="252" col2="17" start="39825" end="39833">
                <SYMBOL line1="252" col1="9" line2="252" col2="17" start="39825" end="39833">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="252" col1="19" line2="252" col2="20" start="39835" end="39836">&lt;-</LEFT_ASSIGN>
              <expr line1="252" col1="22" line2="253" col2="44" start="39838" end="40018">
                <expr line1="252" col1="22" line2="252" col2="31" start="39838" end="39847">
                  <SYMBOL_FUNCTION_CALL line1="252" col1="22" line2="252" col2="31" start="39838" end="39847">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="252" col1="32" line2="252" col2="32" start="39848" end="39848">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="252" col1="33" line2="252" col2="39" start="39849" end="39855">feature</SYMBOL_SUB>
                <EQ_SUB line1="252" col1="41" line2="252" col2="41" start="39857" end="39857">=</EQ_SUB>
                <expr line1="252" col1="43" line2="252" col2="71" start="39859" end="39887">
                  <expr line1="252" col1="43" line2="252" col2="55" start="39859" end="39871">
                    <expr line1="252" col1="43" line2="252" col2="47" start="39859" end="39863">
                      <SYMBOL_FUNCTION_CALL line1="252" col1="43" line2="252" col2="47" start="39859" end="39863">fData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="252" col1="48" line2="252" col2="48" start="39864" end="39864">(</OP-LEFT-PAREN>
                    <expr line1="252" col1="49" line2="252" col2="54" start="39865" end="39870">
                      <SYMBOL line1="252" col1="49" line2="252" col2="54" start="39865" end="39870">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="252" col1="55" line2="252" col2="55" start="39871" end="39871">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="252" col1="56" line2="252" col2="57" start="39872" end="39873">[[</LBB>
                  <expr line1="252" col1="58" line2="252" col2="69" start="39874" end="39885">
                    <SYMBOL line1="252" col1="58" line2="252" col2="69" start="39874" end="39885">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="252" col1="70" line2="252" col2="70" start="39886" end="39886">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="252" col1="71" line2="252" col2="71" start="39887" end="39887">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="252" col1="72" line2="252" col2="72" start="39888" end="39888">,</OP-COMMA>
                <expr line1="253" col1="33" line2="253" col2="43" start="40007" end="40017">
                  <expr line1="253" col1="33" line2="253" col2="35" start="40007" end="40009">
                    <SYMBOL_FUNCTION_CALL line1="253" col1="33" line2="253" col2="35" start="40007" end="40009">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="253" col1="36" line2="253" col2="36" start="40010" end="40010">(</OP-LEFT-PAREN>
                  <expr line1="253" col1="37" line2="253" col2="42" start="40011" end="40016">
                    <SYMBOL line1="253" col1="37" line2="253" col2="42" start="40011" end="40016">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="253" col1="43" line2="253" col2="43" start="40017" end="40017">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="253" col1="44" line2="253" col2="44" start="40018" end="40018">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="254" col1="9" line2="254" col2="51" start="40141" end="40183">
              <expr line1="254" col1="9" line2="254" col2="22" start="40141" end="40154">
                <SYMBOL line1="254" col1="9" line2="254" col2="22" start="40141" end="40154">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="254" col1="24" line2="254" col2="25" start="40156" end="40157">&lt;-</LEFT_ASSIGN>
              <expr line1="254" col1="27" line2="254" col2="51" start="40159" end="40183">
                <expr line1="254" col1="27" line2="254" col2="40" start="40159" end="40172">
                  <SYMBOL_PACKAGE line1="254" col1="27" line2="254" col2="34" start="40159" end="40166">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="254" col1="35" line2="254" col2="36" start="40167" end="40168">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="254" col1="37" line2="254" col2="40" start="40169" end="40172">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="254" col1="41" line2="254" col2="41" start="40173" end="40173">(</OP-LEFT-PAREN>
                <expr line1="254" col1="42" line2="254" col2="50" start="40174" end="40182">
                  <SYMBOL line1="254" col1="42" line2="254" col2="50" start="40174" end="40182">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="254" col1="51" line2="254" col2="51" start="40183" end="40183">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="255" col1="9" line2="255" col2="75" start="40299" end="40365">
              <expr line1="255" col1="9" line2="255" col2="15" start="40299" end="40305">
                <SYMBOL line1="255" col1="9" line2="255" col2="15" start="40299" end="40305">tpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="255" col1="17" line2="255" col2="18" start="40307" end="40308">&lt;-</LEFT_ASSIGN>
              <expr line1="255" col1="20" line2="255" col2="75" start="40310" end="40365">
                <expr line1="255" col1="20" line2="255" col2="34" start="40310" end="40324">
                  <SYMBOL_PACKAGE line1="255" col1="20" line2="255" col2="27" start="40310" end="40317">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="255" col1="28" line2="255" col2="29" start="40318" end="40319">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="255" col1="30" line2="255" col2="34" start="40320" end="40324">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="255" col1="35" line2="255" col2="35" start="40325" end="40325">(</OP-LEFT-PAREN>
                <expr line1="255" col1="36" line2="255" col2="49" start="40326" end="40339">
                  <SYMBOL line1="255" col1="36" line2="255" col2="49" start="40326" end="40339">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="255" col1="50" line2="255" col2="50" start="40340" end="40340">,</OP-COMMA>
                <expr line1="255" col1="52" line2="255" col2="69" start="40342" end="40359">
                  <expr line1="255" col1="52" line2="255" col2="58" start="40342" end="40348">
                    <SYMBOL line1="255" col1="52" line2="255" col2="58" start="40342" end="40348">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="255" col1="60" line2="255" col2="60" start="40350" end="40350">~</OP-TILDE>
                  <expr line1="255" col1="62" line2="255" col2="69" start="40352" end="40359">
                    <SYMBOL line1="255" col1="62" line2="255" col2="69" start="40352" end="40359">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="255" col1="70" line2="255" col2="70" start="40360" end="40360">,</OP-COMMA>
                <expr line1="255" col1="72" line2="255" col2="74" start="40362" end="40364">
                  <SYMBOL line1="255" col1="72" line2="255" col2="74" start="40362" end="40364">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="255" col1="75" line2="255" col2="75" start="40365" end="40365">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="256" col1="9" line2="256" col2="48" start="40457" end="40496">
              <expr line1="256" col1="9" line2="256" col2="25" start="40457" end="40473">
                <expr line1="256" col1="9" line2="256" col2="16" start="40457" end="40464">
                  <SYMBOL_FUNCTION_CALL line1="256" col1="9" line2="256" col2="16" start="40457" end="40464">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="256" col1="17" line2="256" col2="17" start="40465" end="40465">(</OP-LEFT-PAREN>
                <expr line1="256" col1="18" line2="256" col2="24" start="40466" end="40472">
                  <SYMBOL line1="256" col1="18" line2="256" col2="24" start="40466" end="40472">tpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="256" col1="25" line2="256" col2="25" start="40473" end="40473">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="256" col1="27" line2="256" col2="28" start="40475" end="40476">&lt;-</LEFT_ASSIGN>
              <expr line1="256" col1="30" line2="256" col2="48" start="40478" end="40496">
                <expr line1="256" col1="30" line2="256" col2="40" start="40478" end="40488">
                  <SYMBOL_FUNCTION_CALL line1="256" col1="30" line2="256" col2="40" start="40478" end="40488">sampleNames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="256" col1="41" line2="256" col2="41" start="40489" end="40489">(</OP-LEFT-PAREN>
                <expr line1="256" col1="42" line2="256" col2="47" start="40490" end="40495">
                  <SYMBOL line1="256" col1="42" line2="256" col2="47" start="40490" end="40495">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="256" col1="48" line2="256" col2="48" start="40496" end="40496">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="257" col1="9" line2="257" col2="31" start="40615" end="40637">
              <expr line1="257" col1="9" line2="257" col2="20" start="40615" end="40626">
                <expr line1="257" col1="9" line2="257" col2="11" start="40615" end="40617">
                  <SYMBOL_FUNCTION_CALL line1="257" col1="9" line2="257" col2="11" start="40615" end="40617">tpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="257" col1="12" line2="257" col2="12" start="40618" end="40618">(</OP-LEFT-PAREN>
                <expr line1="257" col1="13" line2="257" col2="19" start="40619" end="40625">
                  <SYMBOL line1="257" col1="13" line2="257" col2="19" start="40619" end="40625">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="257" col1="20" line2="257" col2="20" start="40626" end="40626">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="257" col1="22" line2="257" col2="23" start="40628" end="40629">&lt;-</LEFT_ASSIGN>
              <expr line1="257" col1="25" line2="257" col2="31" start="40631" end="40637">
                <SYMBOL line1="257" col1="25" line2="257" col2="31" start="40631" end="40637">tpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="258" col1="9" line2="258" col2="19" start="40773" end="40783">
              <expr line1="258" col1="9" line2="258" col2="10" start="40773" end="40774">
                <SYMBOL_FUNCTION_CALL line1="258" col1="9" line2="258" col2="10" start="40773" end="40774">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="258" col1="11" line2="258" col2="11" start="40775" end="40775">(</OP-LEFT-PAREN>
              <expr line1="258" col1="12" line2="258" col2="18" start="40776" end="40782">
                <SYMBOL line1="258" col1="12" line2="258" col2="18" start="40776" end="40782">tpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="258" col1="19" line2="258" col2="19" start="40783" end="40783">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="259" col1="5" line2="259" col2="5" start="40927" end="40927">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="260" col1="5" line2="268" col2="5" start="41085" end="42349">
          <IF line1="260" col1="5" line2="260" col2="6" start="41085" end="41086">if</IF>
          <OP-LEFT-PAREN line1="260" col1="8" line2="260" col2="8" start="41088" end="41088">(</OP-LEFT-PAREN>
          <expr line1="260" col1="10" line2="260" col2="57" start="41090" end="41137">
            <expr line1="260" col1="10" line2="260" col2="31" start="41090" end="41111">
              <expr line1="260" col1="10" line2="260" col2="21" start="41090" end="41101">
                <SYMBOL line1="260" col1="10" line2="260" col2="21" start="41090" end="41101">exprs_values</SYMBOL>
              </expr>
              <NE line1="260" col1="23" line2="260" col2="24" start="41103" end="41104">!=</NE>
              <expr line1="260" col1="26" line2="260" col2="31" start="41106" end="41111">
                <STR_CONST line1="260" col1="26" line2="260" col2="31" start="41106" end="41111">"fpkm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="260" col1="33" line2="260" col2="34" start="41113" end="41114">&amp;&amp;</AND2>
            <expr line1="260" col1="36" line2="260" col2="57" start="41116" end="41137">
              <OP-EXCLAMATION line1="260" col1="36" line2="260" col2="36" start="41116" end="41116">!</OP-EXCLAMATION>
              <expr line1="260" col1="37" line2="260" col2="57" start="41117" end="41137">
                <expr line1="260" col1="37" line2="260" col2="43" start="41117" end="41123">
                  <SYMBOL_FUNCTION_CALL line1="260" col1="37" line2="260" col2="43" start="41117" end="41123">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="260" col1="44" line2="260" col2="44" start="41124" end="41124">(</OP-LEFT-PAREN>
                <expr line1="260" col1="45" line2="260" col2="56" start="41125" end="41136">
                  <expr line1="260" col1="45" line2="260" col2="48" start="41125" end="41128">
                    <SYMBOL_FUNCTION_CALL line1="260" col1="45" line2="260" col2="48" start="41125" end="41128">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="260" col1="49" line2="260" col2="49" start="41129" end="41129">(</OP-LEFT-PAREN>
                  <expr line1="260" col1="50" line2="260" col2="55" start="41130" end="41135">
                    <SYMBOL line1="260" col1="50" line2="260" col2="55" start="41130" end="41135">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="260" col1="56" line2="260" col2="56" start="41136" end="41136">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="260" col1="57" line2="260" col2="57" start="41137" end="41137">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="260" col1="59" line2="260" col2="59" start="41139" end="41139">)</OP-RIGHT-PAREN>
          <expr line1="260" col1="61" line2="268" col2="5" start="41141" end="42349">
            <OP-LEFT-BRACE line1="260" col1="61" line2="260" col2="61" start="41141" end="41141">{</OP-LEFT-BRACE>
            <expr line1="261" col1="9" line2="262" col2="45" start="41247" end="41441">
              <expr line1="261" col1="9" line2="261" col2="17" start="41247" end="41255">
                <SYMBOL line1="261" col1="9" line2="261" col2="17" start="41247" end="41255">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="261" col1="19" line2="261" col2="20" start="41257" end="41258">&lt;-</LEFT_ASSIGN>
              <expr line1="261" col1="22" line2="262" col2="45" start="41260" end="41441">
                <expr line1="261" col1="22" line2="261" col2="31" start="41260" end="41269">
                  <SYMBOL_FUNCTION_CALL line1="261" col1="22" line2="261" col2="31" start="41260" end="41269">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="261" col1="32" line2="261" col2="32" start="41270" end="41270">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="261" col1="33" line2="261" col2="39" start="41271" end="41277">feature</SYMBOL_SUB>
                <EQ_SUB line1="261" col1="41" line2="261" col2="41" start="41279" end="41279">=</EQ_SUB>
                <expr line1="261" col1="43" line2="261" col2="71" start="41281" end="41309">
                  <expr line1="261" col1="43" line2="261" col2="55" start="41281" end="41293">
                    <expr line1="261" col1="43" line2="261" col2="47" start="41281" end="41285">
                      <SYMBOL_FUNCTION_CALL line1="261" col1="43" line2="261" col2="47" start="41281" end="41285">fData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="261" col1="48" line2="261" col2="48" start="41286" end="41286">(</OP-LEFT-PAREN>
                    <expr line1="261" col1="49" line2="261" col2="54" start="41287" end="41292">
                      <SYMBOL line1="261" col1="49" line2="261" col2="54" start="41287" end="41292">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="261" col1="55" line2="261" col2="55" start="41293" end="41293">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="261" col1="56" line2="261" col2="57" start="41294" end="41295">[[</LBB>
                  <expr line1="261" col1="58" line2="261" col2="69" start="41296" end="41307">
                    <SYMBOL line1="261" col1="58" line2="261" col2="69" start="41296" end="41307">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="261" col1="70" line2="261" col2="70" start="41308" end="41308">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="261" col1="71" line2="261" col2="71" start="41309" end="41309">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="261" col1="72" line2="261" col2="72" start="41310" end="41310">,</OP-COMMA>
                <expr line1="262" col1="33" line2="262" col2="44" start="41429" end="41440">
                  <expr line1="262" col1="33" line2="262" col2="36" start="41429" end="41432">
                    <SYMBOL_FUNCTION_CALL line1="262" col1="33" line2="262" col2="36" start="41429" end="41432">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="262" col1="37" line2="262" col2="37" start="41433" end="41433">(</OP-LEFT-PAREN>
                  <expr line1="262" col1="38" line2="262" col2="43" start="41434" end="41439">
                    <SYMBOL line1="262" col1="38" line2="262" col2="43" start="41434" end="41439">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="262" col1="44" line2="262" col2="44" start="41440" end="41440">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="262" col1="45" line2="262" col2="45" start="41441" end="41441">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="263" col1="9" line2="263" col2="51" start="41563" end="41605">
              <expr line1="263" col1="9" line2="263" col2="22" start="41563" end="41576">
                <SYMBOL line1="263" col1="9" line2="263" col2="22" start="41563" end="41576">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="263" col1="24" line2="263" col2="25" start="41578" end="41579">&lt;-</LEFT_ASSIGN>
              <expr line1="263" col1="27" line2="263" col2="51" start="41581" end="41605">
                <expr line1="263" col1="27" line2="263" col2="40" start="41581" end="41594">
                  <SYMBOL_PACKAGE line1="263" col1="27" line2="263" col2="34" start="41581" end="41588">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="263" col1="35" line2="263" col2="36" start="41589" end="41590">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="263" col1="37" line2="263" col2="40" start="41591" end="41594">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="263" col1="41" line2="263" col2="41" start="41595" end="41595">(</OP-LEFT-PAREN>
                <expr line1="263" col1="42" line2="263" col2="50" start="41596" end="41604">
                  <SYMBOL line1="263" col1="42" line2="263" col2="50" start="41596" end="41604">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="263" col1="51" line2="263" col2="51" start="41605" end="41605">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="264" col1="9" line2="264" col2="76" start="41721" end="41788">
              <expr line1="264" col1="9" line2="264" col2="16" start="41721" end="41728">
                <SYMBOL line1="264" col1="9" line2="264" col2="16" start="41721" end="41728">fpkm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="264" col1="18" line2="264" col2="19" start="41730" end="41731">&lt;-</LEFT_ASSIGN>
              <expr line1="264" col1="21" line2="264" col2="76" start="41733" end="41788">
                <expr line1="264" col1="21" line2="264" col2="35" start="41733" end="41747">
                  <SYMBOL_PACKAGE line1="264" col1="21" line2="264" col2="28" start="41733" end="41740">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="264" col1="29" line2="264" col2="30" start="41741" end="41742">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="264" col1="31" line2="264" col2="35" start="41743" end="41747">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="264" col1="36" line2="264" col2="36" start="41748" end="41748">(</OP-LEFT-PAREN>
                <expr line1="264" col1="37" line2="264" col2="50" start="41749" end="41762">
                  <SYMBOL line1="264" col1="37" line2="264" col2="50" start="41749" end="41762">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="264" col1="51" line2="264" col2="51" start="41763" end="41763">,</OP-COMMA>
                <expr line1="264" col1="53" line2="264" col2="70" start="41765" end="41782">
                  <expr line1="264" col1="53" line2="264" col2="59" start="41765" end="41771">
                    <SYMBOL line1="264" col1="53" line2="264" col2="59" start="41765" end="41771">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="264" col1="61" line2="264" col2="61" start="41773" end="41773">~</OP-TILDE>
                  <expr line1="264" col1="63" line2="264" col2="70" start="41775" end="41782">
                    <SYMBOL line1="264" col1="63" line2="264" col2="70" start="41775" end="41782">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="264" col1="71" line2="264" col2="71" start="41783" end="41783">,</OP-COMMA>
                <expr line1="264" col1="73" line2="264" col2="75" start="41785" end="41787">
                  <SYMBOL line1="264" col1="73" line2="264" col2="75" start="41785" end="41787">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="264" col1="76" line2="264" col2="76" start="41788" end="41788">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="265" col1="9" line2="265" col2="49" start="41879" end="41919">
              <expr line1="265" col1="9" line2="265" col2="26" start="41879" end="41896">
                <expr line1="265" col1="9" line2="265" col2="16" start="41879" end="41886">
                  <SYMBOL_FUNCTION_CALL line1="265" col1="9" line2="265" col2="16" start="41879" end="41886">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="265" col1="17" line2="265" col2="17" start="41887" end="41887">(</OP-LEFT-PAREN>
                <expr line1="265" col1="18" line2="265" col2="25" start="41888" end="41895">
                  <SYMBOL line1="265" col1="18" line2="265" col2="25" start="41888" end="41895">fpkm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="265" col1="26" line2="265" col2="26" start="41896" end="41896">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="265" col1="28" line2="265" col2="29" start="41898" end="41899">&lt;-</LEFT_ASSIGN>
              <expr line1="265" col1="31" line2="265" col2="49" start="41901" end="41919">
                <expr line1="265" col1="31" line2="265" col2="41" start="41901" end="41911">
                  <SYMBOL_FUNCTION_CALL line1="265" col1="31" line2="265" col2="41" start="41901" end="41911">sampleNames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="265" col1="42" line2="265" col2="42" start="41912" end="41912">(</OP-LEFT-PAREN>
                <expr line1="265" col1="43" line2="265" col2="48" start="41913" end="41918">
                  <SYMBOL line1="265" col1="43" line2="265" col2="48" start="41913" end="41918">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="265" col1="49" line2="265" col2="49" start="41919" end="41919">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="266" col1="9" line2="266" col2="33" start="42037" end="42061">
              <expr line1="266" col1="9" line2="266" col2="21" start="42037" end="42049">
                <expr line1="266" col1="9" line2="266" col2="12" start="42037" end="42040">
                  <SYMBOL_FUNCTION_CALL line1="266" col1="9" line2="266" col2="12" start="42037" end="42040">fpkm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="266" col1="13" line2="266" col2="13" start="42041" end="42041">(</OP-LEFT-PAREN>
                <expr line1="266" col1="14" line2="266" col2="20" start="42042" end="42048">
                  <SYMBOL line1="266" col1="14" line2="266" col2="20" start="42042" end="42048">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="266" col1="21" line2="266" col2="21" start="42049" end="42049">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="266" col1="23" line2="266" col2="24" start="42051" end="42052">&lt;-</LEFT_ASSIGN>
              <expr line1="266" col1="26" line2="266" col2="33" start="42054" end="42061">
                <SYMBOL line1="266" col1="26" line2="266" col2="33" start="42054" end="42061">fpkm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="267" col1="9" line2="267" col2="20" start="42195" end="42206">
              <expr line1="267" col1="9" line2="267" col2="10" start="42195" end="42196">
                <SYMBOL_FUNCTION_CALL line1="267" col1="9" line2="267" col2="10" start="42195" end="42196">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="267" col1="11" line2="267" col2="11" start="42197" end="42197">(</OP-LEFT-PAREN>
              <expr line1="267" col1="12" line2="267" col2="19" start="42198" end="42205">
                <SYMBOL line1="267" col1="12" line2="267" col2="19" start="42198" end="42205">fpkm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="267" col1="20" line2="267" col2="20" start="42206" end="42206">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="268" col1="5" line2="268" col2="5" start="42349" end="42349">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="269" col1="5" line2="277" col2="5" start="42507" end="43771">
          <IF line1="269" col1="5" line2="269" col2="6" start="42507" end="42508">if</IF>
          <OP-LEFT-PAREN line1="269" col1="8" line2="269" col2="8" start="42510" end="42510">(</OP-LEFT-PAREN>
          <expr line1="269" col1="10" line2="269" col2="30" start="42512" end="42532">
            <OP-EXCLAMATION line1="269" col1="10" line2="269" col2="10" start="42512" end="42512">!</OP-EXCLAMATION>
            <expr line1="269" col1="11" line2="269" col2="30" start="42513" end="42532">
              <expr line1="269" col1="11" line2="269" col2="17" start="42513" end="42519">
                <SYMBOL_FUNCTION_CALL line1="269" col1="11" line2="269" col2="17" start="42513" end="42519">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="269" col1="18" line2="269" col2="18" start="42520" end="42520">(</OP-LEFT-PAREN>
              <expr line1="269" col1="19" line2="269" col2="29" start="42521" end="42531">
                <expr line1="269" col1="19" line2="269" col2="21" start="42521" end="42523">
                  <SYMBOL_FUNCTION_CALL line1="269" col1="19" line2="269" col2="21" start="42521" end="42523">cpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="269" col1="22" line2="269" col2="22" start="42524" end="42524">(</OP-LEFT-PAREN>
                <expr line1="269" col1="23" line2="269" col2="28" start="42525" end="42530">
                  <SYMBOL line1="269" col1="23" line2="269" col2="28" start="42525" end="42530">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="269" col1="29" line2="269" col2="29" start="42531" end="42531">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="269" col1="30" line2="269" col2="30" start="42532" end="42532">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="269" col1="32" line2="269" col2="32" start="42534" end="42534">)</OP-RIGHT-PAREN>
          <expr line1="269" col1="34" line2="277" col2="5" start="42536" end="43771">
            <OP-LEFT-BRACE line1="269" col1="34" line2="269" col2="34" start="42536" end="42536">{</OP-LEFT-BRACE>
            <expr line1="270" col1="9" line2="271" col2="44" start="42669" end="42862">
              <expr line1="270" col1="9" line2="270" col2="17" start="42669" end="42677">
                <SYMBOL line1="270" col1="9" line2="270" col2="17" start="42669" end="42677">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="270" col1="19" line2="270" col2="20" start="42679" end="42680">&lt;-</LEFT_ASSIGN>
              <expr line1="270" col1="22" line2="271" col2="44" start="42682" end="42862">
                <expr line1="270" col1="22" line2="270" col2="31" start="42682" end="42691">
                  <SYMBOL_FUNCTION_CALL line1="270" col1="22" line2="270" col2="31" start="42682" end="42691">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="270" col1="32" line2="270" col2="32" start="42692" end="42692">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="270" col1="33" line2="270" col2="39" start="42693" end="42699">feature</SYMBOL_SUB>
                <EQ_SUB line1="270" col1="41" line2="270" col2="41" start="42701" end="42701">=</EQ_SUB>
                <expr line1="270" col1="43" line2="270" col2="71" start="42703" end="42731">
                  <expr line1="270" col1="43" line2="270" col2="55" start="42703" end="42715">
                    <expr line1="270" col1="43" line2="270" col2="47" start="42703" end="42707">
                      <SYMBOL_FUNCTION_CALL line1="270" col1="43" line2="270" col2="47" start="42703" end="42707">fData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="270" col1="48" line2="270" col2="48" start="42708" end="42708">(</OP-LEFT-PAREN>
                    <expr line1="270" col1="49" line2="270" col2="54" start="42709" end="42714">
                      <SYMBOL line1="270" col1="49" line2="270" col2="54" start="42709" end="42714">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="270" col1="55" line2="270" col2="55" start="42715" end="42715">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="270" col1="56" line2="270" col2="57" start="42716" end="42717">[[</LBB>
                  <expr line1="270" col1="58" line2="270" col2="69" start="42718" end="42729">
                    <SYMBOL line1="270" col1="58" line2="270" col2="69" start="42718" end="42729">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="270" col1="70" line2="270" col2="70" start="42730" end="42730">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="270" col1="71" line2="270" col2="71" start="42731" end="42731">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="270" col1="72" line2="270" col2="72" start="42732" end="42732">,</OP-COMMA>
                <expr line1="271" col1="33" line2="271" col2="43" start="42851" end="42861">
                  <expr line1="271" col1="33" line2="271" col2="35" start="42851" end="42853">
                    <SYMBOL_FUNCTION_CALL line1="271" col1="33" line2="271" col2="35" start="42851" end="42853">cpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="271" col1="36" line2="271" col2="36" start="42854" end="42854">(</OP-LEFT-PAREN>
                  <expr line1="271" col1="37" line2="271" col2="42" start="42855" end="42860">
                    <SYMBOL line1="271" col1="37" line2="271" col2="42" start="42855" end="42860">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="271" col1="43" line2="271" col2="43" start="42861" end="42861">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="271" col1="44" line2="271" col2="44" start="42862" end="42862">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="272" col1="9" line2="272" col2="51" start="42985" end="43027">
              <expr line1="272" col1="9" line2="272" col2="22" start="42985" end="42998">
                <SYMBOL line1="272" col1="9" line2="272" col2="22" start="42985" end="42998">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="272" col1="24" line2="272" col2="25" start="43000" end="43001">&lt;-</LEFT_ASSIGN>
              <expr line1="272" col1="27" line2="272" col2="51" start="43003" end="43027">
                <expr line1="272" col1="27" line2="272" col2="40" start="43003" end="43016">
                  <SYMBOL_PACKAGE line1="272" col1="27" line2="272" col2="34" start="43003" end="43010">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="272" col1="35" line2="272" col2="36" start="43011" end="43012">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="272" col1="37" line2="272" col2="40" start="43013" end="43016">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="272" col1="41" line2="272" col2="41" start="43017" end="43017">(</OP-LEFT-PAREN>
                <expr line1="272" col1="42" line2="272" col2="50" start="43018" end="43026">
                  <SYMBOL line1="272" col1="42" line2="272" col2="50" start="43018" end="43026">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="272" col1="51" line2="272" col2="51" start="43027" end="43027">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="273" col1="9" line2="273" col2="75" start="43143" end="43209">
              <expr line1="273" col1="9" line2="273" col2="15" start="43143" end="43149">
                <SYMBOL line1="273" col1="9" line2="273" col2="15" start="43143" end="43149">cpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="273" col1="17" line2="273" col2="18" start="43151" end="43152">&lt;-</LEFT_ASSIGN>
              <expr line1="273" col1="20" line2="273" col2="75" start="43154" end="43209">
                <expr line1="273" col1="20" line2="273" col2="34" start="43154" end="43168">
                  <SYMBOL_PACKAGE line1="273" col1="20" line2="273" col2="27" start="43154" end="43161">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="273" col1="28" line2="273" col2="29" start="43162" end="43163">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="273" col1="30" line2="273" col2="34" start="43164" end="43168">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="273" col1="35" line2="273" col2="35" start="43169" end="43169">(</OP-LEFT-PAREN>
                <expr line1="273" col1="36" line2="273" col2="49" start="43170" end="43183">
                  <SYMBOL line1="273" col1="36" line2="273" col2="49" start="43170" end="43183">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="273" col1="50" line2="273" col2="50" start="43184" end="43184">,</OP-COMMA>
                <expr line1="273" col1="52" line2="273" col2="69" start="43186" end="43203">
                  <expr line1="273" col1="52" line2="273" col2="58" start="43186" end="43192">
                    <SYMBOL line1="273" col1="52" line2="273" col2="58" start="43186" end="43192">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="273" col1="60" line2="273" col2="60" start="43194" end="43194">~</OP-TILDE>
                  <expr line1="273" col1="62" line2="273" col2="69" start="43196" end="43203">
                    <SYMBOL line1="273" col1="62" line2="273" col2="69" start="43196" end="43203">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="273" col1="70" line2="273" col2="70" start="43204" end="43204">,</OP-COMMA>
                <expr line1="273" col1="72" line2="273" col2="74" start="43206" end="43208">
                  <SYMBOL line1="273" col1="72" line2="273" col2="74" start="43206" end="43208">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="273" col1="75" line2="273" col2="75" start="43209" end="43209">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="274" col1="9" line2="274" col2="48" start="43301" end="43340">
              <expr line1="274" col1="9" line2="274" col2="25" start="43301" end="43317">
                <expr line1="274" col1="9" line2="274" col2="16" start="43301" end="43308">
                  <SYMBOL_FUNCTION_CALL line1="274" col1="9" line2="274" col2="16" start="43301" end="43308">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="274" col1="17" line2="274" col2="17" start="43309" end="43309">(</OP-LEFT-PAREN>
                <expr line1="274" col1="18" line2="274" col2="24" start="43310" end="43316">
                  <SYMBOL line1="274" col1="18" line2="274" col2="24" start="43310" end="43316">cpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="274" col1="25" line2="274" col2="25" start="43317" end="43317">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="274" col1="27" line2="274" col2="28" start="43319" end="43320">&lt;-</LEFT_ASSIGN>
              <expr line1="274" col1="30" line2="274" col2="48" start="43322" end="43340">
                <expr line1="274" col1="30" line2="274" col2="40" start="43322" end="43332">
                  <SYMBOL_FUNCTION_CALL line1="274" col1="30" line2="274" col2="40" start="43322" end="43332">sampleNames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="274" col1="41" line2="274" col2="41" start="43333" end="43333">(</OP-LEFT-PAREN>
                <expr line1="274" col1="42" line2="274" col2="47" start="43334" end="43339">
                  <SYMBOL line1="274" col1="42" line2="274" col2="47" start="43334" end="43339">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="274" col1="48" line2="274" col2="48" start="43340" end="43340">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="275" col1="9" line2="275" col2="31" start="43459" end="43481">
              <expr line1="275" col1="9" line2="275" col2="20" start="43459" end="43470">
                <expr line1="275" col1="9" line2="275" col2="11" start="43459" end="43461">
                  <SYMBOL_FUNCTION_CALL line1="275" col1="9" line2="275" col2="11" start="43459" end="43461">cpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="275" col1="12" line2="275" col2="12" start="43462" end="43462">(</OP-LEFT-PAREN>
                <expr line1="275" col1="13" line2="275" col2="19" start="43463" end="43469">
                  <SYMBOL line1="275" col1="13" line2="275" col2="19" start="43463" end="43469">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="275" col1="20" line2="275" col2="20" start="43470" end="43470">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="275" col1="22" line2="275" col2="23" start="43472" end="43473">&lt;-</LEFT_ASSIGN>
              <expr line1="275" col1="25" line2="275" col2="31" start="43475" end="43481">
                <SYMBOL line1="275" col1="25" line2="275" col2="31" start="43475" end="43481">cpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="276" col1="9" line2="276" col2="19" start="43617" end="43627">
              <expr line1="276" col1="9" line2="276" col2="10" start="43617" end="43618">
                <SYMBOL_FUNCTION_CALL line1="276" col1="9" line2="276" col2="10" start="43617" end="43618">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="276" col1="11" line2="276" col2="11" start="43619" end="43619">(</OP-LEFT-PAREN>
              <expr line1="276" col1="12" line2="276" col2="18" start="43620" end="43626">
                <SYMBOL line1="276" col1="12" line2="276" col2="18" start="43620" end="43626">cpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="276" col1="19" line2="276" col2="19" start="43627" end="43627">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="277" col1="5" line2="277" col2="5" start="43771" end="43771">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="278" col1="5" line2="278" col2="39" start="43929" end="43963">## Use feature symbols for rownames</COMMENT>
        <expr line1="279" col1="5" line2="279" col2="11" start="44087" end="44093">
          <SYMBOL line1="279" col1="5" line2="279" col2="11" start="44087" end="44093">sce_out</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="280" col1="1" line2="280" col2="1" start="44241" end="44241">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

