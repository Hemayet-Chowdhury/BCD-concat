<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="27" start="180" end="206">#' Identify outlier values </COMMENT>
  <COMMENT line1="2" col1="1" line2="2" col2="3" start="359" end="361">#' </COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="128" start="538" end="665">#' Convenience function to determine which values in a numeric vector are outliers based on the median absolute deviation (MAD).</COMMENT>
  <COMMENT line1="4" col1="1" line2="4" col2="2" start="717" end="718">#'</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="42" start="896" end="937">#' @param metric Numeric vector of values.</COMMENT>
  <COMMENT line1="6" col1="1" line2="6" col2="134" start="1075" end="1208">#' @param nmads A numeric scalar, specifying the minimum number of MADs away from median required for a value to be called an outlier.</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="178" start="1254" end="1431">#' @param type String indicating whether outliers should be looked for at both tails (\code{"both"}), only at the lower tail (\code{"lower"}) or the upper tail (\code{"higher"}).</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="118" start="1433" end="1550">#' @param log Logical scalar, should the values of the metric be transformed to the log10 scale before computing MADs?</COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="111" start="1612" end="1722">#' @param subset Logical or integer vector, which subset of values should be used to calculate the median/MAD? </COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="39" start="1791" end="1829">#' If \code{NULL}, all values are used.</COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="76" start="1970" end="2045">#' Missing values will trigger a warning and will be automatically ignored. </COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="113" start="2149" end="2261">#' @param batch Factor of length equal to \code{metric}, specifying the batch to which each observation belongs. </COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="97" start="2328" end="2424">#' A median/MAD is calculated for each batch, and outliers are then identified within each batch.</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="113" start="2507" end="2619">#' @param min_diff A numeric scalar indicating the minimum difference from the median to consider as an outlier. </COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="153" start="2686" end="2838">#' The outlier threshold is defined from the larger of \code{nmads} MADs and \code{min_diff}, to avoid calling many outliers when the MAD is very small. </COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="31" start="2865" end="2895">#' If \code{NA}, it is ignored.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="3" start="3044" end="3046">#' </COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="138" start="3223" end="3360">#' @return A logical vector of the same length as the \code{metric} argument, specifying the observations that are considered as outliers.</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="3" start="3402" end="3404">#' </COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="20" start="3581" end="3600">#' @author Aaron Lun</COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="2" start="3760" end="3761">#'</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="10" start="3939" end="3948">#' @export</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="12" start="4118" end="4129">#' @examples</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="28" start="4297" end="4324">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="31" start="4476" end="4506">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="39" start="4655" end="4693">#' example_sce &lt;- SingleCellExperiment(</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="50" start="4834" end="4883">#'     assays = list(counts = sc_example_counts), </COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="37" start="5013" end="5049">#'     colData = sc_example_cell_info</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="4" start="5192" end="5195">#' )</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="49" start="5371" end="5419">#' example_sce &lt;- calculateQCMetrics(example_sce)</COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="2" start="5550" end="5551">#'</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="44" start="5729" end="5772">#' ## with a set of feature controls defined</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="50" start="5908" end="5957">#' example_sce &lt;- calculateQCMetrics(example_sce, </COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="40" start="6087" end="6126">#' feature_controls = list(set1 = 1:40))</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="49" start="6266" end="6314">#' isOutlier(example_sce$total_counts, nmads = 3)</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="3" start="6445" end="6447">#' </COMMENT>
  <expr line1="37" col1="1" line2="95" col2="1" start="6624" end="17006">
    <expr line1="37" col1="1" line2="37" col2="9" start="6624" end="6632">
      <SYMBOL line1="37" col1="1" line2="37" col2="9" start="6624" end="6632">isOutlier</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="37" col1="11" line2="37" col2="12" start="6634" end="6635">&lt;-</LEFT_ASSIGN>
    <expr line1="37" col1="14" line2="95" col2="1" start="6637" end="17006">
      <FUNCTION line1="37" col1="14" line2="37" col2="21" start="6637" end="6644">function</FUNCTION>
      <OP-LEFT-PAREN line1="37" col1="22" line2="37" col2="22" start="6645" end="6645">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="37" col1="23" line2="37" col2="28" start="6646" end="6651">metric</SYMBOL_FORMALS>
      <OP-COMMA line1="37" col1="29" line2="37" col2="29" start="6652" end="6652">,</OP-COMMA>
      <SYMBOL_FORMALS line1="37" col1="31" line2="37" col2="35" start="6654" end="6658">nmads</SYMBOL_FORMALS>
      <EQ_FORMALS line1="37" col1="37" line2="37" col2="37" start="6660" end="6660">=</EQ_FORMALS>
      <expr line1="37" col1="39" line2="37" col2="39" start="6662" end="6662">
        <NUM_CONST line1="37" col1="39" line2="37" col2="39" start="6662" end="6662">5</NUM_CONST>
      </expr>
      <OP-COMMA line1="37" col1="40" line2="37" col2="40" start="6663" end="6663">,</OP-COMMA>
      <SYMBOL_FORMALS line1="37" col1="42" line2="37" col2="45" start="6665" end="6668">type</SYMBOL_FORMALS>
      <EQ_FORMALS line1="37" col1="47" line2="37" col2="47" start="6670" end="6670">=</EQ_FORMALS>
      <expr line1="37" col1="49" line2="37" col2="76" start="6672" end="6699">
        <expr line1="37" col1="49" line2="37" col2="49" start="6672" end="6672">
          <SYMBOL_FUNCTION_CALL line1="37" col1="49" line2="37" col2="49" start="6672" end="6672">c</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="37" col1="50" line2="37" col2="50" start="6673" end="6673">(</OP-LEFT-PAREN>
        <expr line1="37" col1="51" line2="37" col2="56" start="6674" end="6679">
          <STR_CONST line1="37" col1="51" line2="37" col2="56" start="6674" end="6679">"both"</STR_CONST>
        </expr>
        <OP-COMMA line1="37" col1="57" line2="37" col2="57" start="6680" end="6680">,</OP-COMMA>
        <expr line1="37" col1="59" line2="37" col2="65" start="6682" end="6688">
          <STR_CONST line1="37" col1="59" line2="37" col2="65" start="6682" end="6688">"lower"</STR_CONST>
        </expr>
        <OP-COMMA line1="37" col1="66" line2="37" col2="66" start="6689" end="6689">,</OP-COMMA>
        <expr line1="37" col1="68" line2="37" col2="75" start="6691" end="6698">
          <STR_CONST line1="37" col1="68" line2="37" col2="75" start="6691" end="6698">"higher"</STR_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="37" col1="76" line2="37" col2="76" start="6699" end="6699">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="37" col1="77" line2="37" col2="77" start="6700" end="6700">,</OP-COMMA>
      <SYMBOL_FORMALS line1="38" col1="23" line2="38" col2="25" start="6825" end="6827">log</SYMBOL_FORMALS>
      <EQ_FORMALS line1="38" col1="27" line2="38" col2="27" start="6829" end="6829">=</EQ_FORMALS>
      <expr line1="38" col1="29" line2="38" col2="33" start="6831" end="6835">
        <NUM_CONST line1="38" col1="29" line2="38" col2="33" start="6831" end="6835">FALSE</NUM_CONST>
      </expr>
      <OP-COMMA line1="38" col1="34" line2="38" col2="34" start="6836" end="6836">,</OP-COMMA>
      <SYMBOL_FORMALS line1="38" col1="36" line2="38" col2="41" start="6838" end="6843">subset</SYMBOL_FORMALS>
      <EQ_FORMALS line1="38" col1="43" line2="38" col2="43" start="6845" end="6845">=</EQ_FORMALS>
      <expr line1="38" col1="45" line2="38" col2="48" start="6847" end="6850">
        <NULL_CONST line1="38" col1="45" line2="38" col2="48" start="6847" end="6850">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="38" col1="49" line2="38" col2="49" start="6851" end="6851">,</OP-COMMA>
      <SYMBOL_FORMALS line1="38" col1="51" line2="38" col2="55" start="6853" end="6857">batch</SYMBOL_FORMALS>
      <EQ_FORMALS line1="38" col1="57" line2="38" col2="57" start="6859" end="6859">=</EQ_FORMALS>
      <expr line1="38" col1="59" line2="38" col2="62" start="6861" end="6864">
        <NULL_CONST line1="38" col1="59" line2="38" col2="62" start="6861" end="6864">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="38" col1="63" line2="38" col2="63" start="6865" end="6865">,</OP-COMMA>
      <SYMBOL_FORMALS line1="38" col1="65" line2="38" col2="72" start="6867" end="6874">min_diff</SYMBOL_FORMALS>
      <EQ_FORMALS line1="38" col1="74" line2="38" col2="74" start="6876" end="6876">=</EQ_FORMALS>
      <expr line1="38" col1="76" line2="38" col2="77" start="6878" end="6879">
        <NUM_CONST line1="38" col1="76" line2="38" col2="77" start="6878" end="6879">NA</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="38" col1="78" line2="38" col2="78" start="6880" end="6880">)</OP-RIGHT-PAREN>
      <expr line1="38" col1="80" line2="95" col2="1" start="6882" end="17006">
        <OP-LEFT-BRACE line1="38" col1="80" line2="38" col2="80" start="6882" end="6882">{</OP-LEFT-BRACE>
        <expr line1="39" col1="5" line2="41" col2="5" start="6986" end="7344">
          <IF line1="39" col1="5" line2="39" col2="6" start="6986" end="6987">if</IF>
          <OP-LEFT-PAREN line1="39" col1="8" line2="39" col2="8" start="6989" end="6989">(</OP-LEFT-PAREN>
          <expr line1="39" col1="9" line2="39" col2="11" start="6990" end="6992">
            <SYMBOL line1="39" col1="9" line2="39" col2="11" start="6990" end="6992">log</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="39" col1="12" line2="39" col2="12" start="6993" end="6993">)</OP-RIGHT-PAREN>
          <expr line1="39" col1="14" line2="41" col2="5" start="6995" end="7344">
            <OP-LEFT-BRACE line1="39" col1="14" line2="39" col2="14" start="6995" end="6995">{</OP-LEFT-BRACE>
            <expr line1="40" col1="9" line2="40" col2="31" start="7169" end="7191">
              <expr line1="40" col1="9" line2="40" col2="14" start="7169" end="7174">
                <SYMBOL line1="40" col1="9" line2="40" col2="14" start="7169" end="7174">metric</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="40" col1="16" line2="40" col2="17" start="7176" end="7177">&lt;-</LEFT_ASSIGN>
              <expr line1="40" col1="19" line2="40" col2="31" start="7179" end="7191">
                <expr line1="40" col1="19" line2="40" col2="23" start="7179" end="7183">
                  <SYMBOL_FUNCTION_CALL line1="40" col1="19" line2="40" col2="23" start="7179" end="7183">log10</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="40" col1="24" line2="40" col2="24" start="7184" end="7184">(</OP-LEFT-PAREN>
                <expr line1="40" col1="25" line2="40" col2="30" start="7185" end="7190">
                  <SYMBOL line1="40" col1="25" line2="40" col2="30" start="7185" end="7190">metric</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="40" col1="31" line2="40" col2="31" start="7191" end="7191">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="41" col1="5" line2="41" col2="5" start="7344" end="7344">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="42" col1="5" line2="44" col2="5" start="7523" end="7881">
          <IF line1="42" col1="5" line2="42" col2="6" start="7523" end="7524">if</IF>
          <OP-LEFT-PAREN line1="42" col1="8" line2="42" col2="8" start="7526" end="7526">(</OP-LEFT-PAREN>
          <expr line1="42" col1="9" line2="42" col2="26" start="7527" end="7544">
            <expr line1="42" col1="9" line2="42" col2="11" start="7527" end="7529">
              <SYMBOL_FUNCTION_CALL line1="42" col1="9" line2="42" col2="11" start="7527" end="7529">any</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="42" col1="12" line2="42" col2="12" start="7530" end="7530">(</OP-LEFT-PAREN>
            <expr line1="42" col1="13" line2="42" col2="25" start="7531" end="7543">
              <expr line1="42" col1="13" line2="42" col2="17" start="7531" end="7535">
                <SYMBOL_FUNCTION_CALL line1="42" col1="13" line2="42" col2="17" start="7531" end="7535">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="42" col1="18" line2="42" col2="18" start="7536" end="7536">(</OP-LEFT-PAREN>
              <expr line1="42" col1="19" line2="42" col2="24" start="7537" end="7542">
                <SYMBOL line1="42" col1="19" line2="42" col2="24" start="7537" end="7542">metric</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="42" col1="25" line2="42" col2="25" start="7543" end="7543">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="42" col1="26" line2="42" col2="26" start="7544" end="7544">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="42" col1="27" line2="42" col2="27" start="7545" end="7545">)</OP-RIGHT-PAREN>
          <expr line1="42" col1="29" line2="44" col2="5" start="7547" end="7881">
            <OP-LEFT-BRACE line1="42" col1="29" line2="42" col2="29" start="7547" end="7547">{</OP-LEFT-BRACE>
            <expr line1="43" col1="9" line2="43" col2="66" start="7706" end="7763">
              <expr line1="43" col1="9" line2="43" col2="15" start="7706" end="7712">
                <SYMBOL_FUNCTION_CALL line1="43" col1="9" line2="43" col2="15" start="7706" end="7712">warning</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="43" col1="16" line2="43" col2="16" start="7713" end="7713">(</OP-LEFT-PAREN>
              <expr line1="43" col1="17" line2="43" col2="65" start="7714" end="7762">
                <STR_CONST line1="43" col1="17" line2="43" col2="65" start="7714" end="7762">"missing values ignored during outlier detection"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="43" col1="66" line2="43" col2="66" start="7763" end="7763">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="44" col1="5" line2="44" col2="5" start="7881" end="7881">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="46" col1="5" line2="69" col2="5" start="8239" end="12356">
          <IF line1="46" col1="5" line2="46" col2="6" start="8239" end="8240">if</IF>
          <OP-LEFT-PAREN line1="46" col1="8" line2="46" col2="8" start="8242" end="8242">(</OP-LEFT-PAREN>
          <expr line1="46" col1="9" line2="46" col2="23" start="8243" end="8257">
            <OP-EXCLAMATION line1="46" col1="9" line2="46" col2="9" start="8243" end="8243">!</OP-EXCLAMATION>
            <expr line1="46" col1="10" line2="46" col2="23" start="8244" end="8257">
              <expr line1="46" col1="10" line2="46" col2="16" start="8244" end="8250">
                <SYMBOL_FUNCTION_CALL line1="46" col1="10" line2="46" col2="16" start="8244" end="8250">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="46" col1="17" line2="46" col2="17" start="8251" end="8251">(</OP-LEFT-PAREN>
              <expr line1="46" col1="18" line2="46" col2="22" start="8252" end="8256">
                <SYMBOL line1="46" col1="18" line2="46" col2="22" start="8252" end="8256">batch</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="46" col1="23" line2="46" col2="23" start="8257" end="8257">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="46" col1="24" line2="46" col2="24" start="8258" end="8258">)</OP-RIGHT-PAREN>
          <expr line1="46" col1="26" line2="69" col2="5" start="8260" end="12356">
            <OP-LEFT-BRACE line1="46" col1="26" line2="46" col2="26" start="8260" end="8260">{</OP-LEFT-BRACE>
            <expr line1="47" col1="9" line2="47" col2="27" start="8422" end="8440">
              <expr line1="47" col1="9" line2="47" col2="9" start="8422" end="8422">
                <SYMBOL line1="47" col1="9" line2="47" col2="9" start="8422" end="8422">N</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="47" col1="11" line2="47" col2="12" start="8424" end="8425">&lt;-</LEFT_ASSIGN>
              <expr line1="47" col1="14" line2="47" col2="27" start="8427" end="8440">
                <expr line1="47" col1="14" line2="47" col2="19" start="8427" end="8432">
                  <SYMBOL_FUNCTION_CALL line1="47" col1="14" line2="47" col2="19" start="8427" end="8432">length</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="47" col1="20" line2="47" col2="20" start="8433" end="8433">(</OP-LEFT-PAREN>
                <expr line1="47" col1="21" line2="47" col2="26" start="8434" end="8439">
                  <SYMBOL line1="47" col1="21" line2="47" col2="26" start="8434" end="8439">metric</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="47" col1="27" line2="47" col2="27" start="8440" end="8440">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="48" col1="9" line2="50" col2="9" start="8601" end="8959">
              <IF line1="48" col1="9" line2="48" col2="10" start="8601" end="8602">if</IF>
              <OP-LEFT-PAREN line1="48" col1="12" line2="48" col2="12" start="8604" end="8604">(</OP-LEFT-PAREN>
              <expr line1="48" col1="13" line2="48" col2="30" start="8605" end="8622">
                <expr line1="48" col1="13" line2="48" col2="25" start="8605" end="8617">
                  <expr line1="48" col1="13" line2="48" col2="18" start="8605" end="8610">
                    <SYMBOL_FUNCTION_CALL line1="48" col1="13" line2="48" col2="18" start="8605" end="8610">length</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="48" col1="19" line2="48" col2="19" start="8611" end="8611">(</OP-LEFT-PAREN>
                  <expr line1="48" col1="20" line2="48" col2="24" start="8612" end="8616">
                    <SYMBOL line1="48" col1="20" line2="48" col2="24" start="8612" end="8616">batch</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="48" col1="25" line2="48" col2="25" start="8617" end="8617">)</OP-RIGHT-PAREN>
                </expr>
                <NE line1="48" col1="27" line2="48" col2="28" start="8619" end="8620">!=</NE>
                <expr line1="48" col1="30" line2="48" col2="30" start="8622" end="8622">
                  <SYMBOL line1="48" col1="30" line2="48" col2="30" start="8622" end="8622">N</SYMBOL>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="48" col1="31" line2="48" col2="31" start="8623" end="8623">)</OP-RIGHT-PAREN>
              <expr line1="48" col1="33" line2="50" col2="9" start="8625" end="8959">
                <OP-LEFT-BRACE line1="48" col1="33" line2="48" col2="33" start="8625" end="8625">{</OP-LEFT-BRACE>
                <expr line1="49" col1="13" line2="49" col2="67" start="8784" end="8838">
                  <expr line1="49" col1="13" line2="49" col2="16" start="8784" end="8787">
                    <SYMBOL_FUNCTION_CALL line1="49" col1="13" line2="49" col2="16" start="8784" end="8787">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="49" col1="17" line2="49" col2="17" start="8788" end="8788">(</OP-LEFT-PAREN>
                  <expr line1="49" col1="18" line2="49" col2="66" start="8789" end="8837">
                    <STR_CONST line1="49" col1="18" line2="49" col2="66" start="8789" end="8837">"length of 'batch' must equal length of 'metric'"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="49" col1="67" line2="49" col2="67" start="8838" end="8838">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="50" col1="9" line2="50" col2="9" start="8959" end="8959">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <COMMENT line1="52" col1="9" line2="52" col2="57" start="9317" end="9365"># Coercing non-NULL subset into a logical vector.</COMMENT>
            <expr line1="53" col1="9" line2="58" col2="9" start="9496" end="10391">
              <IF line1="53" col1="9" line2="53" col2="10" start="9496" end="9497">if</IF>
              <OP-LEFT-PAREN line1="53" col1="12" line2="53" col2="12" start="9499" end="9499">(</OP-LEFT-PAREN>
              <expr line1="53" col1="13" line2="53" col2="28" start="9500" end="9515">
                <OP-EXCLAMATION line1="53" col1="13" line2="53" col2="13" start="9500" end="9500">!</OP-EXCLAMATION>
                <expr line1="53" col1="14" line2="53" col2="28" start="9501" end="9515">
                  <expr line1="53" col1="14" line2="53" col2="20" start="9501" end="9507">
                    <SYMBOL_FUNCTION_CALL line1="53" col1="14" line2="53" col2="20" start="9501" end="9507">is.null</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="53" col1="21" line2="53" col2="21" start="9508" end="9508">(</OP-LEFT-PAREN>
                  <expr line1="53" col1="22" line2="53" col2="27" start="9509" end="9514">
                    <SYMBOL line1="53" col1="22" line2="53" col2="27" start="9509" end="9514">subset</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="53" col1="28" line2="53" col2="28" start="9515" end="9515">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="53" col1="29" line2="53" col2="29" start="9516" end="9516">)</OP-RIGHT-PAREN>
              <expr line1="53" col1="31" line2="58" col2="9" start="9518" end="10391">
                <OP-LEFT-BRACE line1="53" col1="31" line2="53" col2="31" start="9518" end="9518">{</OP-LEFT-BRACE>
                <expr line1="54" col1="13" line2="54" col2="36" start="9679" end="9702">
                  <expr line1="54" col1="13" line2="54" col2="22" start="9679" end="9688">
                    <SYMBOL line1="54" col1="13" line2="54" col2="22" start="9679" end="9688">new.subset</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="54" col1="24" line2="54" col2="25" start="9690" end="9691">&lt;-</LEFT_ASSIGN>
                  <expr line1="54" col1="27" line2="54" col2="36" start="9693" end="9702">
                    <expr line1="54" col1="27" line2="54" col2="33" start="9693" end="9699">
                      <SYMBOL_FUNCTION_CALL line1="54" col1="27" line2="54" col2="33" start="9693" end="9699">logical</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="54" col1="34" line2="54" col2="34" start="9700" end="9700">(</OP-LEFT-PAREN>
                    <expr line1="54" col1="35" line2="54" col2="35" start="9701" end="9701">
                      <SYMBOL line1="54" col1="35" line2="54" col2="35" start="9701" end="9701">N</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="54" col1="36" line2="54" col2="36" start="9702" end="9702">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="55" col1="13" line2="55" col2="46" start="9858" end="9891">
                  <expr line1="55" col1="13" line2="55" col2="29" start="9858" end="9874">
                    <expr line1="55" col1="13" line2="55" col2="17" start="9858" end="9862">
                      <SYMBOL_FUNCTION_CALL line1="55" col1="13" line2="55" col2="17" start="9858" end="9862">names</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="55" col1="18" line2="55" col2="18" start="9863" end="9863">(</OP-LEFT-PAREN>
                    <expr line1="55" col1="19" line2="55" col2="28" start="9864" end="9873">
                      <SYMBOL line1="55" col1="19" line2="55" col2="28" start="9864" end="9873">new.subset</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="55" col1="29" line2="55" col2="29" start="9874" end="9874">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="55" col1="31" line2="55" col2="32" start="9876" end="9877">&lt;-</LEFT_ASSIGN>
                  <expr line1="55" col1="34" line2="55" col2="46" start="9879" end="9891">
                    <expr line1="55" col1="34" line2="55" col2="38" start="9879" end="9883">
                      <SYMBOL_FUNCTION_CALL line1="55" col1="34" line2="55" col2="38" start="9879" end="9883">names</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="55" col1="39" line2="55" col2="39" start="9884" end="9884">(</OP-LEFT-PAREN>
                    <expr line1="55" col1="40" line2="55" col2="45" start="9885" end="9890">
                      <SYMBOL line1="55" col1="40" line2="55" col2="45" start="9885" end="9890">metric</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="55" col1="46" line2="55" col2="46" start="9891" end="9891">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="56" col1="13" line2="56" col2="38" start="10037" end="10062">
                  <expr line1="56" col1="13" line2="56" col2="30" start="10037" end="10054">
                    <expr line1="56" col1="13" line2="56" col2="22" start="10037" end="10046">
                      <SYMBOL line1="56" col1="13" line2="56" col2="22" start="10037" end="10046">new.subset</SYMBOL>
                    </expr>
                    <OP-LEFT-BRACKET line1="56" col1="23" line2="56" col2="23" start="10047" end="10047">[</OP-LEFT-BRACKET>
                    <expr line1="56" col1="24" line2="56" col2="29" start="10048" end="10053">
                      <SYMBOL line1="56" col1="24" line2="56" col2="29" start="10048" end="10053">subset</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACKET line1="56" col1="30" line2="56" col2="30" start="10054" end="10054">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="56" col1="32" line2="56" col2="33" start="10056" end="10057">&lt;-</LEFT_ASSIGN>
                  <expr line1="56" col1="35" line2="56" col2="38" start="10059" end="10062">
                    <NUM_CONST line1="56" col1="35" line2="56" col2="38" start="10059" end="10062">TRUE</NUM_CONST>
                  </expr>
                </expr>
                <expr line1="57" col1="13" line2="57" col2="32" start="10216" end="10235">
                  <expr line1="57" col1="13" line2="57" col2="18" start="10216" end="10221">
                    <SYMBOL line1="57" col1="13" line2="57" col2="18" start="10216" end="10221">subset</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="57" col1="20" line2="57" col2="21" start="10223" end="10224">&lt;-</LEFT_ASSIGN>
                  <expr line1="57" col1="23" line2="57" col2="32" start="10226" end="10235">
                    <SYMBOL line1="57" col1="23" line2="57" col2="32" start="10226" end="10235">new.subset</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="58" col1="9" line2="58" col2="9" start="10391" end="10391">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <COMMENT line1="60" col1="9" line2="60" col2="47" start="10749" end="10787"># Computing QC metrics for each batch. </COMMENT>
            <expr line1="61" col1="9" line2="61" col2="44" start="10928" end="10963">
              <expr line1="61" col1="9" line2="61" col2="16" start="10928" end="10935">
                <SYMBOL line1="61" col1="9" line2="61" col2="16" start="10928" end="10935">by.batch</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="61" col1="18" line2="61" col2="19" start="10937" end="10938">&lt;-</LEFT_ASSIGN>
              <expr line1="61" col1="21" line2="61" col2="44" start="10940" end="10963">
                <expr line1="61" col1="21" line2="61" col2="25" start="10940" end="10944">
                  <SYMBOL_FUNCTION_CALL line1="61" col1="21" line2="61" col2="25" start="10940" end="10944">split</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="61" col1="26" line2="61" col2="26" start="10945" end="10945">(</OP-LEFT-PAREN>
                <expr line1="61" col1="27" line2="61" col2="36" start="10946" end="10955">
                  <expr line1="61" col1="27" line2="61" col2="33" start="10946" end="10952">
                    <SYMBOL_FUNCTION_CALL line1="61" col1="27" line2="61" col2="33" start="10946" end="10952">seq_len</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="61" col1="34" line2="61" col2="34" start="10953" end="10953">(</OP-LEFT-PAREN>
                  <expr line1="61" col1="35" line2="61" col2="35" start="10954" end="10954">
                    <SYMBOL line1="61" col1="35" line2="61" col2="35" start="10954" end="10954">N</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="61" col1="36" line2="61" col2="36" start="10955" end="10955">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="61" col1="37" line2="61" col2="37" start="10956" end="10956">,</OP-COMMA>
                <expr line1="61" col1="39" line2="61" col2="43" start="10958" end="10962">
                  <SYMBOL line1="61" col1="39" line2="61" col2="43" start="10958" end="10962">batch</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="61" col1="44" line2="61" col2="44" start="10963" end="10963">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="62" col1="9" line2="62" col2="31" start="11107" end="11129">
              <expr line1="62" col1="9" line2="62" col2="17" start="11107" end="11115">
                <SYMBOL line1="62" col1="9" line2="62" col2="17" start="11107" end="11115">collected</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="62" col1="19" line2="62" col2="20" start="11117" end="11118">&lt;-</LEFT_ASSIGN>
              <expr line1="62" col1="22" line2="62" col2="31" start="11120" end="11129">
                <expr line1="62" col1="22" line2="62" col2="28" start="11120" end="11126">
                  <SYMBOL_FUNCTION_CALL line1="62" col1="22" line2="62" col2="28" start="11120" end="11126">logical</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="62" col1="29" line2="62" col2="29" start="11127" end="11127">(</OP-LEFT-PAREN>
                <expr line1="62" col1="30" line2="62" col2="30" start="11128" end="11128">
                  <SYMBOL line1="62" col1="30" line2="62" col2="30" start="11128" end="11128">N</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="62" col1="31" line2="62" col2="31" start="11129" end="11129">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="63" col1="9" line2="67" col2="9" start="11286" end="12002">
              <FOR line1="63" col1="9" line2="63" col2="11" start="11286" end="11288">for</FOR>
              <forcond line1="63" col1="13" line2="63" col2="27" start="11290" end="11304">
                <OP-LEFT-PAREN line1="63" col1="13" line2="63" col2="13" start="11290" end="11290">(</OP-LEFT-PAREN>
                <SYMBOL line1="63" col1="14" line2="63" col2="14" start="11291" end="11291">b</SYMBOL>
                <IN line1="63" col1="16" line2="63" col2="17" start="11293" end="11294">in</IN>
                <expr line1="63" col1="19" line2="63" col2="26" start="11296" end="11303">
                  <SYMBOL line1="63" col1="19" line2="63" col2="26" start="11296" end="11303">by.batch</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="63" col1="27" line2="63" col2="27" start="11304" end="11304">)</OP-RIGHT-PAREN>
              </forcond>
              <expr line1="63" col1="29" line2="67" col2="9" start="11306" end="12002">
                <OP-LEFT-BRACE line1="63" col1="29" line2="63" col2="29" start="11306" end="11306">{</OP-LEFT-BRACE>
                <expr line1="64" col1="13" line2="66" col2="69" start="11469" end="11883">
                  <expr line1="64" col1="13" line2="64" col2="24" start="11469" end="11480">
                    <expr line1="64" col1="13" line2="64" col2="21" start="11469" end="11477">
                      <SYMBOL line1="64" col1="13" line2="64" col2="21" start="11469" end="11477">collected</SYMBOL>
                    </expr>
                    <OP-LEFT-BRACKET line1="64" col1="22" line2="64" col2="22" start="11478" end="11478">[</OP-LEFT-BRACKET>
                    <expr line1="64" col1="23" line2="64" col2="23" start="11479" end="11479">
                      <SYMBOL line1="64" col1="23" line2="64" col2="23" start="11479" end="11479">b</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACKET line1="64" col1="24" line2="64" col2="24" start="11480" end="11480">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="64" col1="26" line2="64" col2="27" start="11482" end="11483">&lt;-</LEFT_ASSIGN>
                  <expr line1="64" col1="29" line2="66" col2="69" start="11485" end="11883">
                    <expr line1="64" col1="29" line2="64" col2="34" start="11485" end="11490">
                      <SYMBOL_FUNCTION_CALL line1="64" col1="29" line2="64" col2="34" start="11485" end="11490">Recall</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="64" col1="35" line2="64" col2="35" start="11491" end="11491">(</OP-LEFT-PAREN>
                    <expr line1="64" col1="36" line2="64" col2="44" start="11492" end="11500">
                      <expr line1="64" col1="36" line2="64" col2="41" start="11492" end="11497">
                        <SYMBOL line1="64" col1="36" line2="64" col2="41" start="11492" end="11497">metric</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="64" col1="42" line2="64" col2="42" start="11498" end="11498">[</OP-LEFT-BRACKET>
                      <expr line1="64" col1="43" line2="64" col2="43" start="11499" end="11499">
                        <SYMBOL line1="64" col1="43" line2="64" col2="43" start="11499" end="11499">b</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="64" col1="44" line2="64" col2="44" start="11500" end="11500">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="64" col1="45" line2="64" col2="45" start="11501" end="11501">,</OP-COMMA>
                    <SYMBOL_SUB line1="64" col1="47" line2="64" col2="51" start="11503" end="11507">nmads</SYMBOL_SUB>
                    <EQ_SUB line1="64" col1="53" line2="64" col2="53" start="11509" end="11509">=</EQ_SUB>
                    <expr line1="64" col1="55" line2="64" col2="59" start="11511" end="11515">
                      <SYMBOL line1="64" col1="55" line2="64" col2="59" start="11511" end="11515">nmads</SYMBOL>
                    </expr>
                    <OP-COMMA line1="64" col1="60" line2="64" col2="60" start="11516" end="11516">,</OP-COMMA>
                    <SYMBOL_SUB line1="64" col1="62" line2="64" col2="65" start="11518" end="11521">type</SYMBOL_SUB>
                    <EQ_SUB line1="64" col1="67" line2="64" col2="67" start="11523" end="11523">=</EQ_SUB>
                    <expr line1="64" col1="69" line2="64" col2="72" start="11525" end="11528">
                      <SYMBOL line1="64" col1="69" line2="64" col2="72" start="11525" end="11528">type</SYMBOL>
                    </expr>
                    <OP-COMMA line1="64" col1="73" line2="64" col2="73" start="11529" end="11529">,</OP-COMMA>
                    <SYMBOL_SUB line1="65" col1="36" line2="65" col2="38" start="11671" end="11673">log</SYMBOL_SUB>
                    <EQ_SUB line1="65" col1="40" line2="65" col2="40" start="11675" end="11675">=</EQ_SUB>
                    <expr line1="65" col1="42" line2="65" col2="46" start="11677" end="11681">
                      <NUM_CONST line1="65" col1="42" line2="65" col2="46" start="11677" end="11681">FALSE</NUM_CONST>
                    </expr>
                    <OP-COMMA line1="65" col1="47" line2="65" col2="47" start="11682" end="11682">,</OP-COMMA>
                    <SYMBOL_SUB line1="65" col1="49" line2="65" col2="54" start="11684" end="11689">subset</SYMBOL_SUB>
                    <EQ_SUB line1="65" col1="56" line2="65" col2="56" start="11691" end="11691">=</EQ_SUB>
                    <expr line1="65" col1="58" line2="65" col2="66" start="11693" end="11701">
                      <expr line1="65" col1="58" line2="65" col2="63" start="11693" end="11698">
                        <SYMBOL line1="65" col1="58" line2="65" col2="63" start="11693" end="11698">subset</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="65" col1="64" line2="65" col2="64" start="11699" end="11699">[</OP-LEFT-BRACKET>
                      <expr line1="65" col1="65" line2="65" col2="65" start="11700" end="11700">
                        <SYMBOL line1="65" col1="65" line2="65" col2="65" start="11700" end="11700">b</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="65" col1="66" line2="65" col2="66" start="11701" end="11701">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="65" col1="67" line2="65" col2="67" start="11702" end="11702">,</OP-COMMA>
                    <SYMBOL_SUB line1="66" col1="36" line2="66" col2="40" start="11850" end="11854">batch</SYMBOL_SUB>
                    <EQ_SUB line1="66" col1="42" line2="66" col2="42" start="11856" end="11856">=</EQ_SUB>
                    <expr line1="66" col1="44" line2="66" col2="47" start="11858" end="11861">
                      <NULL_CONST line1="66" col1="44" line2="66" col2="47" start="11858" end="11861">NULL</NULL_CONST>
                    </expr>
                    <OP-COMMA line1="66" col1="48" line2="66" col2="48" start="11862" end="11862">,</OP-COMMA>
                    <SYMBOL_SUB line1="66" col1="50" line2="66" col2="57" start="11864" end="11871">min_diff</SYMBOL_SUB>
                    <EQ_SUB line1="66" col1="59" line2="66" col2="59" start="11873" end="11873">=</EQ_SUB>
                    <expr line1="66" col1="61" line2="66" col2="68" start="11875" end="11882">
                      <SYMBOL line1="66" col1="61" line2="66" col2="68" start="11875" end="11882">min_diff</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="66" col1="69" line2="66" col2="69" start="11883" end="11883">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="67" col1="9" line2="67" col2="9" start="12002" end="12002">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="68" col1="9" line2="68" col2="25" start="12181" end="12197">
              <expr line1="68" col1="9" line2="68" col2="14" start="12181" end="12186">
                <SYMBOL_FUNCTION_CALL line1="68" col1="9" line2="68" col2="14" start="12181" end="12186">return</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="68" col1="15" line2="68" col2="15" start="12187" end="12187">(</OP-LEFT-PAREN>
              <expr line1="68" col1="16" line2="68" col2="24" start="12188" end="12196">
                <SYMBOL line1="68" col1="16" line2="68" col2="24" start="12188" end="12196">collected</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="68" col1="25" line2="68" col2="25" start="12197" end="12197">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="69" col1="5" line2="69" col2="5" start="12356" end="12356">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="71" col1="5" line2="71" col2="66" start="12714" end="12775"># Computing median/MAD (possibly based on subset of the data).</COMMENT>
        <expr line1="72" col1="5" line2="79" col2="5" start="12893" end="14146">
          <IF line1="72" col1="5" line2="72" col2="6" start="12893" end="12894">if</IF>
          <OP-LEFT-PAREN line1="72" col1="8" line2="72" col2="8" start="12896" end="12896">(</OP-LEFT-PAREN>
          <expr line1="72" col1="9" line2="72" col2="24" start="12897" end="12912">
            <OP-EXCLAMATION line1="72" col1="9" line2="72" col2="9" start="12897" end="12897">!</OP-EXCLAMATION>
            <expr line1="72" col1="10" line2="72" col2="24" start="12898" end="12912">
              <expr line1="72" col1="10" line2="72" col2="16" start="12898" end="12904">
                <SYMBOL_FUNCTION_CALL line1="72" col1="10" line2="72" col2="16" start="12898" end="12904">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="72" col1="17" line2="72" col2="17" start="12905" end="12905">(</OP-LEFT-PAREN>
              <expr line1="72" col1="18" line2="72" col2="23" start="12906" end="12911">
                <SYMBOL line1="72" col1="18" line2="72" col2="23" start="12906" end="12911">subset</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="72" col1="24" line2="72" col2="24" start="12912" end="12912">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="72" col1="25" line2="72" col2="25" start="12913" end="12913">)</OP-RIGHT-PAREN>
          <expr line1="72" col1="27" line2="77" col2="5" start="12915" end="13788">
            <OP-LEFT-BRACE line1="72" col1="27" line2="72" col2="27" start="12915" end="12915">{</OP-LEFT-BRACE>
            <expr line1="73" col1="9" line2="73" col2="35" start="13076" end="13102">
              <expr line1="73" col1="9" line2="73" col2="17" start="13076" end="13084">
                <SYMBOL line1="73" col1="9" line2="73" col2="17" start="13076" end="13084">submetric</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="73" col1="19" line2="73" col2="20" start="13086" end="13087">&lt;-</LEFT_ASSIGN>
              <expr line1="73" col1="22" line2="73" col2="35" start="13089" end="13102">
                <expr line1="73" col1="22" line2="73" col2="27" start="13089" end="13094">
                  <SYMBOL line1="73" col1="22" line2="73" col2="27" start="13089" end="13094">metric</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="73" col1="28" line2="73" col2="28" start="13095" end="13095">[</OP-LEFT-BRACKET>
                <expr line1="73" col1="29" line2="73" col2="34" start="13096" end="13101">
                  <SYMBOL line1="73" col1="29" line2="73" col2="34" start="13096" end="13101">subset</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="73" col1="35" line2="73" col2="35" start="13102" end="13102">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="74" col1="9" line2="76" col2="9" start="13255" end="13613">
              <IF line1="74" col1="9" line2="74" col2="10" start="13255" end="13256">if</IF>
              <OP-LEFT-PAREN line1="74" col1="12" line2="74" col2="12" start="13258" end="13258">(</OP-LEFT-PAREN>
              <expr line1="74" col1="13" line2="74" col2="35" start="13259" end="13281">
                <expr line1="74" col1="13" line2="74" col2="29" start="13259" end="13275">
                  <expr line1="74" col1="13" line2="74" col2="18" start="13259" end="13264">
                    <SYMBOL_FUNCTION_CALL line1="74" col1="13" line2="74" col2="18" start="13259" end="13264">length</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="74" col1="19" line2="74" col2="19" start="13265" end="13265">(</OP-LEFT-PAREN>
                  <expr line1="74" col1="20" line2="74" col2="28" start="13266" end="13274">
                    <SYMBOL line1="74" col1="20" line2="74" col2="28" start="13266" end="13274">submetric</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="74" col1="29" line2="74" col2="29" start="13275" end="13275">)</OP-RIGHT-PAREN>
                </expr>
                <EQ line1="74" col1="31" line2="74" col2="32" start="13277" end="13278">==</EQ>
                <expr line1="74" col1="34" line2="74" col2="35" start="13280" end="13281">
                  <NUM_CONST line1="74" col1="34" line2="74" col2="35" start="13280" end="13281">0L</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="74" col1="36" line2="74" col2="36" start="13282" end="13282">)</OP-RIGHT-PAREN>
              <expr line1="74" col1="38" line2="76" col2="9" start="13284" end="13613">
                <OP-LEFT-BRACE line1="74" col1="38" line2="74" col2="38" start="13284" end="13284">{</OP-LEFT-BRACE>
                <expr line1="75" col1="13" line2="75" col2="65" start="13438" end="13490">
                  <expr line1="75" col1="13" line2="75" col2="19" start="13438" end="13444">
                    <SYMBOL_FUNCTION_CALL line1="75" col1="13" line2="75" col2="19" start="13438" end="13444">warning</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="75" col1="20" line2="75" col2="20" start="13445" end="13445">(</OP-LEFT-PAREN>
                  <expr line1="75" col1="21" line2="75" col2="64" start="13446" end="13489">
                    <STR_CONST line1="75" col1="21" line2="75" col2="64" start="13446" end="13489">"no observations remaining after subsetting"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="75" col1="65" line2="75" col2="65" start="13490" end="13490">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="76" col1="9" line2="76" col2="9" start="13613" end="13613">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="77" col1="5" line2="77" col2="5" start="13788" end="13788">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="77" col1="7" line2="77" col2="10" start="13790" end="13793">else</ELSE>
          <expr line1="77" col1="12" line2="79" col2="5" start="13795" end="14146">
            <OP-LEFT-BRACE line1="77" col1="12" line2="77" col2="12" start="13795" end="13795">{</OP-LEFT-BRACE>
            <expr line1="78" col1="9" line2="78" col2="27" start="13971" end="13989">
              <expr line1="78" col1="9" line2="78" col2="17" start="13971" end="13979">
                <SYMBOL line1="78" col1="9" line2="78" col2="17" start="13971" end="13979">submetric</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="78" col1="19" line2="78" col2="20" start="13981" end="13982">&lt;-</LEFT_ASSIGN>
              <expr line1="78" col1="22" line2="78" col2="27" start="13984" end="13989">
                <SYMBOL line1="78" col1="22" line2="78" col2="27" start="13984" end="13989">metric</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="79" col1="5" line2="79" col2="5" start="14146" end="14146">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="80" col1="5" line2="80" col2="46" start="14325" end="14366">
          <expr line1="80" col1="5" line2="80" col2="11" start="14325" end="14331">
            <SYMBOL line1="80" col1="5" line2="80" col2="11" start="14325" end="14331">cur.med</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="80" col1="13" line2="80" col2="14" start="14333" end="14334">&lt;-</LEFT_ASSIGN>
          <expr line1="80" col1="16" line2="80" col2="46" start="14336" end="14366">
            <expr line1="80" col1="16" line2="80" col2="21" start="14336" end="14341">
              <SYMBOL_FUNCTION_CALL line1="80" col1="16" line2="80" col2="21" start="14336" end="14341">median</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="80" col1="22" line2="80" col2="22" start="14342" end="14342">(</OP-LEFT-PAREN>
            <expr line1="80" col1="23" line2="80" col2="31" start="14343" end="14351">
              <SYMBOL line1="80" col1="23" line2="80" col2="31" start="14343" end="14351">submetric</SYMBOL>
            </expr>
            <OP-COMMA line1="80" col1="32" line2="80" col2="32" start="14352" end="14352">,</OP-COMMA>
            <SYMBOL_SUB line1="80" col1="34" line2="80" col2="38" start="14354" end="14358">na.rm</SYMBOL_SUB>
            <EQ_SUB line1="80" col1="40" line2="80" col2="40" start="14360" end="14360">=</EQ_SUB>
            <expr line1="80" col1="42" line2="80" col2="45" start="14362" end="14365">
              <NUM_CONST line1="80" col1="42" line2="80" col2="45" start="14362" end="14365">TRUE</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="80" col1="46" line2="80" col2="46" start="14366" end="14366">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="81" col1="5" line2="81" col2="61" start="14504" end="14560">
          <expr line1="81" col1="5" line2="81" col2="11" start="14504" end="14510">
            <SYMBOL line1="81" col1="5" line2="81" col2="11" start="14504" end="14510">cur.mad</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="81" col1="13" line2="81" col2="14" start="14512" end="14513">&lt;-</LEFT_ASSIGN>
          <expr line1="81" col1="16" line2="81" col2="61" start="14515" end="14560">
            <expr line1="81" col1="16" line2="81" col2="18" start="14515" end="14517">
              <SYMBOL_FUNCTION_CALL line1="81" col1="16" line2="81" col2="18" start="14515" end="14517">mad</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="81" col1="19" line2="81" col2="19" start="14518" end="14518">(</OP-LEFT-PAREN>
            <expr line1="81" col1="20" line2="81" col2="28" start="14519" end="14527">
              <SYMBOL line1="81" col1="20" line2="81" col2="28" start="14519" end="14527">submetric</SYMBOL>
            </expr>
            <OP-COMMA line1="81" col1="29" line2="81" col2="29" start="14528" end="14528">,</OP-COMMA>
            <SYMBOL_SUB line1="81" col1="31" line2="81" col2="36" start="14530" end="14535">center</SYMBOL_SUB>
            <EQ_SUB line1="81" col1="38" line2="81" col2="38" start="14537" end="14537">=</EQ_SUB>
            <expr line1="81" col1="40" line2="81" col2="46" start="14539" end="14545">
              <SYMBOL line1="81" col1="40" line2="81" col2="46" start="14539" end="14545">cur.med</SYMBOL>
            </expr>
            <OP-COMMA line1="81" col1="47" line2="81" col2="47" start="14546" end="14546">,</OP-COMMA>
            <SYMBOL_SUB line1="81" col1="49" line2="81" col2="53" start="14548" end="14552">na.rm</SYMBOL_SUB>
            <EQ_SUB line1="81" col1="55" line2="81" col2="55" start="14554" end="14554">=</EQ_SUB>
            <expr line1="81" col1="57" line2="81" col2="60" start="14556" end="14559">
              <NUM_CONST line1="81" col1="57" line2="81" col2="60" start="14556" end="14559">TRUE</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="81" col1="61" line2="81" col2="61" start="14560" end="14560">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="83" col1="5" line2="83" col2="60" start="14862" end="14917">
          <expr line1="83" col1="5" line2="83" col2="12" start="14862" end="14869">
            <SYMBOL line1="83" col1="5" line2="83" col2="12" start="14862" end="14869">diff.val</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="83" col1="14" line2="83" col2="15" start="14871" end="14872">&lt;-</LEFT_ASSIGN>
          <expr line1="83" col1="17" line2="83" col2="60" start="14874" end="14917">
            <expr line1="83" col1="17" line2="83" col2="19" start="14874" end="14876">
              <SYMBOL_FUNCTION_CALL line1="83" col1="17" line2="83" col2="19" start="14874" end="14876">max</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="83" col1="20" line2="83" col2="20" start="14877" end="14877">(</OP-LEFT-PAREN>
            <expr line1="83" col1="21" line2="83" col2="28" start="14878" end="14885">
              <SYMBOL line1="83" col1="21" line2="83" col2="28" start="14878" end="14885">min_diff</SYMBOL>
            </expr>
            <OP-COMMA line1="83" col1="29" line2="83" col2="29" start="14886" end="14886">,</OP-COMMA>
            <expr line1="83" col1="31" line2="83" col2="45" start="14888" end="14902">
              <expr line1="83" col1="31" line2="83" col2="35" start="14888" end="14892">
                <SYMBOL line1="83" col1="31" line2="83" col2="35" start="14888" end="14892">nmads</SYMBOL>
              </expr>
              <OP-STAR line1="83" col1="37" line2="83" col2="37" start="14894" end="14894">*</OP-STAR>
              <expr line1="83" col1="39" line2="83" col2="45" start="14896" end="14902">
                <SYMBOL line1="83" col1="39" line2="83" col2="45" start="14896" end="14902">cur.mad</SYMBOL>
              </expr>
            </expr>
            <OP-COMMA line1="83" col1="46" line2="83" col2="46" start="14903" end="14903">,</OP-COMMA>
            <SYMBOL_SUB line1="83" col1="48" line2="83" col2="52" start="14905" end="14909">na.rm</SYMBOL_SUB>
            <EQ_SUB line1="83" col1="54" line2="83" col2="54" start="14911" end="14911">=</EQ_SUB>
            <expr line1="83" col1="56" line2="83" col2="59" start="14913" end="14916">
              <NUM_CONST line1="83" col1="56" line2="83" col2="59" start="14913" end="14916">TRUE</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="83" col1="60" line2="83" col2="60" start="14917" end="14917">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="84" col1="5" line2="84" col2="37" start="15041" end="15073">
          <expr line1="84" col1="5" line2="84" col2="15" start="15041" end="15051">
            <SYMBOL line1="84" col1="5" line2="84" col2="15" start="15041" end="15051">upper.limit</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="84" col1="17" line2="84" col2="18" start="15053" end="15054">&lt;-</LEFT_ASSIGN>
          <expr line1="84" col1="20" line2="84" col2="37" start="15056" end="15073">
            <expr line1="84" col1="20" line2="84" col2="26" start="15056" end="15062">
              <SYMBOL line1="84" col1="20" line2="84" col2="26" start="15056" end="15062">cur.med</SYMBOL>
            </expr>
            <OP-PLUS line1="84" col1="28" line2="84" col2="28" start="15064" end="15064">+</OP-PLUS>
            <expr line1="84" col1="30" line2="84" col2="37" start="15066" end="15073">
              <SYMBOL line1="84" col1="30" line2="84" col2="37" start="15066" end="15073">diff.val</SYMBOL>
            </expr>
          </expr>
        </expr>
        <expr line1="85" col1="5" line2="85" col2="37" start="15220" end="15252">
          <expr line1="85" col1="5" line2="85" col2="15" start="15220" end="15230">
            <SYMBOL line1="85" col1="5" line2="85" col2="15" start="15220" end="15230">lower.limit</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="85" col1="17" line2="85" col2="18" start="15232" end="15233">&lt;-</LEFT_ASSIGN>
          <expr line1="85" col1="20" line2="85" col2="37" start="15235" end="15252">
            <expr line1="85" col1="20" line2="85" col2="26" start="15235" end="15241">
              <SYMBOL line1="85" col1="20" line2="85" col2="26" start="15235" end="15241">cur.med</SYMBOL>
            </expr>
            <OP-MINUS line1="85" col1="28" line2="85" col2="28" start="15243" end="15243">-</OP-MINUS>
            <expr line1="85" col1="30" line2="85" col2="37" start="15245" end="15252">
              <SYMBOL line1="85" col1="30" line2="85" col2="37" start="15245" end="15252">diff.val</SYMBOL>
            </expr>
          </expr>
        </expr>
        <expr line1="87" col1="5" line2="87" col2="27" start="15578" end="15600">
          <expr line1="87" col1="5" line2="87" col2="8" start="15578" end="15581">
            <SYMBOL line1="87" col1="5" line2="87" col2="8" start="15578" end="15581">type</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="87" col1="10" line2="87" col2="11" start="15583" end="15584">&lt;-</LEFT_ASSIGN>
          <expr line1="87" col1="13" line2="87" col2="27" start="15586" end="15600">
            <expr line1="87" col1="13" line2="87" col2="21" start="15586" end="15594">
              <SYMBOL_FUNCTION_CALL line1="87" col1="13" line2="87" col2="21" start="15586" end="15594">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="87" col1="22" line2="87" col2="22" start="15595" end="15595">(</OP-LEFT-PAREN>
            <expr line1="87" col1="23" line2="87" col2="26" start="15596" end="15599">
              <SYMBOL line1="87" col1="23" line2="87" col2="26" start="15596" end="15599">type</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="87" col1="27" line2="87" col2="27" start="15600" end="15600">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="88" col1="5" line2="92" col2="5" start="15757" end="16473">
          <IF line1="88" col1="5" line2="88" col2="6" start="15757" end="15758">if</IF>
          <OP-LEFT-PAREN line1="88" col1="8" line2="88" col2="8" start="15760" end="15760">(</OP-LEFT-PAREN>
          <expr line1="88" col1="9" line2="88" col2="23" start="15761" end="15775">
            <expr line1="88" col1="9" line2="88" col2="12" start="15761" end="15764">
              <SYMBOL line1="88" col1="9" line2="88" col2="12" start="15761" end="15764">type</SYMBOL>
            </expr>
            <EQ line1="88" col1="14" line2="88" col2="15" start="15766" end="15767">==</EQ>
            <expr line1="88" col1="17" line2="88" col2="23" start="15769" end="15775">
              <STR_CONST line1="88" col1="17" line2="88" col2="23" start="15769" end="15775">"lower"</STR_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="88" col1="24" line2="88" col2="24" start="15776" end="15776">)</OP-RIGHT-PAREN>
          <expr line1="88" col1="26" line2="90" col2="5" start="15778" end="16115">
            <OP-LEFT-BRACE line1="88" col1="26" line2="88" col2="26" start="15778" end="15778">{</OP-LEFT-BRACE>
            <expr line1="89" col1="9" line2="89" col2="26" start="15940" end="15957">
              <expr line1="89" col1="9" line2="89" col2="19" start="15940" end="15950">
                <SYMBOL line1="89" col1="9" line2="89" col2="19" start="15940" end="15950">upper.limit</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="89" col1="21" line2="89" col2="22" start="15952" end="15953">&lt;-</LEFT_ASSIGN>
              <expr line1="89" col1="24" line2="89" col2="26" start="15955" end="15957">
                <NUM_CONST line1="89" col1="24" line2="89" col2="26" start="15955" end="15957">Inf</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="90" col1="5" line2="90" col2="5" start="16115" end="16115">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="90" col1="7" line2="90" col2="10" start="16117" end="16120">else</ELSE>
          <expr line1="90" col1="12" line2="92" col2="5" start="16122" end="16473">
            <IF line1="90" col1="12" line2="90" col2="13" start="16122" end="16123">if</IF>
            <OP-LEFT-PAREN line1="90" col1="15" line2="90" col2="15" start="16125" end="16125">(</OP-LEFT-PAREN>
            <expr line1="90" col1="16" line2="90" col2="31" start="16126" end="16141">
              <expr line1="90" col1="16" line2="90" col2="19" start="16126" end="16129">
                <SYMBOL line1="90" col1="16" line2="90" col2="19" start="16126" end="16129">type</SYMBOL>
              </expr>
              <EQ line1="90" col1="21" line2="90" col2="22" start="16131" end="16132">==</EQ>
              <expr line1="90" col1="24" line2="90" col2="31" start="16134" end="16141">
                <STR_CONST line1="90" col1="24" line2="90" col2="31" start="16134" end="16141">"higher"</STR_CONST>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="90" col1="32" line2="90" col2="32" start="16142" end="16142">)</OP-RIGHT-PAREN>
            <expr line1="90" col1="34" line2="92" col2="5" start="16144" end="16473">
              <OP-LEFT-BRACE line1="90" col1="34" line2="90" col2="34" start="16144" end="16144">{</OP-LEFT-BRACE>
              <expr line1="91" col1="9" line2="91" col2="27" start="16298" end="16316">
                <expr line1="91" col1="9" line2="91" col2="19" start="16298" end="16308">
                  <SYMBOL line1="91" col1="9" line2="91" col2="19" start="16298" end="16308">lower.limit</SYMBOL>
                </expr>
                <LEFT_ASSIGN line1="91" col1="21" line2="91" col2="22" start="16310" end="16311">&lt;-</LEFT_ASSIGN>
                <expr line1="91" col1="24" line2="91" col2="27" start="16313" end="16316">
                  <OP-MINUS line1="91" col1="24" line2="91" col2="24" start="16313" end="16313">-</OP-MINUS>
                  <expr line1="91" col1="25" line2="91" col2="27" start="16314" end="16316">
                    <NUM_CONST line1="91" col1="25" line2="91" col2="27" start="16314" end="16316">Inf</NUM_CONST>
                  </expr>
                </expr>
              </expr>
              <OP-RIGHT-BRACE line1="92" col1="5" line2="92" col2="5" start="16473" end="16473">}</OP-RIGHT-BRACE>
            </expr>
          </expr>
        </expr>
        <expr line1="94" col1="5" line2="94" col2="55" start="16831" end="16881">
          <expr line1="94" col1="5" line2="94" col2="10" start="16831" end="16836">
            <SYMBOL_FUNCTION_CALL line1="94" col1="5" line2="94" col2="10" start="16831" end="16836">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="94" col1="11" line2="94" col2="11" start="16837" end="16837">(</OP-LEFT-PAREN>
          <expr line1="94" col1="12" line2="94" col2="54" start="16838" end="16880">
            <expr line1="94" col1="12" line2="94" col2="31" start="16838" end="16857">
              <expr line1="94" col1="12" line2="94" col2="17" start="16838" end="16843">
                <SYMBOL line1="94" col1="12" line2="94" col2="17" start="16838" end="16843">metric</SYMBOL>
              </expr>
              <LT line1="94" col1="19" line2="94" col2="19" start="16845" end="16845">&lt;</LT>
              <expr line1="94" col1="21" line2="94" col2="31" start="16847" end="16857">
                <SYMBOL line1="94" col1="21" line2="94" col2="31" start="16847" end="16857">lower.limit</SYMBOL>
              </expr>
            </expr>
            <OR line1="94" col1="33" line2="94" col2="33" start="16859" end="16859">|</OR>
            <expr line1="94" col1="35" line2="94" col2="54" start="16861" end="16880">
              <expr line1="94" col1="35" line2="94" col2="45" start="16861" end="16871">
                <SYMBOL line1="94" col1="35" line2="94" col2="45" start="16861" end="16871">upper.limit</SYMBOL>
              </expr>
              <LT line1="94" col1="47" line2="94" col2="47" start="16873" end="16873">&lt;</LT>
              <expr line1="94" col1="49" line2="94" col2="54" start="16875" end="16880">
                <SYMBOL line1="94" col1="49" line2="94" col2="54" start="16875" end="16880">metric</SYMBOL>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="94" col1="55" line2="94" col2="55" start="16881" end="16881">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="95" col1="1" line2="95" col2="1" start="17006" end="17006">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

