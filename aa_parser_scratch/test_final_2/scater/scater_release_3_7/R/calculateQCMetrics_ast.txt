<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="23" start="184" end="206">#' Calculate QC metrics</COMMENT>
  <COMMENT line1="2" col1="1" line2="2" col2="2" start="367" end="368">#'</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="138" start="550" end="687">#' Compute quality control (QC) metrics for each feature and cell in a SingleCellExperiment object, accounting for specified control sets.</COMMENT>
  <COMMENT line1="4" col1="1" line2="4" col2="2" start="733" end="734">#'</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="92" start="916" end="1007">#' @param object A SingleCellExperiment object containing expression values, usually counts.</COMMENT>
  <COMMENT line1="6" col1="1" line2="6" col2="120" start="1099" end="1218">#' @param exprs_values A string indicating which \code{assays} in the \code{object} should be used to define expression.</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="159" start="1282" end="1440">#' @param feature_controls A named list containing one or more vectors (a character vector of feature names, a logical vector, or a numeric vector of indices),</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="88" start="1465" end="1552">#' used to identify feature controls such as ERCC spike-in sets or mitochondrial genes. </COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="162" start="1648" end="1809">#' @param cell_controls A named list containing one or more vectors (a character vector of cell (sample) names, a logical vector, or a numeric vector of indices),</COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="70" start="1831" end="1900">#' used to identify cell controls, e.g., blank wells or bulk controls.</COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="41" start="2014" end="2054">#' @param percent_top An integer vector. </COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="151" start="2197" end="2347">#' Each element is treated as a number of top genes to compute the percentage of library size occupied by the most highly expressed genes in each cell.</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="58" start="2380" end="2437">#' See \code{pct_X_top_Y_features} below for more details.</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="133" start="2563" end="2695">#' @param detection_limit A numeric scalar to be passed to \code{\link{nexprs}}, specifying the lower detection limit for expression.</COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="182" start="2746" end="2927">#' @param use_spikes A logical scalar indicating whether existing spike-in sets in \code{object} should be automatically added to \code{feature_controls}, see \code{?\link{isSpike}}.</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="127" start="2929" end="3055">#' @param compact A logical scalar indicating whether the metrics should be returned in a compact format as a nested DataFrame.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="2" start="3112" end="3113">#'</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="12" start="3295" end="3306">#' @details </COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="161" start="3478" end="3638">#' This function calculates useful quality control metrics to help with pre-processing of data and identification of potentially problematic features and cells. </COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="3" start="3661" end="3663">#' </COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="176" start="3844" end="4019">#' Underscores in \code{assayNames(object)} and in \code{feature_controls} or \code{cell_controls} can cause theoretically cause ambiguities in the names of the output metrics.</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="112" start="4027" end="4138">#' While problems are highly unlikely, users are advised to avoid underscores when naming their controls/assays.</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="2" start="4210" end="4211">#'</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="34" start="4393" end="4426">#' @section Cell-level QC metrics:</COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="56" start="4576" end="4631">#' Denote the value of \code{exprs_values} as \code{X}. </COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="26" start="4759" end="4784">#' Cell-level metrics are:</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="13" start="4942" end="4954">#' \describe{</COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="130" start="5125" end="5254">#' \item{\code{total_X}:}{Sum of expression values for each cell (i.e., the library size, when counts are the expression values).}</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="99" start="5308" end="5406">#' \item{\code{log10_total_X}:}{Log10-transformed \code{total_X} after adding a pseudo-count of 1.}</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="116" start="5491" end="5606">#' \item{\code{total_features_by_X}:}{The number of features that have expression values above the detection limit.}</COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="123" start="5674" end="5796">#' \item{\code{log10_total_features_by_X}:}{Log10-transformed \code{total_features_by_X} after adding a pseudo-count of 1.}</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="156" start="5857" end="6012">#' \item{\code{pct_X_in_top_Y_features}:}{The percentage of the total that is contained within the top \code{Y} most highly expressed features in each cell.</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="69" start="6040" end="6108">#' This is only reported when there are more than \code{Y} features. </COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="57" start="6223" end="6279">#' The top numbers are specified via \code{percent_top}.}</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="4" start="6406" end="6409">#' }</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="3" start="6589" end="6591">#' </COMMENT>
  <COMMENT line1="37" col1="1" line2="37" col2="143" start="6772" end="6914">#' If any controls are specified in \code{feature_controls}, the above metrics will be recomputed using only the features in each control set. </COMMENT>
  <COMMENT line1="38" col1="1" line2="38" col2="96" start="6955" end="7050">#' The name of the set is appended to the name of the recomputed metric, e.g., \code{total_X_F}.</COMMENT>
  <COMMENT line1="39" col1="1" line2="39" col2="142" start="7138" end="7279">#' A \code{pct_X_F} metric is also calculated for each set, representing the percentage of expression values assigned to features in \code{F}.</COMMENT>
  <COMMENT line1="40" col1="1" line2="40" col2="3" start="7321" end="7323">#' </COMMENT>
  <COMMENT line1="41" col1="1" line2="41" col2="136" start="7504" end="7639">#' In addition to the user-specified control sets, two other sets are automatically generated when \code{feature_controls} is non-empty.</COMMENT>
  <COMMENT line1="42" col1="1" line2="42" col2="97" start="7687" end="7783">#' The first is the \code{"feature_control"} set, containing a union of all feature control sets;</COMMENT>
  <COMMENT line1="43" col1="1" line2="43" col2="94" start="7870" end="7963">#' and the second is an \code{"endogenous"} set, containing all genes not in any control set. </COMMENT>
  <COMMENT line1="44" col1="1" line2="44" col2="162" start="8053" end="8214">#' Metrics are also computed for these sets in the same manner described above, suffixed with \code{_feature_control} and \code{_endogenous} instead of \code{_F}.</COMMENT>
  <COMMENT line1="45" col1="1" line2="45" col2="2" start="8236" end="8237">#'</COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="149" start="8419" end="8567">#' Finally, there is the \code{is_cell_control} field, which indicates whether each cell has been defined as a cell control by \code{cell_controls}. </COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="164" start="8602" end="8765">#' If multiple sets of cell controls are defined (e.g., blanks or bulk libraries), a metric \code{is_cell_control_C} is produced for each cell control set \code{C}.</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="61" start="8785" end="8845">#' The union of all sets is stored in \code{is_cell_control}.</COMMENT>
  <COMMENT line1="49" col1="1" line2="49" col2="2" start="8968" end="8969">#'</COMMENT>
  <COMMENT line1="50" col1="1" line2="50" col2="121" start="9151" end="9271">#' All of these cell-level QC metrics are added as columns to the \code{colData} slot of the SingleCellExperiment object.</COMMENT>
  <COMMENT line1="51" col1="1" line2="51" col2="109" start="9334" end="9442">#' This allows them to be inspected by the user and makes them readily available for other functions to use. </COMMENT>
  <COMMENT line1="52" col1="1" line2="52" col2="2" start="9517" end="9518">#'</COMMENT>
  <COMMENT line1="53" col1="1" line2="53" col2="37" start="9700" end="9736">#' @section Feature-level QC metrics:</COMMENT>
  <COMMENT line1="54" col1="1" line2="54" col2="56" start="9883" end="9938">#' Denote the value of \code{exprs_values} as \code{X}. </COMMENT>
  <COMMENT line1="55" col1="1" line2="55" col2="29" start="10066" end="10094">#' Feature-level metrics are:</COMMENT>
  <COMMENT line1="56" col1="1" line2="56" col2="13" start="10249" end="10261">#' \describe{</COMMENT>
  <COMMENT line1="57" col1="1" line2="57" col2="79" start="10432" end="10510">#' \item{\code{mean_X}:}{Mean expression value for each gene across all cells.}</COMMENT>
  <COMMENT line1="58" col1="1" line2="58" col2="91" start="10615" end="10705">#' \item{\code{log10_mean_X}:}{Log10-mean expression value for each gene across all cells.}</COMMENT>
  <COMMENT line1="59" col1="1" line2="59" col2="111" start="10798" end="10908">#' \item{\code{n_cells_by_X}:}{Number of cells with expression values above the detection limit for each gene.}</COMMENT>
  <COMMENT line1="60" col1="1" line2="60" col2="120" start="10981" end="11100">#' \item{\code{pct_dropout_by_X}:}{Percentage of cells with expression values  below the detection limit for each gene.}</COMMENT>
  <COMMENT line1="61" col1="1" line2="61" col2="83" start="11164" end="11246">#' \item{\code{total_X}:}{Sum of expression values for each gene across all cells.}</COMMENT>
  <COMMENT line1="62" col1="1" line2="62" col2="95" start="11347" end="11441">#' \item{\code{log10_total_X}:}{Log10-sum of expression values for each gene across all cells.}</COMMENT>
  <COMMENT line1="63" col1="1" line2="63" col2="4" start="11530" end="11533">#' }</COMMENT>
  <COMMENT line1="64" col1="1" line2="64" col2="2" start="11713" end="11714">#'</COMMENT>
  <COMMENT line1="65" col1="1" line2="65" col2="137" start="11896" end="12032">#' If any controls are specified in \code{cell_controls}, the above metrics will be recomputed using only the cells in each control set. </COMMENT>
  <COMMENT line1="66" col1="1" line2="66" col2="96" start="12079" end="12174">#' The name of the set is appended to the name of the recomputed metric, e.g., \code{total_X_C}.</COMMENT>
  <COMMENT line1="67" col1="1" line2="67" col2="139" start="12262" end="12400">#' A \code{pct_X_C} metric is also calculated for each set, representing the percentage of expression values assigned to cells in \code{C}.</COMMENT>
  <COMMENT line1="68" col1="1" line2="68" col2="3" start="12445" end="12447">#' </COMMENT>
  <COMMENT line1="69" col1="1" line2="69" col2="134" start="12628" end="12761">#' In addition to the user-specified control sets, two other sets are automatically generated when \code{cell_controls} is non-empty. </COMMENT>
  <COMMENT line1="70" col1="1" line2="70" col2="91" start="12811" end="12901">#' The first is the \code{"cell_control"} set, containing a union of all cell control sets;</COMMENT>
  <COMMENT line1="71" col1="1" line2="71" col2="95" start="12994" end="13088">#' and the second is an \code{"non_control"} set, containing all genes not in any control set. </COMMENT>
  <COMMENT line1="72" col1="1" line2="72" col2="154" start="13177" end="13330">#' Metrics are computed for these sets in the same manner described above, suffixed with \code{_cell_control} and \code{_non_control} instead of\code{_C}.</COMMENT>
  <COMMENT line1="73" col1="1" line2="73" col2="2" start="13360" end="13361">#'</COMMENT>
  <COMMENT line1="74" col1="1" line2="74" col2="153" start="13543" end="13695">#' Finally, there is the \code{is_feature_control} field, which indicates whether each feature has been defined as a control by \code{feature_controls}. </COMMENT>
  <COMMENT line1="75" col1="1" line2="75" col2="175" start="13726" end="13900">#' If multiple sets of feature controls are defined (e.g., ERCCs, mitochondrial genes), a metric \code{is_feature_control_F} is produced for each feature control set \code{F}.</COMMENT>
  <COMMENT line1="76" col1="1" line2="76" col2="64" start="13909" end="13972">#' The union of all sets is stored in \code{is_feature_control}.</COMMENT>
  <COMMENT line1="77" col1="1" line2="77" col2="2" start="14092" end="14093">#'</COMMENT>
  <COMMENT line1="78" col1="1" line2="78" col2="117" start="14275" end="14391">#' These feature-level QC metrics are added as columns to the \code{rowData} slot of the SingleCellExperiment object.</COMMENT>
  <COMMENT line1="79" col1="1" line2="79" col2="91" start="14458" end="14548">#' They can be inspected by the user and are readily available for other functions to use. </COMMENT>
  <COMMENT line1="80" col1="1" line2="80" col2="2" start="14641" end="14642">#'</COMMENT>
  <COMMENT line1="81" col1="1" line2="81" col2="29" start="14824" end="14852">#' @section Compacted output:</COMMENT>
  <COMMENT line1="82" col1="1" line2="82" col2="149" start="15007" end="15155">#' If \code{compact=TRUE}, the QC metrics are stored in the \code{"scater_qc"} field of the \code{colData} and \code{rowData} as a nested DataFrame. </COMMENT>
  <COMMENT line1="83" col1="1" line2="83" col2="141" start="15190" end="15330">#' This avoids cluttering the metadata with QC metrics, especially if many results are to be stored in a single SingleCellExperiment object. </COMMENT>
  <COMMENT line1="84" col1="1" line2="84" col2="2" start="15373" end="15374">#'</COMMENT>
  <COMMENT line1="85" col1="1" line2="85" col2="81" start="15556" end="15636">#' Assume we have a feature control set \code{F} and a cell control set \code{C}.</COMMENT>
  <COMMENT line1="86" col1="1" line2="86" col2="70" start="15739" end="15808">#' The nesting structure in \code{scater_qc} in the \code{colData} is:</COMMENT>
  <COMMENT line1="87" col1="1" line2="87" col2="28" start="15922" end="15949">#' \preformatted{  scater_qc</COMMENT>
  <COMMENT line1="88" col1="1" line2="88" col2="24" start="16105" end="16128">#'   |-- is_cell_control</COMMENT>
  <COMMENT line1="89" col1="1" line2="89" col2="26" start="16288" end="16313">#'   |-- is_cell_control_C</COMMENT>
  <COMMENT line1="90" col1="1" line2="90" col2="12" start="16471" end="16482">#'   |-- all</COMMENT>
  <COMMENT line1="91" col1="1" line2="91" col2="25" start="16654" end="16678">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="92" col1="1" line2="92" col2="37" start="16837" end="16873">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="93" col1="1" line2="93" col2="16" start="17020" end="17035">#'   |   \-- ...</COMMENT>
  <COMMENT line1="94" col1="1" line2="94" col2="19" start="17203" end="17221">#'   +-- endogenous</COMMENT>
  <COMMENT line1="95" col1="1" line2="95" col2="25" start="17386" end="17410">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="96" col1="1" line2="96" col2="37" start="17569" end="17605">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="97" col1="1" line2="97" col2="23" start="17752" end="17774">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="98" col1="1" line2="98" col2="16" start="17935" end="17950">#'   |   \-- ...</COMMENT>
  <COMMENT line1="99" col1="1" line2="99" col2="24" start="18118" end="18141">#'   +-- feature_control</COMMENT>
  <COMMENT line1="100" col1="1" line2="100" col2="25" start="18301" end="18325">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="101" col1="1" line2="101" col2="37" start="18484" end="18520">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="102" col1="1" line2="102" col2="23" start="18667" end="18689">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="103" col1="1" line2="103" col2="16" start="18850" end="18865">#'   |   \-- ...</COMMENT>
  <COMMENT line1="104" col1="1" line2="104" col2="26" start="19033" end="19058">#'   \-- feature_control_F</COMMENT>
  <COMMENT line1="105" col1="1" line2="105" col2="25" start="19216" end="19240">#'       |-- total_counts</COMMENT>
  <COMMENT line1="106" col1="1" line2="106" col2="37" start="19399" end="19435">#'       |-- total_features_by_counts</COMMENT>
  <COMMENT line1="107" col1="1" line2="107" col2="23" start="19582" end="19604">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="108" col1="1" line2="108" col2="16" start="19765" end="19780">#'       \-- ...</COMMENT>
  <COMMENT line1="109" col1="1" line2="109" col2="4" start="19948" end="19951">#' }</COMMENT>
  <COMMENT line1="110" col1="1" line2="110" col2="60" start="20131" end="20190">#' The nesting in \code{scater_qc} in the \code{rowData} is:</COMMENT>
  <COMMENT line1="111" col1="1" line2="111" col2="28" start="20314" end="20341">#' \preformatted{  scater_qc</COMMENT>
  <COMMENT line1="112" col1="1" line2="112" col2="27" start="20497" end="20523">#'   |-- is_feature_control</COMMENT>
  <COMMENT line1="113" col1="1" line2="113" col2="29" start="20680" end="20708">#'   |-- is_feature_control_F</COMMENT>
  <COMMENT line1="114" col1="1" line2="114" col2="12" start="20863" end="20874">#'   |-- all</COMMENT>
  <COMMENT line1="115" col1="1" line2="115" col2="25" start="21046" end="21070">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="116" col1="1" line2="116" col2="37" start="21229" end="21265">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="117" col1="1" line2="117" col2="16" start="21412" end="21427">#'   |   \-- ...</COMMENT>
  <COMMENT line1="118" col1="1" line2="118" col2="21" start="21595" end="21615">#'   +-- non_control </COMMENT>
  <COMMENT line1="119" col1="1" line2="119" col2="25" start="21778" end="21802">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="120" col1="1" line2="120" col2="37" start="21961" end="21997">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="121" col1="1" line2="121" col2="23" start="22144" end="22166">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="122" col1="1" line2="122" col2="16" start="22327" end="22342">#'   |   \-- ...</COMMENT>
  <COMMENT line1="123" col1="1" line2="123" col2="21" start="22510" end="22530">#'   +-- cell_control</COMMENT>
  <COMMENT line1="124" col1="1" line2="124" col2="25" start="22693" end="22717">#'   |   |-- total_counts</COMMENT>
  <COMMENT line1="125" col1="1" line2="125" col2="37" start="22876" end="22912">#'   |   |-- total_features_by_counts</COMMENT>
  <COMMENT line1="126" col1="1" line2="126" col2="23" start="23059" end="23081">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="127" col1="1" line2="127" col2="16" start="23242" end="23257">#'   |   \-- ...</COMMENT>
  <COMMENT line1="128" col1="1" line2="128" col2="23" start="23425" end="23447">#'   \-- cell_control_C</COMMENT>
  <COMMENT line1="129" col1="1" line2="129" col2="25" start="23608" end="23632">#'       |-- total_counts</COMMENT>
  <COMMENT line1="130" col1="1" line2="130" col2="37" start="23791" end="23827">#'       |-- total_features_by_counts</COMMENT>
  <COMMENT line1="131" col1="1" line2="131" col2="23" start="23974" end="23996">#'       |-- pct_counts</COMMENT>
  <COMMENT line1="132" col1="1" line2="132" col2="16" start="24157" end="24172">#'       \-- ...</COMMENT>
  <COMMENT line1="133" col1="1" line2="133" col2="4" start="24340" end="24343">#' }</COMMENT>
  <COMMENT line1="134" col1="1" line2="134" col2="2" start="24523" end="24524">#'</COMMENT>
  <COMMENT line1="135" col1="1" line2="135" col2="76" start="24706" end="24781">#' No suffixing of the metric names by the control names is performed here. </COMMENT>
  <COMMENT line1="136" col1="1" line2="136" col2="76" start="24889" end="24964">#' This is not necessary when each control set has its own nested DataFrame.</COMMENT>
  <COMMENT line1="137" col1="1" line2="137" col2="2" start="25072" end="25073">#'</COMMENT>
  <COMMENT line1="138" col1="1" line2="138" col2="28" start="25255" end="25282">#' @section Renamed metrics:</COMMENT>
  <COMMENT line1="139" col1="1" line2="139" col2="64" start="25438" end="25501">#' Several metric names have been changed in \pkg{scater} 1.7.5:</COMMENT>
  <COMMENT line1="140" col1="1" line2="140" col2="12" start="25621" end="25632">#' \itemize{</COMMENT>
  <COMMENT line1="141" col1="1" line2="141" col2="75" start="25804" end="25878">#'   \item \code{total_features} was changed to \code{total_features_by_X} </COMMENT>
  <COMMENT line1="142" col1="1" line2="142" col2="75" start="25987" end="26061">#'   where \code{X} is the \code{exprs_values}. This avoids ambiguities if </COMMENT>
  <COMMENT line1="143" col1="1" line2="143" col2="91" start="26170" end="26260">#'   \code{calculateQCMetrics} is called multiple times with different \code{exprs_values}.</COMMENT>
  <COMMENT line1="144" col1="1" line2="144" col2="74" start="26353" end="26426">#'   \item \code{n_cells_X} was changed to \code{n_cells_by_X}, to provide</COMMENT>
  <COMMENT line1="145" col1="1" line2="145" col2="41" start="26536" end="26576">#'   a more sensible name for the metric.</COMMENT>
  <COMMENT line1="146" col1="1" line2="146" col2="71" start="26719" end="26789">#'   \item \code{pct_dropout_X} was changed to \code{pct_dropout_by_X}.</COMMENT>
  <COMMENT line1="147" col1="1" line2="147" col2="85" start="26902" end="26986">#'   \item \code{pct_X_top_Y_features} was changed to \code{pct_X_in_top_Y_features}.</COMMENT>
  <COMMENT line1="148" col1="1" line2="148" col2="4" start="27085" end="27088">#' }</COMMENT>
  <COMMENT line1="149" col1="1" line2="149" col2="3" start="27268" end="27270">#' </COMMENT>
  <COMMENT line1="150" col1="1" line2="150" col2="101" start="27451" end="27551">#' All of the old metric names will be kept alongside the new metric names when \code{compact=FALSE}.</COMMENT>
  <COMMENT line1="151" col1="1" line2="151" col2="55" start="27634" end="27688">#' Otherwise, only the new metric names will be stored.</COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="75" start="27817" end="27891">#' The old metric names may be removed in future releases of \pkg{scater}. </COMMENT>
  <COMMENT line1="153" col1="1" line2="153" col2="3" start="28000" end="28002">#' </COMMENT>
  <COMMENT line1="154" col1="1" line2="154" col2="94" start="28183" end="28276">#' @return A SingleCellExperiment object containing QC metrics in the row and column metadata.</COMMENT>
  <COMMENT line1="155" col1="1" line2="155" col2="2" start="28366" end="28367">#'</COMMENT>
  <COMMENT line1="156" col1="1" line2="156" col2="66" start="28549" end="28614">#' @author Davis McCarthy, with (many!) modifications by Aaron Lun</COMMENT>
  <COMMENT line1="157" col1="1" line2="157" col2="2" start="28732" end="28733">#'</COMMENT>
  <COMMENT line1="158" col1="1" line2="158" col2="28" start="28915" end="28942">#' @importFrom Biobase exprs</COMMENT>
  <COMMENT line1="159" col1="1" line2="159" col2="87" start="29098" end="29184">#' @importFrom stats cmdscale coef mad median model.matrix nls prcomp quantile var dist</COMMENT>
  <COMMENT line1="160" col1="1" line2="160" col2="29" start="29281" end="29309">#' @importFrom methods is new</COMMENT>
  <COMMENT line1="161" col1="1" line2="161" col2="31" start="29464" end="29494">#' @importFrom utils read.table</COMMENT>
  <COMMENT line1="162" col1="1" line2="162" col2="45" start="29647" end="29691">#' @importFrom S4Vectors DataFrame SimpleList</COMMENT>
  <COMMENT line1="163" col1="1" line2="163" col2="112" start="29830" end="29941">#' @importFrom SummarizedExperiment assay assay&lt;- assays assays&lt;- assayNames rowData rowData&lt;- colData colData&lt;-</COMMENT>
  <COMMENT line1="164" col1="1" line2="164" col2="53" start="30013" end="30065">#' @importFrom BiocGenerics sizeFactors sizeFactors&lt;-</COMMENT>
  <COMMENT line1="165" col1="1" line2="165" col2="29" start="30196" end="30224">#' @importFrom Rcpp sourceCpp</COMMENT>
  <COMMENT line1="166" col1="1" line2="166" col2="10" start="30379" end="30388">#' @export</COMMENT>
  <COMMENT line1="167" col1="1" line2="167" col2="12" start="30562" end="30573">#' @examples</COMMENT>
  <COMMENT line1="168" col1="1" line2="168" col2="28" start="30745" end="30772">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="169" col1="1" line2="169" col2="31" start="30928" end="30958">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="170" col1="1" line2="170" col2="39" start="31111" end="31149">#' example_sce &lt;- SingleCellExperiment(</COMMENT>
  <COMMENT line1="171" col1="1" line2="171" col2="50" start="31294" end="31343">#'     assays = list(counts = sc_example_counts), </COMMENT>
  <COMMENT line1="172" col1="1" line2="172" col2="37" start="31477" end="31513">#'     colData = sc_example_cell_info</COMMENT>
  <COMMENT line1="173" col1="1" line2="173" col2="4" start="31660" end="31663">#' )</COMMENT>
  <COMMENT line1="174" col1="1" line2="174" col2="49" start="31843" end="31891">#' example_sce &lt;- calculateQCMetrics(example_sce)</COMMENT>
  <COMMENT line1="175" col1="1" line2="175" col2="2" start="32026" end="32027">#'</COMMENT>
  <COMMENT line1="176" col1="1" line2="176" col2="44" start="32209" end="32252">#' ## with a set of feature controls defined</COMMENT>
  <COMMENT line1="177" col1="1" line2="177" col2="50" start="32392" end="32441">#' example_sce &lt;- calculateQCMetrics(example_sce, </COMMENT>
  <COMMENT line1="178" col1="1" line2="178" col2="40" start="32575" end="32614">#' feature_controls = list(set1 = 1:40))</COMMENT>
  <COMMENT line1="179" col1="1" line2="179" col2="3" start="32758" end="32760">#' </COMMENT>
  <COMMENT line1="180" col1="1" line2="180" col2="50" start="32941" end="32990">#' ## with a named set of feature controls defined</COMMENT>
  <COMMENT line1="181" col1="1" line2="181" col2="50" start="33124" end="33173">#' example_sce &lt;- calculateQCMetrics(example_sce, </COMMENT>
  <COMMENT line1="182" col1="1" line2="182" col2="45" start="33307" end="33351">#'      feature_controls = list(ERCC = 1:40))</COMMENT>
  <COMMENT line1="183" col1="1" line2="183" col2="3" start="33490" end="33492">#' </COMMENT>
  <expr line1="184" col1="1" line2="324" col2="1" start="33673" end="59293">
    <expr line1="184" col1="1" line2="184" col2="18" start="33673" end="33690">
      <SYMBOL line1="184" col1="1" line2="184" col2="18" start="33673" end="33690">calculateQCMetrics</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="184" col1="20" line2="184" col2="21" start="33692" end="33693">&lt;-</LEFT_ASSIGN>
    <expr line1="184" col1="23" line2="324" col2="1" start="33695" end="59293">
      <FUNCTION line1="184" col1="23" line2="184" col2="30" start="33695" end="33702">function</FUNCTION>
      <OP-LEFT-PAREN line1="184" col1="31" line2="184" col2="31" start="33703" end="33703">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="184" col1="32" line2="184" col2="37" start="33704" end="33709">object</SYMBOL_FORMALS>
      <OP-COMMA line1="184" col1="38" line2="184" col2="38" start="33710" end="33710">,</OP-COMMA>
      <SYMBOL_FORMALS line1="184" col1="40" line2="184" col2="51" start="33712" end="33723">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="184" col1="52" line2="184" col2="52" start="33724" end="33724">=</EQ_FORMALS>
      <expr line1="184" col1="53" line2="184" col2="60" start="33725" end="33732">
        <STR_CONST line1="184" col1="53" line2="184" col2="60" start="33725" end="33732">"counts"</STR_CONST>
      </expr>
      <OP-COMMA line1="184" col1="61" line2="184" col2="61" start="33733" end="33733">,</OP-COMMA>
      <SYMBOL_FORMALS line1="185" col1="32" line2="185" col2="47" start="33887" end="33902">feature_controls</SYMBOL_FORMALS>
      <EQ_FORMALS line1="185" col1="49" line2="185" col2="49" start="33904" end="33904">=</EQ_FORMALS>
      <expr line1="185" col1="51" line2="185" col2="54" start="33906" end="33909">
        <NULL_CONST line1="185" col1="51" line2="185" col2="54" start="33906" end="33909">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="185" col1="55" line2="185" col2="55" start="33910" end="33910">,</OP-COMMA>
      <SYMBOL_FORMALS line1="185" col1="57" line2="185" col2="69" start="33912" end="33924">cell_controls</SYMBOL_FORMALS>
      <EQ_FORMALS line1="185" col1="71" line2="185" col2="71" start="33926" end="33926">=</EQ_FORMALS>
      <expr line1="185" col1="73" line2="185" col2="76" start="33928" end="33931">
        <NULL_CONST line1="185" col1="73" line2="185" col2="76" start="33928" end="33931">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="185" col1="77" line2="185" col2="77" start="33932" end="33932">,</OP-COMMA>
      <SYMBOL_FORMALS line1="186" col1="32" line2="186" col2="42" start="34070" end="34080">percent_top</SYMBOL_FORMALS>
      <EQ_FORMALS line1="186" col1="44" line2="186" col2="44" start="34082" end="34082">=</EQ_FORMALS>
      <expr line1="186" col1="46" line2="186" col2="65" start="34084" end="34103">
        <expr line1="186" col1="46" line2="186" col2="46" start="34084" end="34084">
          <SYMBOL_FUNCTION_CALL line1="186" col1="46" line2="186" col2="46" start="34084" end="34084">c</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="186" col1="47" line2="186" col2="47" start="34085" end="34085">(</OP-LEFT-PAREN>
        <expr line1="186" col1="48" line2="186" col2="49" start="34086" end="34087">
          <NUM_CONST line1="186" col1="48" line2="186" col2="49" start="34086" end="34087">50</NUM_CONST>
        </expr>
        <OP-COMMA line1="186" col1="50" line2="186" col2="50" start="34088" end="34088">,</OP-COMMA>
        <expr line1="186" col1="52" line2="186" col2="54" start="34090" end="34092">
          <NUM_CONST line1="186" col1="52" line2="186" col2="54" start="34090" end="34092">100</NUM_CONST>
        </expr>
        <OP-COMMA line1="186" col1="55" line2="186" col2="55" start="34093" end="34093">,</OP-COMMA>
        <expr line1="186" col1="57" line2="186" col2="59" start="34095" end="34097">
          <NUM_CONST line1="186" col1="57" line2="186" col2="59" start="34095" end="34097">200</NUM_CONST>
        </expr>
        <OP-COMMA line1="186" col1="60" line2="186" col2="60" start="34098" end="34098">,</OP-COMMA>
        <expr line1="186" col1="62" line2="186" col2="64" start="34100" end="34102">
          <NUM_CONST line1="186" col1="62" line2="186" col2="64" start="34100" end="34102">500</NUM_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="186" col1="65" line2="186" col2="65" start="34103" end="34103">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="186" col1="66" line2="186" col2="66" start="34104" end="34104">,</OP-COMMA>
      <SYMBOL_FORMALS line1="187" col1="32" line2="187" col2="46" start="34253" end="34267">detection_limit</SYMBOL_FORMALS>
      <EQ_FORMALS line1="187" col1="48" line2="187" col2="48" start="34269" end="34269">=</EQ_FORMALS>
      <expr line1="187" col1="50" line2="187" col2="50" start="34271" end="34271">
        <NUM_CONST line1="187" col1="50" line2="187" col2="50" start="34271" end="34271">0</NUM_CONST>
      </expr>
      <OP-COMMA line1="187" col1="51" line2="187" col2="51" start="34272" end="34272">,</OP-COMMA>
      <SYMBOL_FORMALS line1="187" col1="53" line2="187" col2="62" start="34274" end="34283">use_spikes</SYMBOL_FORMALS>
      <EQ_FORMALS line1="187" col1="64" line2="187" col2="64" start="34285" end="34285">=</EQ_FORMALS>
      <expr line1="187" col1="66" line2="187" col2="69" start="34287" end="34290">
        <NUM_CONST line1="187" col1="66" line2="187" col2="69" start="34287" end="34290">TRUE</NUM_CONST>
      </expr>
      <OP-COMMA line1="187" col1="70" line2="187" col2="70" start="34291" end="34291">,</OP-COMMA>
      <SYMBOL_FORMALS line1="188" col1="32" line2="188" col2="38" start="34436" end="34442">compact</SYMBOL_FORMALS>
      <EQ_FORMALS line1="188" col1="40" line2="188" col2="40" start="34444" end="34444">=</EQ_FORMALS>
      <expr line1="188" col1="42" line2="188" col2="46" start="34446" end="34450">
        <NUM_CONST line1="188" col1="42" line2="188" col2="46" start="34446" end="34450">FALSE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="188" col1="47" line2="188" col2="47" start="34451" end="34451">)</OP-RIGHT-PAREN>
      <expr line1="188" col1="49" line2="324" col2="1" start="34453" end="59293">
        <OP-LEFT-BRACE line1="188" col1="49" line2="188" col2="49" start="34453" end="34453">{</OP-LEFT-BRACE>
        <expr line1="190" col1="5" line2="192" col2="5" start="34775" end="35141">
          <IF line1="190" col1="5" line2="190" col2="6" start="34775" end="34776">if</IF>
          <OP-LEFT-PAREN line1="190" col1="8" line2="190" col2="8" start="34778" end="34778">(</OP-LEFT-PAREN>
          <expr line1="190" col1="10" line2="190" col2="53" start="34780" end="34823">
            <OP-EXCLAMATION line1="190" col1="10" line2="190" col2="10" start="34780" end="34780">!</OP-EXCLAMATION>
            <expr line1="190" col1="11" line2="190" col2="53" start="34781" end="34823">
              <expr line1="190" col1="11" line2="190" col2="21" start="34781" end="34791">
                <SYMBOL_PACKAGE line1="190" col1="11" line2="190" col2="17" start="34781" end="34787">methods</SYMBOL_PACKAGE>
                <NS_GET line1="190" col1="18" line2="190" col2="19" start="34788" end="34789">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="190" col1="20" line2="190" col2="21" start="34790" end="34791">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="190" col1="22" line2="190" col2="22" start="34792" end="34792">(</OP-LEFT-PAREN>
              <expr line1="190" col1="23" line2="190" col2="28" start="34793" end="34798">
                <SYMBOL line1="190" col1="23" line2="190" col2="28" start="34793" end="34798">object</SYMBOL>
              </expr>
              <OP-COMMA line1="190" col1="29" line2="190" col2="29" start="34799" end="34799">,</OP-COMMA>
              <expr line1="190" col1="31" line2="190" col2="52" start="34801" end="34822">
                <STR_CONST line1="190" col1="31" line2="190" col2="52" start="34801" end="34822">"SingleCellExperiment"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="190" col1="53" line2="190" col2="53" start="34823" end="34823">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="190" col1="54" line2="190" col2="54" start="34824" end="34824">)</OP-RIGHT-PAREN>
          <expr line1="190" col1="56" line2="192" col2="5" start="34826" end="35141">
            <OP-LEFT-BRACE line1="190" col1="56" line2="190" col2="56" start="34826" end="34826">{</OP-LEFT-BRACE>
            <expr line1="191" col1="9" line2="191" col2="53" start="34962" end="35006">
              <expr line1="191" col1="9" line2="191" col2="12" start="34962" end="34965">
                <SYMBOL_FUNCTION_CALL line1="191" col1="9" line2="191" col2="12" start="34962" end="34965">stop</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="191" col1="13" line2="191" col2="13" start="34966" end="34966">(</OP-LEFT-PAREN>
              <expr line1="191" col1="14" line2="191" col2="52" start="34967" end="35005">
                <STR_CONST line1="191" col1="14" line2="191" col2="52" start="34967" end="35005">"object must be a SingleCellExperiment"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="191" col1="53" line2="191" col2="53" start="35006" end="35006">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="192" col1="5" line2="192" col2="5" start="35141" end="35141">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="193" col1="5" line2="193" col2="48" start="35324" end="35367">
          <expr line1="193" col1="5" line2="193" col2="13" start="35324" end="35332">
            <SYMBOL line1="193" col1="5" line2="193" col2="13" start="35324" end="35332">exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="193" col1="15" line2="193" col2="16" start="35334" end="35335">&lt;-</LEFT_ASSIGN>
          <expr line1="193" col1="18" line2="193" col2="48" start="35337" end="35367">
            <expr line1="193" col1="18" line2="193" col2="22" start="35337" end="35341">
              <SYMBOL_FUNCTION_CALL line1="193" col1="18" line2="193" col2="22" start="35337" end="35341">assay</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="193" col1="23" line2="193" col2="23" start="35342" end="35342">(</OP-LEFT-PAREN>
            <expr line1="193" col1="24" line2="193" col2="29" start="35343" end="35348">
              <SYMBOL line1="193" col1="24" line2="193" col2="29" start="35343" end="35348">object</SYMBOL>
            </expr>
            <OP-COMMA line1="193" col1="30" line2="193" col2="30" start="35349" end="35349">,</OP-COMMA>
            <SYMBOL_SUB line1="193" col1="32" line2="193" col2="32" start="35351" end="35351">i</SYMBOL_SUB>
            <EQ_SUB line1="193" col1="34" line2="193" col2="34" start="35353" end="35353">=</EQ_SUB>
            <expr line1="193" col1="36" line2="193" col2="47" start="35355" end="35366">
              <SYMBOL line1="193" col1="36" line2="193" col2="47" start="35355" end="35366">exprs_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="193" col1="48" line2="193" col2="48" start="35367" end="35367">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="194" col1="5" line2="194" col2="42" start="35507" end="35544">
          <expr line1="194" col1="5" line2="194" col2="15" start="35507" end="35517">
            <SYMBOL line1="194" col1="5" line2="194" col2="15" start="35507" end="35517">percent_top</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="194" col1="17" line2="194" col2="18" start="35519" end="35520">&lt;-</LEFT_ASSIGN>
          <expr line1="194" col1="20" line2="194" col2="42" start="35522" end="35544">
            <expr line1="194" col1="20" line2="194" col2="29" start="35522" end="35531">
              <SYMBOL_FUNCTION_CALL line1="194" col1="20" line2="194" col2="29" start="35522" end="35531">as.integer</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="194" col1="30" line2="194" col2="30" start="35532" end="35532">(</OP-LEFT-PAREN>
            <expr line1="194" col1="31" line2="194" col2="41" start="35533" end="35543">
              <SYMBOL line1="194" col1="31" line2="194" col2="41" start="35533" end="35543">percent_top</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="194" col1="42" line2="194" col2="42" start="35544" end="35544">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="196" col1="5" line2="196" col2="50" start="35873" end="35918">### Adding general metrics for each cell. ### </COMMENT>
        <COMMENT line1="198" col1="5" line2="198" col2="68" start="36239" end="36302"># We first assemble the list of all metrics (all MUST be first).</COMMENT>
        <COMMENT line1="199" col1="5" line2="199" col2="80" start="36422" end="36497"># We also add any existing spike-ins to this set unless otherwise specified.</COMMENT>
        <expr line1="200" col1="5" line2="200" col2="38" start="36605" end="36638">
          <expr line1="200" col1="5" line2="200" col2="20" start="36605" end="36620">
            <SYMBOL line1="200" col1="5" line2="200" col2="20" start="36605" end="36620">all_feature_sets</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="200" col1="22" line2="200" col2="23" start="36622" end="36623">&lt;-</LEFT_ASSIGN>
          <expr line1="200" col1="25" line2="200" col2="38" start="36625" end="36638">
            <expr line1="200" col1="25" line2="200" col2="28" start="36625" end="36628">
              <SYMBOL_FUNCTION_CALL line1="200" col1="25" line2="200" col2="28" start="36625" end="36628">list</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="200" col1="29" line2="200" col2="29" start="36629" end="36629">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="200" col1="30" line2="200" col2="32" start="36630" end="36632">all</SYMBOL_SUB>
            <EQ_SUB line1="200" col1="33" line2="200" col2="33" start="36633" end="36633">=</EQ_SUB>
            <expr line1="200" col1="34" line2="200" col2="37" start="36634" end="36637">
              <NULL_CONST line1="200" col1="34" line2="200" col2="37" start="36634" end="36637">NULL</NULL_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="200" col1="38" line2="200" col2="38" start="36638" end="36638">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="201" col1="5" line2="201" col2="41" start="36788" end="36824">
          <expr line1="201" col1="5" line2="201" col2="19" start="36788" end="36802">
            <SYMBOL line1="201" col1="5" line2="201" col2="19" start="36788" end="36802">existing_spikes</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="201" col1="21" line2="201" col2="22" start="36804" end="36805">&lt;-</LEFT_ASSIGN>
          <expr line1="201" col1="24" line2="201" col2="41" start="36807" end="36824">
            <expr line1="201" col1="24" line2="201" col2="33" start="36807" end="36816">
              <SYMBOL_FUNCTION_CALL line1="201" col1="24" line2="201" col2="33" start="36807" end="36816">spikeNames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="201" col1="34" line2="201" col2="34" start="36817" end="36817">(</OP-LEFT-PAREN>
            <expr line1="201" col1="35" line2="201" col2="40" start="36818" end="36823">
              <SYMBOL line1="201" col1="35" line2="201" col2="40" start="36818" end="36823">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="201" col1="41" line2="201" col2="41" start="36824" end="36824">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="202" col1="5" line2="215" col2="5" start="36971" end="39350">
          <IF line1="202" col1="5" line2="202" col2="6" start="36971" end="36972">if</IF>
          <OP-LEFT-PAREN line1="202" col1="8" line2="202" col2="8" start="36974" end="36974">(</OP-LEFT-PAREN>
          <expr line1="202" col1="9" line2="202" col2="45" start="36975" end="37011">
            <expr line1="202" col1="9" line2="202" col2="18" start="36975" end="36984">
              <SYMBOL line1="202" col1="9" line2="202" col2="18" start="36975" end="36984">use_spikes</SYMBOL>
            </expr>
            <AND2 line1="202" col1="20" line2="202" col2="21" start="36986" end="36987">&amp;&amp;</AND2>
            <expr line1="202" col1="23" line2="202" col2="45" start="36989" end="37011">
              <expr line1="202" col1="23" line2="202" col2="28" start="36989" end="36994">
                <SYMBOL_FUNCTION_CALL line1="202" col1="23" line2="202" col2="28" start="36989" end="36994">length</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="202" col1="29" line2="202" col2="29" start="36995" end="36995">(</OP-LEFT-PAREN>
              <expr line1="202" col1="30" line2="202" col2="44" start="36996" end="37010">
                <SYMBOL line1="202" col1="30" line2="202" col2="44" start="36996" end="37010">existing_spikes</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="202" col1="45" line2="202" col2="45" start="37011" end="37011">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="202" col1="46" line2="202" col2="46" start="37012" end="37012">)</OP-RIGHT-PAREN>
          <expr line1="202" col1="48" line2="215" col2="5" start="37014" end="39350">
            <OP-LEFT-BRACE line1="202" col1="48" line2="202" col2="48" start="37014" end="37014">{</OP-LEFT-BRACE>
            <expr line1="203" col1="9" line2="203" col2="59" start="37158" end="37208">
              <expr line1="203" col1="9" line2="203" col2="16" start="37158" end="37165">
                <SYMBOL line1="203" col1="9" line2="203" col2="16" start="37158" end="37165">existing</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="203" col1="18" line2="203" col2="19" start="37167" end="37168">&lt;-</LEFT_ASSIGN>
              <expr line1="203" col1="21" line2="203" col2="59" start="37170" end="37208">
                <expr line1="203" col1="21" line2="203" col2="26" start="37170" end="37175">
                  <SYMBOL_FUNCTION_CALL line1="203" col1="21" line2="203" col2="26" start="37170" end="37175">vector</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="203" col1="27" line2="203" col2="27" start="37176" end="37176">(</OP-LEFT-PAREN>
                <expr line1="203" col1="28" line2="203" col2="33" start="37177" end="37182">
                  <STR_CONST line1="203" col1="28" line2="203" col2="33" start="37177" end="37182">"list"</STR_CONST>
                </expr>
                <OP-COMMA line1="203" col1="34" line2="203" col2="34" start="37183" end="37183">,</OP-COMMA>
                <expr line1="203" col1="36" line2="203" col2="58" start="37185" end="37207">
                  <expr line1="203" col1="36" line2="203" col2="41" start="37185" end="37190">
                    <SYMBOL_FUNCTION_CALL line1="203" col1="36" line2="203" col2="41" start="37185" end="37190">length</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="203" col1="42" line2="203" col2="42" start="37191" end="37191">(</OP-LEFT-PAREN>
                  <expr line1="203" col1="43" line2="203" col2="57" start="37192" end="37206">
                    <SYMBOL line1="203" col1="43" line2="203" col2="57" start="37192" end="37206">existing_spikes</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="203" col1="58" line2="203" col2="58" start="37207" end="37207">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="203" col1="59" line2="203" col2="59" start="37208" end="37208">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="204" col1="9" line2="204" col2="42" start="37341" end="37374">
              <expr line1="204" col1="9" line2="204" col2="23" start="37341" end="37355">
                <expr line1="204" col1="9" line2="204" col2="13" start="37341" end="37345">
                  <SYMBOL_FUNCTION_CALL line1="204" col1="9" line2="204" col2="13" start="37341" end="37345">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="204" col1="14" line2="204" col2="14" start="37346" end="37346">(</OP-LEFT-PAREN>
                <expr line1="204" col1="15" line2="204" col2="22" start="37347" end="37354">
                  <SYMBOL line1="204" col1="15" line2="204" col2="22" start="37347" end="37354">existing</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="204" col1="23" line2="204" col2="23" start="37355" end="37355">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="204" col1="25" line2="204" col2="26" start="37357" end="37358">&lt;-</LEFT_ASSIGN>
              <expr line1="204" col1="28" line2="204" col2="42" start="37360" end="37374">
                <SYMBOL line1="204" col1="28" line2="204" col2="42" start="37360" end="37374">existing_spikes</SYMBOL>
              </expr>
            </expr>
            <expr line1="205" col1="9" line2="207" col2="9" start="37524" end="37890">
              <FOR line1="205" col1="9" line2="205" col2="11" start="37524" end="37526">for</FOR>
              <forcond line1="205" col1="13" line2="205" col2="38" start="37528" end="37553">
                <OP-LEFT-PAREN line1="205" col1="13" line2="205" col2="13" start="37528" end="37528">(</OP-LEFT-PAREN>
                <SYMBOL line1="205" col1="14" line2="205" col2="18" start="37529" end="37533">spset</SYMBOL>
                <IN line1="205" col1="20" line2="205" col2="21" start="37535" end="37536">in</IN>
                <expr line1="205" col1="23" line2="205" col2="37" start="37538" end="37552">
                  <SYMBOL line1="205" col1="23" line2="205" col2="37" start="37538" end="37552">existing_spikes</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="205" col1="38" line2="205" col2="38" start="37553" end="37553">)</OP-RIGHT-PAREN>
              </forcond>
              <expr line1="205" col1="40" line2="207" col2="9" start="37555" end="37890">
                <OP-LEFT-BRACE line1="205" col1="40" line2="205" col2="40" start="37555" end="37555">{</OP-LEFT-BRACE>
                <expr line1="206" col1="13" line2="206" col2="60" start="37711" end="37758">
                  <expr line1="206" col1="13" line2="206" col2="29" start="37711" end="37727">
                    <expr line1="206" col1="13" line2="206" col2="20" start="37711" end="37718">
                      <SYMBOL line1="206" col1="13" line2="206" col2="20" start="37711" end="37718">existing</SYMBOL>
                    </expr>
                    <LBB line1="206" col1="21" line2="206" col2="22" start="37719" end="37720">[[</LBB>
                    <expr line1="206" col1="23" line2="206" col2="27" start="37721" end="37725">
                      <SYMBOL line1="206" col1="23" line2="206" col2="27" start="37721" end="37725">spset</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACKET line1="206" col1="28" line2="206" col2="28" start="37726" end="37726">]</OP-RIGHT-BRACKET>
                    <OP-RIGHT-BRACKET line1="206" col1="29" line2="206" col2="29" start="37727" end="37727">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="206" col1="31" line2="206" col2="32" start="37729" end="37730">&lt;-</LEFT_ASSIGN>
                  <expr line1="206" col1="34" line2="206" col2="60" start="37732" end="37758">
                    <expr line1="206" col1="34" line2="206" col2="40" start="37732" end="37738">
                      <SYMBOL_FUNCTION_CALL line1="206" col1="34" line2="206" col2="40" start="37732" end="37738">isSpike</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="206" col1="41" line2="206" col2="41" start="37739" end="37739">(</OP-LEFT-PAREN>
                    <expr line1="206" col1="42" line2="206" col2="47" start="37740" end="37745">
                      <SYMBOL line1="206" col1="42" line2="206" col2="47" start="37740" end="37745">object</SYMBOL>
                    </expr>
                    <OP-COMMA line1="206" col1="48" line2="206" col2="48" start="37746" end="37746">,</OP-COMMA>
                    <SYMBOL_SUB line1="206" col1="50" line2="206" col2="53" start="37748" end="37751">type</SYMBOL_SUB>
                    <EQ_SUB line1="206" col1="54" line2="206" col2="54" start="37752" end="37752">=</EQ_SUB>
                    <expr line1="206" col1="55" line2="206" col2="59" start="37753" end="37757">
                      <SYMBOL line1="206" col1="55" line2="206" col2="59" start="37753" end="37757">spset</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="206" col1="60" line2="206" col2="60" start="37758" end="37758">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="207" col1="9" line2="207" col2="9" start="37890" end="37890">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="209" col1="9" line2="209" col2="69" start="38256" end="38316">
              <expr line1="209" col1="9" line2="209" col2="21" start="38256" end="38268">
                <SYMBOL line1="209" col1="9" line2="209" col2="21" start="38256" end="38268">already_there</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="209" col1="23" line2="209" col2="24" start="38270" end="38271">&lt;-</LEFT_ASSIGN>
              <expr line1="209" col1="26" line2="209" col2="69" start="38273" end="38316">
                <expr line1="209" col1="26" line2="209" col2="40" start="38273" end="38287">
                  <expr line1="209" col1="26" line2="209" col2="30" start="38273" end="38277">
                    <SYMBOL_FUNCTION_CALL line1="209" col1="26" line2="209" col2="30" start="38273" end="38277">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="209" col1="31" line2="209" col2="31" start="38278" end="38278">(</OP-LEFT-PAREN>
                  <expr line1="209" col1="32" line2="209" col2="39" start="38279" end="38286">
                    <SYMBOL line1="209" col1="32" line2="209" col2="39" start="38279" end="38286">existing</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="209" col1="40" line2="209" col2="40" start="38287" end="38287">)</OP-RIGHT-PAREN>
                </expr>
                <SPECIAL line1="209" col1="42" line2="209" col2="45" start="38289" end="38292">%in%</SPECIAL>
                <expr line1="209" col1="47" line2="209" col2="69" start="38294" end="38316">
                  <expr line1="209" col1="47" line2="209" col2="51" start="38294" end="38298">
                    <SYMBOL_FUNCTION_CALL line1="209" col1="47" line2="209" col2="51" start="38294" end="38298">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="209" col1="52" line2="209" col2="52" start="38299" end="38299">(</OP-LEFT-PAREN>
                  <expr line1="209" col1="53" line2="209" col2="68" start="38300" end="38315">
                    <SYMBOL line1="209" col1="53" line2="209" col2="68" start="38300" end="38315">feature_controls</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="209" col1="69" line2="209" col2="69" start="38316" end="38316">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
            </expr>
            <expr line1="210" col1="9" line2="213" col2="9" start="38439" end="38988">
              <IF line1="210" col1="9" line2="210" col2="10" start="38439" end="38440">if</IF>
              <OP-LEFT-PAREN line1="210" col1="12" line2="210" col2="12" start="38442" end="38442">(</OP-LEFT-PAREN>
              <expr line1="210" col1="13" line2="210" col2="30" start="38443" end="38460">
                <expr line1="210" col1="13" line2="210" col2="15" start="38443" end="38445">
                  <SYMBOL_FUNCTION_CALL line1="210" col1="13" line2="210" col2="15" start="38443" end="38445">any</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="210" col1="16" line2="210" col2="16" start="38446" end="38446">(</OP-LEFT-PAREN>
                <expr line1="210" col1="17" line2="210" col2="29" start="38447" end="38459">
                  <SYMBOL line1="210" col1="17" line2="210" col2="29" start="38447" end="38459">already_there</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="210" col1="30" line2="210" col2="30" start="38460" end="38460">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="210" col1="31" line2="210" col2="31" start="38461" end="38461">)</OP-RIGHT-PAREN>
              <expr line1="210" col1="33" line2="213" col2="9" start="38463" end="38988">
                <OP-LEFT-BRACE line1="210" col1="33" line2="210" col2="33" start="38463" end="38463">{</OP-LEFT-BRACE>
                <expr line1="211" col1="13" line2="212" col2="55" start="38626" end="38851">
                  <expr line1="211" col1="13" line2="211" col2="19" start="38626" end="38632">
                    <SYMBOL_FUNCTION_CALL line1="211" col1="13" line2="211" col2="19" start="38626" end="38632">warning</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="211" col1="20" line2="211" col2="20" start="38633" end="38633">(</OP-LEFT-PAREN>
                  <expr line1="211" col1="21" line2="212" col2="54" start="38634" end="38850">
                    <expr line1="211" col1="21" line2="211" col2="27" start="38634" end="38640">
                      <SYMBOL_FUNCTION_CALL line1="211" col1="21" line2="211" col2="27" start="38634" end="38640">sprintf</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="211" col1="28" line2="211" col2="28" start="38641" end="38641">(</OP-LEFT-PAREN>
                    <expr line1="211" col1="29" line2="211" col2="100" start="38642" end="38713">
                      <STR_CONST line1="211" col1="29" line2="211" col2="100" start="38642" end="38713">"spike-in set '%s' overwritten by feature_controls set of the same name"</STR_CONST>
                    </expr>
                    <OP-COMMA line1="211" col1="101" line2="211" col2="101" start="38714" end="38714">,</OP-COMMA>
                    <expr line1="212" col1="21" line2="212" col2="53" start="38817" end="38849">
                      <expr line1="212" col1="21" line2="212" col2="50" start="38817" end="38846">
                        <expr line1="212" col1="21" line2="212" col2="35" start="38817" end="38831">
                          <expr line1="212" col1="21" line2="212" col2="25" start="38817" end="38821">
                            <SYMBOL_FUNCTION_CALL line1="212" col1="21" line2="212" col2="25" start="38817" end="38821">names</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="212" col1="26" line2="212" col2="26" start="38822" end="38822">(</OP-LEFT-PAREN>
                          <expr line1="212" col1="27" line2="212" col2="34" start="38823" end="38830">
                            <SYMBOL line1="212" col1="27" line2="212" col2="34" start="38823" end="38830">existing</SYMBOL>
                          </expr>
                          <OP-RIGHT-PAREN line1="212" col1="35" line2="212" col2="35" start="38831" end="38831">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-LEFT-BRACKET line1="212" col1="36" line2="212" col2="36" start="38832" end="38832">[</OP-LEFT-BRACKET>
                        <expr line1="212" col1="37" line2="212" col2="49" start="38833" end="38845">
                          <SYMBOL line1="212" col1="37" line2="212" col2="49" start="38833" end="38845">already_there</SYMBOL>
                        </expr>
                        <OP-RIGHT-BRACKET line1="212" col1="50" line2="212" col2="50" start="38846" end="38846">]</OP-RIGHT-BRACKET>
                      </expr>
                      <OP-LEFT-BRACKET line1="212" col1="51" line2="212" col2="51" start="38847" end="38847">[</OP-LEFT-BRACKET>
                      <expr line1="212" col1="52" line2="212" col2="52" start="38848" end="38848">
                        <NUM_CONST line1="212" col1="52" line2="212" col2="52" start="38848" end="38848">1</NUM_CONST>
                      </expr>
                      <OP-RIGHT-BRACKET line1="212" col1="53" line2="212" col2="53" start="38849" end="38849">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-RIGHT-PAREN line1="212" col1="54" line2="212" col2="54" start="38850" end="38850">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="212" col1="55" line2="212" col2="55" start="38851" end="38851">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="213" col1="9" line2="213" col2="9" start="38988" end="38988">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="214" col1="9" line2="214" col2="73" start="39171" end="39235">
              <expr line1="214" col1="9" line2="214" col2="24" start="39171" end="39186">
                <SYMBOL line1="214" col1="9" line2="214" col2="24" start="39171" end="39186">feature_controls</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="214" col1="26" line2="214" col2="27" start="39188" end="39189">&lt;-</LEFT_ASSIGN>
              <expr line1="214" col1="29" line2="214" col2="73" start="39191" end="39235">
                <expr line1="214" col1="29" line2="214" col2="29" start="39191" end="39191">
                  <SYMBOL_FUNCTION_CALL line1="214" col1="29" line2="214" col2="29" start="39191" end="39191">c</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="214" col1="30" line2="214" col2="30" start="39192" end="39192">(</OP-LEFT-PAREN>
                <expr line1="214" col1="31" line2="214" col2="46" start="39193" end="39208">
                  <SYMBOL line1="214" col1="31" line2="214" col2="46" start="39193" end="39208">feature_controls</SYMBOL>
                </expr>
                <OP-COMMA line1="214" col1="47" line2="214" col2="47" start="39209" end="39209">,</OP-COMMA>
                <expr line1="214" col1="49" line2="214" col2="72" start="39211" end="39234">
                  <expr line1="214" col1="49" line2="214" col2="56" start="39211" end="39218">
                    <SYMBOL line1="214" col1="49" line2="214" col2="56" start="39211" end="39218">existing</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="214" col1="57" line2="214" col2="57" start="39219" end="39219">[</OP-LEFT-BRACKET>
                  <expr line1="214" col1="58" line2="214" col2="71" start="39220" end="39233">
                    <OP-EXCLAMATION line1="214" col1="58" line2="214" col2="58" start="39220" end="39220">!</OP-EXCLAMATION>
                    <expr line1="214" col1="59" line2="214" col2="71" start="39221" end="39233">
                      <SYMBOL line1="214" col1="59" line2="214" col2="71" start="39221" end="39233">already_there</SYMBOL>
                    </expr>
                  </expr>
                  <OP-RIGHT-BRACKET line1="214" col1="72" line2="214" col2="72" start="39234" end="39234">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="214" col1="73" line2="214" col2="73" start="39235" end="39235">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="215" col1="5" line2="215" col2="5" start="39350" end="39350">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="217" col1="5" line2="217" col2="31" start="39716" end="39742">
          <expr line1="217" col1="5" line2="217" col2="21" start="39716" end="39732">
            <SYMBOL line1="217" col1="5" line2="217" col2="21" start="39716" end="39732">feature_set_rdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="217" col1="23" line2="217" col2="24" start="39734" end="39735">&lt;-</LEFT_ASSIGN>
          <expr line1="217" col1="26" line2="217" col2="31" start="39737" end="39742">
            <expr line1="217" col1="26" line2="217" col2="29" start="39737" end="39740">
              <SYMBOL_FUNCTION_CALL line1="217" col1="26" line2="217" col2="29" start="39737" end="39740">list</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="217" col1="30" line2="217" col2="30" start="39741" end="39741">(</OP-LEFT-PAREN>
            <OP-RIGHT-PAREN line1="217" col1="31" line2="217" col2="31" start="39742" end="39742">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="218" col1="5" line2="241" col2="5" start="39899" end="44108">
          <IF line1="218" col1="5" line2="218" col2="6" start="39899" end="39900">if</IF>
          <OP-LEFT-PAREN line1="218" col1="8" line2="218" col2="8" start="39902" end="39902">(</OP-LEFT-PAREN>
          <expr line1="218" col1="9" line2="218" col2="32" start="39903" end="39926">
            <expr line1="218" col1="9" line2="218" col2="14" start="39903" end="39908">
              <SYMBOL_FUNCTION_CALL line1="218" col1="9" line2="218" col2="14" start="39903" end="39908">length</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="218" col1="15" line2="218" col2="15" start="39909" end="39909">(</OP-LEFT-PAREN>
            <expr line1="218" col1="16" line2="218" col2="31" start="39910" end="39925">
              <SYMBOL line1="218" col1="16" line2="218" col2="31" start="39910" end="39925">feature_controls</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="218" col1="32" line2="218" col2="32" start="39926" end="39926">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="218" col1="33" line2="218" col2="33" start="39927" end="39927">)</OP-RIGHT-PAREN>
          <expr line1="218" col1="35" line2="239" col2="5" start="39929" end="43742">
            <OP-LEFT-BRACE line1="218" col1="35" line2="218" col2="35" start="39929" end="39929">{</OP-LEFT-BRACE>
            <expr line1="219" col1="9" line2="221" col2="9" start="40086" end="40452">
              <IF line1="219" col1="9" line2="219" col2="10" start="40086" end="40087">if</IF>
              <OP-LEFT-PAREN line1="219" col1="12" line2="219" col2="12" start="40089" end="40089">(</OP-LEFT-PAREN>
              <expr line1="219" col1="13" line2="219" col2="44" start="40090" end="40121">
                <expr line1="219" col1="13" line2="219" col2="19" start="40090" end="40096">
                  <SYMBOL_FUNCTION_CALL line1="219" col1="13" line2="219" col2="19" start="40090" end="40096">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="219" col1="20" line2="219" col2="20" start="40097" end="40097">(</OP-LEFT-PAREN>
                <expr line1="219" col1="21" line2="219" col2="43" start="40098" end="40120">
                  <expr line1="219" col1="21" line2="219" col2="25" start="40098" end="40102">
                    <SYMBOL_FUNCTION_CALL line1="219" col1="21" line2="219" col2="25" start="40098" end="40102">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="219" col1="26" line2="219" col2="26" start="40103" end="40103">(</OP-LEFT-PAREN>
                  <expr line1="219" col1="27" line2="219" col2="42" start="40104" end="40119">
                    <SYMBOL line1="219" col1="27" line2="219" col2="42" start="40104" end="40119">feature_controls</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="219" col1="43" line2="219" col2="43" start="40120" end="40120">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="219" col1="44" line2="219" col2="44" start="40121" end="40121">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="219" col1="45" line2="219" col2="45" start="40122" end="40122">)</OP-RIGHT-PAREN>
              <expr line1="219" col1="47" line2="221" col2="9" start="40124" end="40452">
                <OP-LEFT-BRACE line1="219" col1="47" line2="219" col2="47" start="40124" end="40124">{</OP-LEFT-BRACE>
                <expr line1="220" col1="13" line2="220" col2="52" start="40273" end="40312">
                  <expr line1="220" col1="13" line2="220" col2="16" start="40273" end="40276">
                    <SYMBOL_FUNCTION_CALL line1="220" col1="13" line2="220" col2="16" start="40273" end="40276">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="220" col1="17" line2="220" col2="17" start="40277" end="40277">(</OP-LEFT-PAREN>
                  <expr line1="220" col1="18" line2="220" col2="51" start="40278" end="40311">
                    <STR_CONST line1="220" col1="18" line2="220" col2="51" start="40278" end="40311">"feature_controls should be named"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="220" col1="52" line2="220" col2="52" start="40312" end="40312">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="221" col1="9" line2="221" col2="9" start="40452" end="40452">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <COMMENT line1="223" col1="9" line2="223" col2="61" start="40818" end="40870"># Converting to integer indices for all applications.</COMMENT>
            <expr line1="224" col1="9" line2="224" col2="86" start="41001" end="41078">
              <expr line1="224" col1="9" line2="224" col2="17" start="41001" end="41009">
                <SYMBOL line1="224" col1="9" line2="224" col2="17" start="41001" end="41009">reindexed</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="224" col1="19" line2="224" col2="20" start="41011" end="41012">&lt;-</LEFT_ASSIGN>
              <expr line1="224" col1="22" line2="224" col2="86" start="41014" end="41078">
                <expr line1="224" col1="22" line2="224" col2="27" start="41014" end="41019">
                  <SYMBOL_FUNCTION_CALL line1="224" col1="22" line2="224" col2="27" start="41014" end="41019">lapply</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="224" col1="28" line2="224" col2="28" start="41020" end="41020">(</OP-LEFT-PAREN>
                <expr line1="224" col1="29" line2="224" col2="44" start="41021" end="41036">
                  <SYMBOL line1="224" col1="29" line2="224" col2="44" start="41021" end="41036">feature_controls</SYMBOL>
                </expr>
                <OP-COMMA line1="224" col1="45" line2="224" col2="45" start="41037" end="41037">,</OP-COMMA>
                <SYMBOL_SUB line1="224" col1="47" line2="224" col2="49" start="41039" end="41041">FUN</SYMBOL_SUB>
                <EQ_SUB line1="224" col1="51" line2="224" col2="51" start="41043" end="41043">=</EQ_SUB>
                <expr line1="224" col1="53" line2="224" col2="65" start="41045" end="41057">
                  <SYMBOL line1="224" col1="53" line2="224" col2="65" start="41045" end="41057">.subset2index</SYMBOL>
                </expr>
                <OP-COMMA line1="224" col1="66" line2="224" col2="66" start="41058" end="41058">,</OP-COMMA>
                <SYMBOL_SUB line1="224" col1="68" line2="224" col2="73" start="41060" end="41065">target</SYMBOL_SUB>
                <EQ_SUB line1="224" col1="75" line2="224" col2="75" start="41067" end="41067">=</EQ_SUB>
                <expr line1="224" col1="77" line2="224" col2="85" start="41069" end="41077">
                  <SYMBOL line1="224" col1="77" line2="224" col2="85" start="41069" end="41077">exprs_mat</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="224" col1="86" line2="224" col2="86" start="41078" end="41078">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="225" col1="9" line2="225" col2="75" start="41184" end="41250">
              <expr line1="225" col1="9" line2="225" col2="24" start="41184" end="41199">
                <expr line1="225" col1="9" line2="225" col2="13" start="41184" end="41188">
                  <SYMBOL_FUNCTION_CALL line1="225" col1="9" line2="225" col2="13" start="41184" end="41188">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="225" col1="14" line2="225" col2="14" start="41189" end="41189">(</OP-LEFT-PAREN>
                <expr line1="225" col1="15" line2="225" col2="23" start="41190" end="41198">
                  <SYMBOL line1="225" col1="15" line2="225" col2="23" start="41190" end="41198">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="225" col1="24" line2="225" col2="24" start="41199" end="41199">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="225" col1="26" line2="225" col2="27" start="41201" end="41202">&lt;-</LEFT_ASSIGN>
              <expr line1="225" col1="29" line2="225" col2="75" start="41204" end="41250">
                <expr line1="225" col1="29" line2="225" col2="35" start="41204" end="41210">
                  <SYMBOL_FUNCTION_CALL line1="225" col1="29" line2="225" col2="35" start="41204" end="41210">sprintf</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="225" col1="36" line2="225" col2="36" start="41211" end="41211">(</OP-LEFT-PAREN>
                <expr line1="225" col1="37" line2="225" col2="56" start="41212" end="41231">
                  <STR_CONST line1="225" col1="37" line2="225" col2="56" start="41212" end="41231">"feature_control_%s"</STR_CONST>
                </expr>
                <OP-COMMA line1="225" col1="57" line2="225" col2="57" start="41232" end="41232">,</OP-COMMA>
                <expr line1="225" col1="59" line2="225" col2="74" start="41234" end="41249">
                  <expr line1="225" col1="59" line2="225" col2="63" start="41234" end="41238">
                    <SYMBOL_FUNCTION_CALL line1="225" col1="59" line2="225" col2="63" start="41234" end="41238">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="225" col1="64" line2="225" col2="64" start="41239" end="41239">(</OP-LEFT-PAREN>
                  <expr line1="225" col1="65" line2="225" col2="73" start="41240" end="41248">
                    <SYMBOL line1="225" col1="65" line2="225" col2="73" start="41240" end="41248">reindexed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="225" col1="74" line2="225" col2="74" start="41249" end="41249">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="225" col1="75" line2="225" col2="75" start="41250" end="41250">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="227" col1="9" line2="227" col2="43" start="41550" end="41584">
              <expr line1="227" col1="9" line2="227" col2="15" start="41550" end="41556">
                <SYMBOL line1="227" col1="9" line2="227" col2="15" start="41550" end="41556">is_fcon</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="227" col1="17" line2="227" col2="18" start="41558" end="41559">&lt;-</LEFT_ASSIGN>
              <expr line1="227" col1="20" line2="227" col2="43" start="41561" end="41584">
                <expr line1="227" col1="20" line2="227" col2="25" start="41561" end="41566">
                  <SYMBOL_FUNCTION_CALL line1="227" col1="20" line2="227" col2="25" start="41561" end="41566">Reduce</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="227" col1="26" line2="227" col2="26" start="41567" end="41567">(</OP-LEFT-PAREN>
                <expr line1="227" col1="27" line2="227" col2="31" start="41568" end="41572">
                  <SYMBOL line1="227" col1="27" line2="227" col2="31" start="41568" end="41572">union</SYMBOL>
                </expr>
                <OP-COMMA line1="227" col1="32" line2="227" col2="32" start="41573" end="41573">,</OP-COMMA>
                <expr line1="227" col1="34" line2="227" col2="42" start="41575" end="41583">
                  <SYMBOL line1="227" col1="34" line2="227" col2="42" start="41575" end="41583">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="227" col1="43" line2="227" col2="43" start="41584" end="41584">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="228" col1="9" line2="228" col2="54" start="41733" end="41778">
              <expr line1="228" col1="9" line2="228" col2="16" start="41733" end="41740">
                <SYMBOL line1="228" col1="9" line2="228" col2="16" start="41733" end="41740">is_endog</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="228" col1="18" line2="228" col2="19" start="41742" end="41743">&lt;-</LEFT_ASSIGN>
              <expr line1="228" col1="21" line2="228" col2="54" start="41745" end="41778">
                <expr line1="228" col1="21" line2="228" col2="44" start="41745" end="41768">
                  <expr line1="228" col1="21" line2="228" col2="27" start="41745" end="41751">
                    <SYMBOL_FUNCTION_CALL line1="228" col1="21" line2="228" col2="27" start="41745" end="41751">seq_len</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="228" col1="28" line2="228" col2="28" start="41752" end="41752">(</OP-LEFT-PAREN>
                  <expr line1="228" col1="29" line2="228" col2="43" start="41753" end="41767">
                    <expr line1="228" col1="29" line2="228" col2="32" start="41753" end="41756">
                      <SYMBOL_FUNCTION_CALL line1="228" col1="29" line2="228" col2="32" start="41753" end="41756">nrow</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="228" col1="33" line2="228" col2="33" start="41757" end="41757">(</OP-LEFT-PAREN>
                    <expr line1="228" col1="34" line2="228" col2="42" start="41758" end="41766">
                      <SYMBOL line1="228" col1="34" line2="228" col2="42" start="41758" end="41766">exprs_mat</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="228" col1="43" line2="228" col2="43" start="41767" end="41767">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="228" col1="44" line2="228" col2="44" start="41768" end="41768">)</OP-RIGHT-PAREN>
                </expr>
                <OP-LEFT-BRACKET line1="228" col1="45" line2="228" col2="45" start="41769" end="41769">[</OP-LEFT-BRACKET>
                <expr line1="228" col1="46" line2="228" col2="53" start="41770" end="41777">
                  <OP-MINUS line1="228" col1="46" line2="228" col2="46" start="41770" end="41770">-</OP-MINUS>
                  <expr line1="228" col1="47" line2="228" col2="53" start="41771" end="41777">
                    <SYMBOL line1="228" col1="47" line2="228" col2="53" start="41771" end="41777">is_fcon</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACKET line1="228" col1="54" line2="228" col2="54" start="41778" end="41778">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="229" col1="9" line2="229" col2="110" start="41916" end="42017">
              <expr line1="229" col1="9" line2="229" col2="24" start="41916" end="41931">
                <SYMBOL line1="229" col1="9" line2="229" col2="24" start="41916" end="41931">all_feature_sets</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="229" col1="26" line2="229" col2="27" start="41933" end="41934">&lt;-</LEFT_ASSIGN>
              <expr line1="229" col1="29" line2="229" col2="110" start="41936" end="42017">
                <expr line1="229" col1="29" line2="229" col2="29" start="41936" end="41936">
                  <SYMBOL_FUNCTION_CALL line1="229" col1="29" line2="229" col2="29" start="41936" end="41936">c</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="229" col1="30" line2="229" col2="30" start="41937" end="41937">(</OP-LEFT-PAREN>
                <expr line1="229" col1="31" line2="229" col2="46" start="41938" end="41953">
                  <SYMBOL line1="229" col1="31" line2="229" col2="46" start="41938" end="41953">all_feature_sets</SYMBOL>
                </expr>
                <OP-COMMA line1="229" col1="47" line2="229" col2="47" start="41954" end="41954">,</OP-COMMA>
                <expr line1="229" col1="49" line2="229" col2="98" start="41956" end="42005">
                  <expr line1="229" col1="49" line2="229" col2="52" start="41956" end="41959">
                    <SYMBOL_FUNCTION_CALL line1="229" col1="49" line2="229" col2="52" start="41956" end="41959">list</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="229" col1="53" line2="229" col2="53" start="41960" end="41960">(</OP-LEFT-PAREN>
                  <SYMBOL_SUB line1="229" col1="54" line2="229" col2="63" start="41961" end="41970">endogenous</SYMBOL_SUB>
                  <EQ_SUB line1="229" col1="64" line2="229" col2="64" start="41971" end="41971">=</EQ_SUB>
                  <expr line1="229" col1="65" line2="229" col2="72" start="41972" end="41979">
                    <SYMBOL line1="229" col1="65" line2="229" col2="72" start="41972" end="41979">is_endog</SYMBOL>
                  </expr>
                  <OP-COMMA line1="229" col1="73" line2="229" col2="73" start="41980" end="41980">,</OP-COMMA>
                  <SYMBOL_SUB line1="229" col1="75" line2="229" col2="89" start="41982" end="41996">feature_control</SYMBOL_SUB>
                  <EQ_SUB line1="229" col1="90" line2="229" col2="90" start="41997" end="41997">=</EQ_SUB>
                  <expr line1="229" col1="91" line2="229" col2="97" start="41998" end="42004">
                    <SYMBOL line1="229" col1="91" line2="229" col2="97" start="41998" end="42004">is_fcon</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="229" col1="98" line2="229" col2="98" start="42005" end="42005">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="229" col1="99" line2="229" col2="99" start="42006" end="42006">,</OP-COMMA>
                <expr line1="229" col1="101" line2="229" col2="109" start="42008" end="42016">
                  <SYMBOL line1="229" col1="101" line2="229" col2="109" start="42008" end="42016">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="229" col1="110" line2="229" col2="110" start="42017" end="42017">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <COMMENT line1="231" col1="9" line2="231" col2="54" start="42282" end="42327"># But storing logical vectors in the metadata.</COMMENT>
            <expr line1="232" col1="9" line2="232" col2="64" start="42465" end="42520">
              <expr line1="232" col1="9" line2="232" col2="25" start="42465" end="42481">
                <SYMBOL line1="232" col1="9" line2="232" col2="25" start="42465" end="42481">feature_set_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="232" col1="27" line2="232" col2="28" start="42483" end="42484">&lt;-</LEFT_ASSIGN>
              <expr line1="232" col1="30" line2="232" col2="64" start="42486" end="42520">
                <expr line1="232" col1="30" line2="232" col2="35" start="42486" end="42491">
                  <SYMBOL_FUNCTION_CALL line1="232" col1="30" line2="232" col2="35" start="42486" end="42491">vector</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="232" col1="36" line2="232" col2="36" start="42492" end="42492">(</OP-LEFT-PAREN>
                <expr line1="232" col1="37" line2="232" col2="42" start="42493" end="42498">
                  <STR_CONST line1="232" col1="37" line2="232" col2="42" start="42493" end="42498">"list"</STR_CONST>
                </expr>
                <OP-COMMA line1="232" col1="43" line2="232" col2="43" start="42499" end="42499">,</OP-COMMA>
                <expr line1="232" col1="45" line2="232" col2="63" start="42501" end="42519">
                  <expr line1="232" col1="45" line2="232" col2="61" start="42501" end="42517">
                    <expr line1="232" col1="45" line2="232" col2="50" start="42501" end="42506">
                      <SYMBOL_FUNCTION_CALL line1="232" col1="45" line2="232" col2="50" start="42501" end="42506">length</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="232" col1="51" line2="232" col2="51" start="42507" end="42507">(</OP-LEFT-PAREN>
                    <expr line1="232" col1="52" line2="232" col2="60" start="42508" end="42516">
                      <SYMBOL line1="232" col1="52" line2="232" col2="60" start="42508" end="42516">reindexed</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="232" col1="61" line2="232" col2="61" start="42517" end="42517">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-PLUS line1="232" col1="62" line2="232" col2="62" start="42518" end="42518">+</OP-PLUS>
                  <expr line1="232" col1="63" line2="232" col2="63" start="42519" end="42519">
                    <NUM_CONST line1="232" col1="63" line2="232" col2="63" start="42519" end="42519">1</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="232" col1="64" line2="232" col2="64" start="42520" end="42520">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="233" col1="9" line2="233" col2="75" start="42648" end="42714">
              <expr line1="233" col1="9" line2="233" col2="32" start="42648" end="42671">
                <expr line1="233" col1="9" line2="233" col2="13" start="42648" end="42652">
                  <SYMBOL_FUNCTION_CALL line1="233" col1="9" line2="233" col2="13" start="42648" end="42652">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="233" col1="14" line2="233" col2="14" start="42653" end="42653">(</OP-LEFT-PAREN>
                <expr line1="233" col1="15" line2="233" col2="31" start="42654" end="42670">
                  <SYMBOL line1="233" col1="15" line2="233" col2="31" start="42654" end="42670">feature_set_rdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="233" col1="32" line2="233" col2="32" start="42671" end="42671">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="233" col1="34" line2="233" col2="35" start="42673" end="42674">&lt;-</LEFT_ASSIGN>
              <expr line1="233" col1="38" line2="233" col2="75" start="42677" end="42714">
                <expr line1="233" col1="38" line2="233" col2="38" start="42677" end="42677">
                  <SYMBOL_FUNCTION_CALL line1="233" col1="38" line2="233" col2="38" start="42677" end="42677">c</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="233" col1="39" line2="233" col2="39" start="42678" end="42678">(</OP-LEFT-PAREN>
                <expr line1="233" col1="40" line2="233" col2="56" start="42679" end="42695">
                  <STR_CONST line1="233" col1="40" line2="233" col2="56" start="42679" end="42695">"feature_control"</STR_CONST>
                </expr>
                <OP-COMMA line1="233" col1="57" line2="233" col2="57" start="42696" end="42696">,</OP-COMMA>
                <expr line1="233" col1="59" line2="233" col2="74" start="42698" end="42713">
                  <expr line1="233" col1="59" line2="233" col2="63" start="42698" end="42702">
                    <SYMBOL_FUNCTION_CALL line1="233" col1="59" line2="233" col2="63" start="42698" end="42702">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="233" col1="64" line2="233" col2="64" start="42703" end="42703">(</OP-LEFT-PAREN>
                  <expr line1="233" col1="65" line2="233" col2="73" start="42704" end="42712">
                    <SYMBOL line1="233" col1="65" line2="233" col2="73" start="42704" end="42712">reindexed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="233" col1="74" line2="233" col2="74" start="42713" end="42713">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="233" col1="75" line2="233" col2="75" start="42714" end="42714">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="234" col1="9" line2="238" col2="9" start="42831" end="43563">
              <FOR line1="234" col1="9" line2="234" col2="11" start="42831" end="42833">for</FOR>
              <forcond line1="234" col1="13" line2="234" col2="45" start="42835" end="42867">
                <OP-LEFT-PAREN line1="234" col1="13" line2="234" col2="13" start="42835" end="42835">(</OP-LEFT-PAREN>
                <SYMBOL line1="234" col1="14" line2="234" col2="16" start="42836" end="42838">set</SYMBOL>
                <IN line1="234" col1="18" line2="234" col2="19" start="42840" end="42841">in</IN>
                <expr line1="234" col1="21" line2="234" col2="44" start="42843" end="42866">
                  <expr line1="234" col1="21" line2="234" col2="25" start="42843" end="42847">
                    <SYMBOL_FUNCTION_CALL line1="234" col1="21" line2="234" col2="25" start="42843" end="42847">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="234" col1="26" line2="234" col2="26" start="42848" end="42848">(</OP-LEFT-PAREN>
                  <expr line1="234" col1="27" line2="234" col2="43" start="42849" end="42865">
                    <SYMBOL line1="234" col1="27" line2="234" col2="43" start="42849" end="42865">feature_set_rdata</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="234" col1="44" line2="234" col2="44" start="42866" end="42866">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="234" col1="45" line2="234" col2="45" start="42867" end="42867">)</OP-RIGHT-PAREN>
              </forcond>
              <expr line1="234" col1="47" line2="238" col2="9" start="42869" end="43563">
                <OP-LEFT-BRACE line1="234" col1="47" line2="234" col2="47" start="42869" end="42869">{</OP-LEFT-BRACE>
                <expr line1="235" col1="13" line2="235" col2="47" start="43018" end="43052">
                  <expr line1="235" col1="13" line2="235" col2="19" start="43018" end="43024">
                    <SYMBOL line1="235" col1="13" line2="235" col2="19" start="43018" end="43024">new_set</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="235" col1="21" line2="235" col2="22" start="43026" end="43027">&lt;-</LEFT_ASSIGN>
                  <expr line1="235" col1="24" line2="235" col2="47" start="43029" end="43052">
                    <expr line1="235" col1="24" line2="235" col2="30" start="43029" end="43035">
                      <SYMBOL_FUNCTION_CALL line1="235" col1="24" line2="235" col2="30" start="43029" end="43035">logical</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="235" col1="31" line2="235" col2="31" start="43036" end="43036">(</OP-LEFT-PAREN>
                    <expr line1="235" col1="32" line2="235" col2="46" start="43037" end="43051">
                      <expr line1="235" col1="32" line2="235" col2="35" start="43037" end="43040">
                        <SYMBOL_FUNCTION_CALL line1="235" col1="32" line2="235" col2="35" start="43037" end="43040">nrow</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="235" col1="36" line2="235" col2="36" start="43041" end="43041">(</OP-LEFT-PAREN>
                      <expr line1="235" col1="37" line2="235" col2="45" start="43042" end="43050">
                        <SYMBOL line1="235" col1="37" line2="235" col2="45" start="43042" end="43050">exprs_mat</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="235" col1="46" line2="235" col2="46" start="43051" end="43051">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="235" col1="47" line2="235" col2="47" start="43052" end="43052">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="236" col1="13" line2="236" col2="52" start="43201" end="43240">
                  <expr line1="236" col1="13" line2="236" col2="44" start="43201" end="43232">
                    <expr line1="236" col1="13" line2="236" col2="19" start="43201" end="43207">
                      <SYMBOL line1="236" col1="13" line2="236" col2="19" start="43201" end="43207">new_set</SYMBOL>
                    </expr>
                    <OP-LEFT-BRACKET line1="236" col1="20" line2="236" col2="20" start="43208" end="43208">[</OP-LEFT-BRACKET>
                    <expr line1="236" col1="21" line2="236" col2="43" start="43209" end="43231">
                      <expr line1="236" col1="21" line2="236" col2="36" start="43209" end="43224">
                        <SYMBOL line1="236" col1="21" line2="236" col2="36" start="43209" end="43224">all_feature_sets</SYMBOL>
                      </expr>
                      <LBB line1="236" col1="37" line2="236" col2="38" start="43225" end="43226">[[</LBB>
                      <expr line1="236" col1="39" line2="236" col2="41" start="43227" end="43229">
                        <SYMBOL line1="236" col1="39" line2="236" col2="41" start="43227" end="43229">set</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="236" col1="42" line2="236" col2="42" start="43230" end="43230">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="236" col1="43" line2="236" col2="43" start="43231" end="43231">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-RIGHT-BRACKET line1="236" col1="44" line2="236" col2="44" start="43232" end="43232">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="236" col1="46" line2="236" col2="47" start="43234" end="43235">&lt;-</LEFT_ASSIGN>
                  <expr line1="236" col1="49" line2="236" col2="52" start="43237" end="43240">
                    <NUM_CONST line1="236" col1="49" line2="236" col2="52" start="43237" end="43240">TRUE</NUM_CONST>
                  </expr>
                </expr>
                <expr line1="237" col1="13" line2="237" col2="47" start="43384" end="43418">
                  <expr line1="237" col1="13" line2="237" col2="36" start="43384" end="43407">
                    <expr line1="237" col1="13" line2="237" col2="29" start="43384" end="43400">
                      <SYMBOL line1="237" col1="13" line2="237" col2="29" start="43384" end="43400">feature_set_rdata</SYMBOL>
                    </expr>
                    <LBB line1="237" col1="30" line2="237" col2="31" start="43401" end="43402">[[</LBB>
                    <expr line1="237" col1="32" line2="237" col2="34" start="43403" end="43405">
                      <SYMBOL line1="237" col1="32" line2="237" col2="34" start="43403" end="43405">set</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACKET line1="237" col1="35" line2="237" col2="35" start="43406" end="43406">]</OP-RIGHT-BRACKET>
                    <OP-RIGHT-BRACKET line1="237" col1="36" line2="237" col2="36" start="43407" end="43407">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="237" col1="38" line2="237" col2="39" start="43409" end="43410">&lt;-</LEFT_ASSIGN>
                  <expr line1="237" col1="41" line2="237" col2="47" start="43412" end="43418">
                    <SYMBOL line1="237" col1="41" line2="237" col2="47" start="43412" end="43418">new_set</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="238" col1="9" line2="238" col2="9" start="43563" end="43563">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="239" col1="5" line2="239" col2="5" start="43742" end="43742">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="239" col1="7" line2="239" col2="10" start="43744" end="43747">else</ELSE>
          <expr line1="239" col1="12" line2="241" col2="5" start="43749" end="44108">
            <OP-LEFT-BRACE line1="239" col1="12" line2="239" col2="12" start="43749" end="43749">{</OP-LEFT-BRACE>
            <expr line1="240" col1="9" line2="240" col2="72" start="43929" end="43992">
              <expr line1="240" col1="9" line2="240" col2="25" start="43929" end="43945">
                <SYMBOL line1="240" col1="9" line2="240" col2="25" start="43929" end="43945">feature_set_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="240" col1="27" line2="240" col2="28" start="43947" end="43948">&lt;-</LEFT_ASSIGN>
              <expr line1="240" col1="30" line2="240" col2="72" start="43950" end="43992">
                <expr line1="240" col1="30" line2="240" col2="33" start="43950" end="43953">
                  <SYMBOL_FUNCTION_CALL line1="240" col1="30" line2="240" col2="33" start="43950" end="43953">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="240" col1="34" line2="240" col2="34" start="43954" end="43954">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="240" col1="35" line2="240" col2="49" start="43955" end="43969">feature_control</SYMBOL_SUB>
                <EQ_SUB line1="240" col1="50" line2="240" col2="50" start="43970" end="43970">=</EQ_SUB>
                <expr line1="240" col1="51" line2="240" col2="71" start="43971" end="43991">
                  <expr line1="240" col1="51" line2="240" col2="57" start="43971" end="43977">
                    <SYMBOL_FUNCTION_CALL line1="240" col1="51" line2="240" col2="57" start="43971" end="43977">logical</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="240" col1="58" line2="240" col2="58" start="43978" end="43978">(</OP-LEFT-PAREN>
                  <expr line1="240" col1="59" line2="240" col2="70" start="43979" end="43990">
                    <expr line1="240" col1="59" line2="240" col2="62" start="43979" end="43982">
                      <SYMBOL_FUNCTION_CALL line1="240" col1="59" line2="240" col2="62" start="43979" end="43982">nrow</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="240" col1="63" line2="240" col2="63" start="43983" end="43983">(</OP-LEFT-PAREN>
                    <expr line1="240" col1="64" line2="240" col2="69" start="43984" end="43989">
                      <SYMBOL line1="240" col1="64" line2="240" col2="69" start="43984" end="43989">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="240" col1="70" line2="240" col2="70" start="43990" end="43990">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="240" col1="71" line2="240" col2="71" start="43991" end="43991">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="240" col1="72" line2="240" col2="72" start="43992" end="43992">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="241" col1="5" line2="241" col2="5" start="44108" end="44108">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="243" col1="5" line2="243" col2="52" start="44474" end="44521"># Computing the cell-level metrics for each set.</COMMENT>
        <expr line1="244" col1="5" line2="244" col2="49" start="44657" end="44701">
          <expr line1="244" col1="5" line2="244" col2="29" start="44657" end="44681">
            <SYMBOL line1="244" col1="5" line2="244" col2="29" start="44657" end="44681">cell_stats_by_feature_set</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="244" col1="31" line2="244" col2="32" start="44683" end="44684">&lt;-</LEFT_ASSIGN>
          <expr line1="244" col1="34" line2="244" col2="49" start="44686" end="44701">
            <SYMBOL line1="244" col1="34" line2="244" col2="49" start="44686" end="44701">all_feature_sets</SYMBOL>
          </expr>
        </expr>
        <expr line1="245" col1="5" line2="245" col2="23" start="44840" end="44858">
          <expr line1="245" col1="5" line2="245" col2="15" start="44840" end="44850">
            <SYMBOL line1="245" col1="5" line2="245" col2="15" start="44840" end="44850">total_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="245" col1="17" line2="245" col2="18" start="44852" end="44853">&lt;-</LEFT_ASSIGN>
          <expr line1="245" col1="20" line2="245" col2="23" start="44855" end="44858">
            <NULL_CONST line1="245" col1="20" line2="245" col2="23" start="44855" end="44858">NULL</NULL_CONST>
          </expr>
        </expr>
        <expr line1="247" col1="5" line2="256" col2="5" start="45206" end="46853">
          <FOR line1="247" col1="5" line2="247" col2="7" start="45206" end="45208">for</FOR>
          <forcond line1="247" col1="9" line2="247" col2="40" start="45210" end="45241">
            <OP-LEFT-PAREN line1="247" col1="9" line2="247" col2="9" start="45210" end="45210">(</OP-LEFT-PAREN>
            <SYMBOL line1="247" col1="10" line2="247" col2="12" start="45211" end="45213">set</SYMBOL>
            <IN line1="247" col1="14" line2="247" col2="15" start="45215" end="45216">in</IN>
            <expr line1="247" col1="17" line2="247" col2="39" start="45218" end="45240">
              <expr line1="247" col1="17" line2="247" col2="21" start="45218" end="45222">
                <SYMBOL_FUNCTION_CALL line1="247" col1="17" line2="247" col2="21" start="45218" end="45222">names</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="247" col1="22" line2="247" col2="22" start="45223" end="45223">(</OP-LEFT-PAREN>
              <expr line1="247" col1="23" line2="247" col2="38" start="45224" end="45239">
                <SYMBOL line1="247" col1="23" line2="247" col2="38" start="45224" end="45239">all_feature_sets</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="247" col1="39" line2="247" col2="39" start="45240" end="45240">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="247" col1="40" line2="247" col2="40" start="45241" end="45241">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="247" col1="42" line2="256" col2="5" start="45243" end="46853">
            <OP-LEFT-BRACE line1="247" col1="42" line2="247" col2="42" start="45243" end="45243">{</OP-LEFT-BRACE>
            <expr line1="248" col1="9" line2="251" col2="57" start="45393" end="45990">
              <expr line1="248" col1="9" line2="248" col2="40" start="45393" end="45424">
                <expr line1="248" col1="9" line2="248" col2="33" start="45393" end="45417">
                  <SYMBOL line1="248" col1="9" line2="248" col2="33" start="45393" end="45417">cell_stats_by_feature_set</SYMBOL>
                </expr>
                <LBB line1="248" col1="34" line2="248" col2="35" start="45418" end="45419">[[</LBB>
                <expr line1="248" col1="36" line2="248" col2="38" start="45420" end="45422">
                  <SYMBOL line1="248" col1="36" line2="248" col2="38" start="45420" end="45422">set</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="248" col1="39" line2="248" col2="39" start="45423" end="45423">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="248" col1="40" line2="248" col2="40" start="45424" end="45424">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="248" col1="42" line2="248" col2="43" start="45426" end="45427">&lt;-</LEFT_ASSIGN>
              <expr line1="248" col1="44" line2="251" col2="57" start="45428" end="45990">
                <expr line1="248" col1="44" line2="248" col2="67" start="45428" end="45451">
                  <SYMBOL_FUNCTION_CALL line1="248" col1="44" line2="248" col2="67" start="45428" end="45451">.get_qc_metrics_per_cell</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="248" col1="68" line2="248" col2="68" start="45452" end="45452">(</OP-LEFT-PAREN>
                <expr line1="248" col1="69" line2="248" col2="77" start="45453" end="45461">
                  <SYMBOL line1="248" col1="69" line2="248" col2="77" start="45453" end="45461">exprs_mat</SYMBOL>
                </expr>
                <OP-COMMA line1="248" col1="78" line2="248" col2="78" start="45462" end="45462">,</OP-COMMA>
                <SYMBOL_SUB line1="249" col1="13" line2="249" col2="22" start="45580" end="45589">exprs_type</SYMBOL_SUB>
                <EQ_SUB line1="249" col1="24" line2="249" col2="24" start="45591" end="45591">=</EQ_SUB>
                <expr line1="249" col1="26" line2="249" col2="37" start="45593" end="45604">
                  <SYMBOL line1="249" col1="26" line2="249" col2="37" start="45593" end="45604">exprs_values</SYMBOL>
                </expr>
                <OP-COMMA line1="249" col1="38" line2="249" col2="38" start="45605" end="45605">,</OP-COMMA>
                <SYMBOL_SUB line1="249" col1="40" line2="249" col2="49" start="45607" end="45616">subset_row</SYMBOL_SUB>
                <EQ_SUB line1="249" col1="51" line2="249" col2="51" start="45618" end="45618">=</EQ_SUB>
                <expr line1="249" col1="53" line2="249" col2="75" start="45620" end="45642">
                  <expr line1="249" col1="53" line2="249" col2="68" start="45620" end="45635">
                    <SYMBOL line1="249" col1="53" line2="249" col2="68" start="45620" end="45635">all_feature_sets</SYMBOL>
                  </expr>
                  <LBB line1="249" col1="69" line2="249" col2="70" start="45636" end="45637">[[</LBB>
                  <expr line1="249" col1="71" line2="249" col2="73" start="45638" end="45640">
                    <SYMBOL line1="249" col1="71" line2="249" col2="73" start="45638" end="45640">set</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="249" col1="74" line2="249" col2="74" start="45641" end="45641">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="249" col1="75" line2="249" col2="75" start="45642" end="45642">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="249" col1="76" line2="249" col2="76" start="45643" end="45643">,</OP-COMMA>
                <SYMBOL_SUB line1="250" col1="13" line2="250" col2="23" start="45763" end="45773">percent_top</SYMBOL_SUB>
                <EQ_SUB line1="250" col1="25" line2="250" col2="25" start="45775" end="45775">=</EQ_SUB>
                <expr line1="250" col1="27" line2="250" col2="37" start="45777" end="45787">
                  <SYMBOL line1="250" col1="27" line2="250" col2="37" start="45777" end="45787">percent_top</SYMBOL>
                </expr>
                <OP-COMMA line1="250" col1="38" line2="250" col2="38" start="45788" end="45788">,</OP-COMMA>
                <SYMBOL_SUB line1="250" col1="40" line2="250" col2="54" start="45790" end="45804">detection_limit</SYMBOL_SUB>
                <EQ_SUB line1="250" col1="56" line2="250" col2="56" start="45806" end="45806">=</EQ_SUB>
                <expr line1="250" col1="58" line2="250" col2="72" start="45808" end="45822">
                  <SYMBOL line1="250" col1="58" line2="250" col2="72" start="45808" end="45822">detection_limit</SYMBOL>
                </expr>
                <OP-COMMA line1="250" col1="73" line2="250" col2="73" start="45823" end="45823">,</OP-COMMA>
                <SYMBOL_SUB line1="251" col1="13" line2="251" col2="23" start="45946" end="45956">total_exprs</SYMBOL_SUB>
                <EQ_SUB line1="251" col1="25" line2="251" col2="25" start="45958" end="45958">=</EQ_SUB>
                <expr line1="251" col1="27" line2="251" col2="37" start="45960" end="45970">
                  <SYMBOL line1="251" col1="27" line2="251" col2="37" start="45960" end="45970">total_exprs</SYMBOL>
                </expr>
                <OP-COMMA line1="251" col1="38" line2="251" col2="38" start="45971" end="45971">,</OP-COMMA>
                <SYMBOL_SUB line1="251" col1="40" line2="251" col2="45" start="45973" end="45978">legacy</SYMBOL_SUB>
                <EQ_SUB line1="251" col1="47" line2="251" col2="47" start="45980" end="45980">=</EQ_SUB>
                <expr line1="251" col1="49" line2="251" col2="56" start="45982" end="45989">
                  <OP-EXCLAMATION line1="251" col1="49" line2="251" col2="49" start="45982" end="45982">!</OP-EXCLAMATION>
                  <expr line1="251" col1="50" line2="251" col2="56" start="45983" end="45989">
                    <SYMBOL line1="251" col1="50" line2="251" col2="56" start="45983" end="45989">compact</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="251" col1="57" line2="251" col2="57" start="45990" end="45990">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="253" col1="9" line2="255" col2="9" start="46308" end="46674">
              <IF line1="253" col1="9" line2="253" col2="10" start="46308" end="46309">if</IF>
              <OP-LEFT-PAREN line1="253" col1="12" line2="253" col2="12" start="46311" end="46311">(</OP-LEFT-PAREN>
              <expr line1="253" col1="13" line2="253" col2="22" start="46312" end="46321">
                <expr line1="253" col1="13" line2="253" col2="15" start="46312" end="46314">
                  <SYMBOL line1="253" col1="13" line2="253" col2="15" start="46312" end="46314">set</SYMBOL>
                </expr>
                <EQ line1="253" col1="16" line2="253" col2="17" start="46315" end="46316">==</EQ>
                <expr line1="253" col1="18" line2="253" col2="22" start="46317" end="46321">
                  <STR_CONST line1="253" col1="18" line2="253" col2="22" start="46317" end="46321">"all"</STR_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="253" col1="23" line2="253" col2="23" start="46322" end="46322">)</OP-RIGHT-PAREN>
              <expr line1="253" col1="25" line2="255" col2="9" start="46324" end="46674">
                <OP-LEFT-BRACE line1="253" col1="25" line2="253" col2="25" start="46324" end="46324">{</OP-LEFT-BRACE>
                <expr line1="254" col1="13" line2="254" col2="93" start="46495" end="46575">
                  <expr line1="254" col1="13" line2="254" col2="23" start="46495" end="46505">
                    <SYMBOL line1="254" col1="13" line2="254" col2="23" start="46495" end="46505">total_exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="254" col1="25" line2="254" col2="26" start="46507" end="46508">&lt;-</LEFT_ASSIGN>
                  <expr line1="254" col1="28" line2="254" col2="93" start="46510" end="46575">
                    <expr line1="254" col1="28" line2="254" col2="59" start="46510" end="46541">
                      <expr line1="254" col1="28" line2="254" col2="52" start="46510" end="46534">
                        <SYMBOL line1="254" col1="28" line2="254" col2="52" start="46510" end="46534">cell_stats_by_feature_set</SYMBOL>
                      </expr>
                      <LBB line1="254" col1="53" line2="254" col2="54" start="46535" end="46536">[[</LBB>
                      <expr line1="254" col1="55" line2="254" col2="57" start="46537" end="46539">
                        <SYMBOL line1="254" col1="55" line2="254" col2="57" start="46537" end="46539">set</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="254" col1="58" line2="254" col2="58" start="46540" end="46540">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="254" col1="59" line2="254" col2="59" start="46541" end="46541">]</OP-RIGHT-BRACKET>
                    </expr>
                    <LBB line1="254" col1="60" line2="254" col2="61" start="46542" end="46543">[[</LBB>
                    <expr line1="254" col1="62" line2="254" col2="91" start="46544" end="46573">
                      <expr line1="254" col1="62" line2="254" col2="67" start="46544" end="46549">
                        <SYMBOL_FUNCTION_CALL line1="254" col1="62" line2="254" col2="67" start="46544" end="46549">paste0</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="254" col1="68" line2="254" col2="68" start="46550" end="46550">(</OP-LEFT-PAREN>
                      <expr line1="254" col1="69" line2="254" col2="76" start="46551" end="46558">
                        <STR_CONST line1="254" col1="69" line2="254" col2="76" start="46551" end="46558">"total_"</STR_CONST>
                      </expr>
                      <OP-COMMA line1="254" col1="77" line2="254" col2="77" start="46559" end="46559">,</OP-COMMA>
                      <expr line1="254" col1="79" line2="254" col2="90" start="46561" end="46572">
                        <SYMBOL line1="254" col1="79" line2="254" col2="90" start="46561" end="46572">exprs_values</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="254" col1="91" line2="254" col2="91" start="46573" end="46573">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-BRACKET line1="254" col1="92" line2="254" col2="92" start="46574" end="46574">]</OP-RIGHT-BRACKET>
                    <OP-RIGHT-BRACKET line1="254" col1="93" line2="254" col2="93" start="46575" end="46575">]</OP-RIGHT-BRACKET>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="255" col1="9" line2="255" col2="9" start="46674" end="46674">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="256" col1="5" line2="256" col2="5" start="46853" end="46853">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="258" col1="5" line2="258" col2="53" start="47219" end="47267">### Adding general metrics for each feature. ### </COMMENT>
        <COMMENT line1="260" col1="5" line2="260" col2="69" start="47585" end="47649"># We first assemble thie list of all metrics (all MUST be first).</COMMENT>
        <expr line1="261" col1="5" line2="261" col2="35" start="47768" end="47798">
          <expr line1="261" col1="5" line2="261" col2="17" start="47768" end="47780">
            <SYMBOL line1="261" col1="5" line2="261" col2="17" start="47768" end="47780">all_cell_sets</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="261" col1="19" line2="261" col2="20" start="47782" end="47783">&lt;-</LEFT_ASSIGN>
          <expr line1="261" col1="22" line2="261" col2="35" start="47785" end="47798">
            <expr line1="261" col1="22" line2="261" col2="25" start="47785" end="47788">
              <SYMBOL_FUNCTION_CALL line1="261" col1="22" line2="261" col2="25" start="47785" end="47788">list</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="261" col1="26" line2="261" col2="26" start="47789" end="47789">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="261" col1="27" line2="261" col2="29" start="47790" end="47792">all</SYMBOL_SUB>
            <EQ_SUB line1="261" col1="30" line2="261" col2="30" start="47793" end="47793">=</EQ_SUB>
            <expr line1="261" col1="31" line2="261" col2="34" start="47794" end="47797">
              <NULL_CONST line1="261" col1="31" line2="261" col2="34" start="47794" end="47797">NULL</NULL_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="261" col1="35" line2="261" col2="35" start="47798" end="47798">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="262" col1="5" line2="262" col2="28" start="47951" end="47974">
          <expr line1="262" col1="5" line2="262" col2="18" start="47951" end="47964">
            <SYMBOL line1="262" col1="5" line2="262" col2="18" start="47951" end="47964">cell_set_cdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="262" col1="20" line2="262" col2="21" start="47966" end="47967">&lt;-</LEFT_ASSIGN>
          <expr line1="262" col1="23" line2="262" col2="28" start="47969" end="47974">
            <expr line1="262" col1="23" line2="262" col2="26" start="47969" end="47972">
              <SYMBOL_FUNCTION_CALL line1="262" col1="23" line2="262" col2="26" start="47969" end="47972">list</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="262" col1="27" line2="262" col2="27" start="47973" end="47973">(</OP-LEFT-PAREN>
            <OP-RIGHT-PAREN line1="262" col1="28" line2="262" col2="28" start="47974" end="47974">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="264" col1="5" line2="287" col2="5" start="48317" end="52526">
          <IF line1="264" col1="5" line2="264" col2="6" start="48317" end="48318">if</IF>
          <OP-LEFT-PAREN line1="264" col1="8" line2="264" col2="8" start="48320" end="48320">(</OP-LEFT-PAREN>
          <expr line1="264" col1="9" line2="264" col2="29" start="48321" end="48341">
            <expr line1="264" col1="9" line2="264" col2="14" start="48321" end="48326">
              <SYMBOL_FUNCTION_CALL line1="264" col1="9" line2="264" col2="14" start="48321" end="48326">length</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="264" col1="15" line2="264" col2="15" start="48327" end="48327">(</OP-LEFT-PAREN>
            <expr line1="264" col1="16" line2="264" col2="28" start="48328" end="48340">
              <SYMBOL line1="264" col1="16" line2="264" col2="28" start="48328" end="48340">cell_controls</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="264" col1="29" line2="264" col2="29" start="48341" end="48341">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="264" col1="30" line2="264" col2="30" start="48342" end="48342">)</OP-RIGHT-PAREN>
          <expr line1="264" col1="32" line2="285" col2="5" start="48344" end="52160">
            <OP-LEFT-BRACE line1="264" col1="32" line2="264" col2="32" start="48344" end="48344">{</OP-LEFT-BRACE>
            <expr line1="265" col1="9" line2="267" col2="9" start="48504" end="48870">
              <IF line1="265" col1="9" line2="265" col2="10" start="48504" end="48505">if</IF>
              <OP-LEFT-PAREN line1="265" col1="12" line2="265" col2="12" start="48507" end="48507">(</OP-LEFT-PAREN>
              <expr line1="265" col1="13" line2="265" col2="41" start="48508" end="48536">
                <expr line1="265" col1="13" line2="265" col2="19" start="48508" end="48514">
                  <SYMBOL_FUNCTION_CALL line1="265" col1="13" line2="265" col2="19" start="48508" end="48514">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="265" col1="20" line2="265" col2="20" start="48515" end="48515">(</OP-LEFT-PAREN>
                <expr line1="265" col1="21" line2="265" col2="40" start="48516" end="48535">
                  <expr line1="265" col1="21" line2="265" col2="25" start="48516" end="48520">
                    <SYMBOL_FUNCTION_CALL line1="265" col1="21" line2="265" col2="25" start="48516" end="48520">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="265" col1="26" line2="265" col2="26" start="48521" end="48521">(</OP-LEFT-PAREN>
                  <expr line1="265" col1="27" line2="265" col2="39" start="48522" end="48534">
                    <SYMBOL line1="265" col1="27" line2="265" col2="39" start="48522" end="48534">cell_controls</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="265" col1="40" line2="265" col2="40" start="48535" end="48535">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="265" col1="41" line2="265" col2="41" start="48536" end="48536">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="265" col1="42" line2="265" col2="42" start="48537" end="48537">)</OP-RIGHT-PAREN>
              <expr line1="265" col1="44" line2="267" col2="9" start="48539" end="48870">
                <OP-LEFT-BRACE line1="265" col1="44" line2="265" col2="44" start="48539" end="48539">{</OP-LEFT-BRACE>
                <expr line1="266" col1="13" line2="266" col2="49" start="48691" end="48727">
                  <expr line1="266" col1="13" line2="266" col2="16" start="48691" end="48694">
                    <SYMBOL_FUNCTION_CALL line1="266" col1="13" line2="266" col2="16" start="48691" end="48694">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="266" col1="17" line2="266" col2="17" start="48695" end="48695">(</OP-LEFT-PAREN>
                  <expr line1="266" col1="18" line2="266" col2="48" start="48696" end="48726">
                    <STR_CONST line1="266" col1="18" line2="266" col2="48" start="48696" end="48726">"cell_controls should be named"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="266" col1="49" line2="266" col2="49" start="48727" end="48727">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="267" col1="9" line2="267" col2="9" start="48870" end="48870">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <COMMENT line1="269" col1="9" line2="269" col2="61" start="49236" end="49288"># Converting to integer indices for all applications.</COMMENT>
            <expr line1="270" col1="9" line2="270" col2="96" start="49419" end="49506">
              <expr line1="270" col1="9" line2="270" col2="17" start="49419" end="49427">
                <SYMBOL line1="270" col1="9" line2="270" col2="17" start="49419" end="49427">reindexed</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="270" col1="19" line2="270" col2="20" start="49429" end="49430">&lt;-</LEFT_ASSIGN>
              <expr line1="270" col1="22" line2="270" col2="96" start="49432" end="49506">
                <expr line1="270" col1="22" line2="270" col2="27" start="49432" end="49437">
                  <SYMBOL_FUNCTION_CALL line1="270" col1="22" line2="270" col2="27" start="49432" end="49437">lapply</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="270" col1="28" line2="270" col2="28" start="49438" end="49438">(</OP-LEFT-PAREN>
                <expr line1="270" col1="29" line2="270" col2="41" start="49439" end="49451">
                  <SYMBOL line1="270" col1="29" line2="270" col2="41" start="49439" end="49451">cell_controls</SYMBOL>
                </expr>
                <OP-COMMA line1="270" col1="42" line2="270" col2="42" start="49452" end="49452">,</OP-COMMA>
                <SYMBOL_SUB line1="270" col1="44" line2="270" col2="46" start="49454" end="49456">FUN</SYMBOL_SUB>
                <EQ_SUB line1="270" col1="48" line2="270" col2="48" start="49458" end="49458">=</EQ_SUB>
                <expr line1="270" col1="50" line2="270" col2="62" start="49460" end="49472">
                  <SYMBOL line1="270" col1="50" line2="270" col2="62" start="49460" end="49472">.subset2index</SYMBOL>
                </expr>
                <OP-COMMA line1="270" col1="63" line2="270" col2="63" start="49473" end="49473">,</OP-COMMA>
                <SYMBOL_SUB line1="270" col1="65" line2="270" col2="70" start="49475" end="49480">target</SYMBOL_SUB>
                <EQ_SUB line1="270" col1="72" line2="270" col2="72" start="49482" end="49482">=</EQ_SUB>
                <expr line1="270" col1="74" line2="270" col2="82" start="49484" end="49492">
                  <SYMBOL line1="270" col1="74" line2="270" col2="82" start="49484" end="49492">exprs_mat</SYMBOL>
                </expr>
                <OP-COMMA line1="270" col1="83" line2="270" col2="83" start="49493" end="49493">,</OP-COMMA>
                <SYMBOL_SUB line1="270" col1="85" line2="270" col2="89" start="49495" end="49499">byrow</SYMBOL_SUB>
                <EQ_SUB line1="270" col1="90" line2="270" col2="90" start="49500" end="49500">=</EQ_SUB>
                <expr line1="270" col1="91" line2="270" col2="95" start="49501" end="49505">
                  <NUM_CONST line1="270" col1="91" line2="270" col2="95" start="49501" end="49505">FALSE</NUM_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="270" col1="96" line2="270" col2="96" start="49506" end="49506">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="271" col1="9" line2="271" col2="72" start="49602" end="49665">
              <expr line1="271" col1="9" line2="271" col2="24" start="49602" end="49617">
                <expr line1="271" col1="9" line2="271" col2="13" start="49602" end="49606">
                  <SYMBOL_FUNCTION_CALL line1="271" col1="9" line2="271" col2="13" start="49602" end="49606">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="271" col1="14" line2="271" col2="14" start="49607" end="49607">(</OP-LEFT-PAREN>
                <expr line1="271" col1="15" line2="271" col2="23" start="49608" end="49616">
                  <SYMBOL line1="271" col1="15" line2="271" col2="23" start="49608" end="49616">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="271" col1="24" line2="271" col2="24" start="49617" end="49617">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="271" col1="26" line2="271" col2="27" start="49619" end="49620">&lt;-</LEFT_ASSIGN>
              <expr line1="271" col1="29" line2="271" col2="72" start="49622" end="49665">
                <expr line1="271" col1="29" line2="271" col2="35" start="49622" end="49628">
                  <SYMBOL_FUNCTION_CALL line1="271" col1="29" line2="271" col2="35" start="49622" end="49628">sprintf</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="271" col1="36" line2="271" col2="36" start="49629" end="49629">(</OP-LEFT-PAREN>
                <expr line1="271" col1="37" line2="271" col2="53" start="49630" end="49646">
                  <STR_CONST line1="271" col1="37" line2="271" col2="53" start="49630" end="49646">"cell_control_%s"</STR_CONST>
                </expr>
                <OP-COMMA line1="271" col1="54" line2="271" col2="54" start="49647" end="49647">,</OP-COMMA>
                <expr line1="271" col1="56" line2="271" col2="71" start="49649" end="49664">
                  <expr line1="271" col1="56" line2="271" col2="60" start="49649" end="49653">
                    <SYMBOL_FUNCTION_CALL line1="271" col1="56" line2="271" col2="60" start="49649" end="49653">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="271" col1="61" line2="271" col2="61" start="49654" end="49654">(</OP-LEFT-PAREN>
                  <expr line1="271" col1="62" line2="271" col2="70" start="49655" end="49663">
                    <SYMBOL line1="271" col1="62" line2="271" col2="70" start="49655" end="49663">reindexed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="271" col1="71" line2="271" col2="71" start="49664" end="49664">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="271" col1="72" line2="271" col2="72" start="49665" end="49665">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="273" col1="9" line2="273" col2="43" start="49968" end="50002">
              <expr line1="273" col1="9" line2="273" col2="15" start="49968" end="49974">
                <SYMBOL line1="273" col1="9" line2="273" col2="15" start="49968" end="49974">is_ccon</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="273" col1="17" line2="273" col2="18" start="49976" end="49977">&lt;-</LEFT_ASSIGN>
              <expr line1="273" col1="20" line2="273" col2="43" start="49979" end="50002">
                <expr line1="273" col1="20" line2="273" col2="25" start="49979" end="49984">
                  <SYMBOL_FUNCTION_CALL line1="273" col1="20" line2="273" col2="25" start="49979" end="49984">Reduce</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="273" col1="26" line2="273" col2="26" start="49985" end="49985">(</OP-LEFT-PAREN>
                <expr line1="273" col1="27" line2="273" col2="31" start="49986" end="49990">
                  <SYMBOL line1="273" col1="27" line2="273" col2="31" start="49986" end="49990">union</SYMBOL>
                </expr>
                <OP-COMMA line1="273" col1="32" line2="273" col2="32" start="49991" end="49991">,</OP-COMMA>
                <expr line1="273" col1="34" line2="273" col2="42" start="49993" end="50001">
                  <SYMBOL line1="273" col1="34" line2="273" col2="42" start="49993" end="50001">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="273" col1="43" line2="273" col2="43" start="50002" end="50002">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="274" col1="9" line2="274" col2="53" start="50151" end="50195">
              <expr line1="274" col1="9" line2="274" col2="15" start="50151" end="50157">
                <SYMBOL line1="274" col1="9" line2="274" col2="15" start="50151" end="50157">is_ncon</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="274" col1="17" line2="274" col2="18" start="50159" end="50160">&lt;-</LEFT_ASSIGN>
              <expr line1="274" col1="20" line2="274" col2="53" start="50162" end="50195">
                <expr line1="274" col1="20" line2="274" col2="43" start="50162" end="50185">
                  <expr line1="274" col1="20" line2="274" col2="26" start="50162" end="50168">
                    <SYMBOL_FUNCTION_CALL line1="274" col1="20" line2="274" col2="26" start="50162" end="50168">seq_len</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="274" col1="27" line2="274" col2="27" start="50169" end="50169">(</OP-LEFT-PAREN>
                  <expr line1="274" col1="28" line2="274" col2="42" start="50170" end="50184">
                    <expr line1="274" col1="28" line2="274" col2="31" start="50170" end="50173">
                      <SYMBOL_FUNCTION_CALL line1="274" col1="28" line2="274" col2="31" start="50170" end="50173">ncol</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="274" col1="32" line2="274" col2="32" start="50174" end="50174">(</OP-LEFT-PAREN>
                    <expr line1="274" col1="33" line2="274" col2="41" start="50175" end="50183">
                      <SYMBOL line1="274" col1="33" line2="274" col2="41" start="50175" end="50183">exprs_mat</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="274" col1="42" line2="274" col2="42" start="50184" end="50184">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="274" col1="43" line2="274" col2="43" start="50185" end="50185">)</OP-RIGHT-PAREN>
                </expr>
                <OP-LEFT-BRACKET line1="274" col1="44" line2="274" col2="44" start="50186" end="50186">[</OP-LEFT-BRACKET>
                <expr line1="274" col1="45" line2="274" col2="52" start="50187" end="50194">
                  <OP-MINUS line1="274" col1="45" line2="274" col2="45" start="50187" end="50187">-</OP-MINUS>
                  <expr line1="274" col1="46" line2="274" col2="52" start="50188" end="50194">
                    <SYMBOL line1="274" col1="46" line2="274" col2="52" start="50188" end="50194">is_ccon</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACKET line1="274" col1="53" line2="274" col2="53" start="50195" end="50195">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="275" col1="9" line2="275" col2="101" start="50334" end="50426">
              <expr line1="275" col1="9" line2="275" col2="21" start="50334" end="50346">
                <SYMBOL line1="275" col1="9" line2="275" col2="21" start="50334" end="50346">all_cell_sets</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="275" col1="23" line2="275" col2="24" start="50348" end="50349">&lt;-</LEFT_ASSIGN>
              <expr line1="275" col1="26" line2="275" col2="101" start="50351" end="50426">
                <expr line1="275" col1="26" line2="275" col2="26" start="50351" end="50351">
                  <SYMBOL_FUNCTION_CALL line1="275" col1="26" line2="275" col2="26" start="50351" end="50351">c</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="275" col1="27" line2="275" col2="27" start="50352" end="50352">(</OP-LEFT-PAREN>
                <expr line1="275" col1="28" line2="275" col2="40" start="50353" end="50365">
                  <SYMBOL line1="275" col1="28" line2="275" col2="40" start="50353" end="50365">all_cell_sets</SYMBOL>
                </expr>
                <OP-COMMA line1="275" col1="41" line2="275" col2="41" start="50366" end="50366">,</OP-COMMA>
                <expr line1="275" col1="43" line2="275" col2="89" start="50368" end="50414">
                  <expr line1="275" col1="43" line2="275" col2="46" start="50368" end="50371">
                    <SYMBOL_FUNCTION_CALL line1="275" col1="43" line2="275" col2="46" start="50368" end="50371">list</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="275" col1="47" line2="275" col2="47" start="50372" end="50372">(</OP-LEFT-PAREN>
                  <SYMBOL_SUB line1="275" col1="48" line2="275" col2="58" start="50373" end="50383">non_control</SYMBOL_SUB>
                  <EQ_SUB line1="275" col1="59" line2="275" col2="59" start="50384" end="50384">=</EQ_SUB>
                  <expr line1="275" col1="60" line2="275" col2="66" start="50385" end="50391">
                    <SYMBOL line1="275" col1="60" line2="275" col2="66" start="50385" end="50391">is_ncon</SYMBOL>
                  </expr>
                  <OP-COMMA line1="275" col1="67" line2="275" col2="67" start="50392" end="50392">,</OP-COMMA>
                  <SYMBOL_SUB line1="275" col1="69" line2="275" col2="80" start="50394" end="50405">cell_control</SYMBOL_SUB>
                  <EQ_SUB line1="275" col1="81" line2="275" col2="81" start="50406" end="50406">=</EQ_SUB>
                  <expr line1="275" col1="82" line2="275" col2="88" start="50407" end="50413">
                    <SYMBOL line1="275" col1="82" line2="275" col2="88" start="50407" end="50413">is_ccon</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="275" col1="89" line2="275" col2="89" start="50414" end="50414">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="275" col1="90" line2="275" col2="90" start="50415" end="50415">,</OP-COMMA>
                <expr line1="275" col1="92" line2="275" col2="100" start="50417" end="50425">
                  <SYMBOL line1="275" col1="92" line2="275" col2="100" start="50417" end="50425">reindexed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="275" col1="101" line2="275" col2="101" start="50426" end="50426">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <COMMENT line1="277" col1="9" line2="277" col2="54" start="50700" end="50745"># But storing logical vectors in the metadata.</COMMENT>
            <expr line1="278" col1="9" line2="278" col2="61" start="50883" end="50935">
              <expr line1="278" col1="9" line2="278" col2="22" start="50883" end="50896">
                <SYMBOL line1="278" col1="9" line2="278" col2="22" start="50883" end="50896">cell_set_cdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="278" col1="24" line2="278" col2="25" start="50898" end="50899">&lt;-</LEFT_ASSIGN>
              <expr line1="278" col1="27" line2="278" col2="61" start="50901" end="50935">
                <expr line1="278" col1="27" line2="278" col2="32" start="50901" end="50906">
                  <SYMBOL_FUNCTION_CALL line1="278" col1="27" line2="278" col2="32" start="50901" end="50906">vector</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="278" col1="33" line2="278" col2="33" start="50907" end="50907">(</OP-LEFT-PAREN>
                <expr line1="278" col1="34" line2="278" col2="39" start="50908" end="50913">
                  <STR_CONST line1="278" col1="34" line2="278" col2="39" start="50908" end="50913">"list"</STR_CONST>
                </expr>
                <OP-COMMA line1="278" col1="40" line2="278" col2="40" start="50914" end="50914">,</OP-COMMA>
                <expr line1="278" col1="42" line2="278" col2="60" start="50916" end="50934">
                  <expr line1="278" col1="42" line2="278" col2="58" start="50916" end="50932">
                    <expr line1="278" col1="42" line2="278" col2="47" start="50916" end="50921">
                      <SYMBOL_FUNCTION_CALL line1="278" col1="42" line2="278" col2="47" start="50916" end="50921">length</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="278" col1="48" line2="278" col2="48" start="50922" end="50922">(</OP-LEFT-PAREN>
                    <expr line1="278" col1="49" line2="278" col2="57" start="50923" end="50931">
                      <SYMBOL line1="278" col1="49" line2="278" col2="57" start="50923" end="50931">reindexed</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="278" col1="58" line2="278" col2="58" start="50932" end="50932">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-PLUS line1="278" col1="59" line2="278" col2="59" start="50933" end="50933">+</OP-PLUS>
                  <expr line1="278" col1="60" line2="278" col2="60" start="50934" end="50934">
                    <NUM_CONST line1="278" col1="60" line2="278" col2="60" start="50934" end="50934">1</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="278" col1="61" line2="278" col2="61" start="50935" end="50935">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="279" col1="9" line2="279" col2="69" start="51066" end="51126">
              <expr line1="279" col1="9" line2="279" col2="29" start="51066" end="51086">
                <expr line1="279" col1="9" line2="279" col2="13" start="51066" end="51070">
                  <SYMBOL_FUNCTION_CALL line1="279" col1="9" line2="279" col2="13" start="51066" end="51070">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="279" col1="14" line2="279" col2="14" start="51071" end="51071">(</OP-LEFT-PAREN>
                <expr line1="279" col1="15" line2="279" col2="28" start="51072" end="51085">
                  <SYMBOL line1="279" col1="15" line2="279" col2="28" start="51072" end="51085">cell_set_cdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="279" col1="29" line2="279" col2="29" start="51086" end="51086">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="279" col1="31" line2="279" col2="32" start="51088" end="51089">&lt;-</LEFT_ASSIGN>
              <expr line1="279" col1="35" line2="279" col2="69" start="51092" end="51126">
                <expr line1="279" col1="35" line2="279" col2="35" start="51092" end="51092">
                  <SYMBOL_FUNCTION_CALL line1="279" col1="35" line2="279" col2="35" start="51092" end="51092">c</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="279" col1="36" line2="279" col2="36" start="51093" end="51093">(</OP-LEFT-PAREN>
                <expr line1="279" col1="37" line2="279" col2="50" start="51094" end="51107">
                  <STR_CONST line1="279" col1="37" line2="279" col2="50" start="51094" end="51107">"cell_control"</STR_CONST>
                </expr>
                <OP-COMMA line1="279" col1="51" line2="279" col2="51" start="51108" end="51108">,</OP-COMMA>
                <expr line1="279" col1="53" line2="279" col2="68" start="51110" end="51125">
                  <expr line1="279" col1="53" line2="279" col2="57" start="51110" end="51114">
                    <SYMBOL_FUNCTION_CALL line1="279" col1="53" line2="279" col2="57" start="51110" end="51114">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="279" col1="58" line2="279" col2="58" start="51115" end="51115">(</OP-LEFT-PAREN>
                  <expr line1="279" col1="59" line2="279" col2="67" start="51116" end="51124">
                    <SYMBOL line1="279" col1="59" line2="279" col2="67" start="51116" end="51124">reindexed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="279" col1="68" line2="279" col2="68" start="51125" end="51125">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="279" col1="69" line2="279" col2="69" start="51126" end="51126">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="280" col1="9" line2="284" col2="9" start="51249" end="51981">
              <FOR line1="280" col1="9" line2="280" col2="11" start="51249" end="51251">for</FOR>
              <forcond line1="280" col1="13" line2="280" col2="42" start="51253" end="51282">
                <OP-LEFT-PAREN line1="280" col1="13" line2="280" col2="13" start="51253" end="51253">(</OP-LEFT-PAREN>
                <SYMBOL line1="280" col1="14" line2="280" col2="16" start="51254" end="51256">set</SYMBOL>
                <IN line1="280" col1="18" line2="280" col2="19" start="51258" end="51259">in</IN>
                <expr line1="280" col1="21" line2="280" col2="41" start="51261" end="51281">
                  <expr line1="280" col1="21" line2="280" col2="25" start="51261" end="51265">
                    <SYMBOL_FUNCTION_CALL line1="280" col1="21" line2="280" col2="25" start="51261" end="51265">names</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="280" col1="26" line2="280" col2="26" start="51266" end="51266">(</OP-LEFT-PAREN>
                  <expr line1="280" col1="27" line2="280" col2="40" start="51267" end="51280">
                    <SYMBOL line1="280" col1="27" line2="280" col2="40" start="51267" end="51280">cell_set_cdata</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="280" col1="41" line2="280" col2="41" start="51281" end="51281">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="280" col1="42" line2="280" col2="42" start="51282" end="51282">)</OP-RIGHT-PAREN>
              </forcond>
              <expr line1="280" col1="44" line2="284" col2="9" start="51284" end="51981">
                <OP-LEFT-BRACE line1="280" col1="44" line2="280" col2="44" start="51284" end="51284">{</OP-LEFT-BRACE>
                <expr line1="281" col1="13" line2="281" col2="47" start="51436" end="51470">
                  <expr line1="281" col1="13" line2="281" col2="19" start="51436" end="51442">
                    <SYMBOL line1="281" col1="13" line2="281" col2="19" start="51436" end="51442">new_set</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="281" col1="21" line2="281" col2="22" start="51444" end="51445">&lt;-</LEFT_ASSIGN>
                  <expr line1="281" col1="24" line2="281" col2="47" start="51447" end="51470">
                    <expr line1="281" col1="24" line2="281" col2="30" start="51447" end="51453">
                      <SYMBOL_FUNCTION_CALL line1="281" col1="24" line2="281" col2="30" start="51447" end="51453">logical</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="281" col1="31" line2="281" col2="31" start="51454" end="51454">(</OP-LEFT-PAREN>
                    <expr line1="281" col1="32" line2="281" col2="46" start="51455" end="51469">
                      <expr line1="281" col1="32" line2="281" col2="35" start="51455" end="51458">
                        <SYMBOL_FUNCTION_CALL line1="281" col1="32" line2="281" col2="35" start="51455" end="51458">ncol</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="281" col1="36" line2="281" col2="36" start="51459" end="51459">(</OP-LEFT-PAREN>
                      <expr line1="281" col1="37" line2="281" col2="45" start="51460" end="51468">
                        <SYMBOL line1="281" col1="37" line2="281" col2="45" start="51460" end="51468">exprs_mat</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="281" col1="46" line2="281" col2="46" start="51469" end="51469">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="281" col1="47" line2="281" col2="47" start="51470" end="51470">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="282" col1="13" line2="282" col2="49" start="51619" end="51655">
                  <expr line1="282" col1="13" line2="282" col2="41" start="51619" end="51647">
                    <expr line1="282" col1="13" line2="282" col2="19" start="51619" end="51625">
                      <SYMBOL line1="282" col1="13" line2="282" col2="19" start="51619" end="51625">new_set</SYMBOL>
                    </expr>
                    <OP-LEFT-BRACKET line1="282" col1="20" line2="282" col2="20" start="51626" end="51626">[</OP-LEFT-BRACKET>
                    <expr line1="282" col1="21" line2="282" col2="40" start="51627" end="51646">
                      <expr line1="282" col1="21" line2="282" col2="33" start="51627" end="51639">
                        <SYMBOL line1="282" col1="21" line2="282" col2="33" start="51627" end="51639">all_cell_sets</SYMBOL>
                      </expr>
                      <LBB line1="282" col1="34" line2="282" col2="35" start="51640" end="51641">[[</LBB>
                      <expr line1="282" col1="36" line2="282" col2="38" start="51642" end="51644">
                        <SYMBOL line1="282" col1="36" line2="282" col2="38" start="51642" end="51644">set</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="282" col1="39" line2="282" col2="39" start="51645" end="51645">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="282" col1="40" line2="282" col2="40" start="51646" end="51646">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-RIGHT-BRACKET line1="282" col1="41" line2="282" col2="41" start="51647" end="51647">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="282" col1="43" line2="282" col2="44" start="51649" end="51650">&lt;-</LEFT_ASSIGN>
                  <expr line1="282" col1="46" line2="282" col2="49" start="51652" end="51655">
                    <NUM_CONST line1="282" col1="46" line2="282" col2="49" start="51652" end="51655">TRUE</NUM_CONST>
                  </expr>
                </expr>
                <expr line1="283" col1="13" line2="283" col2="44" start="51802" end="51833">
                  <expr line1="283" col1="13" line2="283" col2="33" start="51802" end="51822">
                    <expr line1="283" col1="13" line2="283" col2="26" start="51802" end="51815">
                      <SYMBOL line1="283" col1="13" line2="283" col2="26" start="51802" end="51815">cell_set_cdata</SYMBOL>
                    </expr>
                    <LBB line1="283" col1="27" line2="283" col2="28" start="51816" end="51817">[[</LBB>
                    <expr line1="283" col1="29" line2="283" col2="31" start="51818" end="51820">
                      <SYMBOL line1="283" col1="29" line2="283" col2="31" start="51818" end="51820">set</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACKET line1="283" col1="32" line2="283" col2="32" start="51821" end="51821">]</OP-RIGHT-BRACKET>
                    <OP-RIGHT-BRACKET line1="283" col1="33" line2="283" col2="33" start="51822" end="51822">]</OP-RIGHT-BRACKET>
                  </expr>
                  <LEFT_ASSIGN line1="283" col1="35" line2="283" col2="36" start="51824" end="51825">&lt;-</LEFT_ASSIGN>
                  <expr line1="283" col1="38" line2="283" col2="44" start="51827" end="51833">
                    <SYMBOL line1="283" col1="38" line2="283" col2="44" start="51827" end="51833">new_set</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="284" col1="9" line2="284" col2="9" start="51981" end="51981">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="285" col1="5" line2="285" col2="5" start="52160" end="52160">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="285" col1="7" line2="285" col2="10" start="52162" end="52165">else</ELSE>
          <expr line1="285" col1="12" line2="287" col2="5" start="52167" end="52526">
            <OP-LEFT-BRACE line1="285" col1="12" line2="285" col2="12" start="52167" end="52167">{</OP-LEFT-BRACE>
            <expr line1="286" col1="9" line2="286" col2="66" start="52347" end="52404">
              <expr line1="286" col1="9" line2="286" col2="22" start="52347" end="52360">
                <SYMBOL line1="286" col1="9" line2="286" col2="22" start="52347" end="52360">cell_set_cdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="286" col1="24" line2="286" col2="25" start="52362" end="52363">&lt;-</LEFT_ASSIGN>
              <expr line1="286" col1="27" line2="286" col2="66" start="52365" end="52404">
                <expr line1="286" col1="27" line2="286" col2="30" start="52365" end="52368">
                  <SYMBOL_FUNCTION_CALL line1="286" col1="27" line2="286" col2="30" start="52365" end="52368">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="286" col1="31" line2="286" col2="31" start="52369" end="52369">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="286" col1="32" line2="286" col2="43" start="52370" end="52381">cell_control</SYMBOL_SUB>
                <EQ_SUB line1="286" col1="44" line2="286" col2="44" start="52382" end="52382">=</EQ_SUB>
                <expr line1="286" col1="45" line2="286" col2="65" start="52383" end="52403">
                  <expr line1="286" col1="45" line2="286" col2="51" start="52383" end="52389">
                    <SYMBOL_FUNCTION_CALL line1="286" col1="45" line2="286" col2="51" start="52383" end="52389">logical</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="286" col1="52" line2="286" col2="52" start="52390" end="52390">(</OP-LEFT-PAREN>
                  <expr line1="286" col1="53" line2="286" col2="64" start="52391" end="52402">
                    <expr line1="286" col1="53" line2="286" col2="56" start="52391" end="52394">
                      <SYMBOL_FUNCTION_CALL line1="286" col1="53" line2="286" col2="56" start="52391" end="52394">ncol</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="286" col1="57" line2="286" col2="57" start="52395" end="52395">(</OP-LEFT-PAREN>
                    <expr line1="286" col1="58" line2="286" col2="63" start="52396" end="52401">
                      <SYMBOL line1="286" col1="58" line2="286" col2="63" start="52396" end="52401">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="286" col1="64" line2="286" col2="64" start="52402" end="52402">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="286" col1="65" line2="286" col2="65" start="52403" end="52403">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="286" col1="66" line2="286" col2="66" start="52404" end="52404">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="287" col1="5" line2="287" col2="5" start="52526" end="52526">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="289" col1="5" line2="289" col2="55" start="52892" end="52942"># Computing the feature-level metrics for each set.</COMMENT>
        <expr line1="290" col1="5" line2="290" col2="46" start="53075" end="53116">
          <expr line1="290" col1="5" line2="290" col2="29" start="53075" end="53099">
            <SYMBOL line1="290" col1="5" line2="290" col2="29" start="53075" end="53099">feature_stats_by_cell_set</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="290" col1="31" line2="290" col2="32" start="53101" end="53102">&lt;-</LEFT_ASSIGN>
          <expr line1="290" col1="34" line2="290" col2="46" start="53104" end="53116">
            <SYMBOL line1="290" col1="34" line2="290" col2="46" start="53104" end="53116">all_cell_sets</SYMBOL>
          </expr>
        </expr>
        <expr line1="291" col1="5" line2="291" col2="23" start="53258" end="53276">
          <expr line1="291" col1="5" line2="291" col2="15" start="53258" end="53268">
            <SYMBOL line1="291" col1="5" line2="291" col2="15" start="53258" end="53268">total_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="291" col1="17" line2="291" col2="18" start="53270" end="53271">&lt;-</LEFT_ASSIGN>
          <expr line1="291" col1="20" line2="291" col2="23" start="53273" end="53276">
            <NULL_CONST line1="291" col1="20" line2="291" col2="23" start="53273" end="53276">NULL</NULL_CONST>
          </expr>
        </expr>
        <expr line1="293" col1="5" line2="302" col2="5" start="53624" end="55271">
          <FOR line1="293" col1="5" line2="293" col2="7" start="53624" end="53626">for</FOR>
          <forcond line1="293" col1="9" line2="293" col2="37" start="53628" end="53656">
            <OP-LEFT-PAREN line1="293" col1="9" line2="293" col2="9" start="53628" end="53628">(</OP-LEFT-PAREN>
            <SYMBOL line1="293" col1="10" line2="293" col2="12" start="53629" end="53631">set</SYMBOL>
            <IN line1="293" col1="14" line2="293" col2="15" start="53633" end="53634">in</IN>
            <expr line1="293" col1="17" line2="293" col2="36" start="53636" end="53655">
              <expr line1="293" col1="17" line2="293" col2="21" start="53636" end="53640">
                <SYMBOL_FUNCTION_CALL line1="293" col1="17" line2="293" col2="21" start="53636" end="53640">names</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="293" col1="22" line2="293" col2="22" start="53641" end="53641">(</OP-LEFT-PAREN>
              <expr line1="293" col1="23" line2="293" col2="35" start="53642" end="53654">
                <SYMBOL line1="293" col1="23" line2="293" col2="35" start="53642" end="53654">all_cell_sets</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="293" col1="36" line2="293" col2="36" start="53655" end="53655">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="293" col1="37" line2="293" col2="37" start="53656" end="53656">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="293" col1="39" line2="302" col2="5" start="53658" end="55271">
            <OP-LEFT-BRACE line1="293" col1="39" line2="293" col2="39" start="53658" end="53658">{</OP-LEFT-BRACE>
            <expr line1="294" col1="9" line2="297" col2="30" start="53811" end="54381">
              <expr line1="294" col1="9" line2="294" col2="40" start="53811" end="53842">
                <expr line1="294" col1="9" line2="294" col2="33" start="53811" end="53835">
                  <SYMBOL line1="294" col1="9" line2="294" col2="33" start="53811" end="53835">feature_stats_by_cell_set</SYMBOL>
                </expr>
                <LBB line1="294" col1="34" line2="294" col2="35" start="53836" end="53837">[[</LBB>
                <expr line1="294" col1="36" line2="294" col2="38" start="53838" end="53840">
                  <SYMBOL line1="294" col1="36" line2="294" col2="38" start="53838" end="53840">set</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="294" col1="39" line2="294" col2="39" start="53841" end="53841">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="294" col1="40" line2="294" col2="40" start="53842" end="53842">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="294" col1="42" line2="294" col2="43" start="53844" end="53845">&lt;-</LEFT_ASSIGN>
              <expr line1="294" col1="44" line2="297" col2="30" start="53846" end="54381">
                <expr line1="294" col1="44" line2="294" col2="70" start="53846" end="53872">
                  <SYMBOL_FUNCTION_CALL line1="294" col1="44" line2="294" col2="70" start="53846" end="53872">.get_qc_metrics_per_feature</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="294" col1="71" line2="294" col2="71" start="53873" end="53873">(</OP-LEFT-PAREN>
                <expr line1="294" col1="72" line2="294" col2="80" start="53874" end="53882">
                  <SYMBOL line1="294" col1="72" line2="294" col2="80" start="53874" end="53882">exprs_mat</SYMBOL>
                </expr>
                <OP-COMMA line1="294" col1="81" line2="294" col2="81" start="53883" end="53883">,</OP-COMMA>
                <SYMBOL_SUB line1="295" col1="13" line2="295" col2="22" start="53998" end="54007">exprs_type</SYMBOL_SUB>
                <EQ_SUB line1="295" col1="24" line2="295" col2="24" start="54009" end="54009">=</EQ_SUB>
                <expr line1="295" col1="26" line2="295" col2="37" start="54011" end="54022">
                  <SYMBOL line1="295" col1="26" line2="295" col2="37" start="54011" end="54022">exprs_values</SYMBOL>
                </expr>
                <OP-COMMA line1="295" col1="38" line2="295" col2="38" start="54023" end="54023">,</OP-COMMA>
                <SYMBOL_SUB line1="295" col1="40" line2="295" col2="49" start="54025" end="54034">subset_col</SYMBOL_SUB>
                <EQ_SUB line1="295" col1="51" line2="295" col2="51" start="54036" end="54036">=</EQ_SUB>
                <expr line1="295" col1="53" line2="295" col2="72" start="54038" end="54057">
                  <expr line1="295" col1="53" line2="295" col2="65" start="54038" end="54050">
                    <SYMBOL line1="295" col1="53" line2="295" col2="65" start="54038" end="54050">all_cell_sets</SYMBOL>
                  </expr>
                  <LBB line1="295" col1="66" line2="295" col2="67" start="54051" end="54052">[[</LBB>
                  <expr line1="295" col1="68" line2="295" col2="70" start="54053" end="54055">
                    <SYMBOL line1="295" col1="68" line2="295" col2="70" start="54053" end="54055">set</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="295" col1="71" line2="295" col2="71" start="54056" end="54056">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="295" col1="72" line2="295" col2="72" start="54057" end="54057">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="295" col1="73" line2="295" col2="73" start="54058" end="54058">,</OP-COMMA>
                <SYMBOL_SUB line1="296" col1="13" line2="296" col2="27" start="54181" end="54195">detection_limit</SYMBOL_SUB>
                <EQ_SUB line1="296" col1="29" line2="296" col2="29" start="54197" end="54197">=</EQ_SUB>
                <expr line1="296" col1="31" line2="296" col2="45" start="54199" end="54213">
                  <SYMBOL line1="296" col1="31" line2="296" col2="45" start="54199" end="54213">detection_limit</SYMBOL>
                </expr>
                <OP-COMMA line1="296" col1="46" line2="296" col2="46" start="54214" end="54214">,</OP-COMMA>
                <SYMBOL_SUB line1="296" col1="48" line2="296" col2="58" start="54216" end="54226">total_exprs</SYMBOL_SUB>
                <EQ_SUB line1="296" col1="60" line2="296" col2="60" start="54228" end="54228">=</EQ_SUB>
                <expr line1="296" col1="62" line2="296" col2="72" start="54230" end="54240">
                  <SYMBOL line1="296" col1="62" line2="296" col2="72" start="54230" end="54240">total_exprs</SYMBOL>
                </expr>
                <OP-COMMA line1="296" col1="73" line2="296" col2="73" start="54241" end="54241">,</OP-COMMA>
                <SYMBOL_SUB line1="297" col1="13" line2="297" col2="18" start="54364" end="54369">legacy</SYMBOL_SUB>
                <EQ_SUB line1="297" col1="20" line2="297" col2="20" start="54371" end="54371">=</EQ_SUB>
                <expr line1="297" col1="22" line2="297" col2="29" start="54373" end="54380">
                  <OP-EXCLAMATION line1="297" col1="22" line2="297" col2="22" start="54373" end="54373">!</OP-EXCLAMATION>
                  <expr line1="297" col1="23" line2="297" col2="29" start="54374" end="54380">
                    <SYMBOL line1="297" col1="23" line2="297" col2="29" start="54374" end="54380">compact</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="297" col1="30" line2="297" col2="30" start="54381" end="54381">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="299" col1="9" line2="301" col2="9" start="54726" end="55092">
              <IF line1="299" col1="9" line2="299" col2="10" start="54726" end="54727">if</IF>
              <OP-LEFT-PAREN line1="299" col1="12" line2="299" col2="12" start="54729" end="54729">(</OP-LEFT-PAREN>
              <expr line1="299" col1="13" line2="299" col2="22" start="54730" end="54739">
                <expr line1="299" col1="13" line2="299" col2="15" start="54730" end="54732">
                  <SYMBOL line1="299" col1="13" line2="299" col2="15" start="54730" end="54732">set</SYMBOL>
                </expr>
                <EQ line1="299" col1="16" line2="299" col2="17" start="54733" end="54734">==</EQ>
                <expr line1="299" col1="18" line2="299" col2="22" start="54735" end="54739">
                  <STR_CONST line1="299" col1="18" line2="299" col2="22" start="54735" end="54739">"all"</STR_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="299" col1="23" line2="299" col2="23" start="54740" end="54740">)</OP-RIGHT-PAREN>
              <expr line1="299" col1="25" line2="301" col2="9" start="54742" end="55092">
                <OP-LEFT-BRACE line1="299" col1="25" line2="299" col2="25" start="54742" end="54742">{</OP-LEFT-BRACE>
                <expr line1="300" col1="13" line2="300" col2="93" start="54913" end="54993">
                  <expr line1="300" col1="13" line2="300" col2="23" start="54913" end="54923">
                    <SYMBOL line1="300" col1="13" line2="300" col2="23" start="54913" end="54923">total_exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="300" col1="25" line2="300" col2="26" start="54925" end="54926">&lt;-</LEFT_ASSIGN>
                  <expr line1="300" col1="28" line2="300" col2="93" start="54928" end="54993">
                    <expr line1="300" col1="28" line2="300" col2="59" start="54928" end="54959">
                      <expr line1="300" col1="28" line2="300" col2="52" start="54928" end="54952">
                        <SYMBOL line1="300" col1="28" line2="300" col2="52" start="54928" end="54952">feature_stats_by_cell_set</SYMBOL>
                      </expr>
                      <LBB line1="300" col1="53" line2="300" col2="54" start="54953" end="54954">[[</LBB>
                      <expr line1="300" col1="55" line2="300" col2="57" start="54955" end="54957">
                        <SYMBOL line1="300" col1="55" line2="300" col2="57" start="54955" end="54957">set</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="300" col1="58" line2="300" col2="58" start="54958" end="54958">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="300" col1="59" line2="300" col2="59" start="54959" end="54959">]</OP-RIGHT-BRACKET>
                    </expr>
                    <LBB line1="300" col1="60" line2="300" col2="61" start="54960" end="54961">[[</LBB>
                    <expr line1="300" col1="62" line2="300" col2="91" start="54962" end="54991">
                      <expr line1="300" col1="62" line2="300" col2="67" start="54962" end="54967">
                        <SYMBOL_FUNCTION_CALL line1="300" col1="62" line2="300" col2="67" start="54962" end="54967">paste0</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="300" col1="68" line2="300" col2="68" start="54968" end="54968">(</OP-LEFT-PAREN>
                      <expr line1="300" col1="69" line2="300" col2="76" start="54969" end="54976">
                        <STR_CONST line1="300" col1="69" line2="300" col2="76" start="54969" end="54976">"total_"</STR_CONST>
                      </expr>
                      <OP-COMMA line1="300" col1="77" line2="300" col2="77" start="54977" end="54977">,</OP-COMMA>
                      <expr line1="300" col1="79" line2="300" col2="90" start="54979" end="54990">
                        <SYMBOL line1="300" col1="79" line2="300" col2="90" start="54979" end="54990">exprs_values</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="300" col1="91" line2="300" col2="91" start="54991" end="54991">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-BRACKET line1="300" col1="92" line2="300" col2="92" start="54992" end="54992">]</OP-RIGHT-BRACKET>
                    <OP-RIGHT-BRACKET line1="300" col1="93" line2="300" col2="93" start="54993" end="54993">]</OP-RIGHT-BRACKET>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="301" col1="9" line2="301" col2="9" start="55092" end="55092">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="302" col1="5" line2="302" col2="5" start="55271" end="55271">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="304" col1="5" line2="304" col2="75" start="55637" end="55707">### Formatting output depending on whether we're compacting or not. ###</COMMENT>
        <expr line1="306" col1="5" line2="322" col2="5" start="56003" end="58931">
          <IF line1="306" col1="5" line2="306" col2="6" start="56003" end="56004">if</IF>
          <OP-LEFT-PAREN line1="306" col1="8" line2="306" col2="8" start="56006" end="56006">(</OP-LEFT-PAREN>
          <expr line1="306" col1="9" line2="306" col2="15" start="56007" end="56013">
            <SYMBOL line1="306" col1="9" line2="306" col2="15" start="56007" end="56013">compact</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="306" col1="16" line2="306" col2="16" start="56014" end="56014">)</OP-RIGHT-PAREN>
          <expr line1="306" col1="18" line2="313" col2="5" start="56016" end="57284">
            <OP-LEFT-BRACE line1="306" col1="18" line2="306" col2="18" start="56016" end="56016">{</OP-LEFT-BRACE>
            <expr line1="307" col1="9" line2="308" col2="54" start="56190" end="56418">
              <expr line1="307" col1="9" line2="307" col2="17" start="56190" end="56198">
                <SYMBOL line1="307" col1="9" line2="307" col2="17" start="56190" end="56198">scater_cd</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="307" col1="19" line2="307" col2="20" start="56200" end="56201">&lt;-</LEFT_ASSIGN>
              <expr line1="307" col1="22" line2="308" col2="54" start="56203" end="56418">
                <expr line1="307" col1="22" line2="307" col2="49" start="56203" end="56230">
                  <SYMBOL_FUNCTION_CALL line1="307" col1="22" line2="307" col2="49" start="56203" end="56230">.convert_to_nested_DataFrame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="307" col1="50" line2="307" col2="50" start="56231" end="56231">(</OP-LEFT-PAREN>
                <expr line1="307" col1="51" line2="307" col2="75" start="56232" end="56256">
                  <expr line1="307" col1="51" line2="307" col2="65" start="56232" end="56246">
                    <expr line1="307" col1="51" line2="307" col2="57" start="56232" end="56238">
                      <SYMBOL_FUNCTION_CALL line1="307" col1="51" line2="307" col2="57" start="56232" end="56238">colData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="307" col1="58" line2="307" col2="58" start="56239" end="56239">(</OP-LEFT-PAREN>
                    <expr line1="307" col1="59" line2="307" col2="64" start="56240" end="56245">
                      <SYMBOL line1="307" col1="59" line2="307" col2="64" start="56240" end="56245">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="307" col1="65" line2="307" col2="65" start="56246" end="56246">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-DOLLAR line1="307" col1="66" line2="307" col2="66" start="56247" end="56247">$</OP-DOLLAR>
                  <SYMBOL line1="307" col1="67" line2="307" col2="75" start="56248" end="56256">scater_qc</SYMBOL>
                </expr>
                <OP-COMMA line1="307" col1="76" line2="307" col2="76" start="56257" end="56257">,</OP-COMMA>
                <expr line1="308" col1="13" line2="308" col2="26" start="56377" end="56390">
                  <SYMBOL line1="308" col1="13" line2="308" col2="26" start="56377" end="56390">cell_set_cdata</SYMBOL>
                </expr>
                <OP-COMMA line1="308" col1="27" line2="308" col2="27" start="56391" end="56391">,</OP-COMMA>
                <expr line1="308" col1="29" line2="308" col2="53" start="56393" end="56417">
                  <SYMBOL line1="308" col1="29" line2="308" col2="53" start="56393" end="56417">cell_stats_by_feature_set</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="308" col1="54" line2="308" col2="54" start="56418" end="56418">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="309" col1="9" line2="310" col2="57" start="56556" end="56787">
              <expr line1="309" col1="9" line2="309" col2="17" start="56556" end="56564">
                <SYMBOL line1="309" col1="9" line2="309" col2="17" start="56556" end="56564">scater_rd</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="309" col1="19" line2="309" col2="20" start="56566" end="56567">&lt;-</LEFT_ASSIGN>
              <expr line1="309" col1="22" line2="310" col2="57" start="56569" end="56787">
                <expr line1="309" col1="22" line2="309" col2="49" start="56569" end="56596">
                  <SYMBOL_FUNCTION_CALL line1="309" col1="22" line2="309" col2="49" start="56569" end="56596">.convert_to_nested_DataFrame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="309" col1="50" line2="309" col2="50" start="56597" end="56597">(</OP-LEFT-PAREN>
                <expr line1="309" col1="51" line2="309" col2="75" start="56598" end="56622">
                  <expr line1="309" col1="51" line2="309" col2="65" start="56598" end="56612">
                    <expr line1="309" col1="51" line2="309" col2="57" start="56598" end="56604">
                      <SYMBOL_FUNCTION_CALL line1="309" col1="51" line2="309" col2="57" start="56598" end="56604">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="309" col1="58" line2="309" col2="58" start="56605" end="56605">(</OP-LEFT-PAREN>
                    <expr line1="309" col1="59" line2="309" col2="64" start="56606" end="56611">
                      <SYMBOL line1="309" col1="59" line2="309" col2="64" start="56606" end="56611">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="309" col1="65" line2="309" col2="65" start="56612" end="56612">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-DOLLAR line1="309" col1="66" line2="309" col2="66" start="56613" end="56613">$</OP-DOLLAR>
                  <SYMBOL line1="309" col1="67" line2="309" col2="75" start="56614" end="56622">scater_qc</SYMBOL>
                </expr>
                <OP-COMMA line1="309" col1="76" line2="309" col2="76" start="56623" end="56623">,</OP-COMMA>
                <expr line1="310" col1="13" line2="310" col2="29" start="56743" end="56759">
                  <SYMBOL line1="310" col1="13" line2="310" col2="29" start="56743" end="56759">feature_set_rdata</SYMBOL>
                </expr>
                <OP-COMMA line1="310" col1="30" line2="310" col2="30" start="56760" end="56760">,</OP-COMMA>
                <expr line1="310" col1="32" line2="310" col2="56" start="56762" end="56786">
                  <SYMBOL line1="310" col1="32" line2="310" col2="56" start="56762" end="56786">feature_stats_by_cell_set</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="310" col1="57" line2="310" col2="57" start="56787" end="56787">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="311" col1="9" line2="311" col2="46" start="56922" end="56959">
              <expr line1="311" col1="9" line2="311" col2="33" start="56922" end="56946">
                <expr line1="311" col1="9" line2="311" col2="23" start="56922" end="56936">
                  <expr line1="311" col1="9" line2="311" col2="15" start="56922" end="56928">
                    <SYMBOL_FUNCTION_CALL line1="311" col1="9" line2="311" col2="15" start="56922" end="56928">colData</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="311" col1="16" line2="311" col2="16" start="56929" end="56929">(</OP-LEFT-PAREN>
                  <expr line1="311" col1="17" line2="311" col2="22" start="56930" end="56935">
                    <SYMBOL line1="311" col1="17" line2="311" col2="22" start="56930" end="56935">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="311" col1="23" line2="311" col2="23" start="56936" end="56936">)</OP-RIGHT-PAREN>
                </expr>
                <OP-DOLLAR line1="311" col1="24" line2="311" col2="24" start="56937" end="56937">$</OP-DOLLAR>
                <SYMBOL line1="311" col1="25" line2="311" col2="33" start="56938" end="56946">scater_qc</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="311" col1="35" line2="311" col2="36" start="56948" end="56949">&lt;-</LEFT_ASSIGN>
              <expr line1="311" col1="38" line2="311" col2="46" start="56951" end="56959">
                <SYMBOL line1="311" col1="38" line2="311" col2="46" start="56951" end="56959">scater_cd</SYMBOL>
              </expr>
            </expr>
            <expr line1="312" col1="9" line2="312" col2="46" start="57105" end="57142">
              <expr line1="312" col1="9" line2="312" col2="33" start="57105" end="57129">
                <expr line1="312" col1="9" line2="312" col2="23" start="57105" end="57119">
                  <expr line1="312" col1="9" line2="312" col2="15" start="57105" end="57111">
                    <SYMBOL_FUNCTION_CALL line1="312" col1="9" line2="312" col2="15" start="57105" end="57111">rowData</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="312" col1="16" line2="312" col2="16" start="57112" end="57112">(</OP-LEFT-PAREN>
                  <expr line1="312" col1="17" line2="312" col2="22" start="57113" end="57118">
                    <SYMBOL line1="312" col1="17" line2="312" col2="22" start="57113" end="57118">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="312" col1="23" line2="312" col2="23" start="57119" end="57119">)</OP-RIGHT-PAREN>
                </expr>
                <OP-DOLLAR line1="312" col1="24" line2="312" col2="24" start="57120" end="57120">$</OP-DOLLAR>
                <SYMBOL line1="312" col1="25" line2="312" col2="33" start="57121" end="57129">scater_qc</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="312" col1="35" line2="312" col2="36" start="57131" end="57132">&lt;-</LEFT_ASSIGN>
              <expr line1="312" col1="38" line2="312" col2="46" start="57134" end="57142">
                <SYMBOL line1="312" col1="38" line2="312" col2="46" start="57134" end="57142">scater_rd</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="313" col1="5" line2="313" col2="5" start="57284" end="57284">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="313" col1="7" line2="313" col2="10" start="57286" end="57289">else</ELSE>
          <expr line1="313" col1="12" line2="322" col2="5" start="57291" end="58931">
            <OP-LEFT-BRACE line1="313" col1="12" line2="313" col2="12" start="57291" end="57291">{</OP-LEFT-BRACE>
            <expr line1="314" col1="9" line2="315" col2="99" start="57471" end="57744">
              <expr line1="314" col1="9" line2="314" col2="15" start="57471" end="57477">
                <SYMBOL_FUNCTION_CALL line1="314" col1="9" line2="314" col2="15" start="57471" end="57477">message</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="314" col1="16" line2="314" col2="16" start="57478" end="57478">(</OP-LEFT-PAREN>
              <expr line1="314" col1="17" line2="315" col2="98" start="57479" end="57743">
                <STR_CONST line1="314" col1="17" line2="315" col2="98" start="57479" end="57743">"Note that the names of some metrics have changed, see 'Renamed metrics' in ?calculateQCMetrics.
Old names are currently maintained for back-compatibility, but may be removed in future releases."</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="315" col1="99" line2="315" col2="99" start="57744" end="57744">)</OP-RIGHT-PAREN>
            </expr>
            <expr line1="316" col1="9" line2="317" col2="92" start="57837" end="58103">
              <expr line1="316" col1="9" line2="316" col2="17" start="57837" end="57845">
                <SYMBOL line1="316" col1="9" line2="316" col2="17" start="57837" end="57845">scater_cd</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="316" col1="19" line2="316" col2="20" start="57847" end="57848">&lt;-</LEFT_ASSIGN>
              <expr line1="316" col1="22" line2="317" col2="92" start="57850" end="58103">
                <expr line1="316" col1="22" line2="316" col2="47" start="57850" end="57875">
                  <SYMBOL_FUNCTION_CALL line1="316" col1="22" line2="316" col2="47" start="57850" end="57875">.convert_to_full_DataFrame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="316" col1="48" line2="316" col2="48" start="57876" end="57876">(</OP-LEFT-PAREN>
                <expr line1="316" col1="49" line2="316" col2="63" start="57877" end="57891">
                  <expr line1="316" col1="49" line2="316" col2="55" start="57877" end="57883">
                    <SYMBOL_FUNCTION_CALL line1="316" col1="49" line2="316" col2="55" start="57877" end="57883">colData</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="316" col1="56" line2="316" col2="56" start="57884" end="57884">(</OP-LEFT-PAREN>
                  <expr line1="316" col1="57" line2="316" col2="62" start="57885" end="57890">
                    <SYMBOL line1="316" col1="57" line2="316" col2="62" start="57885" end="57890">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="316" col1="63" line2="316" col2="63" start="57891" end="57891">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="316" col1="64" line2="316" col2="64" start="57892" end="57892">,</OP-COMMA>
                <expr line1="316" col1="66" line2="316" col2="79" start="57894" end="57907">
                  <SYMBOL line1="316" col1="66" line2="316" col2="79" start="57894" end="57907">cell_set_cdata</SYMBOL>
                </expr>
                <OP-COMMA line1="316" col1="80" line2="316" col2="80" start="57908" end="57908">,</OP-COMMA>
                <expr line1="317" col1="13" line2="317" col2="37" start="58024" end="58048">
                  <SYMBOL line1="317" col1="13" line2="317" col2="37" start="58024" end="58048">cell_stats_by_feature_set</SYMBOL>
                </expr>
                <OP-COMMA line1="317" col1="38" line2="317" col2="38" start="58049" end="58049">,</OP-COMMA>
                <SYMBOL_SUB line1="317" col1="40" line2="317" col2="47" start="58051" end="58058">trim.fun</SYMBOL_SUB>
                <EQ_SUB line1="317" col1="48" line2="317" col2="48" start="58059" end="58059">=</EQ_SUB>
                <expr line1="317" col1="49" line2="317" col2="91" start="58060" end="58102">
                  <FUNCTION line1="317" col1="49" line2="317" col2="56" start="58060" end="58067">function</FUNCTION>
                  <OP-LEFT-PAREN line1="317" col1="57" line2="317" col2="57" start="58068" end="58068">(</OP-LEFT-PAREN>
                  <SYMBOL_FORMALS line1="317" col1="58" line2="317" col2="58" start="58069" end="58069">x</SYMBOL_FORMALS>
                  <OP-RIGHT-PAREN line1="317" col1="59" line2="317" col2="59" start="58070" end="58070">)</OP-RIGHT-PAREN>
                  <expr line1="317" col1="61" line2="317" col2="91" start="58072" end="58102">
                    <expr line1="317" col1="61" line2="317" col2="63" start="58072" end="58074">
                      <SYMBOL_FUNCTION_CALL line1="317" col1="61" line2="317" col2="63" start="58072" end="58074">sub</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="317" col1="64" line2="317" col2="64" start="58075" end="58075">(</OP-LEFT-PAREN>
                    <expr line1="317" col1="65" line2="317" col2="83" start="58076" end="58094">
                      <STR_CONST line1="317" col1="65" line2="317" col2="83" start="58076" end="58094">"^feature_control_"</STR_CONST>
                    </expr>
                    <OP-COMMA line1="317" col1="84" line2="317" col2="84" start="58095" end="58095">,</OP-COMMA>
                    <expr line1="317" col1="86" line2="317" col2="87" start="58097" end="58098">
                      <STR_CONST line1="317" col1="86" line2="317" col2="87" start="58097" end="58098">""</STR_CONST>
                    </expr>
                    <OP-COMMA line1="317" col1="88" line2="317" col2="88" start="58099" end="58099">,</OP-COMMA>
                    <expr line1="317" col1="90" line2="317" col2="90" start="58101" end="58101">
                      <SYMBOL line1="317" col1="90" line2="317" col2="90" start="58101" end="58101">x</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="317" col1="91" line2="317" col2="91" start="58102" end="58102">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="317" col1="92" line2="317" col2="92" start="58103" end="58103">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="318" col1="9" line2="319" col2="89" start="58203" end="58466">
              <expr line1="318" col1="9" line2="318" col2="17" start="58203" end="58211">
                <SYMBOL line1="318" col1="9" line2="318" col2="17" start="58203" end="58211">scater_rd</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="318" col1="19" line2="318" col2="20" start="58213" end="58214">&lt;-</LEFT_ASSIGN>
              <expr line1="318" col1="22" line2="319" col2="89" start="58216" end="58466">
                <expr line1="318" col1="22" line2="318" col2="47" start="58216" end="58241">
                  <SYMBOL_FUNCTION_CALL line1="318" col1="22" line2="318" col2="47" start="58216" end="58241">.convert_to_full_DataFrame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="318" col1="48" line2="318" col2="48" start="58242" end="58242">(</OP-LEFT-PAREN>
                <expr line1="318" col1="49" line2="318" col2="63" start="58243" end="58257">
                  <expr line1="318" col1="49" line2="318" col2="55" start="58243" end="58249">
                    <SYMBOL_FUNCTION_CALL line1="318" col1="49" line2="318" col2="55" start="58243" end="58249">rowData</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="318" col1="56" line2="318" col2="56" start="58250" end="58250">(</OP-LEFT-PAREN>
                  <expr line1="318" col1="57" line2="318" col2="62" start="58251" end="58256">
                    <SYMBOL line1="318" col1="57" line2="318" col2="62" start="58251" end="58256">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="318" col1="63" line2="318" col2="63" start="58257" end="58257">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="318" col1="64" line2="318" col2="64" start="58258" end="58258">,</OP-COMMA>
                <expr line1="318" col1="66" line2="318" col2="82" start="58260" end="58276">
                  <SYMBOL line1="318" col1="66" line2="318" col2="82" start="58260" end="58276">feature_set_rdata</SYMBOL>
                </expr>
                <OP-COMMA line1="318" col1="83" line2="318" col2="83" start="58277" end="58277">,</OP-COMMA>
                <expr line1="319" col1="13" line2="319" col2="37" start="58390" end="58414">
                  <SYMBOL line1="319" col1="13" line2="319" col2="37" start="58390" end="58414">feature_stats_by_cell_set</SYMBOL>
                </expr>
                <OP-COMMA line1="319" col1="38" line2="319" col2="38" start="58415" end="58415">,</OP-COMMA>
                <SYMBOL_SUB line1="319" col1="40" line2="319" col2="47" start="58417" end="58424">trim.fun</SYMBOL_SUB>
                <EQ_SUB line1="319" col1="48" line2="319" col2="48" start="58425" end="58425">=</EQ_SUB>
                <expr line1="319" col1="49" line2="319" col2="88" start="58426" end="58465">
                  <FUNCTION line1="319" col1="49" line2="319" col2="56" start="58426" end="58433">function</FUNCTION>
                  <OP-LEFT-PAREN line1="319" col1="57" line2="319" col2="57" start="58434" end="58434">(</OP-LEFT-PAREN>
                  <SYMBOL_FORMALS line1="319" col1="58" line2="319" col2="58" start="58435" end="58435">x</SYMBOL_FORMALS>
                  <OP-RIGHT-PAREN line1="319" col1="59" line2="319" col2="59" start="58436" end="58436">)</OP-RIGHT-PAREN>
                  <expr line1="319" col1="61" line2="319" col2="88" start="58438" end="58465">
                    <expr line1="319" col1="61" line2="319" col2="63" start="58438" end="58440">
                      <SYMBOL_FUNCTION_CALL line1="319" col1="61" line2="319" col2="63" start="58438" end="58440">sub</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="319" col1="64" line2="319" col2="64" start="58441" end="58441">(</OP-LEFT-PAREN>
                    <expr line1="319" col1="65" line2="319" col2="80" start="58442" end="58457">
                      <STR_CONST line1="319" col1="65" line2="319" col2="80" start="58442" end="58457">"^cell_control_"</STR_CONST>
                    </expr>
                    <OP-COMMA line1="319" col1="81" line2="319" col2="81" start="58458" end="58458">,</OP-COMMA>
                    <expr line1="319" col1="83" line2="319" col2="84" start="58460" end="58461">
                      <STR_CONST line1="319" col1="83" line2="319" col2="84" start="58460" end="58461">""</STR_CONST>
                    </expr>
                    <OP-COMMA line1="319" col1="85" line2="319" col2="85" start="58462" end="58462">,</OP-COMMA>
                    <expr line1="319" col1="87" line2="319" col2="87" start="58464" end="58464">
                      <SYMBOL line1="319" col1="87" line2="319" col2="87" start="58464" end="58464">x</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="319" col1="88" line2="319" col2="88" start="58465" end="58465">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="319" col1="89" line2="319" col2="89" start="58466" end="58466">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="320" col1="9" line2="320" col2="36" start="58569" end="58596">
              <expr line1="320" col1="9" line2="320" col2="23" start="58569" end="58583">
                <expr line1="320" col1="9" line2="320" col2="15" start="58569" end="58575">
                  <SYMBOL_FUNCTION_CALL line1="320" col1="9" line2="320" col2="15" start="58569" end="58575">colData</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="320" col1="16" line2="320" col2="16" start="58576" end="58576">(</OP-LEFT-PAREN>
                <expr line1="320" col1="17" line2="320" col2="22" start="58577" end="58582">
                  <SYMBOL line1="320" col1="17" line2="320" col2="22" start="58577" end="58582">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="320" col1="23" line2="320" col2="23" start="58583" end="58583">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="320" col1="25" line2="320" col2="26" start="58585" end="58586">&lt;-</LEFT_ASSIGN>
              <expr line1="320" col1="28" line2="320" col2="36" start="58588" end="58596">
                <SYMBOL line1="320" col1="28" line2="320" col2="36" start="58588" end="58596">scater_cd</SYMBOL>
              </expr>
            </expr>
            <expr line1="321" col1="9" line2="321" col2="36" start="58752" end="58779">
              <expr line1="321" col1="9" line2="321" col2="23" start="58752" end="58766">
                <expr line1="321" col1="9" line2="321" col2="15" start="58752" end="58758">
                  <SYMBOL_FUNCTION_CALL line1="321" col1="9" line2="321" col2="15" start="58752" end="58758">rowData</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="321" col1="16" line2="321" col2="16" start="58759" end="58759">(</OP-LEFT-PAREN>
                <expr line1="321" col1="17" line2="321" col2="22" start="58760" end="58765">
                  <SYMBOL line1="321" col1="17" line2="321" col2="22" start="58760" end="58765">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="321" col1="23" line2="321" col2="23" start="58766" end="58766">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="321" col1="25" line2="321" col2="26" start="58768" end="58769">&lt;-</LEFT_ASSIGN>
              <expr line1="321" col1="28" line2="321" col2="36" start="58771" end="58779">
                <SYMBOL line1="321" col1="28" line2="321" col2="36" start="58771" end="58779">scater_rd</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="322" col1="5" line2="322" col2="5" start="58931" end="58931">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="323" col1="5" line2="323" col2="18" start="59114" end="59127">
          <expr line1="323" col1="5" line2="323" col2="10" start="59114" end="59119">
            <SYMBOL_FUNCTION_CALL line1="323" col1="5" line2="323" col2="10" start="59114" end="59119">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="323" col1="11" line2="323" col2="11" start="59120" end="59120">(</OP-LEFT-PAREN>
          <expr line1="323" col1="12" line2="323" col2="17" start="59121" end="59126">
            <SYMBOL line1="323" col1="12" line2="323" col2="17" start="59121" end="59126">object</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="323" col1="18" line2="323" col2="18" start="59127" end="59127">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="324" col1="1" line2="324" col2="1" start="59293" end="59293">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="326" col1="1" line2="363" col2="1" start="59659" end="66430">
    <expr line1="326" col1="1" line2="326" col2="24" start="59659" end="59682">
      <SYMBOL line1="326" col1="1" line2="326" col2="24" start="59659" end="59682">.get_qc_metrics_per_cell</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="326" col1="26" line2="326" col2="27" start="59684" end="59685">&lt;-</LEFT_ASSIGN>
    <expr line1="326" col1="29" line2="363" col2="1" start="59687" end="66430">
      <FUNCTION line1="326" col1="29" line2="326" col2="36" start="59687" end="59694">function</FUNCTION>
      <OP-LEFT-PAREN line1="326" col1="37" line2="326" col2="37" start="59695" end="59695">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="326" col1="38" line2="326" col2="46" start="59696" end="59704">exprs_mat</SYMBOL_FORMALS>
      <OP-COMMA line1="326" col1="47" line2="326" col2="47" start="59705" end="59705">,</OP-COMMA>
      <SYMBOL_FORMALS line1="326" col1="49" line2="326" col2="58" start="59707" end="59716">exprs_type</SYMBOL_FORMALS>
      <EQ_FORMALS line1="326" col1="60" line2="326" col2="60" start="59718" end="59718">=</EQ_FORMALS>
      <expr line1="326" col1="62" line2="326" col2="69" start="59720" end="59727">
        <STR_CONST line1="326" col1="62" line2="326" col2="69" start="59720" end="59727">"counts"</STR_CONST>
      </expr>
      <OP-COMMA line1="326" col1="70" line2="326" col2="70" start="59728" end="59728">,</OP-COMMA>
      <SYMBOL_FORMALS line1="327" col1="9" line2="327" col2="18" start="59850" end="59859">subset_row</SYMBOL_FORMALS>
      <EQ_FORMALS line1="327" col1="20" line2="327" col2="20" start="59861" end="59861">=</EQ_FORMALS>
      <expr line1="327" col1="22" line2="327" col2="25" start="59863" end="59866">
        <NULL_CONST line1="327" col1="22" line2="327" col2="25" start="59863" end="59866">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="327" col1="26" line2="327" col2="26" start="59867" end="59867">,</OP-COMMA>
      <SYMBOL_FORMALS line1="327" col1="28" line2="327" col2="42" start="59869" end="59883">detection_limit</SYMBOL_FORMALS>
      <EQ_FORMALS line1="327" col1="44" line2="327" col2="44" start="59885" end="59885">=</EQ_FORMALS>
      <expr line1="327" col1="46" line2="327" col2="46" start="59887" end="59887">
        <NUM_CONST line1="327" col1="46" line2="327" col2="46" start="59887" end="59887">0</NUM_CONST>
      </expr>
      <OP-COMMA line1="327" col1="47" line2="327" col2="47" start="59888" end="59888">,</OP-COMMA>
      <SYMBOL_FORMALS line1="328" col1="9" line2="328" col2="19" start="60033" end="60043">percent_top</SYMBOL_FORMALS>
      <EQ_FORMALS line1="328" col1="21" line2="328" col2="21" start="60045" end="60045">=</EQ_FORMALS>
      <expr line1="328" col1="23" line2="328" col2="32" start="60047" end="60056">
        <expr line1="328" col1="23" line2="328" col2="29" start="60047" end="60053">
          <SYMBOL_FUNCTION_CALL line1="328" col1="23" line2="328" col2="29" start="60047" end="60053">integer</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="328" col1="30" line2="328" col2="30" start="60054" end="60054">(</OP-LEFT-PAREN>
        <expr line1="328" col1="31" line2="328" col2="31" start="60055" end="60055">
          <NUM_CONST line1="328" col1="31" line2="328" col2="31" start="60055" end="60055">0</NUM_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="328" col1="32" line2="328" col2="32" start="60056" end="60056">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="328" col1="33" line2="328" col2="33" start="60057" end="60057">,</OP-COMMA>
      <SYMBOL_FORMALS line1="328" col1="35" line2="328" col2="45" start="60059" end="60069">total_exprs</SYMBOL_FORMALS>
      <EQ_FORMALS line1="328" col1="47" line2="328" col2="47" start="60071" end="60071">=</EQ_FORMALS>
      <expr line1="328" col1="49" line2="328" col2="67" start="60073" end="60091">
        <expr line1="328" col1="49" line2="328" col2="56" start="60073" end="60080">
          <SYMBOL_FUNCTION_CALL line1="328" col1="49" line2="328" col2="56" start="60073" end="60080">.colSums</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="328" col1="57" line2="328" col2="57" start="60081" end="60081">(</OP-LEFT-PAREN>
        <expr line1="328" col1="58" line2="328" col2="66" start="60082" end="60090">
          <SYMBOL line1="328" col1="58" line2="328" col2="66" start="60082" end="60090">exprs_mat</SYMBOL>
        </expr>
        <OP-RIGHT-PAREN line1="328" col1="67" line2="328" col2="67" start="60091" end="60091">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="328" col1="68" line2="328" col2="68" start="60092" end="60092">,</OP-COMMA>
      <SYMBOL_FORMALS line1="329" col1="9" line2="329" col2="14" start="60216" end="60221">legacy</SYMBOL_FORMALS>
      <EQ_FORMALS line1="329" col1="16" line2="329" col2="16" start="60223" end="60223">=</EQ_FORMALS>
      <expr line1="329" col1="18" line2="329" col2="22" start="60225" end="60229">
        <NUM_CONST line1="329" col1="18" line2="329" col2="22" start="60225" end="60229">FALSE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="329" col1="23" line2="329" col2="23" start="60230" end="60230">)</OP-RIGHT-PAREN>
      <expr line1="329" col1="25" line2="363" col2="1" start="60232" end="66430">
        <OP-LEFT-BRACE line1="329" col1="25" line2="329" col2="25" start="60232" end="60232">{</OP-LEFT-BRACE>
        <COMMENT line1="331" col1="5" line2="331" col2="43" start="60578" end="60616"># Adding the total number of features. </COMMENT>
        <expr line1="332" col1="5" line2="333" col2="58" start="60761" end="60997">
          <expr line1="332" col1="5" line2="332" col2="13" start="60761" end="60769">
            <SYMBOL line1="332" col1="5" line2="332" col2="13" start="60761" end="60769">nfeatures</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="332" col1="15" line2="332" col2="16" start="60771" end="60772">&lt;-</LEFT_ASSIGN>
          <expr line1="332" col1="18" line2="333" col2="58" start="60774" end="60997">
            <expr line1="332" col1="18" line2="332" col2="23" start="60774" end="60779">
              <SYMBOL_FUNCTION_CALL line1="332" col1="18" line2="332" col2="23" start="60774" end="60779">nexprs</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="332" col1="24" line2="332" col2="24" start="60780" end="60780">(</OP-LEFT-PAREN>
            <expr line1="332" col1="25" line2="332" col2="33" start="60781" end="60789">
              <SYMBOL line1="332" col1="25" line2="332" col2="33" start="60781" end="60789">exprs_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="332" col1="34" line2="332" col2="34" start="60790" end="60790">,</OP-COMMA>
            <SYMBOL_SUB line1="332" col1="36" line2="332" col2="45" start="60792" end="60801">subset_row</SYMBOL_SUB>
            <EQ_SUB line1="332" col1="47" line2="332" col2="47" start="60803" end="60803">=</EQ_SUB>
            <expr line1="332" col1="49" line2="332" col2="58" start="60805" end="60814">
              <SYMBOL line1="332" col1="49" line2="332" col2="58" start="60805" end="60814">subset_row</SYMBOL>
            </expr>
            <OP-COMMA line1="332" col1="59" line2="332" col2="59" start="60815" end="60815">,</OP-COMMA>
            <SYMBOL_SUB line1="332" col1="61" line2="332" col2="65" start="60817" end="60821">byrow</SYMBOL_SUB>
            <EQ_SUB line1="332" col1="67" line2="332" col2="67" start="60823" end="60823">=</EQ_SUB>
            <expr line1="332" col1="69" line2="332" col2="73" start="60825" end="60829">
              <NUM_CONST line1="332" col1="69" line2="332" col2="73" start="60825" end="60829">FALSE</NUM_CONST>
            </expr>
            <OP-COMMA line1="332" col1="74" line2="332" col2="74" start="60830" end="60830">,</OP-COMMA>
            <SYMBOL_SUB line1="333" col1="25" line2="333" col2="39" start="60964" end="60978">detection_limit</SYMBOL_SUB>
            <EQ_SUB line1="333" col1="41" line2="333" col2="41" start="60980" end="60980">=</EQ_SUB>
            <expr line1="333" col1="43" line2="333" col2="57" start="60982" end="60996">
              <SYMBOL line1="333" col1="43" line2="333" col2="57" start="60982" end="60996">detection_limit</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="333" col1="58" line2="333" col2="58" start="60997" end="60997">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="334" col1="5" line2="334" col2="92" start="61127" end="61214">
          <expr line1="334" col1="5" line2="334" col2="13" start="61127" end="61135">
            <SYMBOL line1="334" col1="5" line2="334" col2="13" start="61127" end="61135">cell_data</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="334" col1="15" line2="334" col2="16" start="61137" end="61138">&lt;-</LEFT_ASSIGN>
          <expr line1="334" col1="18" line2="334" col2="92" start="61140" end="61214">
            <expr line1="334" col1="18" line2="334" col2="26" start="61140" end="61148">
              <SYMBOL_FUNCTION_CALL line1="334" col1="18" line2="334" col2="26" start="61140" end="61148">DataFrame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="334" col1="27" line2="334" col2="27" start="61149" end="61149">(</OP-LEFT-PAREN>
            <expr line1="334" col1="28" line2="334" col2="36" start="61150" end="61158">
              <SYMBOL line1="334" col1="28" line2="334" col2="36" start="61150" end="61158">nfeatures</SYMBOL>
            </expr>
            <OP-COMMA line1="334" col1="37" line2="334" col2="37" start="61159" end="61159">,</OP-COMMA>
            <expr line1="334" col1="39" line2="334" col2="58" start="61161" end="61180">
              <expr line1="334" col1="39" line2="334" col2="43" start="61161" end="61165">
                <SYMBOL_FUNCTION_CALL line1="334" col1="39" line2="334" col2="43" start="61161" end="61165">log10</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="334" col1="44" line2="334" col2="44" start="61166" end="61166">(</OP-LEFT-PAREN>
              <expr line1="334" col1="45" line2="334" col2="57" start="61167" end="61179">
                <expr line1="334" col1="45" line2="334" col2="53" start="61167" end="61175">
                  <SYMBOL line1="334" col1="45" line2="334" col2="53" start="61167" end="61175">nfeatures</SYMBOL>
                </expr>
                <OP-PLUS line1="334" col1="55" line2="334" col2="55" start="61177" end="61177">+</OP-PLUS>
                <expr line1="334" col1="57" line2="334" col2="57" start="61179" end="61179">
                  <NUM_CONST line1="334" col1="57" line2="334" col2="57" start="61179" end="61179">1</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="334" col1="58" line2="334" col2="58" start="61180" end="61180">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="334" col1="59" line2="334" col2="59" start="61181" end="61181">,</OP-COMMA>
            <SYMBOL_SUB line1="334" col1="61" line2="334" col2="69" start="61183" end="61191">row.names</SYMBOL_SUB>
            <EQ_SUB line1="334" col1="71" line2="334" col2="71" start="61193" end="61193">=</EQ_SUB>
            <expr line1="334" col1="73" line2="334" col2="91" start="61195" end="61213">
              <expr line1="334" col1="73" line2="334" col2="80" start="61195" end="61202">
                <SYMBOL_FUNCTION_CALL line1="334" col1="73" line2="334" col2="80" start="61195" end="61202">colnames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="334" col1="81" line2="334" col2="81" start="61203" end="61203">(</OP-LEFT-PAREN>
              <expr line1="334" col1="82" line2="334" col2="90" start="61204" end="61212">
                <SYMBOL line1="334" col1="82" line2="334" col2="90" start="61204" end="61212">exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="334" col1="91" line2="334" col2="91" start="61213" end="61213">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="334" col1="92" line2="334" col2="92" start="61214" end="61214">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="335" col1="5" line2="335" col2="84" start="61310" end="61389">
          <expr line1="335" col1="5" line2="335" col2="23" start="61310" end="61328">
            <expr line1="335" col1="5" line2="335" col2="12" start="61310" end="61317">
              <SYMBOL_FUNCTION_CALL line1="335" col1="5" line2="335" col2="12" start="61310" end="61317">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="335" col1="13" line2="335" col2="13" start="61318" end="61318">(</OP-LEFT-PAREN>
            <expr line1="335" col1="14" line2="335" col2="22" start="61319" end="61327">
              <SYMBOL line1="335" col1="14" line2="335" col2="22" start="61319" end="61327">cell_data</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="335" col1="23" line2="335" col2="23" start="61328" end="61328">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="335" col1="25" line2="335" col2="26" start="61330" end="61331">&lt;-</LEFT_ASSIGN>
          <expr line1="335" col1="28" line2="335" col2="84" start="61333" end="61389">
            <expr line1="335" col1="28" line2="335" col2="33" start="61333" end="61338">
              <SYMBOL_FUNCTION_CALL line1="335" col1="28" line2="335" col2="33" start="61333" end="61338">paste0</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="335" col1="34" line2="335" col2="34" start="61339" end="61339">(</OP-LEFT-PAREN>
            <expr line1="335" col1="35" line2="335" col2="49" start="61340" end="61354">
              <expr line1="335" col1="35" line2="335" col2="35" start="61340" end="61340">
                <SYMBOL_FUNCTION_CALL line1="335" col1="35" line2="335" col2="35" start="61340" end="61340">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="335" col1="36" line2="335" col2="36" start="61341" end="61341">(</OP-LEFT-PAREN>
              <expr line1="335" col1="37" line2="335" col2="38" start="61342" end="61343">
                <STR_CONST line1="335" col1="37" line2="335" col2="38" start="61342" end="61343">""</STR_CONST>
              </expr>
              <OP-COMMA line1="335" col1="39" line2="335" col2="39" start="61344" end="61344">,</OP-COMMA>
              <expr line1="335" col1="41" line2="335" col2="48" start="61346" end="61353">
                <STR_CONST line1="335" col1="41" line2="335" col2="48" start="61346" end="61353">"log10_"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="335" col1="49" line2="335" col2="49" start="61354" end="61354">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="335" col1="50" line2="335" col2="50" start="61355" end="61355">,</OP-COMMA>
            <expr line1="335" col1="52" line2="335" col2="71" start="61357" end="61376">
              <STR_CONST line1="335" col1="52" line2="335" col2="71" start="61357" end="61376">"total_features_by_"</STR_CONST>
            </expr>
            <OP-COMMA line1="335" col1="72" line2="335" col2="72" start="61377" end="61377">,</OP-COMMA>
            <expr line1="335" col1="74" line2="335" col2="83" start="61379" end="61388">
              <SYMBOL line1="335" col1="74" line2="335" col2="83" start="61379" end="61388">exprs_type</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="335" col1="84" line2="335" col2="84" start="61389" end="61389">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="337" col1="5" line2="337" col2="28" start="61676" end="61699">## Adding the total sum.</COMMENT>
        <expr line1="338" col1="5" line2="338" col2="53" start="61859" end="61907">
          <expr line1="338" col1="5" line2="338" col2="11" start="61859" end="61865">
            <SYMBOL line1="338" col1="5" line2="338" col2="11" start="61859" end="61865">libsize</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="338" col1="13" line2="338" col2="14" start="61867" end="61868">&lt;-</LEFT_ASSIGN>
          <expr line1="338" col1="16" line2="338" col2="53" start="61870" end="61907">
            <expr line1="338" col1="16" line2="338" col2="23" start="61870" end="61877">
              <SYMBOL_FUNCTION_CALL line1="338" col1="16" line2="338" col2="23" start="61870" end="61877">.colSums</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="338" col1="24" line2="338" col2="24" start="61878" end="61878">(</OP-LEFT-PAREN>
            <expr line1="338" col1="25" line2="338" col2="33" start="61879" end="61887">
              <SYMBOL line1="338" col1="25" line2="338" col2="33" start="61879" end="61887">exprs_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="338" col1="34" line2="338" col2="34" start="61888" end="61888">,</OP-COMMA>
            <SYMBOL_SUB line1="338" col1="36" line2="338" col2="39" start="61890" end="61893">rows</SYMBOL_SUB>
            <EQ_SUB line1="338" col1="41" line2="338" col2="41" start="61895" end="61895">=</EQ_SUB>
            <expr line1="338" col1="43" line2="338" col2="52" start="61897" end="61906">
              <SYMBOL line1="338" col1="43" line2="338" col2="52" start="61897" end="61906">subset_row</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="338" col1="53" line2="338" col2="53" start="61907" end="61907">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="339" col1="5" line2="339" col2="56" start="62042" end="62093">
          <expr line1="339" col1="5" line2="339" col2="45" start="62042" end="62082">
            <expr line1="339" col1="5" line2="339" col2="13" start="62042" end="62050">
              <SYMBOL line1="339" col1="5" line2="339" col2="13" start="62042" end="62050">cell_data</SYMBOL>
            </expr>
            <LBB line1="339" col1="14" line2="339" col2="15" start="62051" end="62052">[[</LBB>
            <expr line1="339" col1="16" line2="339" col2="43" start="62053" end="62080">
              <expr line1="339" col1="16" line2="339" col2="21" start="62053" end="62058">
                <SYMBOL_FUNCTION_CALL line1="339" col1="16" line2="339" col2="21" start="62053" end="62058">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="339" col1="22" line2="339" col2="22" start="62059" end="62059">(</OP-LEFT-PAREN>
              <expr line1="339" col1="23" line2="339" col2="30" start="62060" end="62067">
                <STR_CONST line1="339" col1="23" line2="339" col2="30" start="62060" end="62067">"total_"</STR_CONST>
              </expr>
              <OP-COMMA line1="339" col1="31" line2="339" col2="31" start="62068" end="62068">,</OP-COMMA>
              <expr line1="339" col1="33" line2="339" col2="42" start="62070" end="62079">
                <SYMBOL line1="339" col1="33" line2="339" col2="42" start="62070" end="62079">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="339" col1="43" line2="339" col2="43" start="62080" end="62080">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="339" col1="44" line2="339" col2="44" start="62081" end="62081">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="339" col1="45" line2="339" col2="45" start="62082" end="62082">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="339" col1="47" line2="339" col2="48" start="62084" end="62085">&lt;-</LEFT_ASSIGN>
          <expr line1="339" col1="50" line2="339" col2="56" start="62087" end="62093">
            <SYMBOL line1="339" col1="50" line2="339" col2="56" start="62087" end="62093">libsize</SYMBOL>
          </expr>
        </expr>
        <expr line1="340" col1="5" line2="340" col2="73" start="62225" end="62293">
          <expr line1="340" col1="5" line2="340" col2="51" start="62225" end="62271">
            <expr line1="340" col1="5" line2="340" col2="13" start="62225" end="62233">
              <SYMBOL line1="340" col1="5" line2="340" col2="13" start="62225" end="62233">cell_data</SYMBOL>
            </expr>
            <LBB line1="340" col1="14" line2="340" col2="15" start="62234" end="62235">[[</LBB>
            <expr line1="340" col1="16" line2="340" col2="49" start="62236" end="62269">
              <expr line1="340" col1="16" line2="340" col2="21" start="62236" end="62241">
                <SYMBOL_FUNCTION_CALL line1="340" col1="16" line2="340" col2="21" start="62236" end="62241">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="340" col1="22" line2="340" col2="22" start="62242" end="62242">(</OP-LEFT-PAREN>
              <expr line1="340" col1="23" line2="340" col2="36" start="62243" end="62256">
                <STR_CONST line1="340" col1="23" line2="340" col2="36" start="62243" end="62256">"log10_total_"</STR_CONST>
              </expr>
              <OP-COMMA line1="340" col1="37" line2="340" col2="37" start="62257" end="62257">,</OP-COMMA>
              <expr line1="340" col1="39" line2="340" col2="48" start="62259" end="62268">
                <SYMBOL line1="340" col1="39" line2="340" col2="48" start="62259" end="62268">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="340" col1="49" line2="340" col2="49" start="62269" end="62269">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="340" col1="50" line2="340" col2="50" start="62270" end="62270">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="340" col1="51" line2="340" col2="51" start="62271" end="62271">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="340" col1="53" line2="340" col2="54" start="62273" end="62274">&lt;-</LEFT_ASSIGN>
          <expr line1="340" col1="56" line2="340" col2="73" start="62276" end="62293">
            <expr line1="340" col1="56" line2="340" col2="60" start="62276" end="62280">
              <SYMBOL_FUNCTION_CALL line1="340" col1="56" line2="340" col2="60" start="62276" end="62280">log10</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="340" col1="61" line2="340" col2="61" start="62281" end="62281">(</OP-LEFT-PAREN>
            <expr line1="340" col1="62" line2="340" col2="72" start="62282" end="62292">
              <expr line1="340" col1="62" line2="340" col2="68" start="62282" end="62288">
                <SYMBOL line1="340" col1="62" line2="340" col2="68" start="62282" end="62288">libsize</SYMBOL>
              </expr>
              <OP-PLUS line1="340" col1="70" line2="340" col2="70" start="62290" end="62290">+</OP-PLUS>
              <expr line1="340" col1="72" line2="340" col2="72" start="62292" end="62292">
                <NUM_CONST line1="340" col1="72" line2="340" col2="72" start="62292" end="62292">1</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="340" col1="73" line2="340" col2="73" start="62293" end="62293">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="342" col1="5" line2="345" col2="5" start="62591" end="63140">
          <IF line1="342" col1="5" line2="342" col2="6" start="62591" end="62592">if</IF>
          <OP-LEFT-PAREN line1="342" col1="8" line2="342" col2="8" start="62594" end="62594">(</OP-LEFT-PAREN>
          <expr line1="342" col1="9" line2="342" col2="28" start="62595" end="62614">
            <OP-EXCLAMATION line1="342" col1="9" line2="342" col2="9" start="62595" end="62595">!</OP-EXCLAMATION>
            <expr line1="342" col1="10" line2="342" col2="28" start="62596" end="62614">
              <expr line1="342" col1="10" line2="342" col2="16" start="62596" end="62602">
                <SYMBOL_FUNCTION_CALL line1="342" col1="10" line2="342" col2="16" start="62596" end="62602">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="342" col1="17" line2="342" col2="17" start="62603" end="62603">(</OP-LEFT-PAREN>
              <expr line1="342" col1="18" line2="342" col2="27" start="62604" end="62613">
                <SYMBOL line1="342" col1="18" line2="342" col2="27" start="62604" end="62613">subset_row</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="342" col1="28" line2="342" col2="28" start="62614" end="62614">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="342" col1="29" line2="342" col2="29" start="62615" end="62615">)</OP-RIGHT-PAREN>
          <expr line1="342" col1="31" line2="345" col2="5" start="62617" end="63140">
            <OP-LEFT-BRACE line1="342" col1="31" line2="342" col2="31" start="62617" end="62617">{</OP-LEFT-BRACE>
            <COMMENT line1="343" col1="9" line2="343" col2="49" start="62778" end="62818">## Computing percentages of actual total.</COMMENT>
            <expr line1="344" col1="9" line2="344" col2="78" start="62961" end="63030">
              <expr line1="344" col1="9" line2="344" col2="47" start="62961" end="62999">
                <expr line1="344" col1="9" line2="344" col2="17" start="62961" end="62969">
                  <SYMBOL line1="344" col1="9" line2="344" col2="17" start="62961" end="62969">cell_data</SYMBOL>
                </expr>
                <LBB line1="344" col1="18" line2="344" col2="19" start="62970" end="62971">[[</LBB>
                <expr line1="344" col1="20" line2="344" col2="45" start="62972" end="62997">
                  <expr line1="344" col1="20" line2="344" col2="25" start="62972" end="62977">
                    <SYMBOL_FUNCTION_CALL line1="344" col1="20" line2="344" col2="25" start="62972" end="62977">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="344" col1="26" line2="344" col2="26" start="62978" end="62978">(</OP-LEFT-PAREN>
                  <expr line1="344" col1="27" line2="344" col2="32" start="62979" end="62984">
                    <STR_CONST line1="344" col1="27" line2="344" col2="32" start="62979" end="62984">"pct_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="344" col1="33" line2="344" col2="33" start="62985" end="62985">,</OP-COMMA>
                  <expr line1="344" col1="35" line2="344" col2="44" start="62987" end="62996">
                    <SYMBOL line1="344" col1="35" line2="344" col2="44" start="62987" end="62996">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="344" col1="45" line2="344" col2="45" start="62997" end="62997">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="344" col1="46" line2="344" col2="46" start="62998" end="62998">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="344" col1="47" line2="344" col2="47" start="62999" end="62999">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="344" col1="49" line2="344" col2="50" start="63001" end="63002">&lt;-</LEFT_ASSIGN>
              <expr line1="344" col1="52" line2="344" col2="78" start="63004" end="63030">
                <expr line1="344" col1="52" line2="344" col2="64" start="63004" end="63016">
                  <expr line1="344" col1="52" line2="344" col2="54" start="63004" end="63006">
                    <NUM_CONST line1="344" col1="52" line2="344" col2="54" start="63004" end="63006">100</NUM_CONST>
                  </expr>
                  <OP-STAR line1="344" col1="56" line2="344" col2="56" start="63008" end="63008">*</OP-STAR>
                  <expr line1="344" col1="58" line2="344" col2="64" start="63010" end="63016">
                    <SYMBOL line1="344" col1="58" line2="344" col2="64" start="63010" end="63016">libsize</SYMBOL>
                  </expr>
                </expr>
                <OP-SLASH line1="344" col1="66" line2="344" col2="66" start="63018" end="63018">/</OP-SLASH>
                <expr line1="344" col1="68" line2="344" col2="78" start="63020" end="63030">
                  <SYMBOL line1="344" col1="68" line2="344" col2="78" start="63020" end="63030">total_exprs</SYMBOL>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="345" col1="5" line2="345" col2="5" start="63140" end="63140">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="347" col1="5" line2="347" col2="35" start="63506" end="63536">## Computing total percentages.</COMMENT>
        <expr line1="348" col1="5" line2="349" col2="54" start="63689" end="63921">
          <expr line1="348" col1="5" line2="348" col2="11" start="63689" end="63695">
            <SYMBOL line1="348" col1="5" line2="348" col2="11" start="63689" end="63695">pct_top</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="348" col1="13" line2="348" col2="14" start="63697" end="63698">&lt;-</LEFT_ASSIGN>
          <expr line1="348" col1="16" line2="349" col2="54" start="63700" end="63921">
            <expr line1="348" col1="16" line2="348" col2="29" start="63700" end="63713">
              <SYMBOL_FUNCTION_CALL line1="348" col1="16" line2="348" col2="29" start="63700" end="63713">.calc_top_prop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="348" col1="30" line2="348" col2="30" start="63714" end="63714">(</OP-LEFT-PAREN>
            <expr line1="348" col1="31" line2="348" col2="39" start="63715" end="63723">
              <SYMBOL line1="348" col1="31" line2="348" col2="39" start="63715" end="63723">exprs_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="348" col1="40" line2="348" col2="40" start="63724" end="63724">,</OP-COMMA>
            <SYMBOL_SUB line1="348" col1="42" line2="348" col2="51" start="63726" end="63735">subset_row</SYMBOL_SUB>
            <EQ_SUB line1="348" col1="53" line2="348" col2="53" start="63737" end="63737">=</EQ_SUB>
            <expr line1="348" col1="55" line2="348" col2="64" start="63739" end="63748">
              <SYMBOL line1="348" col1="55" line2="348" col2="64" start="63739" end="63748">subset_row</SYMBOL>
            </expr>
            <OP-COMMA line1="348" col1="65" line2="348" col2="65" start="63749" end="63749">,</OP-COMMA>
            <SYMBOL_SUB line1="348" col1="67" line2="348" col2="77" start="63751" end="63761">percent_top</SYMBOL_SUB>
            <EQ_SUB line1="348" col1="79" line2="348" col2="79" start="63763" end="63763">=</EQ_SUB>
            <expr line1="348" col1="81" line2="348" col2="91" start="63765" end="63775">
              <SYMBOL line1="348" col1="81" line2="348" col2="91" start="63765" end="63775">percent_top</SYMBOL>
            </expr>
            <OP-COMMA line1="348" col1="92" line2="348" col2="92" start="63776" end="63776">,</OP-COMMA>
            <SYMBOL_SUB line1="349" col1="31" line2="349" col2="40" start="63898" end="63907">exprs_type</SYMBOL_SUB>
            <EQ_SUB line1="349" col1="42" line2="349" col2="42" start="63909" end="63909">=</EQ_SUB>
            <expr line1="349" col1="44" line2="349" col2="53" start="63911" end="63920">
              <SYMBOL line1="349" col1="44" line2="349" col2="53" start="63911" end="63920">exprs_type</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="349" col1="54" line2="349" col2="54" start="63921" end="63921">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="350" col1="5" line2="350" col2="42" start="64055" end="64092">
          <expr line1="350" col1="5" line2="350" col2="13" start="64055" end="64063">
            <SYMBOL line1="350" col1="5" line2="350" col2="13" start="64055" end="64063">cell_data</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="350" col1="15" line2="350" col2="16" start="64065" end="64066">&lt;-</LEFT_ASSIGN>
          <expr line1="350" col1="18" line2="350" col2="42" start="64068" end="64092">
            <expr line1="350" col1="18" line2="350" col2="22" start="64068" end="64072">
              <SYMBOL_FUNCTION_CALL line1="350" col1="18" line2="350" col2="22" start="64068" end="64072">cbind</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="350" col1="23" line2="350" col2="23" start="64073" end="64073">(</OP-LEFT-PAREN>
            <expr line1="350" col1="24" line2="350" col2="32" start="64074" end="64082">
              <SYMBOL line1="350" col1="24" line2="350" col2="32" start="64074" end="64082">cell_data</SYMBOL>
            </expr>
            <OP-COMMA line1="350" col1="33" line2="350" col2="33" start="64083" end="64083">,</OP-COMMA>
            <expr line1="350" col1="35" line2="350" col2="41" start="64085" end="64091">
              <SYMBOL line1="350" col1="35" line2="350" col2="41" start="64085" end="64091">pct_top</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="350" col1="42" line2="350" col2="42" start="64092" end="64092">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="352" col1="5" line2="352" col2="32" start="64421" end="64448">### Legacy metric names. ###</COMMENT>
        <expr line1="353" col1="5" line2="360" col2="5" start="64604" end="65885">
          <IF line1="353" col1="5" line2="353" col2="6" start="64604" end="64605">if</IF>
          <OP-LEFT-PAREN line1="353" col1="8" line2="353" col2="8" start="64607" end="64607">(</OP-LEFT-PAREN>
          <expr line1="353" col1="9" line2="353" col2="14" start="64608" end="64613">
            <SYMBOL line1="353" col1="9" line2="353" col2="14" start="64608" end="64613">legacy</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="353" col1="15" line2="353" col2="15" start="64614" end="64614">)</OP-RIGHT-PAREN>
          <expr line1="353" col1="17" line2="360" col2="5" start="64616" end="65885">
            <OP-LEFT-BRACE line1="353" col1="17" line2="353" col2="17" start="64616" end="64616">{</OP-LEFT-BRACE>
            <expr line1="354" col1="9" line2="354" col2="89" start="64791" end="64871">
              <expr line1="354" col1="9" line2="354" col2="32" start="64791" end="64814">
                <expr line1="354" col1="9" line2="354" col2="17" start="64791" end="64799">
                  <SYMBOL line1="354" col1="9" line2="354" col2="17" start="64791" end="64799">cell_data</SYMBOL>
                </expr>
                <OP-DOLLAR line1="354" col1="18" line2="354" col2="18" start="64800" end="64800">$</OP-DOLLAR>
                <SYMBOL line1="354" col1="19" line2="354" col2="32" start="64801" end="64814">total_features</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="354" col1="34" line2="354" col2="35" start="64816" end="64817">&lt;-</LEFT_ASSIGN>
              <expr line1="354" col1="37" line2="354" col2="89" start="64819" end="64871">
                <expr line1="354" col1="37" line2="354" col2="45" start="64819" end="64827">
                  <SYMBOL line1="354" col1="37" line2="354" col2="45" start="64819" end="64827">cell_data</SYMBOL>
                </expr>
                <LBB line1="354" col1="46" line2="354" col2="47" start="64828" end="64829">[[</LBB>
                <expr line1="354" col1="48" line2="354" col2="87" start="64830" end="64869">
                  <expr line1="354" col1="48" line2="354" col2="53" start="64830" end="64835">
                    <SYMBOL_FUNCTION_CALL line1="354" col1="48" line2="354" col2="53" start="64830" end="64835">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="354" col1="54" line2="354" col2="54" start="64836" end="64836">(</OP-LEFT-PAREN>
                  <expr line1="354" col1="55" line2="354" col2="74" start="64837" end="64856">
                    <STR_CONST line1="354" col1="55" line2="354" col2="74" start="64837" end="64856">"total_features_by_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="354" col1="75" line2="354" col2="75" start="64857" end="64857">,</OP-COMMA>
                  <expr line1="354" col1="77" line2="354" col2="86" start="64859" end="64868">
                    <SYMBOL line1="354" col1="77" line2="354" col2="86" start="64859" end="64868">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="354" col1="87" line2="354" col2="87" start="64869" end="64869">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="354" col1="88" line2="354" col2="88" start="64870" end="64870">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="354" col1="89" line2="354" col2="89" start="64871" end="64871">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="355" col1="9" line2="355" col2="101" start="64974" end="65066">
              <expr line1="355" col1="9" line2="355" col2="38" start="64974" end="65003">
                <expr line1="355" col1="9" line2="355" col2="17" start="64974" end="64982">
                  <SYMBOL line1="355" col1="9" line2="355" col2="17" start="64974" end="64982">cell_data</SYMBOL>
                </expr>
                <OP-DOLLAR line1="355" col1="18" line2="355" col2="18" start="64983" end="64983">$</OP-DOLLAR>
                <SYMBOL line1="355" col1="19" line2="355" col2="38" start="64984" end="65003">log10_total_features</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="355" col1="40" line2="355" col2="41" start="65005" end="65006">&lt;-</LEFT_ASSIGN>
              <expr line1="355" col1="43" line2="355" col2="101" start="65008" end="65066">
                <expr line1="355" col1="43" line2="355" col2="51" start="65008" end="65016">
                  <SYMBOL line1="355" col1="43" line2="355" col2="51" start="65008" end="65016">cell_data</SYMBOL>
                </expr>
                <LBB line1="355" col1="52" line2="355" col2="53" start="65017" end="65018">[[</LBB>
                <expr line1="355" col1="54" line2="355" col2="99" start="65019" end="65064">
                  <expr line1="355" col1="54" line2="355" col2="59" start="65019" end="65024">
                    <SYMBOL_FUNCTION_CALL line1="355" col1="54" line2="355" col2="59" start="65019" end="65024">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="355" col1="60" line2="355" col2="60" start="65025" end="65025">(</OP-LEFT-PAREN>
                  <expr line1="355" col1="61" line2="355" col2="86" start="65026" end="65051">
                    <STR_CONST line1="355" col1="61" line2="355" col2="86" start="65026" end="65051">"log10_total_features_by_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="355" col1="87" line2="355" col2="87" start="65052" end="65052">,</OP-COMMA>
                  <expr line1="355" col1="89" line2="355" col2="98" start="65054" end="65063">
                    <SYMBOL line1="355" col1="89" line2="355" col2="98" start="65054" end="65063">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="355" col1="99" line2="355" col2="99" start="65064" end="65064">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="355" col1="100" line2="355" col2="100" start="65065" end="65065">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="355" col1="101" line2="355" col2="101" start="65066" end="65066">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="357" col1="9" line2="357" col2="33" start="65340" end="65364">
              <expr line1="357" col1="9" line2="357" col2="22" start="65340" end="65353">
                <SYMBOL line1="357" col1="9" line2="357" col2="22" start="65340" end="65353">pct_top_legacy</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="357" col1="24" line2="357" col2="25" start="65355" end="65356">&lt;-</LEFT_ASSIGN>
              <expr line1="357" col1="27" line2="357" col2="33" start="65358" end="65364">
                <SYMBOL line1="357" col1="27" line2="357" col2="33" start="65358" end="65364">pct_top</SYMBOL>
              </expr>
            </expr>
            <expr line1="358" col1="9" line2="358" col2="107" start="65523" end="65621">
              <expr line1="358" col1="9" line2="358" col2="32" start="65523" end="65546">
                <expr line1="358" col1="9" line2="358" col2="16" start="65523" end="65530">
                  <SYMBOL_FUNCTION_CALL line1="358" col1="9" line2="358" col2="16" start="65523" end="65530">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="358" col1="17" line2="358" col2="17" start="65531" end="65531">(</OP-LEFT-PAREN>
                <expr line1="358" col1="18" line2="358" col2="31" start="65532" end="65545">
                  <SYMBOL line1="358" col1="18" line2="358" col2="31" start="65532" end="65545">pct_top_legacy</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="358" col1="32" line2="358" col2="32" start="65546" end="65546">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="358" col1="34" line2="358" col2="35" start="65548" end="65549">&lt;-</LEFT_ASSIGN>
              <expr line1="358" col1="37" line2="358" col2="107" start="65551" end="65621">
                <expr line1="358" col1="37" line2="358" col2="39" start="65551" end="65553">
                  <SYMBOL_FUNCTION_CALL line1="358" col1="37" line2="358" col2="39" start="65551" end="65553">sub</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="358" col1="40" line2="358" col2="40" start="65554" end="65554">(</OP-LEFT-PAREN>
                <expr line1="358" col1="41" line2="358" col2="68" start="65555" end="65582">
                  <STR_CONST line1="358" col1="41" line2="358" col2="68" start="65555" end="65582">"_in_top_([0-9]+_features)$"</STR_CONST>
                </expr>
                <OP-COMMA line1="358" col1="69" line2="358" col2="69" start="65583" end="65583">,</OP-COMMA>
                <expr line1="358" col1="71" line2="358" col2="80" start="65585" end="65594">
                  <STR_CONST line1="358" col1="71" line2="358" col2="80" start="65585" end="65594">"_top_\\1"</STR_CONST>
                </expr>
                <OP-COMMA line1="358" col1="81" line2="358" col2="81" start="65595" end="65595">,</OP-COMMA>
                <expr line1="358" col1="83" line2="358" col2="106" start="65597" end="65620">
                  <expr line1="358" col1="83" line2="358" col2="90" start="65597" end="65604">
                    <SYMBOL_FUNCTION_CALL line1="358" col1="83" line2="358" col2="90" start="65597" end="65604">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="358" col1="91" line2="358" col2="91" start="65605" end="65605">(</OP-LEFT-PAREN>
                  <expr line1="358" col1="92" line2="358" col2="105" start="65606" end="65619">
                    <SYMBOL line1="358" col1="92" line2="358" col2="105" start="65606" end="65619">pct_top_legacy</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="358" col1="106" line2="358" col2="106" start="65620" end="65620">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="358" col1="107" line2="358" col2="107" start="65621" end="65621">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="359" col1="9" line2="359" col2="53" start="65706" end="65750">
              <expr line1="359" col1="9" line2="359" col2="17" start="65706" end="65714">
                <SYMBOL line1="359" col1="9" line2="359" col2="17" start="65706" end="65714">cell_data</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="359" col1="19" line2="359" col2="20" start="65716" end="65717">&lt;-</LEFT_ASSIGN>
              <expr line1="359" col1="22" line2="359" col2="53" start="65719" end="65750">
                <expr line1="359" col1="22" line2="359" col2="26" start="65719" end="65723">
                  <SYMBOL_FUNCTION_CALL line1="359" col1="22" line2="359" col2="26" start="65719" end="65723">cbind</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="359" col1="27" line2="359" col2="27" start="65724" end="65724">(</OP-LEFT-PAREN>
                <expr line1="359" col1="28" line2="359" col2="36" start="65725" end="65733">
                  <SYMBOL line1="359" col1="28" line2="359" col2="36" start="65725" end="65733">cell_data</SYMBOL>
                </expr>
                <OP-COMMA line1="359" col1="37" line2="359" col2="37" start="65734" end="65734">,</OP-COMMA>
                <expr line1="359" col1="39" line2="359" col2="52" start="65736" end="65749">
                  <SYMBOL line1="359" col1="39" line2="359" col2="52" start="65736" end="65749">pct_top_legacy</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="359" col1="53" line2="359" col2="53" start="65750" end="65750">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="360" col1="5" line2="360" col2="5" start="65885" end="65885">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="362" col1="5" line2="362" col2="21" start="66251" end="66267">
          <expr line1="362" col1="5" line2="362" col2="10" start="66251" end="66256">
            <SYMBOL_FUNCTION_CALL line1="362" col1="5" line2="362" col2="10" start="66251" end="66256">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="362" col1="11" line2="362" col2="11" start="66257" end="66257">(</OP-LEFT-PAREN>
          <expr line1="362" col1="12" line2="362" col2="20" start="66258" end="66266">
            <SYMBOL line1="362" col1="12" line2="362" col2="20" start="66258" end="66266">cell_data</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="362" col1="21" line2="362" col2="21" start="66267" end="66267">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="363" col1="1" line2="363" col2="1" start="66430" end="66430">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="365" col1="1" line2="385" col2="1" start="66796" end="70456">
    <expr line1="365" col1="1" line2="365" col2="14" start="66796" end="66809">
      <SYMBOL line1="365" col1="1" line2="365" col2="14" start="66796" end="66809">.calc_top_prop</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="365" col1="16" line2="365" col2="17" start="66811" end="66812">&lt;-</LEFT_ASSIGN>
    <expr line1="365" col1="19" line2="385" col2="1" start="66814" end="70456">
      <FUNCTION line1="365" col1="19" line2="365" col2="26" start="66814" end="66821">function</FUNCTION>
      <OP-LEFT-PAREN line1="365" col1="27" line2="365" col2="27" start="66822" end="66822">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="365" col1="28" line2="365" col2="36" start="66823" end="66831">exprs_mat</SYMBOL_FORMALS>
      <OP-COMMA line1="365" col1="37" line2="365" col2="37" start="66832" end="66832">,</OP-COMMA>
      <SYMBOL_FORMALS line1="365" col1="39" line2="365" col2="49" start="66834" end="66844">percent_top</SYMBOL_FORMALS>
      <OP-COMMA line1="365" col1="50" line2="365" col2="50" start="66845" end="66845">,</OP-COMMA>
      <SYMBOL_FORMALS line1="365" col1="52" line2="365" col2="61" start="66847" end="66856">subset_row</SYMBOL_FORMALS>
      <EQ_FORMALS line1="365" col1="63" line2="365" col2="63" start="66858" end="66858">=</EQ_FORMALS>
      <expr line1="365" col1="65" line2="365" col2="68" start="66860" end="66863">
        <NULL_CONST line1="365" col1="65" line2="365" col2="68" start="66860" end="66863">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="365" col1="69" line2="365" col2="69" start="66864" end="66864">,</OP-COMMA>
      <SYMBOL_FORMALS line1="365" col1="71" line2="365" col2="80" start="66866" end="66875">exprs_type</SYMBOL_FORMALS>
      <EQ_FORMALS line1="365" col1="82" line2="365" col2="82" start="66877" end="66877">=</EQ_FORMALS>
      <expr line1="365" col1="84" line2="365" col2="91" start="66879" end="66886">
        <STR_CONST line1="365" col1="84" line2="365" col2="91" start="66879" end="66886">"counts"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="365" col1="92" line2="365" col2="92" start="66887" end="66887">)</OP-RIGHT-PAREN>
      <COMMENT line1="366" col1="1" line2="366" col2="76" start="66979" end="67054">## Calculate the proportion of expression belonging to the top set of genes.</COMMENT>
      <COMMENT line1="367" col1="1" line2="367" col2="56" start="67162" end="67217">## Produces a matrix of proportions for each top number.</COMMENT>
      <expr line1="368" col1="1" line2="385" col2="1" start="67345" end="70456">
        <OP-LEFT-BRACE line1="368" col1="1" line2="368" col2="1" start="67345" end="67345">{</OP-LEFT-BRACE>
        <expr line1="370" col1="5" line2="375" col2="5" start="67715" end="68630">
          <IF line1="370" col1="5" line2="370" col2="6" start="67715" end="67716">if</IF>
          <OP-LEFT-PAREN line1="370" col1="8" line2="370" col2="8" start="67718" end="67718">(</OP-LEFT-PAREN>
          <expr line1="370" col1="9" line2="370" col2="27" start="67719" end="67737">
            <expr line1="370" col1="9" line2="370" col2="15" start="67719" end="67725">
              <SYMBOL_FUNCTION_CALL line1="370" col1="9" line2="370" col2="15" start="67719" end="67725">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="370" col1="16" line2="370" col2="16" start="67726" end="67726">(</OP-LEFT-PAREN>
            <expr line1="370" col1="17" line2="370" col2="26" start="67727" end="67736">
              <SYMBOL line1="370" col1="17" line2="370" col2="26" start="67727" end="67736">subset_row</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="370" col1="27" line2="370" col2="27" start="67737" end="67737">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="370" col1="28" line2="370" col2="28" start="67738" end="67738">)</OP-RIGHT-PAREN>
          <expr line1="370" col1="30" line2="372" col2="5" start="67740" end="68081">
            <OP-LEFT-BRACE line1="370" col1="30" line2="370" col2="30" start="67740" end="67740">{</OP-LEFT-BRACE>
            <expr line1="371" col1="9" line2="371" col2="38" start="67902" end="67931">
              <expr line1="371" col1="9" line2="371" col2="19" start="67902" end="67912">
                <SYMBOL line1="371" col1="9" line2="371" col2="19" start="67902" end="67912">total_nrows</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="371" col1="21" line2="371" col2="22" start="67914" end="67915">&lt;-</LEFT_ASSIGN>
              <expr line1="371" col1="24" line2="371" col2="38" start="67917" end="67931">
                <expr line1="371" col1="24" line2="371" col2="27" start="67917" end="67920">
                  <SYMBOL_FUNCTION_CALL line1="371" col1="24" line2="371" col2="27" start="67917" end="67920">nrow</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="371" col1="28" line2="371" col2="28" start="67921" end="67921">(</OP-LEFT-PAREN>
                <expr line1="371" col1="29" line2="371" col2="37" start="67922" end="67930">
                  <SYMBOL line1="371" col1="29" line2="371" col2="37" start="67922" end="67930">exprs_mat</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="371" col1="38" line2="371" col2="38" start="67931" end="67931">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="372" col1="5" line2="372" col2="5" start="68081" end="68081">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="372" col1="7" line2="372" col2="10" start="68083" end="68086">else</ELSE>
          <expr line1="372" col1="12" line2="375" col2="5" start="68088" end="68630">
            <OP-LEFT-BRACE line1="372" col1="12" line2="372" col2="12" start="68088" end="68088">{</OP-LEFT-BRACE>
            <expr line1="373" col1="9" line2="373" col2="37" start="68268" end="68296">
              <expr line1="373" col1="9" line2="373" col2="18" start="68268" end="68277">
                <SYMBOL line1="373" col1="9" line2="373" col2="18" start="68268" end="68277">subset_row</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="373" col1="20" line2="373" col2="21" start="68279" end="68280">&lt;-</LEFT_ASSIGN>
              <expr line1="373" col1="23" line2="373" col2="37" start="68282" end="68296">
                <expr line1="373" col1="23" line2="373" col2="32" start="68282" end="68291">
                  <SYMBOL line1="373" col1="23" line2="373" col2="32" start="68282" end="68291">subset_row</SYMBOL>
                </expr>
                <OP-MINUS line1="373" col1="34" line2="373" col2="34" start="68293" end="68293">-</OP-MINUS>
                <expr line1="373" col1="36" line2="373" col2="37" start="68295" end="68296">
                  <NUM_CONST line1="373" col1="36" line2="373" col2="37" start="68295" end="68296">1L</NUM_CONST>
                </expr>
              </expr>
            </expr>
            <COMMENT line1="373" col1="39" line2="373" col2="79" start="68298" end="68338"># zero indexing needed for this C++ code.</COMMENT>
            <expr line1="374" col1="9" line2="374" col2="41" start="68451" end="68483">
              <expr line1="374" col1="9" line2="374" col2="19" start="68451" end="68461">
                <SYMBOL line1="374" col1="9" line2="374" col2="19" start="68451" end="68461">total_nrows</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="374" col1="21" line2="374" col2="22" start="68463" end="68464">&lt;-</LEFT_ASSIGN>
              <expr line1="374" col1="24" line2="374" col2="41" start="68466" end="68483">
                <expr line1="374" col1="24" line2="374" col2="29" start="68466" end="68471">
                  <SYMBOL_FUNCTION_CALL line1="374" col1="24" line2="374" col2="29" start="68466" end="68471">length</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="374" col1="30" line2="374" col2="30" start="68472" end="68472">(</OP-LEFT-PAREN>
                <expr line1="374" col1="31" line2="374" col2="40" start="68473" end="68482">
                  <SYMBOL line1="374" col1="31" line2="374" col2="40" start="68473" end="68482">subset_row</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="374" col1="41" line2="374" col2="41" start="68483" end="68483">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="375" col1="5" line2="375" col2="5" start="68630" end="68630">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="377" col1="5" line2="377" col2="47" start="68996" end="69038">
          <expr line1="377" col1="5" line2="377" col2="17" start="68996" end="69008">
            <SYMBOL line1="377" col1="5" line2="377" col2="17" start="68996" end="69008">can.calculate</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="377" col1="19" line2="377" col2="20" start="69010" end="69011">&lt;-</LEFT_ASSIGN>
          <expr line1="377" col1="22" line2="377" col2="47" start="69013" end="69038">
            <expr line1="377" col1="22" line2="377" col2="32" start="69013" end="69023">
              <SYMBOL line1="377" col1="22" line2="377" col2="32" start="69013" end="69023">percent_top</SYMBOL>
            </expr>
            <LE line1="377" col1="34" line2="377" col2="35" start="69025" end="69026">&lt;=</LE>
            <expr line1="377" col1="37" line2="377" col2="47" start="69028" end="69038">
              <SYMBOL line1="377" col1="37" line2="377" col2="47" start="69028" end="69038">total_nrows</SYMBOL>
            </expr>
          </expr>
        </expr>
        <expr line1="378" col1="5" line2="383" col2="5" start="69179" end="70094">
          <IF line1="378" col1="5" line2="378" col2="6" start="69179" end="69180">if</IF>
          <OP-LEFT-PAREN line1="378" col1="8" line2="378" col2="8" start="69182" end="69182">(</OP-LEFT-PAREN>
          <expr line1="378" col1="9" line2="378" col2="26" start="69183" end="69200">
            <expr line1="378" col1="9" line2="378" col2="11" start="69183" end="69185">
              <SYMBOL_FUNCTION_CALL line1="378" col1="9" line2="378" col2="11" start="69183" end="69185">any</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="378" col1="12" line2="378" col2="12" start="69186" end="69186">(</OP-LEFT-PAREN>
            <expr line1="378" col1="13" line2="378" col2="25" start="69187" end="69199">
              <SYMBOL line1="378" col1="13" line2="378" col2="25" start="69187" end="69199">can.calculate</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="378" col1="26" line2="378" col2="26" start="69200" end="69200">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="378" col1="27" line2="378" col2="27" start="69201" end="69201">)</OP-RIGHT-PAREN>
          <expr line1="378" col1="29" line2="383" col2="5" start="69203" end="70094">
            <OP-LEFT-BRACE line1="378" col1="29" line2="378" col2="29" start="69203" end="69203">{</OP-LEFT-BRACE>
            <expr line1="379" col1="9" line2="379" col2="49" start="69366" end="69406">
              <expr line1="379" col1="9" line2="379" col2="19" start="69366" end="69376">
                <SYMBOL line1="379" col1="9" line2="379" col2="19" start="69366" end="69376">percent_top</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="379" col1="21" line2="379" col2="22" start="69378" end="69379">&lt;-</LEFT_ASSIGN>
              <expr line1="379" col1="24" line2="379" col2="49" start="69381" end="69406">
                <expr line1="379" col1="24" line2="379" col2="34" start="69381" end="69391">
                  <SYMBOL line1="379" col1="24" line2="379" col2="34" start="69381" end="69391">percent_top</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="379" col1="35" line2="379" col2="35" start="69392" end="69392">[</OP-LEFT-BRACKET>
                <expr line1="379" col1="36" line2="379" col2="48" start="69393" end="69405">
                  <SYMBOL line1="379" col1="36" line2="379" col2="48" start="69393" end="69405">can.calculate</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="379" col1="49" line2="379" col2="49" start="69406" end="69406">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="380" col1="9" line2="380" col2="93" start="69549" end="69633">
              <expr line1="380" col1="9" line2="380" col2="25" start="69549" end="69565">
                <SYMBOL line1="380" col1="9" line2="380" col2="25" start="69549" end="69565">pct_exprs_top_out</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="380" col1="27" line2="380" col2="28" start="69567" end="69568">&lt;-</LEFT_ASSIGN>
              <expr line1="380" col1="30" line2="380" col2="93" start="69570" end="69633">
                <expr line1="380" col1="30" line2="380" col2="34" start="69570" end="69574">
                  <SYMBOL_FUNCTION_CALL line1="380" col1="30" line2="380" col2="34" start="69570" end="69574">.Call</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="380" col1="35" line2="380" col2="35" start="69575" end="69575">(</OP-LEFT-PAREN>
                <expr line1="380" col1="36" line2="380" col2="56" start="69576" end="69596">
                  <SYMBOL line1="380" col1="36" line2="380" col2="56" start="69576" end="69596">cxx_calc_top_features</SYMBOL>
                </expr>
                <OP-COMMA line1="380" col1="57" line2="380" col2="57" start="69597" end="69597">,</OP-COMMA>
                <expr line1="380" col1="59" line2="380" col2="67" start="69599" end="69607">
                  <SYMBOL line1="380" col1="59" line2="380" col2="67" start="69599" end="69607">exprs_mat</SYMBOL>
                </expr>
                <OP-COMMA line1="380" col1="68" line2="380" col2="68" start="69608" end="69608">,</OP-COMMA>
                <expr line1="380" col1="70" line2="380" col2="80" start="69610" end="69620">
                  <SYMBOL line1="380" col1="70" line2="380" col2="80" start="69610" end="69620">percent_top</SYMBOL>
                </expr>
                <OP-COMMA line1="380" col1="81" line2="380" col2="81" start="69621" end="69621">,</OP-COMMA>
                <expr line1="380" col1="83" line2="380" col2="92" start="69623" end="69632">
                  <SYMBOL line1="380" col1="83" line2="380" col2="92" start="69623" end="69632">subset_row</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="380" col1="93" line2="380" col2="93" start="69633" end="69633">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="381" col1="9" line2="381" col2="100" start="69732" end="69823">
              <expr line1="381" col1="9" line2="381" col2="32" start="69732" end="69755">
                <expr line1="381" col1="9" line2="381" col2="13" start="69732" end="69736">
                  <SYMBOL_FUNCTION_CALL line1="381" col1="9" line2="381" col2="13" start="69732" end="69736">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="381" col1="14" line2="381" col2="14" start="69737" end="69737">(</OP-LEFT-PAREN>
                <expr line1="381" col1="15" line2="381" col2="31" start="69738" end="69754">
                  <SYMBOL line1="381" col1="15" line2="381" col2="31" start="69738" end="69754">pct_exprs_top_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="381" col1="32" line2="381" col2="32" start="69755" end="69755">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="381" col1="34" line2="381" col2="35" start="69757" end="69758">&lt;-</LEFT_ASSIGN>
              <expr line1="381" col1="37" line2="381" col2="100" start="69760" end="69823">
                <expr line1="381" col1="37" line2="381" col2="42" start="69760" end="69765">
                  <SYMBOL_FUNCTION_CALL line1="381" col1="37" line2="381" col2="42" start="69760" end="69765">paste0</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="381" col1="43" line2="381" col2="43" start="69766" end="69766">(</OP-LEFT-PAREN>
                <expr line1="381" col1="44" line2="381" col2="49" start="69767" end="69772">
                  <STR_CONST line1="381" col1="44" line2="381" col2="49" start="69767" end="69772">"pct_"</STR_CONST>
                </expr>
                <OP-COMMA line1="381" col1="50" line2="381" col2="50" start="69773" end="69773">,</OP-COMMA>
                <expr line1="381" col1="52" line2="381" col2="61" start="69775" end="69784">
                  <SYMBOL line1="381" col1="52" line2="381" col2="61" start="69775" end="69784">exprs_type</SYMBOL>
                </expr>
                <OP-COMMA line1="381" col1="62" line2="381" col2="62" start="69785" end="69785">,</OP-COMMA>
                <expr line1="381" col1="64" line2="381" col2="73" start="69787" end="69796">
                  <STR_CONST line1="381" col1="64" line2="381" col2="73" start="69787" end="69796">"_in_top_"</STR_CONST>
                </expr>
                <OP-COMMA line1="381" col1="74" line2="381" col2="74" start="69797" end="69797">,</OP-COMMA>
                <expr line1="381" col1="76" line2="381" col2="86" start="69799" end="69809">
                  <SYMBOL line1="381" col1="76" line2="381" col2="86" start="69799" end="69809">percent_top</SYMBOL>
                </expr>
                <OP-COMMA line1="381" col1="87" line2="381" col2="87" start="69810" end="69810">,</OP-COMMA>
                <expr line1="381" col1="89" line2="381" col2="99" start="69812" end="69822">
                  <STR_CONST line1="381" col1="89" line2="381" col2="99" start="69812" end="69822">"_features"</STR_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="381" col1="100" line2="381" col2="100" start="69823" end="69823">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="382" col1="9" line2="382" col2="53" start="69915" end="69959">
              <expr line1="382" col1="9" line2="382" col2="14" start="69915" end="69920">
                <SYMBOL_FUNCTION_CALL line1="382" col1="9" line2="382" col2="14" start="69915" end="69920">return</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="382" col1="15" line2="382" col2="15" start="69921" end="69921">(</OP-LEFT-PAREN>
              <expr line1="382" col1="16" line2="382" col2="52" start="69922" end="69958">
                <expr line1="382" col1="16" line2="382" col2="22" start="69922" end="69928">
                  <SYMBOL_FUNCTION_CALL line1="382" col1="16" line2="382" col2="22" start="69922" end="69928">do.call</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="382" col1="23" line2="382" col2="23" start="69929" end="69929">(</OP-LEFT-PAREN>
                <expr line1="382" col1="24" line2="382" col2="32" start="69930" end="69938">
                  <SYMBOL line1="382" col1="24" line2="382" col2="32" start="69930" end="69938">DataFrame</SYMBOL>
                </expr>
                <OP-COMMA line1="382" col1="33" line2="382" col2="33" start="69939" end="69939">,</OP-COMMA>
                <expr line1="382" col1="35" line2="382" col2="51" start="69941" end="69957">
                  <SYMBOL line1="382" col1="35" line2="382" col2="51" start="69941" end="69957">pct_exprs_top_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="382" col1="52" line2="382" col2="52" start="69958" end="69958">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="382" col1="53" line2="382" col2="53" start="69959" end="69959">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="383" col1="5" line2="383" col2="5" start="70094" end="70094">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="384" col1="5" line2="384" col2="51" start="70277" end="70323">
          <expr line1="384" col1="5" line2="384" col2="10" start="70277" end="70282">
            <SYMBOL_FUNCTION_CALL line1="384" col1="5" line2="384" col2="10" start="70277" end="70282">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="384" col1="11" line2="384" col2="11" start="70283" end="70283">(</OP-LEFT-PAREN>
          <expr line1="384" col1="12" line2="384" col2="50" start="70284" end="70322">
            <expr line1="384" col1="12" line2="384" col2="14" start="70284" end="70286">
              <SYMBOL_FUNCTION_CALL line1="384" col1="12" line2="384" col2="14" start="70284" end="70286">new</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="384" col1="15" line2="384" col2="15" start="70287" end="70287">(</OP-LEFT-PAREN>
            <expr line1="384" col1="16" line2="384" col2="26" start="70288" end="70298">
              <STR_CONST line1="384" col1="16" line2="384" col2="26" start="70288" end="70298">"DataFrame"</STR_CONST>
            </expr>
            <OP-COMMA line1="384" col1="27" line2="384" col2="27" start="70299" end="70299">,</OP-COMMA>
            <SYMBOL_SUB line1="384" col1="29" line2="384" col2="33" start="70301" end="70305">nrows</SYMBOL_SUB>
            <EQ_SUB line1="384" col1="34" line2="384" col2="34" start="70306" end="70306">=</EQ_SUB>
            <expr line1="384" col1="35" line2="384" col2="49" start="70307" end="70321">
              <expr line1="384" col1="35" line2="384" col2="38" start="70307" end="70310">
                <SYMBOL_FUNCTION_CALL line1="384" col1="35" line2="384" col2="38" start="70307" end="70310">ncol</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="384" col1="39" line2="384" col2="39" start="70311" end="70311">(</OP-LEFT-PAREN>
              <expr line1="384" col1="40" line2="384" col2="48" start="70312" end="70320">
                <SYMBOL line1="384" col1="40" line2="384" col2="48" start="70312" end="70320">exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="384" col1="49" line2="384" col2="49" start="70321" end="70321">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="384" col1="50" line2="384" col2="50" start="70322" end="70322">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="384" col1="51" line2="384" col2="51" start="70323" end="70323">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="385" col1="1" line2="385" col2="1" start="70456" end="70456">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="387" col1="1" line2="423" col2="1" start="70822" end="77410">
    <expr line1="387" col1="1" line2="387" col2="27" start="70822" end="70848">
      <SYMBOL line1="387" col1="1" line2="387" col2="27" start="70822" end="70848">.get_qc_metrics_per_feature</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="387" col1="29" line2="387" col2="30" start="70850" end="70851">&lt;-</LEFT_ASSIGN>
    <expr line1="387" col1="32" line2="423" col2="1" start="70853" end="77410">
      <FUNCTION line1="387" col1="32" line2="387" col2="39" start="70853" end="70860">function</FUNCTION>
      <OP-LEFT-PAREN line1="387" col1="40" line2="387" col2="40" start="70861" end="70861">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="387" col1="41" line2="387" col2="49" start="70862" end="70870">exprs_mat</SYMBOL_FORMALS>
      <OP-COMMA line1="387" col1="50" line2="387" col2="50" start="70871" end="70871">,</OP-COMMA>
      <SYMBOL_FORMALS line1="387" col1="52" line2="387" col2="61" start="70873" end="70882">exprs_type</SYMBOL_FORMALS>
      <EQ_FORMALS line1="387" col1="62" line2="387" col2="62" start="70883" end="70883">=</EQ_FORMALS>
      <expr line1="387" col1="63" line2="387" col2="70" start="70884" end="70891">
        <STR_CONST line1="387" col1="63" line2="387" col2="70" start="70884" end="70891">"counts"</STR_CONST>
      </expr>
      <OP-COMMA line1="387" col1="71" line2="387" col2="71" start="70892" end="70892">,</OP-COMMA>
      <SYMBOL_FORMALS line1="388" col1="9" line2="388" col2="18" start="71013" end="71022">subset_col</SYMBOL_FORMALS>
      <EQ_FORMALS line1="388" col1="19" line2="388" col2="19" start="71023" end="71023">=</EQ_FORMALS>
      <expr line1="388" col1="20" line2="388" col2="23" start="71024" end="71027">
        <NULL_CONST line1="388" col1="20" line2="388" col2="23" start="71024" end="71027">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="388" col1="24" line2="388" col2="24" start="71028" end="71028">,</OP-COMMA>
      <SYMBOL_FORMALS line1="388" col1="26" line2="388" col2="40" start="71030" end="71044">detection_limit</SYMBOL_FORMALS>
      <EQ_FORMALS line1="388" col1="41" line2="388" col2="41" start="71045" end="71045">=</EQ_FORMALS>
      <expr line1="388" col1="42" line2="388" col2="42" start="71046" end="71046">
        <NUM_CONST line1="388" col1="42" line2="388" col2="42" start="71046" end="71046">0</NUM_CONST>
      </expr>
      <OP-COMMA line1="388" col1="43" line2="388" col2="43" start="71047" end="71047">,</OP-COMMA>
      <SYMBOL_FORMALS line1="388" col1="45" line2="388" col2="55" start="71049" end="71059">total_exprs</SYMBOL_FORMALS>
      <EQ_FORMALS line1="388" col1="57" line2="388" col2="57" start="71061" end="71061">=</EQ_FORMALS>
      <expr line1="388" col1="59" line2="388" col2="77" start="71063" end="71081">
        <expr line1="388" col1="59" line2="388" col2="66" start="71063" end="71070">
          <SYMBOL_FUNCTION_CALL line1="388" col1="59" line2="388" col2="66" start="71063" end="71070">.rowSums</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="388" col1="67" line2="388" col2="67" start="71071" end="71071">(</OP-LEFT-PAREN>
        <expr line1="388" col1="68" line2="388" col2="76" start="71072" end="71080">
          <SYMBOL line1="388" col1="68" line2="388" col2="76" start="71072" end="71080">exprs_mat</SYMBOL>
        </expr>
        <OP-RIGHT-PAREN line1="388" col1="77" line2="388" col2="77" start="71081" end="71081">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="388" col1="78" line2="388" col2="78" start="71082" end="71082">,</OP-COMMA>
      <SYMBOL_FORMALS line1="389" col1="9" line2="389" col2="14" start="71196" end="71201">legacy</SYMBOL_FORMALS>
      <EQ_FORMALS line1="389" col1="16" line2="389" col2="16" start="71203" end="71203">=</EQ_FORMALS>
      <expr line1="389" col1="18" line2="389" col2="22" start="71205" end="71209">
        <NUM_CONST line1="389" col1="18" line2="389" col2="22" start="71205" end="71209">FALSE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="389" col1="23" line2="389" col2="23" start="71210" end="71210">)</OP-RIGHT-PAREN>
      <expr line1="389" col1="25" line2="423" col2="1" start="71212" end="77410">
        <OP-LEFT-BRACE line1="389" col1="25" line2="389" col2="25" start="71212" end="71212">{</OP-LEFT-BRACE>
        <expr line1="391" col1="5" line2="395" col2="5" start="71558" end="72290">
          <IF line1="391" col1="5" line2="391" col2="6" start="71558" end="71559">if</IF>
          <OP-LEFT-PAREN line1="391" col1="8" line2="391" col2="8" start="71561" end="71561">(</OP-LEFT-PAREN>
          <expr line1="391" col1="9" line2="391" col2="27" start="71562" end="71580">
            <expr line1="391" col1="9" line2="391" col2="15" start="71562" end="71568">
              <SYMBOL_FUNCTION_CALL line1="391" col1="9" line2="391" col2="15" start="71562" end="71568">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="391" col1="16" line2="391" col2="16" start="71569" end="71569">(</OP-LEFT-PAREN>
            <expr line1="391" col1="17" line2="391" col2="26" start="71570" end="71579">
              <SYMBOL line1="391" col1="17" line2="391" col2="26" start="71570" end="71579">subset_col</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="391" col1="27" line2="391" col2="27" start="71580" end="71580">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="391" col1="28" line2="391" col2="28" start="71581" end="71581">)</OP-RIGHT-PAREN>
          <expr line1="391" col1="30" line2="393" col2="5" start="71583" end="71924">
            <OP-LEFT-BRACE line1="391" col1="30" line2="391" col2="30" start="71583" end="71583">{</OP-LEFT-BRACE>
            <expr line1="392" col1="9" line2="392" col2="38" start="71745" end="71774">
              <expr line1="392" col1="9" line2="392" col2="19" start="71745" end="71755">
                <SYMBOL line1="392" col1="9" line2="392" col2="19" start="71745" end="71755">total_cells</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="392" col1="21" line2="392" col2="22" start="71757" end="71758">&lt;-</LEFT_ASSIGN>
              <expr line1="392" col1="24" line2="392" col2="38" start="71760" end="71774">
                <expr line1="392" col1="24" line2="392" col2="27" start="71760" end="71763">
                  <SYMBOL_FUNCTION_CALL line1="392" col1="24" line2="392" col2="27" start="71760" end="71763">ncol</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="392" col1="28" line2="392" col2="28" start="71764" end="71764">(</OP-LEFT-PAREN>
                <expr line1="392" col1="29" line2="392" col2="37" start="71765" end="71773">
                  <SYMBOL line1="392" col1="29" line2="392" col2="37" start="71765" end="71773">exprs_mat</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="392" col1="38" line2="392" col2="38" start="71774" end="71774">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="393" col1="5" line2="393" col2="5" start="71924" end="71924">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="393" col1="7" line2="393" col2="10" start="71926" end="71929">else</ELSE>
          <expr line1="393" col1="12" line2="395" col2="5" start="71931" end="72290">
            <OP-LEFT-BRACE line1="393" col1="12" line2="393" col2="12" start="71931" end="71931">{</OP-LEFT-BRACE>
            <expr line1="394" col1="9" line2="394" col2="41" start="72111" end="72143">
              <expr line1="394" col1="9" line2="394" col2="19" start="72111" end="72121">
                <SYMBOL line1="394" col1="9" line2="394" col2="19" start="72111" end="72121">total_cells</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="394" col1="21" line2="394" col2="22" start="72123" end="72124">&lt;-</LEFT_ASSIGN>
              <expr line1="394" col1="24" line2="394" col2="41" start="72126" end="72143">
                <expr line1="394" col1="24" line2="394" col2="29" start="72126" end="72131">
                  <SYMBOL_FUNCTION_CALL line1="394" col1="24" line2="394" col2="29" start="72126" end="72131">length</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="394" col1="30" line2="394" col2="30" start="72132" end="72132">(</OP-LEFT-PAREN>
                <expr line1="394" col1="31" line2="394" col2="40" start="72133" end="72142">
                  <SYMBOL line1="394" col1="31" line2="394" col2="40" start="72133" end="72142">subset_col</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="394" col1="41" line2="394" col2="41" start="72143" end="72143">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="395" col1="5" line2="395" col2="5" start="72290" end="72290">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="397" col1="5" line2="397" col2="22" start="72656" end="72673"># Mean expression.</COMMENT>
        <expr line1="398" col1="5" line2="398" col2="55" start="72839" end="72889">
          <expr line1="398" col1="5" line2="398" col2="13" start="72839" end="72847">
            <SYMBOL line1="398" col1="5" line2="398" col2="13" start="72839" end="72847">sum_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="398" col1="15" line2="398" col2="16" start="72849" end="72850">&lt;-</LEFT_ASSIGN>
          <expr line1="398" col1="18" line2="398" col2="55" start="72852" end="72889">
            <expr line1="398" col1="18" line2="398" col2="25" start="72852" end="72859">
              <SYMBOL_FUNCTION_CALL line1="398" col1="18" line2="398" col2="25" start="72852" end="72859">.rowSums</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="398" col1="26" line2="398" col2="26" start="72860" end="72860">(</OP-LEFT-PAREN>
            <expr line1="398" col1="27" line2="398" col2="35" start="72861" end="72869">
              <SYMBOL line1="398" col1="27" line2="398" col2="35" start="72861" end="72869">exprs_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="398" col1="36" line2="398" col2="36" start="72870" end="72870">,</OP-COMMA>
            <SYMBOL_SUB line1="398" col1="38" line2="398" col2="41" start="72872" end="72875">cols</SYMBOL_SUB>
            <EQ_SUB line1="398" col1="43" line2="398" col2="43" start="72877" end="72877">=</EQ_SUB>
            <expr line1="398" col1="45" line2="398" col2="54" start="72879" end="72888">
              <SYMBOL line1="398" col1="45" line2="398" col2="54" start="72879" end="72888">subset_col</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="398" col1="55" line2="398" col2="55" start="72889" end="72889">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="399" col1="5" line2="399" col2="32" start="73022" end="73049">
          <expr line1="399" col1="5" line2="399" col2="7" start="73022" end="73024">
            <SYMBOL line1="399" col1="5" line2="399" col2="7" start="73022" end="73024">ave</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="399" col1="9" line2="399" col2="10" start="73026" end="73027">&lt;-</LEFT_ASSIGN>
          <expr line1="399" col1="12" line2="399" col2="32" start="73029" end="73049">
            <expr line1="399" col1="12" line2="399" col2="20" start="73029" end="73037">
              <SYMBOL line1="399" col1="12" line2="399" col2="20" start="73029" end="73037">sum_exprs</SYMBOL>
            </expr>
            <OP-SLASH line1="399" col1="21" line2="399" col2="21" start="73038" end="73038">/</OP-SLASH>
            <expr line1="399" col1="22" line2="399" col2="32" start="73039" end="73049">
              <SYMBOL line1="399" col1="22" line2="399" col2="32" start="73039" end="73049">total_cells</SYMBOL>
            </expr>
          </expr>
        </expr>
        <expr line1="400" col1="5" line2="400" col2="83" start="73205" end="73283">
          <expr line1="400" col1="5" line2="400" col2="16" start="73205" end="73216">
            <SYMBOL line1="400" col1="5" line2="400" col2="16" start="73205" end="73216">feature_data</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="400" col1="18" line2="400" col2="19" start="73218" end="73219">&lt;-</LEFT_ASSIGN>
          <expr line1="400" col1="21" line2="400" col2="83" start="73221" end="73283">
            <expr line1="400" col1="21" line2="400" col2="29" start="73221" end="73229">
              <SYMBOL_FUNCTION_CALL line1="400" col1="21" line2="400" col2="29" start="73221" end="73229">DataFrame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="400" col1="30" line2="400" col2="30" start="73230" end="73230">(</OP-LEFT-PAREN>
            <expr line1="400" col1="31" line2="400" col2="33" start="73231" end="73233">
              <SYMBOL line1="400" col1="31" line2="400" col2="33" start="73231" end="73233">ave</SYMBOL>
            </expr>
            <OP-COMMA line1="400" col1="34" line2="400" col2="34" start="73234" end="73234">,</OP-COMMA>
            <expr line1="400" col1="36" line2="400" col2="49" start="73236" end="73249">
              <expr line1="400" col1="36" line2="400" col2="40" start="73236" end="73240">
                <SYMBOL_FUNCTION_CALL line1="400" col1="36" line2="400" col2="40" start="73236" end="73240">log10</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="400" col1="41" line2="400" col2="41" start="73241" end="73241">(</OP-LEFT-PAREN>
              <expr line1="400" col1="42" line2="400" col2="48" start="73242" end="73248">
                <expr line1="400" col1="42" line2="400" col2="44" start="73242" end="73244">
                  <SYMBOL line1="400" col1="42" line2="400" col2="44" start="73242" end="73244">ave</SYMBOL>
                </expr>
                <OP-PLUS line1="400" col1="46" line2="400" col2="46" start="73246" end="73246">+</OP-PLUS>
                <expr line1="400" col1="48" line2="400" col2="48" start="73248" end="73248">
                  <NUM_CONST line1="400" col1="48" line2="400" col2="48" start="73248" end="73248">1</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="400" col1="49" line2="400" col2="49" start="73249" end="73249">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="400" col1="50" line2="400" col2="50" start="73250" end="73250">,</OP-COMMA>
            <SYMBOL_SUB line1="400" col1="52" line2="400" col2="60" start="73252" end="73260">row.names</SYMBOL_SUB>
            <EQ_SUB line1="400" col1="62" line2="400" col2="62" start="73262" end="73262">=</EQ_SUB>
            <expr line1="400" col1="64" line2="400" col2="82" start="73264" end="73282">
              <expr line1="400" col1="64" line2="400" col2="71" start="73264" end="73271">
                <SYMBOL_FUNCTION_CALL line1="400" col1="64" line2="400" col2="71" start="73264" end="73271">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="400" col1="72" line2="400" col2="72" start="73272" end="73272">(</OP-LEFT-PAREN>
              <expr line1="400" col1="73" line2="400" col2="81" start="73273" end="73281">
                <SYMBOL line1="400" col1="73" line2="400" col2="81" start="73273" end="73281">exprs_mat</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="400" col1="82" line2="400" col2="82" start="73282" end="73282">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="400" col1="83" line2="400" col2="83" start="73283" end="73283">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="401" col1="5" line2="401" col2="78" start="73388" end="73461">
          <expr line1="401" col1="5" line2="401" col2="26" start="73388" end="73409">
            <expr line1="401" col1="5" line2="401" col2="12" start="73388" end="73395">
              <SYMBOL_FUNCTION_CALL line1="401" col1="5" line2="401" col2="12" start="73388" end="73395">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="401" col1="13" line2="401" col2="13" start="73396" end="73396">(</OP-LEFT-PAREN>
            <expr line1="401" col1="14" line2="401" col2="25" start="73397" end="73408">
              <SYMBOL line1="401" col1="14" line2="401" col2="25" start="73397" end="73408">feature_data</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="401" col1="26" line2="401" col2="26" start="73409" end="73409">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="401" col1="28" line2="401" col2="29" start="73411" end="73412">&lt;-</LEFT_ASSIGN>
          <expr line1="401" col1="31" line2="401" col2="78" start="73414" end="73461">
            <expr line1="401" col1="31" line2="401" col2="36" start="73414" end="73419">
              <SYMBOL_FUNCTION_CALL line1="401" col1="31" line2="401" col2="36" start="73414" end="73419">paste0</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="401" col1="37" line2="401" col2="37" start="73420" end="73420">(</OP-LEFT-PAREN>
            <expr line1="401" col1="38" line2="401" col2="60" start="73421" end="73443">
              <expr line1="401" col1="38" line2="401" col2="38" start="73421" end="73421">
                <SYMBOL_FUNCTION_CALL line1="401" col1="38" line2="401" col2="38" start="73421" end="73421">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="401" col1="39" line2="401" col2="39" start="73422" end="73422">(</OP-LEFT-PAREN>
              <expr line1="401" col1="40" line2="401" col2="45" start="73423" end="73428">
                <STR_CONST line1="401" col1="40" line2="401" col2="45" start="73423" end="73428">"mean"</STR_CONST>
              </expr>
              <OP-COMMA line1="401" col1="46" line2="401" col2="46" start="73429" end="73429">,</OP-COMMA>
              <expr line1="401" col1="48" line2="401" col2="59" start="73431" end="73442">
                <STR_CONST line1="401" col1="48" line2="401" col2="59" start="73431" end="73442">"log10_mean"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="401" col1="60" line2="401" col2="60" start="73443" end="73443">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="401" col1="61" line2="401" col2="61" start="73444" end="73444">,</OP-COMMA>
            <expr line1="401" col1="63" line2="401" col2="65" start="73446" end="73448">
              <STR_CONST line1="401" col1="63" line2="401" col2="65" start="73446" end="73448">"_"</STR_CONST>
            </expr>
            <OP-COMMA line1="401" col1="66" line2="401" col2="66" start="73449" end="73449">,</OP-COMMA>
            <expr line1="401" col1="68" line2="401" col2="77" start="73451" end="73460">
              <SYMBOL line1="401" col1="68" line2="401" col2="77" start="73451" end="73460">exprs_type</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="401" col1="78" line2="401" col2="78" start="73461" end="73461">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="403" col1="5" line2="403" col2="33" start="73754" end="73782"># Number of cells expressing.</COMMENT>
        <expr line1="404" col1="5" line2="405" col2="61" start="73937" end="74176">
          <expr line1="404" col1="5" line2="404" col2="16" start="73937" end="73948">
            <SYMBOL line1="404" col1="5" line2="404" col2="16" start="73937" end="73948">ncells.exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="404" col1="18" line2="404" col2="19" start="73950" end="73951">&lt;-</LEFT_ASSIGN>
          <expr line1="404" col1="21" line2="405" col2="61" start="73953" end="74176">
            <expr line1="404" col1="21" line2="404" col2="26" start="73953" end="73958">
              <SYMBOL_FUNCTION_CALL line1="404" col1="21" line2="404" col2="26" start="73953" end="73958">nexprs</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="404" col1="27" line2="404" col2="27" start="73959" end="73959">(</OP-LEFT-PAREN>
            <expr line1="404" col1="28" line2="404" col2="36" start="73960" end="73968">
              <SYMBOL line1="404" col1="28" line2="404" col2="36" start="73960" end="73968">exprs_mat</SYMBOL>
            </expr>
            <OP-COMMA line1="404" col1="37" line2="404" col2="37" start="73969" end="73969">,</OP-COMMA>
            <SYMBOL_SUB line1="404" col1="39" line2="404" col2="48" start="73971" end="73980">subset_col</SYMBOL_SUB>
            <EQ_SUB line1="404" col1="50" line2="404" col2="50" start="73982" end="73982">=</EQ_SUB>
            <expr line1="404" col1="52" line2="404" col2="61" start="73984" end="73993">
              <SYMBOL line1="404" col1="52" line2="404" col2="61" start="73984" end="73993">subset_col</SYMBOL>
            </expr>
            <OP-COMMA line1="404" col1="62" line2="404" col2="62" start="73994" end="73994">,</OP-COMMA>
            <SYMBOL_SUB line1="404" col1="64" line2="404" col2="68" start="73996" end="74000">byrow</SYMBOL_SUB>
            <EQ_SUB line1="404" col1="70" line2="404" col2="70" start="74002" end="74002">=</EQ_SUB>
            <expr line1="404" col1="72" line2="404" col2="75" start="74004" end="74007">
              <NUM_CONST line1="404" col1="72" line2="404" col2="75" start="74004" end="74007">TRUE</NUM_CONST>
            </expr>
            <OP-COMMA line1="404" col1="76" line2="404" col2="76" start="74008" end="74008">,</OP-COMMA>
            <SYMBOL_SUB line1="405" col1="28" line2="405" col2="42" start="74143" end="74157">detection_limit</SYMBOL_SUB>
            <EQ_SUB line1="405" col1="44" line2="405" col2="44" start="74159" end="74159">=</EQ_SUB>
            <expr line1="405" col1="46" line2="405" col2="60" start="74161" end="74175">
              <SYMBOL line1="405" col1="46" line2="405" col2="60" start="74161" end="74175">detection_limit</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="405" col1="61" line2="405" col2="61" start="74176" end="74176">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="406" col1="5" line2="406" col2="69" start="74303" end="74367">
          <expr line1="406" col1="5" line2="406" col2="53" start="74303" end="74351">
            <expr line1="406" col1="5" line2="406" col2="16" start="74303" end="74314">
              <SYMBOL line1="406" col1="5" line2="406" col2="16" start="74303" end="74314">feature_data</SYMBOL>
            </expr>
            <LBB line1="406" col1="17" line2="406" col2="18" start="74315" end="74316">[[</LBB>
            <expr line1="406" col1="19" line2="406" col2="51" start="74317" end="74349">
              <expr line1="406" col1="19" line2="406" col2="24" start="74317" end="74322">
                <SYMBOL_FUNCTION_CALL line1="406" col1="19" line2="406" col2="24" start="74317" end="74322">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="406" col1="25" line2="406" col2="25" start="74323" end="74323">(</OP-LEFT-PAREN>
              <expr line1="406" col1="26" line2="406" col2="38" start="74324" end="74336">
                <STR_CONST line1="406" col1="26" line2="406" col2="38" start="74324" end="74336">"n_cells_by_"</STR_CONST>
              </expr>
              <OP-COMMA line1="406" col1="39" line2="406" col2="39" start="74337" end="74337">,</OP-COMMA>
              <expr line1="406" col1="41" line2="406" col2="50" start="74339" end="74348">
                <SYMBOL line1="406" col1="41" line2="406" col2="50" start="74339" end="74348">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="406" col1="51" line2="406" col2="51" start="74349" end="74349">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="406" col1="52" line2="406" col2="52" start="74350" end="74350">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="406" col1="53" line2="406" col2="53" start="74351" end="74351">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="406" col1="55" line2="406" col2="56" start="74353" end="74354">&lt;-</LEFT_ASSIGN>
          <expr line1="406" col1="58" line2="406" col2="69" start="74356" end="74367">
            <SYMBOL line1="406" col1="58" line2="406" col2="69" start="74356" end="74367">ncells.exprs</SYMBOL>
          </expr>
        </expr>
        <expr line1="407" col1="5" line2="407" col2="97" start="74486" end="74578">
          <expr line1="407" col1="5" line2="407" col2="57" start="74486" end="74538">
            <expr line1="407" col1="5" line2="407" col2="16" start="74486" end="74497">
              <SYMBOL line1="407" col1="5" line2="407" col2="16" start="74486" end="74497">feature_data</SYMBOL>
            </expr>
            <LBB line1="407" col1="17" line2="407" col2="18" start="74498" end="74499">[[</LBB>
            <expr line1="407" col1="19" line2="407" col2="55" start="74500" end="74536">
              <expr line1="407" col1="19" line2="407" col2="24" start="74500" end="74505">
                <SYMBOL_FUNCTION_CALL line1="407" col1="19" line2="407" col2="24" start="74500" end="74505">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="407" col1="25" line2="407" col2="25" start="74506" end="74506">(</OP-LEFT-PAREN>
              <expr line1="407" col1="26" line2="407" col2="42" start="74507" end="74523">
                <STR_CONST line1="407" col1="26" line2="407" col2="42" start="74507" end="74523">"pct_dropout_by_"</STR_CONST>
              </expr>
              <OP-COMMA line1="407" col1="43" line2="407" col2="43" start="74524" end="74524">,</OP-COMMA>
              <expr line1="407" col1="45" line2="407" col2="54" start="74526" end="74535">
                <SYMBOL line1="407" col1="45" line2="407" col2="54" start="74526" end="74535">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="407" col1="55" line2="407" col2="55" start="74536" end="74536">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="407" col1="56" line2="407" col2="56" start="74537" end="74537">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="407" col1="57" line2="407" col2="57" start="74538" end="74538">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="407" col1="59" line2="407" col2="60" start="74540" end="74541">&lt;-</LEFT_ASSIGN>
          <expr line1="407" col1="62" line2="407" col2="97" start="74543" end="74578">
            <expr line1="407" col1="62" line2="407" col2="64" start="74543" end="74545">
              <NUM_CONST line1="407" col1="62" line2="407" col2="64" start="74543" end="74545">100</NUM_CONST>
            </expr>
            <OP-STAR line1="407" col1="66" line2="407" col2="66" start="74547" end="74547">*</OP-STAR>
            <expr line1="407" col1="68" line2="407" col2="97" start="74549" end="74578">
              <OP-LEFT-PAREN line1="407" col1="68" line2="407" col2="68" start="74549" end="74549">(</OP-LEFT-PAREN>
              <expr line1="407" col1="69" line2="407" col2="96" start="74550" end="74577">
                <expr line1="407" col1="69" line2="407" col2="69" start="74550" end="74550">
                  <NUM_CONST line1="407" col1="69" line2="407" col2="69" start="74550" end="74550">1</NUM_CONST>
                </expr>
                <OP-MINUS line1="407" col1="71" line2="407" col2="71" start="74552" end="74552">-</OP-MINUS>
                <expr line1="407" col1="73" line2="407" col2="96" start="74554" end="74577">
                  <expr line1="407" col1="73" line2="407" col2="84" start="74554" end="74565">
                    <SYMBOL line1="407" col1="73" line2="407" col2="84" start="74554" end="74565">ncells.exprs</SYMBOL>
                  </expr>
                  <OP-SLASH line1="407" col1="85" line2="407" col2="85" start="74566" end="74566">/</OP-SLASH>
                  <expr line1="407" col1="86" line2="407" col2="96" start="74567" end="74577">
                    <SYMBOL line1="407" col1="86" line2="407" col2="96" start="74567" end="74577">total_cells</SYMBOL>
                  </expr>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="407" col1="97" line2="407" col2="97" start="74578" end="74578">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="409" col1="5" line2="409" col2="23" start="74852" end="74870"># Total expression.</COMMENT>
        <expr line1="410" col1="5" line2="410" col2="61" start="75035" end="75091">
          <expr line1="410" col1="5" line2="410" col2="48" start="75035" end="75078">
            <expr line1="410" col1="5" line2="410" col2="16" start="75035" end="75046">
              <SYMBOL line1="410" col1="5" line2="410" col2="16" start="75035" end="75046">feature_data</SYMBOL>
            </expr>
            <LBB line1="410" col1="17" line2="410" col2="18" start="75047" end="75048">[[</LBB>
            <expr line1="410" col1="19" line2="410" col2="46" start="75049" end="75076">
              <expr line1="410" col1="19" line2="410" col2="24" start="75049" end="75054">
                <SYMBOL_FUNCTION_CALL line1="410" col1="19" line2="410" col2="24" start="75049" end="75054">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="410" col1="25" line2="410" col2="25" start="75055" end="75055">(</OP-LEFT-PAREN>
              <expr line1="410" col1="26" line2="410" col2="33" start="75056" end="75063">
                <STR_CONST line1="410" col1="26" line2="410" col2="33" start="75056" end="75063">"total_"</STR_CONST>
              </expr>
              <OP-COMMA line1="410" col1="34" line2="410" col2="34" start="75064" end="75064">,</OP-COMMA>
              <expr line1="410" col1="36" line2="410" col2="45" start="75066" end="75075">
                <SYMBOL line1="410" col1="36" line2="410" col2="45" start="75066" end="75075">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="410" col1="46" line2="410" col2="46" start="75076" end="75076">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="410" col1="47" line2="410" col2="47" start="75077" end="75077">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="410" col1="48" line2="410" col2="48" start="75078" end="75078">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="410" col1="50" line2="410" col2="51" start="75080" end="75081">&lt;-</LEFT_ASSIGN>
          <expr line1="410" col1="53" line2="410" col2="61" start="75083" end="75091">
            <SYMBOL line1="410" col1="53" line2="410" col2="61" start="75083" end="75091">sum_exprs</SYMBOL>
          </expr>
        </expr>
        <expr line1="411" col1="5" line2="411" col2="78" start="75218" end="75291">
          <expr line1="411" col1="5" line2="411" col2="54" start="75218" end="75267">
            <expr line1="411" col1="5" line2="411" col2="16" start="75218" end="75229">
              <SYMBOL line1="411" col1="5" line2="411" col2="16" start="75218" end="75229">feature_data</SYMBOL>
            </expr>
            <LBB line1="411" col1="17" line2="411" col2="18" start="75230" end="75231">[[</LBB>
            <expr line1="411" col1="19" line2="411" col2="52" start="75232" end="75265">
              <expr line1="411" col1="19" line2="411" col2="24" start="75232" end="75237">
                <SYMBOL_FUNCTION_CALL line1="411" col1="19" line2="411" col2="24" start="75232" end="75237">paste0</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="411" col1="25" line2="411" col2="25" start="75238" end="75238">(</OP-LEFT-PAREN>
              <expr line1="411" col1="26" line2="411" col2="39" start="75239" end="75252">
                <STR_CONST line1="411" col1="26" line2="411" col2="39" start="75239" end="75252">"log10_total_"</STR_CONST>
              </expr>
              <OP-COMMA line1="411" col1="40" line2="411" col2="40" start="75253" end="75253">,</OP-COMMA>
              <expr line1="411" col1="42" line2="411" col2="51" start="75255" end="75264">
                <SYMBOL line1="411" col1="42" line2="411" col2="51" start="75255" end="75264">exprs_type</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="411" col1="52" line2="411" col2="52" start="75265" end="75265">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="411" col1="53" line2="411" col2="53" start="75266" end="75266">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="411" col1="54" line2="411" col2="54" start="75267" end="75267">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="411" col1="56" line2="411" col2="57" start="75269" end="75270">&lt;-</LEFT_ASSIGN>
          <expr line1="411" col1="59" line2="411" col2="78" start="75272" end="75291">
            <expr line1="411" col1="59" line2="411" col2="63" start="75272" end="75276">
              <SYMBOL_FUNCTION_CALL line1="411" col1="59" line2="411" col2="63" start="75272" end="75276">log10</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="411" col1="64" line2="411" col2="64" start="75277" end="75277">(</OP-LEFT-PAREN>
            <expr line1="411" col1="65" line2="411" col2="77" start="75278" end="75290">
              <expr line1="411" col1="65" line2="411" col2="73" start="75278" end="75286">
                <SYMBOL line1="411" col1="65" line2="411" col2="73" start="75278" end="75286">sum_exprs</SYMBOL>
              </expr>
              <OP-PLUS line1="411" col1="75" line2="411" col2="75" start="75288" end="75288">+</OP-PLUS>
              <expr line1="411" col1="77" line2="411" col2="77" start="75290" end="75290">
                <NUM_CONST line1="411" col1="77" line2="411" col2="77" start="75290" end="75290">1</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="411" col1="78" line2="411" col2="78" start="75291" end="75291">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="412" col1="5" line2="414" col2="5" start="75401" end="75767">
          <IF line1="412" col1="5" line2="412" col2="6" start="75401" end="75402">if</IF>
          <OP-LEFT-PAREN line1="412" col1="8" line2="412" col2="8" start="75404" end="75404">(</OP-LEFT-PAREN>
          <expr line1="412" col1="9" line2="412" col2="28" start="75405" end="75424">
            <OP-EXCLAMATION line1="412" col1="9" line2="412" col2="9" start="75405" end="75405">!</OP-EXCLAMATION>
            <expr line1="412" col1="10" line2="412" col2="28" start="75406" end="75424">
              <expr line1="412" col1="10" line2="412" col2="16" start="75406" end="75412">
                <SYMBOL_FUNCTION_CALL line1="412" col1="10" line2="412" col2="16" start="75406" end="75412">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="412" col1="17" line2="412" col2="17" start="75413" end="75413">(</OP-LEFT-PAREN>
              <expr line1="412" col1="18" line2="412" col2="27" start="75414" end="75423">
                <SYMBOL line1="412" col1="18" line2="412" col2="27" start="75414" end="75423">subset_col</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="412" col1="28" line2="412" col2="28" start="75424" end="75424">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="412" col1="29" line2="412" col2="29" start="75425" end="75425">)</OP-RIGHT-PAREN>
          <expr line1="412" col1="31" line2="414" col2="5" start="75427" end="75767">
            <OP-LEFT-BRACE line1="412" col1="31" line2="412" col2="31" start="75427" end="75427">{</OP-LEFT-BRACE>
            <expr line1="413" col1="9" line2="413" col2="81" start="75588" end="75660">
              <expr line1="413" col1="9" line2="413" col2="50" start="75588" end="75629">
                <expr line1="413" col1="9" line2="413" col2="20" start="75588" end="75599">
                  <SYMBOL line1="413" col1="9" line2="413" col2="20" start="75588" end="75599">feature_data</SYMBOL>
                </expr>
                <LBB line1="413" col1="21" line2="413" col2="22" start="75600" end="75601">[[</LBB>
                <expr line1="413" col1="23" line2="413" col2="48" start="75602" end="75627">
                  <expr line1="413" col1="23" line2="413" col2="28" start="75602" end="75607">
                    <SYMBOL_FUNCTION_CALL line1="413" col1="23" line2="413" col2="28" start="75602" end="75607">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="413" col1="29" line2="413" col2="29" start="75608" end="75608">(</OP-LEFT-PAREN>
                  <expr line1="413" col1="30" line2="413" col2="35" start="75609" end="75614">
                    <STR_CONST line1="413" col1="30" line2="413" col2="35" start="75609" end="75614">"pct_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="413" col1="36" line2="413" col2="36" start="75615" end="75615">,</OP-COMMA>
                  <expr line1="413" col1="38" line2="413" col2="47" start="75617" end="75626">
                    <SYMBOL line1="413" col1="38" line2="413" col2="47" start="75617" end="75626">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="413" col1="48" line2="413" col2="48" start="75627" end="75627">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="413" col1="49" line2="413" col2="49" start="75628" end="75628">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="413" col1="50" line2="413" col2="50" start="75629" end="75629">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="413" col1="52" line2="413" col2="53" start="75631" end="75632">&lt;-</LEFT_ASSIGN>
              <expr line1="413" col1="55" line2="413" col2="81" start="75634" end="75660">
                <expr line1="413" col1="55" line2="413" col2="75" start="75634" end="75654">
                  <expr line1="413" col1="55" line2="413" col2="63" start="75634" end="75642">
                    <SYMBOL line1="413" col1="55" line2="413" col2="63" start="75634" end="75642">sum_exprs</SYMBOL>
                  </expr>
                  <OP-SLASH line1="413" col1="64" line2="413" col2="64" start="75643" end="75643">/</OP-SLASH>
                  <expr line1="413" col1="65" line2="413" col2="75" start="75644" end="75654">
                    <SYMBOL line1="413" col1="65" line2="413" col2="75" start="75644" end="75654">total_exprs</SYMBOL>
                  </expr>
                </expr>
                <OP-STAR line1="413" col1="77" line2="413" col2="77" start="75656" end="75656">*</OP-STAR>
                <expr line1="413" col1="79" line2="413" col2="81" start="75658" end="75660">
                  <NUM_CONST line1="413" col1="79" line2="413" col2="81" start="75658" end="75660">100</NUM_CONST>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="414" col1="5" line2="414" col2="5" start="75767" end="75767">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="416" col1="5" line2="416" col2="32" start="76133" end="76160">### Legacy metric names. ###</COMMENT>
        <expr line1="417" col1="5" line2="420" col2="5" start="76316" end="76865">
          <IF line1="417" col1="5" line2="417" col2="6" start="76316" end="76317">if</IF>
          <OP-LEFT-PAREN line1="417" col1="8" line2="417" col2="8" start="76319" end="76319">(</OP-LEFT-PAREN>
          <expr line1="417" col1="9" line2="417" col2="14" start="76320" end="76325">
            <SYMBOL line1="417" col1="9" line2="417" col2="14" start="76320" end="76325">legacy</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="417" col1="15" line2="417" col2="15" start="76326" end="76326">)</OP-RIGHT-PAREN>
          <expr line1="417" col1="17" line2="420" col2="5" start="76328" end="76865">
            <OP-LEFT-BRACE line1="417" col1="17" line2="417" col2="17" start="76328" end="76328">{</OP-LEFT-BRACE>
            <expr line1="418" col1="9" line2="418" col2="107" start="76503" end="76601">
              <expr line1="418" col1="9" line2="418" col2="54" start="76503" end="76548">
                <expr line1="418" col1="9" line2="418" col2="20" start="76503" end="76514">
                  <SYMBOL line1="418" col1="9" line2="418" col2="20" start="76503" end="76514">feature_data</SYMBOL>
                </expr>
                <LBB line1="418" col1="21" line2="418" col2="22" start="76515" end="76516">[[</LBB>
                <expr line1="418" col1="23" line2="418" col2="52" start="76517" end="76546">
                  <expr line1="418" col1="23" line2="418" col2="28" start="76517" end="76522">
                    <SYMBOL_FUNCTION_CALL line1="418" col1="23" line2="418" col2="28" start="76517" end="76522">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="418" col1="29" line2="418" col2="29" start="76523" end="76523">(</OP-LEFT-PAREN>
                  <expr line1="418" col1="30" line2="418" col2="39" start="76524" end="76533">
                    <STR_CONST line1="418" col1="30" line2="418" col2="39" start="76524" end="76533">"n_cells_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="418" col1="40" line2="418" col2="40" start="76534" end="76534">,</OP-COMMA>
                  <expr line1="418" col1="42" line2="418" col2="51" start="76536" end="76545">
                    <SYMBOL line1="418" col1="42" line2="418" col2="51" start="76536" end="76545">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="418" col1="52" line2="418" col2="52" start="76546" end="76546">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="418" col1="53" line2="418" col2="53" start="76547" end="76547">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="418" col1="54" line2="418" col2="54" start="76548" end="76548">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="418" col1="56" line2="418" col2="57" start="76550" end="76551">&lt;-</LEFT_ASSIGN>
              <expr line1="418" col1="59" line2="418" col2="107" start="76553" end="76601">
                <expr line1="418" col1="59" line2="418" col2="70" start="76553" end="76564">
                  <SYMBOL line1="418" col1="59" line2="418" col2="70" start="76553" end="76564">feature_data</SYMBOL>
                </expr>
                <LBB line1="418" col1="71" line2="418" col2="72" start="76565" end="76566">[[</LBB>
                <expr line1="418" col1="73" line2="418" col2="105" start="76567" end="76599">
                  <expr line1="418" col1="73" line2="418" col2="78" start="76567" end="76572">
                    <SYMBOL_FUNCTION_CALL line1="418" col1="73" line2="418" col2="78" start="76567" end="76572">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="418" col1="79" line2="418" col2="79" start="76573" end="76573">(</OP-LEFT-PAREN>
                  <expr line1="418" col1="80" line2="418" col2="92" start="76574" end="76586">
                    <STR_CONST line1="418" col1="80" line2="418" col2="92" start="76574" end="76586">"n_cells_by_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="418" col1="93" line2="418" col2="93" start="76587" end="76587">,</OP-COMMA>
                  <expr line1="418" col1="95" line2="418" col2="104" start="76589" end="76598">
                    <SYMBOL line1="418" col1="95" line2="418" col2="104" start="76589" end="76598">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="418" col1="105" line2="418" col2="105" start="76599" end="76599">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="418" col1="106" line2="418" col2="106" start="76600" end="76600">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="418" col1="107" line2="418" col2="107" start="76601" end="76601">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="419" col1="9" line2="419" col2="115" start="76686" end="76792">
              <expr line1="419" col1="9" line2="419" col2="58" start="76686" end="76735">
                <expr line1="419" col1="9" line2="419" col2="20" start="76686" end="76697">
                  <SYMBOL line1="419" col1="9" line2="419" col2="20" start="76686" end="76697">feature_data</SYMBOL>
                </expr>
                <LBB line1="419" col1="21" line2="419" col2="22" start="76698" end="76699">[[</LBB>
                <expr line1="419" col1="23" line2="419" col2="56" start="76700" end="76733">
                  <expr line1="419" col1="23" line2="419" col2="28" start="76700" end="76705">
                    <SYMBOL_FUNCTION_CALL line1="419" col1="23" line2="419" col2="28" start="76700" end="76705">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="419" col1="29" line2="419" col2="29" start="76706" end="76706">(</OP-LEFT-PAREN>
                  <expr line1="419" col1="30" line2="419" col2="43" start="76707" end="76720">
                    <STR_CONST line1="419" col1="30" line2="419" col2="43" start="76707" end="76720">"pct_dropout_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="419" col1="44" line2="419" col2="44" start="76721" end="76721">,</OP-COMMA>
                  <expr line1="419" col1="46" line2="419" col2="55" start="76723" end="76732">
                    <SYMBOL line1="419" col1="46" line2="419" col2="55" start="76723" end="76732">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="419" col1="56" line2="419" col2="56" start="76733" end="76733">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="419" col1="57" line2="419" col2="57" start="76734" end="76734">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="419" col1="58" line2="419" col2="58" start="76735" end="76735">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="419" col1="60" line2="419" col2="61" start="76737" end="76738">&lt;-</LEFT_ASSIGN>
              <expr line1="419" col1="63" line2="419" col2="115" start="76740" end="76792">
                <expr line1="419" col1="63" line2="419" col2="74" start="76740" end="76751">
                  <SYMBOL line1="419" col1="63" line2="419" col2="74" start="76740" end="76751">feature_data</SYMBOL>
                </expr>
                <LBB line1="419" col1="75" line2="419" col2="76" start="76752" end="76753">[[</LBB>
                <expr line1="419" col1="77" line2="419" col2="113" start="76754" end="76790">
                  <expr line1="419" col1="77" line2="419" col2="82" start="76754" end="76759">
                    <SYMBOL_FUNCTION_CALL line1="419" col1="77" line2="419" col2="82" start="76754" end="76759">paste0</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="419" col1="83" line2="419" col2="83" start="76760" end="76760">(</OP-LEFT-PAREN>
                  <expr line1="419" col1="84" line2="419" col2="100" start="76761" end="76777">
                    <STR_CONST line1="419" col1="84" line2="419" col2="100" start="76761" end="76777">"pct_dropout_by_"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="419" col1="101" line2="419" col2="101" start="76778" end="76778">,</OP-COMMA>
                  <expr line1="419" col1="103" line2="419" col2="112" start="76780" end="76789">
                    <SYMBOL line1="419" col1="103" line2="419" col2="112" start="76780" end="76789">exprs_type</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="419" col1="113" line2="419" col2="113" start="76790" end="76790">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACKET line1="419" col1="114" line2="419" col2="114" start="76791" end="76791">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="419" col1="115" line2="419" col2="115" start="76792" end="76792">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="420" col1="5" line2="420" col2="5" start="76865" end="76865">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="422" col1="5" line2="422" col2="24" start="77231" end="77250">
          <expr line1="422" col1="5" line2="422" col2="10" start="77231" end="77236">
            <SYMBOL_FUNCTION_CALL line1="422" col1="5" line2="422" col2="10" start="77231" end="77236">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="422" col1="11" line2="422" col2="11" start="77237" end="77237">(</OP-LEFT-PAREN>
          <expr line1="422" col1="12" line2="422" col2="23" start="77238" end="77249">
            <SYMBOL line1="422" col1="12" line2="422" col2="23" start="77238" end="77249">feature_data</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="422" col1="24" line2="422" col2="24" start="77250" end="77250">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="423" col1="1" line2="423" col2="1" start="77410" end="77410">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="425" col1="1" line2="438" col2="1" start="77776" end="80155">
    <expr line1="425" col1="1" line2="425" col2="28" start="77776" end="77803">
      <SYMBOL line1="425" col1="1" line2="425" col2="28" start="77776" end="77803">.convert_to_nested_DataFrame</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="425" col1="30" line2="425" col2="31" start="77805" end="77806">&lt;-</LEFT_ASSIGN>
    <expr line1="425" col1="33" line2="438" col2="1" start="77808" end="80155">
      <FUNCTION line1="425" col1="33" line2="425" col2="40" start="77808" end="77815">function</FUNCTION>
      <OP-LEFT-PAREN line1="425" col1="41" line2="425" col2="41" start="77816" end="77816">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="425" col1="42" line2="425" col2="49" start="77817" end="77824">existing</SYMBOL_FORMALS>
      <OP-COMMA line1="425" col1="50" line2="425" col2="50" start="77825" end="77825">,</OP-COMMA>
      <SYMBOL_FORMALS line1="425" col1="52" line2="425" col2="59" start="77827" end="77834">set_list</SYMBOL_FORMALS>
      <OP-COMMA line1="425" col1="60" line2="425" col2="60" start="77835" end="77835">,</OP-COMMA>
      <SYMBOL_FORMALS line1="425" col1="62" line2="425" col2="70" start="77837" end="77845">stat_list</SYMBOL_FORMALS>
      <OP-COMMA line1="425" col1="71" line2="425" col2="71" start="77846" end="77846">,</OP-COMMA>
      <SYMBOL_FORMALS line1="425" col1="73" line2="425" col2="84" start="77848" end="77859">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="425" col1="86" line2="425" col2="86" start="77861" end="77861">=</EQ_FORMALS>
      <expr line1="425" col1="88" line2="425" col2="95" start="77863" end="77870">
        <STR_CONST line1="425" col1="88" line2="425" col2="95" start="77863" end="77870">"counts"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="425" col1="96" line2="425" col2="96" start="77871" end="77871">)</OP-RIGHT-PAREN>
      <expr line1="425" col1="98" line2="438" col2="1" start="77873" end="80155">
        <OP-LEFT-BRACE line1="425" col1="98" line2="425" col2="98" start="77873" end="77873">{</OP-LEFT-BRACE>
        <expr line1="426" col1="5" line2="426" col2="43" start="77963" end="78001">
          <expr line1="426" col1="5" line2="426" col2="12" start="77963" end="77970">
            <SYMBOL line1="426" col1="5" line2="426" col2="12" start="77963" end="77970">n_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="426" col1="14" line2="426" col2="15" start="77972" end="77973">&lt;-</LEFT_ASSIGN>
          <expr line1="426" col1="17" line2="426" col2="43" start="77975" end="78001">
            <expr line1="426" col1="17" line2="426" col2="22" start="77975" end="77980">
              <SYMBOL_FUNCTION_CALL line1="426" col1="17" line2="426" col2="22" start="77975" end="77980">length</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="426" col1="23" line2="426" col2="23" start="77981" end="77981">(</OP-LEFT-PAREN>
            <expr line1="426" col1="24" line2="426" col2="42" start="77982" end="78000">
              <expr line1="426" col1="24" line2="426" col2="37" start="77982" end="77995">
                <expr line1="426" col1="24" line2="426" col2="32" start="77982" end="77990">
                  <SYMBOL line1="426" col1="24" line2="426" col2="32" start="77982" end="77990">stat_list</SYMBOL>
                </expr>
                <LBB line1="426" col1="33" line2="426" col2="34" start="77991" end="77992">[[</LBB>
                <expr line1="426" col1="35" line2="426" col2="35" start="77993" end="77993">
                  <NUM_CONST line1="426" col1="35" line2="426" col2="35" start="77993" end="77993">1</NUM_CONST>
                </expr>
                <OP-RIGHT-BRACKET line1="426" col1="36" line2="426" col2="36" start="77994" end="77994">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="426" col1="37" line2="426" col2="37" start="77995" end="77995">]</OP-RIGHT-BRACKET>
              </expr>
              <LBB line1="426" col1="38" line2="426" col2="39" start="77996" end="77997">[[</LBB>
              <expr line1="426" col1="40" line2="426" col2="40" start="77998" end="77998">
                <NUM_CONST line1="426" col1="40" line2="426" col2="40" start="77998" end="77998">1</NUM_CONST>
              </expr>
              <OP-RIGHT-BRACKET line1="426" col1="41" line2="426" col2="41" start="77999" end="77999">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="426" col1="42" line2="426" col2="42" start="78000" end="78000">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="426" col1="43" line2="426" col2="43" start="78001" end="78001">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="426" col1="45" line2="426" col2="85" start="78003" end="78043"># There should be at least one statistic.</COMMENT>
        <expr line1="427" col1="5" line2="427" col2="57" start="78146" end="78198">
          <expr line1="427" col1="5" line2="427" col2="10" start="78146" end="78151">
            <SYMBOL line1="427" col1="5" line2="427" col2="10" start="78146" end="78151">output</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="427" col1="12" line2="427" col2="13" start="78153" end="78154">&lt;-</LEFT_ASSIGN>
          <expr line1="427" col1="15" line2="427" col2="57" start="78156" end="78198">
            <expr line1="427" col1="15" line2="427" col2="37" start="78156" end="78178">
              <SYMBOL_FUNCTION_CALL line1="427" col1="15" line2="427" col2="37" start="78156" end="78178">.create_outer_DataFrame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="427" col1="38" line2="427" col2="38" start="78179" end="78179">(</OP-LEFT-PAREN>
            <expr line1="427" col1="39" line2="427" col2="46" start="78180" end="78187">
              <SYMBOL line1="427" col1="39" line2="427" col2="46" start="78180" end="78187">set_list</SYMBOL>
            </expr>
            <OP-COMMA line1="427" col1="47" line2="427" col2="47" start="78188" end="78188">,</OP-COMMA>
            <expr line1="427" col1="49" line2="427" col2="56" start="78190" end="78197">
              <SYMBOL line1="427" col1="49" line2="427" col2="56" start="78190" end="78197">n_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="427" col1="57" line2="427" col2="57" start="78198" end="78198">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="429" col1="5" line2="429" col2="50" start="78512" end="78557">
          <expr line1="429" col1="5" line2="429" col2="14" start="78512" end="78521">
            <SYMBOL line1="429" col1="5" line2="429" col2="14" start="78512" end="78521">sub_output</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="429" col1="16" line2="429" col2="17" start="78523" end="78524">&lt;-</LEFT_ASSIGN>
          <expr line1="429" col1="19" line2="429" col2="50" start="78526" end="78557">
            <expr line1="429" col1="19" line2="429" col2="21" start="78526" end="78528">
              <SYMBOL_FUNCTION_CALL line1="429" col1="19" line2="429" col2="21" start="78526" end="78528">new</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="429" col1="22" line2="429" col2="22" start="78529" end="78529">(</OP-LEFT-PAREN>
            <expr line1="429" col1="23" line2="429" col2="33" start="78530" end="78540">
              <STR_CONST line1="429" col1="23" line2="429" col2="33" start="78530" end="78540">"DataFrame"</STR_CONST>
            </expr>
            <OP-COMMA line1="429" col1="34" line2="429" col2="34" start="78541" end="78541">,</OP-COMMA>
            <SYMBOL_SUB line1="429" col1="36" line2="429" col2="40" start="78543" end="78547">nrows</SYMBOL_SUB>
            <EQ_SUB line1="429" col1="41" line2="429" col2="41" start="78548" end="78548">=</EQ_SUB>
            <expr line1="429" col1="42" line2="429" col2="49" start="78549" end="78556">
              <SYMBOL line1="429" col1="42" line2="429" col2="49" start="78549" end="78556">n_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="429" col1="50" line2="429" col2="50" start="78557" end="78557">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="430" col1="5" line2="434" col2="5" start="78695" end="79427">
          <FOR line1="430" col1="5" line2="430" col2="7" start="78695" end="78697">for</FOR>
          <forcond line1="430" col1="9" line2="430" col2="31" start="78699" end="78721">
            <OP-LEFT-PAREN line1="430" col1="9" line2="430" col2="9" start="78699" end="78699">(</OP-LEFT-PAREN>
            <SYMBOL line1="430" col1="10" line2="430" col2="10" start="78700" end="78700">x</SYMBOL>
            <IN line1="430" col1="12" line2="430" col2="13" start="78702" end="78703">in</IN>
            <expr line1="430" col1="15" line2="430" col2="30" start="78705" end="78720">
              <expr line1="430" col1="15" line2="430" col2="19" start="78705" end="78709">
                <SYMBOL_FUNCTION_CALL line1="430" col1="15" line2="430" col2="19" start="78705" end="78709">names</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="430" col1="20" line2="430" col2="20" start="78710" end="78710">(</OP-LEFT-PAREN>
              <expr line1="430" col1="21" line2="430" col2="29" start="78711" end="78719">
                <SYMBOL line1="430" col1="21" line2="430" col2="29" start="78711" end="78719">stat_list</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="430" col1="30" line2="430" col2="30" start="78720" end="78720">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="430" col1="31" line2="430" col2="31" start="78721" end="78721">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="430" col1="33" line2="434" col2="5" start="78723" end="79427">
            <OP-LEFT-BRACE line1="430" col1="33" line2="430" col2="33" start="78723" end="78723">{</OP-LEFT-BRACE>
            <expr line1="431" col1="9" line2="431" col2="33" start="78882" end="78906">
              <expr line1="431" col1="9" line2="431" col2="15" start="78882" end="78888">
                <SYMBOL line1="431" col1="9" line2="431" col2="15" start="78882" end="78888">current</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="431" col1="17" line2="431" col2="18" start="78890" end="78891">&lt;-</LEFT_ASSIGN>
              <expr line1="431" col1="20" line2="431" col2="33" start="78893" end="78906">
                <expr line1="431" col1="20" line2="431" col2="28" start="78893" end="78901">
                  <SYMBOL line1="431" col1="20" line2="431" col2="28" start="78893" end="78901">stat_list</SYMBOL>
                </expr>
                <LBB line1="431" col1="29" line2="431" col2="30" start="78902" end="78903">[[</LBB>
                <expr line1="431" col1="31" line2="431" col2="31" start="78904" end="78904">
                  <SYMBOL line1="431" col1="31" line2="431" col2="31" start="78904" end="78904">x</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="431" col1="32" line2="431" col2="32" start="78905" end="78905">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="431" col1="33" line2="431" col2="33" start="78906" end="78906">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <COMMENT line1="431" col1="35" line2="431" col2="92" start="78908" end="78965"># need to do it via "[[&lt;-" to store DataFrames as columns.</COMMENT>
            <expr line1="432" col1="9" line2="432" col2="70" start="79065" end="79126">
              <expr line1="432" col1="9" line2="432" col2="15" start="79065" end="79071">
                <SYMBOL line1="432" col1="9" line2="432" col2="15" start="79065" end="79071">current</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="432" col1="17" line2="432" col2="18" start="79073" end="79074">&lt;-</LEFT_ASSIGN>
              <expr line1="432" col1="20" line2="432" col2="70" start="79076" end="79126">
                <expr line1="432" col1="20" line2="432" col2="46" start="79076" end="79102">
                  <SYMBOL_FUNCTION_CALL line1="432" col1="20" line2="432" col2="46" start="79076" end="79102">.cbind_overwrite_DataFrames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="432" col1="47" line2="432" col2="47" start="79103" end="79103">(</OP-LEFT-PAREN>
                <expr line1="432" col1="48" line2="432" col2="60" start="79104" end="79116">
                  <expr line1="432" col1="48" line2="432" col2="55" start="79104" end="79111">
                    <SYMBOL line1="432" col1="48" line2="432" col2="55" start="79104" end="79111">existing</SYMBOL>
                  </expr>
                  <LBB line1="432" col1="56" line2="432" col2="57" start="79112" end="79113">[[</LBB>
                  <expr line1="432" col1="58" line2="432" col2="58" start="79114" end="79114">
                    <SYMBOL line1="432" col1="58" line2="432" col2="58" start="79114" end="79114">x</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="432" col1="59" line2="432" col2="59" start="79115" end="79115">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="432" col1="60" line2="432" col2="60" start="79116" end="79116">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="432" col1="61" line2="432" col2="61" start="79117" end="79117">,</OP-COMMA>
                <expr line1="432" col1="63" line2="432" col2="69" start="79119" end="79125">
                  <SYMBOL line1="432" col1="63" line2="432" col2="69" start="79119" end="79125">current</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="432" col1="70" line2="432" col2="70" start="79126" end="79126">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="433" col1="9" line2="433" col2="34" start="79248" end="79273">
              <expr line1="433" col1="9" line2="433" col2="23" start="79248" end="79262">
                <expr line1="433" col1="9" line2="433" col2="18" start="79248" end="79257">
                  <SYMBOL line1="433" col1="9" line2="433" col2="18" start="79248" end="79257">sub_output</SYMBOL>
                </expr>
                <LBB line1="433" col1="19" line2="433" col2="20" start="79258" end="79259">[[</LBB>
                <expr line1="433" col1="21" line2="433" col2="21" start="79260" end="79260">
                  <SYMBOL line1="433" col1="21" line2="433" col2="21" start="79260" end="79260">x</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="433" col1="22" line2="433" col2="22" start="79261" end="79261">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="433" col1="23" line2="433" col2="23" start="79262" end="79262">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="433" col1="25" line2="433" col2="26" start="79264" end="79265">&lt;-</LEFT_ASSIGN>
              <expr line1="433" col1="28" line2="433" col2="34" start="79267" end="79273">
                <SYMBOL line1="433" col1="28" line2="433" col2="34" start="79267" end="79273">current</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="434" col1="5" line2="434" col2="5" start="79427" end="79427">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="436" col1="5" line2="436" col2="39" start="79793" end="79827">
          <expr line1="436" col1="5" line2="436" col2="10" start="79793" end="79798">
            <SYMBOL line1="436" col1="5" line2="436" col2="10" start="79793" end="79798">output</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="436" col1="12" line2="436" col2="13" start="79800" end="79801">&lt;-</LEFT_ASSIGN>
          <expr line1="436" col1="15" line2="436" col2="39" start="79803" end="79827">
            <expr line1="436" col1="15" line2="436" col2="19" start="79803" end="79807">
              <SYMBOL_FUNCTION_CALL line1="436" col1="15" line2="436" col2="19" start="79803" end="79807">cbind</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="436" col1="20" line2="436" col2="20" start="79808" end="79808">(</OP-LEFT-PAREN>
            <expr line1="436" col1="21" line2="436" col2="26" start="79809" end="79814">
              <SYMBOL line1="436" col1="21" line2="436" col2="26" start="79809" end="79814">output</SYMBOL>
            </expr>
            <OP-COMMA line1="436" col1="27" line2="436" col2="27" start="79815" end="79815">,</OP-COMMA>
            <expr line1="436" col1="29" line2="436" col2="38" start="79817" end="79826">
              <SYMBOL line1="436" col1="29" line2="436" col2="38" start="79817" end="79826">sub_output</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="436" col1="39" line2="436" col2="39" start="79827" end="79827">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="437" col1="5" line2="437" col2="49" start="79976" end="80020">
          <expr line1="437" col1="5" line2="437" col2="31" start="79976" end="80002">
            <SYMBOL_FUNCTION_CALL line1="437" col1="5" line2="437" col2="31" start="79976" end="80002">.cbind_overwrite_DataFrames</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="437" col1="32" line2="437" col2="32" start="80003" end="80003">(</OP-LEFT-PAREN>
          <expr line1="437" col1="33" line2="437" col2="40" start="80004" end="80011">
            <SYMBOL line1="437" col1="33" line2="437" col2="40" start="80004" end="80011">existing</SYMBOL>
          </expr>
          <OP-COMMA line1="437" col1="41" line2="437" col2="41" start="80012" end="80012">,</OP-COMMA>
          <expr line1="437" col1="43" line2="437" col2="48" start="80014" end="80019">
            <SYMBOL line1="437" col1="43" line2="437" col2="48" start="80014" end="80019">output</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="437" col1="49" line2="437" col2="49" start="80020" end="80020">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="438" col1="1" line2="438" col2="1" start="80155" end="80155">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="440" col1="1" line2="458" col2="1" start="80521" end="83815">
    <expr line1="440" col1="1" line2="440" col2="26" start="80521" end="80546">
      <SYMBOL line1="440" col1="1" line2="440" col2="26" start="80521" end="80546">.convert_to_full_DataFrame</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="440" col1="28" line2="440" col2="29" start="80548" end="80549">&lt;-</LEFT_ASSIGN>
    <expr line1="440" col1="31" line2="458" col2="1" start="80551" end="83815">
      <FUNCTION line1="440" col1="31" line2="440" col2="38" start="80551" end="80558">function</FUNCTION>
      <OP-LEFT-PAREN line1="440" col1="39" line2="440" col2="39" start="80559" end="80559">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="440" col1="40" line2="440" col2="47" start="80560" end="80567">existing</SYMBOL_FORMALS>
      <OP-COMMA line1="440" col1="48" line2="440" col2="48" start="80568" end="80568">,</OP-COMMA>
      <SYMBOL_FORMALS line1="440" col1="50" line2="440" col2="57" start="80570" end="80577">set_list</SYMBOL_FORMALS>
      <OP-COMMA line1="440" col1="58" line2="440" col2="58" start="80578" end="80578">,</OP-COMMA>
      <SYMBOL_FORMALS line1="440" col1="60" line2="440" col2="68" start="80580" end="80588">stat_list</SYMBOL_FORMALS>
      <OP-COMMA line1="440" col1="69" line2="440" col2="69" start="80589" end="80589">,</OP-COMMA>
      <SYMBOL_FORMALS line1="440" col1="71" line2="440" col2="78" start="80591" end="80598">trim.fun</SYMBOL_FORMALS>
      <EQ_FORMALS line1="440" col1="79" line2="440" col2="79" start="80599" end="80599">=</EQ_FORMALS>
      <expr line1="440" col1="80" line2="440" col2="87" start="80600" end="80607">
        <SYMBOL line1="440" col1="80" line2="440" col2="87" start="80600" end="80607">identity</SYMBOL>
      </expr>
      <OP-RIGHT-PAREN line1="440" col1="88" line2="440" col2="88" start="80608" end="80608">)</OP-RIGHT-PAREN>
      <expr line1="440" col1="90" line2="458" col2="1" start="80610" end="83815">
        <OP-LEFT-BRACE line1="440" col1="90" line2="440" col2="90" start="80610" end="80610">{</OP-LEFT-BRACE>
        <expr line1="441" col1="5" line2="441" col2="43" start="80708" end="80746">
          <expr line1="441" col1="5" line2="441" col2="12" start="80708" end="80715">
            <SYMBOL line1="441" col1="5" line2="441" col2="12" start="80708" end="80715">n_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="441" col1="14" line2="441" col2="15" start="80717" end="80718">&lt;-</LEFT_ASSIGN>
          <expr line1="441" col1="17" line2="441" col2="43" start="80720" end="80746">
            <expr line1="441" col1="17" line2="441" col2="22" start="80720" end="80725">
              <SYMBOL_FUNCTION_CALL line1="441" col1="17" line2="441" col2="22" start="80720" end="80725">length</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="441" col1="23" line2="441" col2="23" start="80726" end="80726">(</OP-LEFT-PAREN>
            <expr line1="441" col1="24" line2="441" col2="42" start="80727" end="80745">
              <expr line1="441" col1="24" line2="441" col2="37" start="80727" end="80740">
                <expr line1="441" col1="24" line2="441" col2="32" start="80727" end="80735">
                  <SYMBOL line1="441" col1="24" line2="441" col2="32" start="80727" end="80735">stat_list</SYMBOL>
                </expr>
                <LBB line1="441" col1="33" line2="441" col2="34" start="80736" end="80737">[[</LBB>
                <expr line1="441" col1="35" line2="441" col2="35" start="80738" end="80738">
                  <NUM_CONST line1="441" col1="35" line2="441" col2="35" start="80738" end="80738">1</NUM_CONST>
                </expr>
                <OP-RIGHT-BRACKET line1="441" col1="36" line2="441" col2="36" start="80739" end="80739">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="441" col1="37" line2="441" col2="37" start="80740" end="80740">]</OP-RIGHT-BRACKET>
              </expr>
              <LBB line1="441" col1="38" line2="441" col2="39" start="80741" end="80742">[[</LBB>
              <expr line1="441" col1="40" line2="441" col2="40" start="80743" end="80743">
                <NUM_CONST line1="441" col1="40" line2="441" col2="40" start="80743" end="80743">1</NUM_CONST>
              </expr>
              <OP-RIGHT-BRACKET line1="441" col1="41" line2="441" col2="41" start="80744" end="80744">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="441" col1="42" line2="441" col2="42" start="80745" end="80745">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="441" col1="43" line2="441" col2="43" start="80746" end="80746">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="441" col1="45" line2="441" col2="85" start="80748" end="80788"># There should be at least one statistic.</COMMENT>
        <expr line1="442" col1="5" line2="442" col2="57" start="80891" end="80943">
          <expr line1="442" col1="5" line2="442" col2="10" start="80891" end="80896">
            <SYMBOL line1="442" col1="5" line2="442" col2="10" start="80891" end="80896">output</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="442" col1="12" line2="442" col2="13" start="80898" end="80899">&lt;-</LEFT_ASSIGN>
          <expr line1="442" col1="15" line2="442" col2="57" start="80901" end="80943">
            <expr line1="442" col1="15" line2="442" col2="37" start="80901" end="80923">
              <SYMBOL_FUNCTION_CALL line1="442" col1="15" line2="442" col2="37" start="80901" end="80923">.create_outer_DataFrame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="442" col1="38" line2="442" col2="38" start="80924" end="80924">(</OP-LEFT-PAREN>
            <expr line1="442" col1="39" line2="442" col2="46" start="80925" end="80932">
              <SYMBOL line1="442" col1="39" line2="442" col2="46" start="80925" end="80932">set_list</SYMBOL>
            </expr>
            <OP-COMMA line1="442" col1="47" line2="442" col2="47" start="80933" end="80933">,</OP-COMMA>
            <expr line1="442" col1="49" line2="442" col2="56" start="80935" end="80942">
              <SYMBOL line1="442" col1="49" line2="442" col2="56" start="80935" end="80942">n_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="442" col1="57" line2="442" col2="57" start="80943" end="80943">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="444" col1="5" line2="444" col2="26" start="81257" end="81278">
          <expr line1="444" col1="5" line2="444" col2="13" start="81257" end="81265">
            <SYMBOL line1="444" col1="5" line2="444" col2="13" start="81257" end="81265">collected</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="444" col1="15" line2="444" col2="16" start="81267" end="81268">&lt;-</LEFT_ASSIGN>
          <expr line1="444" col1="18" line2="444" col2="26" start="81270" end="81278">
            <SYMBOL line1="444" col1="18" line2="444" col2="26" start="81270" end="81278">stat_list</SYMBOL>
          </expr>
        </expr>
        <expr line1="445" col1="5" line2="454" col2="5" start="81440" end="83087">
          <FOR line1="445" col1="5" line2="445" col2="7" start="81440" end="81442">for</FOR>
          <forcond line1="445" col1="9" line2="445" col2="31" start="81444" end="81466">
            <OP-LEFT-PAREN line1="445" col1="9" line2="445" col2="9" start="81444" end="81444">(</OP-LEFT-PAREN>
            <SYMBOL line1="445" col1="10" line2="445" col2="10" start="81445" end="81445">x</SYMBOL>
            <IN line1="445" col1="12" line2="445" col2="13" start="81447" end="81448">in</IN>
            <expr line1="445" col1="15" line2="445" col2="30" start="81450" end="81465">
              <expr line1="445" col1="15" line2="445" col2="19" start="81450" end="81454">
                <SYMBOL_FUNCTION_CALL line1="445" col1="15" line2="445" col2="19" start="81450" end="81454">names</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="445" col1="20" line2="445" col2="20" start="81455" end="81455">(</OP-LEFT-PAREN>
              <expr line1="445" col1="21" line2="445" col2="29" start="81456" end="81464">
                <SYMBOL line1="445" col1="21" line2="445" col2="29" start="81456" end="81464">stat_list</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="445" col1="30" line2="445" col2="30" start="81465" end="81465">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="445" col1="31" line2="445" col2="31" start="81466" end="81466">)</OP-RIGHT-PAREN>
          </forcond>
          <expr line1="445" col1="33" line2="454" col2="5" start="81468" end="83087">
            <OP-LEFT-BRACE line1="445" col1="33" line2="445" col2="33" start="81468" end="81468">{</OP-LEFT-BRACE>
            <expr line1="446" col1="9" line2="446" col2="33" start="81627" end="81651">
              <expr line1="446" col1="9" line2="446" col2="15" start="81627" end="81633">
                <SYMBOL line1="446" col1="9" line2="446" col2="15" start="81627" end="81633">current</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="446" col1="17" line2="446" col2="18" start="81635" end="81636">&lt;-</LEFT_ASSIGN>
              <expr line1="446" col1="20" line2="446" col2="33" start="81638" end="81651">
                <expr line1="446" col1="20" line2="446" col2="28" start="81638" end="81646">
                  <SYMBOL line1="446" col1="20" line2="446" col2="28" start="81638" end="81646">stat_list</SYMBOL>
                </expr>
                <LBB line1="446" col1="29" line2="446" col2="30" start="81647" end="81648">[[</LBB>
                <expr line1="446" col1="31" line2="446" col2="31" start="81649" end="81649">
                  <SYMBOL line1="446" col1="31" line2="446" col2="31" start="81649" end="81649">x</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="446" col1="32" line2="446" col2="32" start="81650" end="81650">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="446" col1="33" line2="446" col2="33" start="81651" end="81651">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <COMMENT line1="448" col1="9" line2="448" col2="42" start="81993" end="82026"># For consistency with old output.</COMMENT>
            <expr line1="449" col1="9" line2="451" col2="9" start="82176" end="82542">
              <IF line1="449" col1="9" line2="449" col2="10" start="82176" end="82177">if</IF>
              <OP-LEFT-PAREN line1="449" col1="12" line2="449" col2="12" start="82179" end="82179">(</OP-LEFT-PAREN>
              <expr line1="449" col1="13" line2="449" col2="20" start="82180" end="82187">
                <expr line1="449" col1="13" line2="449" col2="13" start="82180" end="82180">
                  <SYMBOL line1="449" col1="13" line2="449" col2="13" start="82180" end="82180">x</SYMBOL>
                </expr>
                <NE line1="449" col1="14" line2="449" col2="15" start="82181" end="82182">!=</NE>
                <expr line1="449" col1="16" line2="449" col2="20" start="82183" end="82187">
                  <STR_CONST line1="449" col1="16" line2="449" col2="20" start="82183" end="82187">"all"</STR_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="449" col1="21" line2="449" col2="21" start="82188" end="82188">)</OP-RIGHT-PAREN>
              <expr line1="449" col1="23" line2="451" col2="9" start="82190" end="82542">
                <OP-LEFT-BRACE line1="449" col1="23" line2="449" col2="23" start="82190" end="82190">{</OP-LEFT-BRACE>
                <expr line1="450" col1="13" line2="450" col2="81" start="82363" end="82431">
                  <expr line1="450" col1="13" line2="450" col2="29" start="82363" end="82379">
                    <expr line1="450" col1="13" line2="450" col2="20" start="82363" end="82370">
                      <SYMBOL_FUNCTION_CALL line1="450" col1="13" line2="450" col2="20" start="82363" end="82370">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="450" col1="21" line2="450" col2="21" start="82371" end="82371">(</OP-LEFT-PAREN>
                    <expr line1="450" col1="22" line2="450" col2="28" start="82372" end="82378">
                      <SYMBOL line1="450" col1="22" line2="450" col2="28" start="82372" end="82378">current</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="450" col1="29" line2="450" col2="29" start="82379" end="82379">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="450" col1="31" line2="450" col2="32" start="82381" end="82382">&lt;-</LEFT_ASSIGN>
                  <expr line1="450" col1="34" line2="450" col2="81" start="82384" end="82431">
                    <expr line1="450" col1="34" line2="450" col2="40" start="82384" end="82390">
                      <SYMBOL_FUNCTION_CALL line1="450" col1="34" line2="450" col2="40" start="82384" end="82390">sprintf</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="450" col1="41" line2="450" col2="41" start="82391" end="82391">(</OP-LEFT-PAREN>
                    <expr line1="450" col1="42" line2="450" col2="48" start="82392" end="82398">
                      <STR_CONST line1="450" col1="42" line2="450" col2="48" start="82392" end="82398">"%s_%s"</STR_CONST>
                    </expr>
                    <OP-COMMA line1="450" col1="49" line2="450" col2="49" start="82399" end="82399">,</OP-COMMA>
                    <expr line1="450" col1="51" line2="450" col2="67" start="82401" end="82417">
                      <expr line1="450" col1="51" line2="450" col2="58" start="82401" end="82408">
                        <SYMBOL_FUNCTION_CALL line1="450" col1="51" line2="450" col2="58" start="82401" end="82408">colnames</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="450" col1="59" line2="450" col2="59" start="82409" end="82409">(</OP-LEFT-PAREN>
                      <expr line1="450" col1="60" line2="450" col2="66" start="82410" end="82416">
                        <SYMBOL line1="450" col1="60" line2="450" col2="66" start="82410" end="82416">current</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="450" col1="67" line2="450" col2="67" start="82417" end="82417">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-COMMA line1="450" col1="68" line2="450" col2="68" start="82418" end="82418">,</OP-COMMA>
                    <expr line1="450" col1="70" line2="450" col2="80" start="82420" end="82430">
                      <expr line1="450" col1="70" line2="450" col2="77" start="82420" end="82427">
                        <SYMBOL_FUNCTION_CALL line1="450" col1="70" line2="450" col2="77" start="82420" end="82427">trim.fun</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="450" col1="78" line2="450" col2="78" start="82428" end="82428">(</OP-LEFT-PAREN>
                      <expr line1="450" col1="79" line2="450" col2="79" start="82429" end="82429">
                        <SYMBOL line1="450" col1="79" line2="450" col2="79" start="82429" end="82429">x</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="450" col1="80" line2="450" col2="80" start="82430" end="82430">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="450" col1="81" line2="450" col2="81" start="82431" end="82431">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="451" col1="9" line2="451" col2="9" start="82542" end="82542">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="453" col1="9" line2="453" col2="33" start="82908" end="82932">
              <expr line1="453" col1="9" line2="453" col2="22" start="82908" end="82921">
                <expr line1="453" col1="9" line2="453" col2="17" start="82908" end="82916">
                  <SYMBOL line1="453" col1="9" line2="453" col2="17" start="82908" end="82916">collected</SYMBOL>
                </expr>
                <LBB line1="453" col1="18" line2="453" col2="19" start="82917" end="82918">[[</LBB>
                <expr line1="453" col1="20" line2="453" col2="20" start="82919" end="82919">
                  <SYMBOL line1="453" col1="20" line2="453" col2="20" start="82919" end="82919">x</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="453" col1="21" line2="453" col2="21" start="82920" end="82920">]</OP-RIGHT-BRACKET>
                <OP-RIGHT-BRACKET line1="453" col1="22" line2="453" col2="22" start="82921" end="82921">]</OP-RIGHT-BRACKET>
              </expr>
              <LEFT_ASSIGN line1="453" col1="24" line2="453" col2="25" start="82923" end="82924">&lt;-</LEFT_ASSIGN>
              <expr line1="453" col1="27" line2="453" col2="33" start="82926" end="82932">
                <SYMBOL line1="453" col1="27" line2="453" col2="33" start="82926" end="82932">current</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="454" col1="5" line2="454" col2="5" start="83087" end="83087">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="456" col1="5" line2="456" col2="66" start="83453" end="83514">
          <expr line1="456" col1="5" line2="456" col2="12" start="83453" end="83460">
            <SYMBOL line1="456" col1="5" line2="456" col2="12" start="83453" end="83460">combined</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="456" col1="14" line2="456" col2="15" start="83462" end="83463">&lt;-</LEFT_ASSIGN>
          <expr line1="456" col1="17" line2="456" col2="66" start="83465" end="83514">
            <expr line1="456" col1="17" line2="456" col2="23" start="83465" end="83471">
              <SYMBOL_FUNCTION_CALL line1="456" col1="17" line2="456" col2="23" start="83465" end="83471">do.call</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="456" col1="24" line2="456" col2="24" start="83472" end="83472">(</OP-LEFT-PAREN>
            <expr line1="456" col1="25" line2="456" col2="29" start="83473" end="83477">
              <SYMBOL line1="456" col1="25" line2="456" col2="29" start="83473" end="83477">cbind</SYMBOL>
            </expr>
            <OP-COMMA line1="456" col1="30" line2="456" col2="30" start="83478" end="83478">,</OP-COMMA>
            <expr line1="456" col1="32" line2="456" col2="65" start="83480" end="83513">
              <expr line1="456" col1="32" line2="456" col2="32" start="83480" end="83480">
                <SYMBOL_FUNCTION_CALL line1="456" col1="32" line2="456" col2="32" start="83480" end="83480">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="456" col1="33" line2="456" col2="33" start="83481" end="83481">(</OP-LEFT-PAREN>
              <expr line1="456" col1="34" line2="456" col2="45" start="83482" end="83493">
                <expr line1="456" col1="34" line2="456" col2="37" start="83482" end="83485">
                  <SYMBOL_FUNCTION_CALL line1="456" col1="34" line2="456" col2="37" start="83482" end="83485">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="456" col1="38" line2="456" col2="38" start="83486" end="83486">(</OP-LEFT-PAREN>
                <expr line1="456" col1="39" line2="456" col2="44" start="83487" end="83492">
                  <SYMBOL line1="456" col1="39" line2="456" col2="44" start="83487" end="83492">output</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="456" col1="45" line2="456" col2="45" start="83493" end="83493">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="456" col1="46" line2="456" col2="46" start="83494" end="83494">,</OP-COMMA>
              <expr line1="456" col1="48" line2="456" col2="64" start="83496" end="83512">
                <expr line1="456" col1="48" line2="456" col2="53" start="83496" end="83501">
                  <SYMBOL_FUNCTION_CALL line1="456" col1="48" line2="456" col2="53" start="83496" end="83501">unname</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="456" col1="54" line2="456" col2="54" start="83502" end="83502">(</OP-LEFT-PAREN>
                <expr line1="456" col1="55" line2="456" col2="63" start="83503" end="83511">
                  <SYMBOL line1="456" col1="55" line2="456" col2="63" start="83503" end="83511">collected</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="456" col1="64" line2="456" col2="64" start="83512" end="83512">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="456" col1="65" line2="456" col2="65" start="83513" end="83513">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="456" col1="66" line2="456" col2="66" start="83514" end="83514">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="457" col1="5" line2="457" col2="51" start="83636" end="83682">
          <expr line1="457" col1="5" line2="457" col2="31" start="83636" end="83662">
            <SYMBOL_FUNCTION_CALL line1="457" col1="5" line2="457" col2="31" start="83636" end="83662">.cbind_overwrite_DataFrames</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="457" col1="32" line2="457" col2="32" start="83663" end="83663">(</OP-LEFT-PAREN>
          <expr line1="457" col1="33" line2="457" col2="40" start="83664" end="83671">
            <SYMBOL line1="457" col1="33" line2="457" col2="40" start="83664" end="83671">existing</SYMBOL>
          </expr>
          <OP-COMMA line1="457" col1="41" line2="457" col2="41" start="83672" end="83672">,</OP-COMMA>
          <expr line1="457" col1="43" line2="457" col2="50" start="83674" end="83681">
            <SYMBOL line1="457" col1="43" line2="457" col2="50" start="83674" end="83681">combined</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="457" col1="51" line2="457" col2="51" start="83682" end="83682">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="458" col1="1" line2="458" col2="1" start="83815" end="83815">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="460" col1="1" line2="468" col2="1" start="84181" end="85645">
    <expr line1="460" col1="1" line2="460" col2="23" start="84181" end="84203">
      <SYMBOL line1="460" col1="1" line2="460" col2="23" start="84181" end="84203">.create_outer_DataFrame</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="460" col1="25" line2="460" col2="26" start="84205" end="84206">&lt;-</LEFT_ASSIGN>
    <expr line1="460" col1="28" line2="468" col2="1" start="84208" end="85645">
      <FUNCTION line1="460" col1="28" line2="460" col2="35" start="84208" end="84215">function</FUNCTION>
      <OP-LEFT-PAREN line1="460" col1="36" line2="460" col2="36" start="84216" end="84216">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="460" col1="37" line2="460" col2="44" start="84217" end="84224">set_list</SYMBOL_FORMALS>
      <OP-COMMA line1="460" col1="45" line2="460" col2="45" start="84225" end="84225">,</OP-COMMA>
      <SYMBOL_FORMALS line1="460" col1="47" line2="460" col2="54" start="84227" end="84234">n_values</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="460" col1="55" line2="460" col2="55" start="84235" end="84235">)</OP-RIGHT-PAREN>
      <expr line1="460" col1="57" line2="468" col2="1" start="84237" end="85645">
        <OP-LEFT-BRACE line1="460" col1="57" line2="460" col2="57" start="84237" end="84237">{</OP-LEFT-BRACE>
        <expr line1="461" col1="5" line2="466" col2="5" start="84368" end="85283">
          <IF line1="461" col1="5" line2="461" col2="6" start="84368" end="84369">if</IF>
          <OP-LEFT-PAREN line1="461" col1="8" line2="461" col2="8" start="84371" end="84371">(</OP-LEFT-PAREN>
          <expr line1="461" col1="9" line2="461" col2="24" start="84372" end="84387">
            <expr line1="461" col1="9" line2="461" col2="14" start="84372" end="84377">
              <SYMBOL_FUNCTION_CALL line1="461" col1="9" line2="461" col2="14" start="84372" end="84377">length</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="461" col1="15" line2="461" col2="15" start="84378" end="84378">(</OP-LEFT-PAREN>
            <expr line1="461" col1="16" line2="461" col2="23" start="84379" end="84386">
              <SYMBOL line1="461" col1="16" line2="461" col2="23" start="84379" end="84386">set_list</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="461" col1="24" line2="461" col2="24" start="84387" end="84387">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="461" col1="25" line2="461" col2="25" start="84388" end="84388">)</OP-RIGHT-PAREN>
          <expr line1="461" col1="27" line2="464" col2="5" start="84390" end="84917">
            <OP-LEFT-BRACE line1="461" col1="27" line2="461" col2="27" start="84390" end="84390">{</OP-LEFT-BRACE>
            <expr line1="462" col1="9" line2="462" col2="46" start="84555" end="84592">
              <expr line1="462" col1="9" line2="462" col2="14" start="84555" end="84560">
                <SYMBOL line1="462" col1="9" line2="462" col2="14" start="84555" end="84560">output</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="462" col1="16" line2="462" col2="17" start="84562" end="84563">&lt;-</LEFT_ASSIGN>
              <expr line1="462" col1="19" line2="462" col2="46" start="84565" end="84592">
                <expr line1="462" col1="19" line2="462" col2="25" start="84565" end="84571">
                  <SYMBOL_FUNCTION_CALL line1="462" col1="19" line2="462" col2="25" start="84565" end="84571">do.call</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="462" col1="26" line2="462" col2="26" start="84572" end="84572">(</OP-LEFT-PAREN>
                <expr line1="462" col1="27" line2="462" col2="35" start="84573" end="84581">
                  <SYMBOL line1="462" col1="27" line2="462" col2="35" start="84573" end="84581">DataFrame</SYMBOL>
                </expr>
                <OP-COMMA line1="462" col1="36" line2="462" col2="36" start="84582" end="84582">,</OP-COMMA>
                <expr line1="462" col1="38" line2="462" col2="45" start="84584" end="84591">
                  <SYMBOL line1="462" col1="38" line2="462" col2="45" start="84584" end="84591">set_list</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="462" col1="46" line2="462" col2="46" start="84592" end="84592">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="463" col1="9" line2="463" col2="62" start="84738" end="84791">
              <expr line1="463" col1="9" line2="463" col2="24" start="84738" end="84753">
                <expr line1="463" col1="9" line2="463" col2="16" start="84738" end="84745">
                  <SYMBOL_FUNCTION_CALL line1="463" col1="9" line2="463" col2="16" start="84738" end="84745">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="463" col1="17" line2="463" col2="17" start="84746" end="84746">(</OP-LEFT-PAREN>
                <expr line1="463" col1="18" line2="463" col2="23" start="84747" end="84752">
                  <SYMBOL line1="463" col1="18" line2="463" col2="23" start="84747" end="84752">output</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="463" col1="24" line2="463" col2="24" start="84753" end="84753">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="463" col1="26" line2="463" col2="27" start="84755" end="84756">&lt;-</LEFT_ASSIGN>
              <expr line1="463" col1="29" line2="463" col2="62" start="84758" end="84791">
                <expr line1="463" col1="29" line2="463" col2="35" start="84758" end="84764">
                  <SYMBOL_FUNCTION_CALL line1="463" col1="29" line2="463" col2="35" start="84758" end="84764">sprintf</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="463" col1="36" line2="463" col2="36" start="84765" end="84765">(</OP-LEFT-PAREN>
                <expr line1="463" col1="37" line2="463" col2="43" start="84766" end="84772">
                  <STR_CONST line1="463" col1="37" line2="463" col2="43" start="84766" end="84772">"is_%s"</STR_CONST>
                </expr>
                <OP-COMMA line1="463" col1="44" line2="463" col2="44" start="84773" end="84773">,</OP-COMMA>
                <expr line1="463" col1="46" line2="463" col2="61" start="84775" end="84790">
                  <expr line1="463" col1="46" line2="463" col2="53" start="84775" end="84782">
                    <SYMBOL_FUNCTION_CALL line1="463" col1="46" line2="463" col2="53" start="84775" end="84782">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="463" col1="54" line2="463" col2="54" start="84783" end="84783">(</OP-LEFT-PAREN>
                  <expr line1="463" col1="55" line2="463" col2="60" start="84784" end="84789">
                    <SYMBOL line1="463" col1="55" line2="463" col2="60" start="84784" end="84789">output</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="463" col1="61" line2="463" col2="61" start="84790" end="84790">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="463" col1="62" line2="463" col2="62" start="84791" end="84791">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="464" col1="5" line2="464" col2="5" start="84917" end="84917">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="464" col1="7" line2="464" col2="10" start="84919" end="84922">else</ELSE>
          <expr line1="464" col1="12" line2="466" col2="5" start="84924" end="85283">
            <OP-LEFT-BRACE line1="464" col1="12" line2="464" col2="12" start="84924" end="84924">{</OP-LEFT-BRACE>
            <expr line1="465" col1="9" line2="465" col2="50" start="85104" end="85145">
              <expr line1="465" col1="9" line2="465" col2="14" start="85104" end="85109">
                <SYMBOL line1="465" col1="9" line2="465" col2="14" start="85104" end="85109">output</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="465" col1="16" line2="465" col2="17" start="85111" end="85112">&lt;-</LEFT_ASSIGN>
              <expr line1="465" col1="19" line2="465" col2="50" start="85114" end="85145">
                <expr line1="465" col1="19" line2="465" col2="21" start="85114" end="85116">
                  <SYMBOL_FUNCTION_CALL line1="465" col1="19" line2="465" col2="21" start="85114" end="85116">new</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="465" col1="22" line2="465" col2="22" start="85117" end="85117">(</OP-LEFT-PAREN>
                <expr line1="465" col1="23" line2="465" col2="33" start="85118" end="85128">
                  <STR_CONST line1="465" col1="23" line2="465" col2="33" start="85118" end="85128">"DataFrame"</STR_CONST>
                </expr>
                <OP-COMMA line1="465" col1="34" line2="465" col2="34" start="85129" end="85129">,</OP-COMMA>
                <SYMBOL_SUB line1="465" col1="36" line2="465" col2="40" start="85131" end="85135">nrows</SYMBOL_SUB>
                <EQ_SUB line1="465" col1="41" line2="465" col2="41" start="85136" end="85136">=</EQ_SUB>
                <expr line1="465" col1="42" line2="465" col2="49" start="85137" end="85144">
                  <SYMBOL line1="465" col1="42" line2="465" col2="49" start="85137" end="85144">n_values</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="465" col1="50" line2="465" col2="50" start="85145" end="85145">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="466" col1="5" line2="466" col2="5" start="85283" end="85283">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="467" col1="5" line2="467" col2="18" start="85466" end="85479">
          <expr line1="467" col1="5" line2="467" col2="10" start="85466" end="85471">
            <SYMBOL_FUNCTION_CALL line1="467" col1="5" line2="467" col2="10" start="85466" end="85471">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="467" col1="11" line2="467" col2="11" start="85472" end="85472">(</OP-LEFT-PAREN>
          <expr line1="467" col1="12" line2="467" col2="17" start="85473" end="85478">
            <SYMBOL line1="467" col1="12" line2="467" col2="17" start="85473" end="85478">output</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="467" col1="18" line2="467" col2="18" start="85479" end="85479">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="468" col1="1" line2="468" col2="1" start="85645" end="85645">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <expr line1="470" col1="1" line2="476" col2="1" start="86011" end="87109">
    <expr line1="470" col1="1" line2="470" col2="27" start="86011" end="86037">
      <SYMBOL line1="470" col1="1" line2="470" col2="27" start="86011" end="86037">.cbind_overwrite_DataFrames</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="470" col1="29" line2="470" col2="30" start="86039" end="86040">&lt;-</LEFT_ASSIGN>
    <expr line1="470" col1="32" line2="476" col2="1" start="86042" end="87109">
      <FUNCTION line1="470" col1="32" line2="470" col2="39" start="86042" end="86049">function</FUNCTION>
      <OP-LEFT-PAREN line1="470" col1="40" line2="470" col2="40" start="86050" end="86050">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="470" col1="41" line2="470" col2="48" start="86051" end="86058">existing</SYMBOL_FORMALS>
      <OP-COMMA line1="470" col1="49" line2="470" col2="49" start="86059" end="86059">,</OP-COMMA>
      <SYMBOL_FORMALS line1="470" col1="51" line2="470" col2="57" start="86061" end="86067">updated</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="470" col1="58" line2="470" col2="58" start="86068" end="86068">)</OP-RIGHT-PAREN>
      <expr line1="470" col1="60" line2="476" col2="1" start="86070" end="87109">
        <OP-LEFT-BRACE line1="470" col1="60" line2="470" col2="60" start="86070" end="86070">{</OP-LEFT-BRACE>
        <expr line1="471" col1="5" line2="473" col2="5" start="86198" end="86564">
          <IF line1="471" col1="5" line2="471" col2="6" start="86198" end="86199">if</IF>
          <OP-LEFT-PAREN line1="471" col1="8" line2="471" col2="8" start="86201" end="86201">(</OP-LEFT-PAREN>
          <expr line1="471" col1="9" line2="471" col2="25" start="86202" end="86218">
            <expr line1="471" col1="9" line2="471" col2="15" start="86202" end="86208">
              <SYMBOL_FUNCTION_CALL line1="471" col1="9" line2="471" col2="15" start="86202" end="86208">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="471" col1="16" line2="471" col2="16" start="86209" end="86209">(</OP-LEFT-PAREN>
            <expr line1="471" col1="17" line2="471" col2="24" start="86210" end="86217">
              <SYMBOL line1="471" col1="17" line2="471" col2="24" start="86210" end="86217">existing</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="471" col1="25" line2="471" col2="25" start="86218" end="86218">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="471" col1="26" line2="471" col2="26" start="86219" end="86219">)</OP-RIGHT-PAREN>
          <expr line1="471" col1="28" line2="473" col2="5" start="86221" end="86564">
            <OP-LEFT-BRACE line1="471" col1="28" line2="471" col2="28" start="86221" end="86221">{</OP-LEFT-BRACE>
            <expr line1="472" col1="9" line2="472" col2="23" start="86385" end="86399">
              <expr line1="472" col1="9" line2="472" col2="14" start="86385" end="86390">
                <SYMBOL_FUNCTION_CALL line1="472" col1="9" line2="472" col2="14" start="86385" end="86390">return</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="472" col1="15" line2="472" col2="15" start="86391" end="86391">(</OP-LEFT-PAREN>
              <expr line1="472" col1="16" line2="472" col2="22" start="86392" end="86398">
                <SYMBOL line1="472" col1="16" line2="472" col2="22" start="86392" end="86398">updated</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="472" col1="23" line2="472" col2="23" start="86399" end="86399">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="473" col1="5" line2="473" col2="5" start="86564" end="86564">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="474" col1="5" line2="474" col2="86" start="86747" end="86828">
          <expr line1="474" col1="5" line2="474" col2="12" start="86747" end="86754">
            <SYMBOL line1="474" col1="5" line2="474" col2="12" start="86747" end="86754">existing</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="474" col1="14" line2="474" col2="15" start="86756" end="86757">&lt;-</LEFT_ASSIGN>
          <expr line1="474" col1="17" line2="474" col2="86" start="86759" end="86828">
            <expr line1="474" col1="17" line2="474" col2="24" start="86759" end="86766">
              <SYMBOL line1="474" col1="17" line2="474" col2="24" start="86759" end="86766">existing</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="474" col1="25" line2="474" col2="25" start="86767" end="86767">[</OP-LEFT-BRACKET>
            <OP-COMMA line1="474" col1="26" line2="474" col2="26" start="86768" end="86768">,</OP-COMMA>
            <expr line1="474" col1="28" line2="474" col2="71" start="86770" end="86813">
              <OP-EXCLAMATION line1="474" col1="28" line2="474" col2="28" start="86770" end="86770">!</OP-EXCLAMATION>
              <expr line1="474" col1="29" line2="474" col2="71" start="86771" end="86813">
                <OP-LEFT-PAREN line1="474" col1="29" line2="474" col2="29" start="86771" end="86771">(</OP-LEFT-PAREN>
                <expr line1="474" col1="30" line2="474" col2="70" start="86772" end="86812">
                  <expr line1="474" col1="30" line2="474" col2="47" start="86772" end="86789">
                    <expr line1="474" col1="30" line2="474" col2="37" start="86772" end="86779">
                      <SYMBOL_FUNCTION_CALL line1="474" col1="30" line2="474" col2="37" start="86772" end="86779">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="474" col1="38" line2="474" col2="38" start="86780" end="86780">(</OP-LEFT-PAREN>
                    <expr line1="474" col1="39" line2="474" col2="46" start="86781" end="86788">
                      <SYMBOL line1="474" col1="39" line2="474" col2="46" start="86781" end="86788">existing</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="474" col1="47" line2="474" col2="47" start="86789" end="86789">)</OP-RIGHT-PAREN>
                  </expr>
                  <SPECIAL line1="474" col1="49" line2="474" col2="52" start="86791" end="86794">%in%</SPECIAL>
                  <expr line1="474" col1="54" line2="474" col2="70" start="86796" end="86812">
                    <expr line1="474" col1="54" line2="474" col2="61" start="86796" end="86803">
                      <SYMBOL_FUNCTION_CALL line1="474" col1="54" line2="474" col2="61" start="86796" end="86803">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="474" col1="62" line2="474" col2="62" start="86804" end="86804">(</OP-LEFT-PAREN>
                    <expr line1="474" col1="63" line2="474" col2="69" start="86805" end="86811">
                      <SYMBOL line1="474" col1="63" line2="474" col2="69" start="86805" end="86811">updated</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="474" col1="70" line2="474" col2="70" start="86812" end="86812">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="474" col1="71" line2="474" col2="71" start="86813" end="86813">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-COMMA line1="474" col1="72" line2="474" col2="72" start="86814" end="86814">,</OP-COMMA>
            <SYMBOL_SUB line1="474" col1="74" line2="474" col2="77" start="86816" end="86819">drop</SYMBOL_SUB>
            <EQ_SUB line1="474" col1="79" line2="474" col2="79" start="86821" end="86821">=</EQ_SUB>
            <expr line1="474" col1="81" line2="474" col2="85" start="86823" end="86827">
              <NUM_CONST line1="474" col1="81" line2="474" col2="85" start="86823" end="86827">FALSE</NUM_CONST>
            </expr>
            <OP-RIGHT-BRACKET line1="474" col1="86" line2="474" col2="86" start="86828" end="86828">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="475" col1="5" line2="475" col2="28" start="86930" end="86953">
          <expr line1="475" col1="5" line2="475" col2="9" start="86930" end="86934">
            <SYMBOL_FUNCTION_CALL line1="475" col1="5" line2="475" col2="9" start="86930" end="86934">cbind</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="475" col1="10" line2="475" col2="10" start="86935" end="86935">(</OP-LEFT-PAREN>
          <expr line1="475" col1="11" line2="475" col2="18" start="86936" end="86943">
            <SYMBOL line1="475" col1="11" line2="475" col2="18" start="86936" end="86943">existing</SYMBOL>
          </expr>
          <OP-COMMA line1="475" col1="19" line2="475" col2="19" start="86944" end="86944">,</OP-COMMA>
          <expr line1="475" col1="21" line2="475" col2="27" start="86946" end="86952">
            <SYMBOL line1="475" col1="21" line2="475" col2="27" start="86946" end="86952">updated</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="475" col1="28" line2="475" col2="28" start="86953" end="86953">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="476" col1="1" line2="476" col2="1" start="87109" end="87109">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

