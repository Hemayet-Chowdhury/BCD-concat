<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="37" start="177" end="213">#' Calculate counts per million (CPM)</COMMENT>
  <COMMENT line1="2" col1="1" line2="2" col2="2" start="353" end="354">#'</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="64" start="529" end="592">#' Calculate count-per-million (CPM) values from the count data.</COMMENT>
  <COMMENT line1="4" col1="1" line2="4" col2="2" start="705" end="706">#'</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="63" start="881" end="943">#' @param object A SingleCellExperiment object or count matrix.</COMMENT>
  <COMMENT line1="6" col1="1" line2="6" col2="142" start="1057" end="1198">#' @param exprs_values A string specifying the assay of \code{object} containing the count matrix, if \code{object} is a SingleCellExperiment.</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="143" start="1233" end="1375">#' @param use_size_factors A logical scalar indicating whether size factors in \code{object} should be used to compute effective library sizes.</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="126" start="1409" end="1534">#' If not, all size factors are deleted and library size-based factors are used instead (see \code{\link{librarySizeFactors}}.</COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="127" start="1585" end="1711">#' Alternatively, a numeric vector containing a size factor for each cell, which is used in place of \code{sizeFactor(object)}.</COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="108" start="1761" end="1868">#' @param size_factor_grouping A factor to be passed to \code{grouping=} in \code{\link{centreSizeFactors}}.</COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="145" start="1937" end="2081">#' @param subset_row A vector specifying whether the rows of \code{object} should be (effectively) subsetted before calcaulting feature averages.</COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="2" start="2113" end="2114">#'</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="12" start="2289" end="2300">#' @details </COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="78" start="2465" end="2542">#' If requested, size factors are used to define the effective library sizes. </COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="138" start="2641" end="2778">#' This is done by scaling all size factors such that the mean scaled size factor is equal to the mean sum of counts across all features. </COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="90" start="2817" end="2906">#' The effective library sizes are then used to in the denominator of the CPM calculation.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="2" start="2993" end="2994">#'</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="57" start="3169" end="3225">#' Assuming that \code{object} is a SingleCellExperiment:</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="12" start="3345" end="3356">#' \itemize{</COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="99" start="3521" end="3619">#' \item If \code{use_size_factors=TRUE}, size factors are automatically extracted from the object.</COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="106" start="3697" end="3802">#' Note that effective library sizes may be computed differently for features marked as spike-in controls.</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="130" start="3873" end="4002">#' This is due to the presence of control-specific size factors in \code{object}, see \code{\link{normalizeSCE}} for more details.</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="89" start="4049" end="4137">#' \item If \code{use_size_factors=FALSE}, all size factors in \code{object} are ignored.</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="124" start="4225" end="4348">#' The total count for each cell will be used as the library size for all features (endogenous genes and spike-in controls).</COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="138" start="4401" end="4538">#' \item If \code{use_size_factors} is a numeric vector, it will override the any size factors for non-spike-in features in \code{object}.</COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="77" start="4577" end="4653">#' The spike-in size factors will still be used for the spike-in transcripts.</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="4" start="4753" end="4756">#' }</COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="68" start="4929" end="4996">#' If no size factors are available, the library sizes will be used.</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="2" start="5105" end="5106">#'</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="133" start="5281" end="5413">#' If \code{object} is a matrix or matrix-like object, size factors will only be used if \code{use_size_factors} is a numeric vector.</COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="83" start="5457" end="5539">#' Otherwise, the sum of counts for each cell is directly used as the library size.</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="2" start="5633" end="5634">#'</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="137" start="5809" end="5945">#' Note that the rescaling is performed to the mean sum of counts for all features, regardless of whether \code{subset.row} is specified.</COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="175" start="5985" end="6159">#' This ensures that the output of the function with \code{subset.row} is equivalent (but more efficient) than subsetting the output of the function without \code{subset.row}.</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="2" start="6161" end="6162">#'</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="32" start="6337" end="6368">#' @return Matrix of CPM values.</COMMENT>
  <COMMENT line1="37" col1="1" line2="37" col2="10" start="6513" end="6522">#' @export</COMMENT>
  <COMMENT line1="38" col1="1" line2="38" col2="12" start="6689" end="6700">#' @examples</COMMENT>
  <COMMENT line1="39" col1="1" line2="39" col2="28" start="6865" end="6892">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="40" col1="1" line2="40" col2="31" start="7041" end="7071">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="41" col1="1" line2="41" col2="39" start="7217" end="7255">#' example_sce &lt;- SingleCellExperiment(</COMMENT>
  <COMMENT line1="42" col1="1" line2="42" col2="41" start="7393" end="7433">#'     list(counts = sc_example_counts), </COMMENT>
  <COMMENT line1="43" col1="1" line2="43" col2="38" start="7569" end="7606">#'     colData = sc_example_cell_info)</COMMENT>
  <COMMENT line1="44" col1="1" line2="44" col2="2" start="7745" end="7746">#'</COMMENT>
  <COMMENT line1="45" col1="1" line2="45" col2="74" start="7921" end="7994">#' cpm(example_sce) &lt;- calculateCPM(example_sce, use_size_factors = FALSE)</COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="2" start="8097" end="8098">#'</COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="40" start="8273" end="8312">#' @importFrom DelayedArray DelayedArray</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="42" start="8449" end="8490">#' @importFrom DelayedMatrixStats colSums2</COMMENT>
  <expr line1="49" col1="1" line2="76" col2="1" start="8625" end="13377">
    <expr line1="49" col1="1" line2="49" col2="12" start="8625" end="8636">
      <SYMBOL line1="49" col1="1" line2="49" col2="12" start="8625" end="8636">calculateCPM</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="49" col1="14" line2="49" col2="15" start="8638" end="8639">&lt;-</LEFT_ASSIGN>
    <expr line1="49" col1="17" line2="76" col2="1" start="8641" end="13377">
      <FUNCTION line1="49" col1="17" line2="49" col2="24" start="8641" end="8648">function</FUNCTION>
      <OP-LEFT-PAREN line1="49" col1="25" line2="49" col2="25" start="8649" end="8649">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="49" col1="26" line2="49" col2="31" start="8650" end="8655">object</SYMBOL_FORMALS>
      <OP-COMMA line1="49" col1="32" line2="49" col2="32" start="8656" end="8656">,</OP-COMMA>
      <SYMBOL_FORMALS line1="49" col1="34" line2="49" col2="45" start="8658" end="8669">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="49" col1="46" line2="49" col2="46" start="8670" end="8670">=</EQ_FORMALS>
      <expr line1="49" col1="47" line2="49" col2="54" start="8671" end="8678">
        <STR_CONST line1="49" col1="47" line2="49" col2="54" start="8671" end="8678">"counts"</STR_CONST>
      </expr>
      <OP-COMMA line1="49" col1="55" line2="49" col2="55" start="8679" end="8679">,</OP-COMMA>
      <SYMBOL_FORMALS line1="49" col1="57" line2="49" col2="72" start="8681" end="8696">use_size_factors</SYMBOL_FORMALS>
      <EQ_FORMALS line1="49" col1="74" line2="49" col2="74" start="8698" end="8698">=</EQ_FORMALS>
      <expr line1="49" col1="76" line2="49" col2="79" start="8700" end="8703">
        <NUM_CONST line1="49" col1="76" line2="49" col2="79" start="8700" end="8703">TRUE</NUM_CONST>
      </expr>
      <OP-COMMA line1="49" col1="80" line2="49" col2="80" start="8704" end="8704">,</OP-COMMA>
      <SYMBOL_FORMALS line1="49" col1="82" line2="49" col2="101" start="8706" end="8725">size_factor_grouping</SYMBOL_FORMALS>
      <EQ_FORMALS line1="49" col1="103" line2="49" col2="103" start="8727" end="8727">=</EQ_FORMALS>
      <expr line1="49" col1="105" line2="49" col2="108" start="8729" end="8732">
        <NULL_CONST line1="49" col1="105" line2="49" col2="108" start="8729" end="8732">NULL</NULL_CONST>
      </expr>
      <OP-COMMA line1="49" col1="109" line2="49" col2="109" start="8733" end="8733">,</OP-COMMA>
      <SYMBOL_FORMALS line1="49" col1="111" line2="49" col2="120" start="8735" end="8744">subset_row</SYMBOL_FORMALS>
      <EQ_FORMALS line1="49" col1="122" line2="49" col2="122" start="8746" end="8746">=</EQ_FORMALS>
      <expr line1="49" col1="124" line2="49" col2="127" start="8748" end="8751">
        <NULL_CONST line1="49" col1="124" line2="49" col2="127" start="8748" end="8751">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="49" col1="128" line2="49" col2="128" start="8752" end="8752">)</OP-RIGHT-PAREN>
      <expr line1="49" col1="130" line2="76" col2="1" start="8754" end="13377">
        <OP-LEFT-BRACE line1="49" col1="130" line2="49" col2="130" start="8754" end="8754">{</OP-LEFT-BRACE>
        <expr line1="50" col1="5" line2="54" col2="5" start="8805" end="9509">
          <IF line1="50" col1="5" line2="50" col2="6" start="8805" end="8806">if</IF>
          <OP-LEFT-PAREN line1="50" col1="8" line2="50" col2="8" start="8808" end="8808">(</OP-LEFT-PAREN>
          <expr line1="50" col1="9" line2="50" col2="43" start="8809" end="8843">
            <OP-EXCLAMATION line1="50" col1="9" line2="50" col2="9" start="8809" end="8809">!</OP-EXCLAMATION>
            <expr line1="50" col1="10" line2="50" col2="43" start="8810" end="8843">
              <expr line1="50" col1="10" line2="50" col2="11" start="8810" end="8811">
                <SYMBOL_FUNCTION_CALL line1="50" col1="10" line2="50" col2="11" start="8810" end="8811">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="50" col1="12" line2="50" col2="12" start="8812" end="8812">(</OP-LEFT-PAREN>
              <expr line1="50" col1="13" line2="50" col2="18" start="8813" end="8818">
                <SYMBOL line1="50" col1="13" line2="50" col2="18" start="8813" end="8818">object</SYMBOL>
              </expr>
              <OP-COMMA line1="50" col1="19" line2="50" col2="19" start="8819" end="8819">,</OP-COMMA>
              <expr line1="50" col1="21" line2="50" col2="42" start="8821" end="8842">
                <STR_CONST line1="50" col1="21" line2="50" col2="42" start="8821" end="8842">"SingleCellExperiment"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="50" col1="43" line2="50" col2="43" start="8843" end="8843">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="50" col1="44" line2="50" col2="44" start="8844" end="8844">)</OP-RIGHT-PAREN>
          <expr line1="50" col1="46" line2="54" col2="5" start="8846" end="9509">
            <OP-LEFT-BRACE line1="50" col1="46" line2="50" col2="46" start="8846" end="8846">{</OP-LEFT-BRACE>
            <expr line1="51" col1="9" line2="51" col2="30" start="8985" end="9006">
              <expr line1="51" col1="9" line2="51" col2="14" start="8985" end="8990">
                <SYMBOL line1="51" col1="9" line2="51" col2="14" start="8985" end="8990">assays</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="51" col1="16" line2="51" col2="17" start="8992" end="8993">&lt;-</LEFT_ASSIGN>
              <expr line1="51" col1="19" line2="51" col2="30" start="8995" end="9006">
                <expr line1="51" col1="19" line2="51" col2="22" start="8995" end="8998">
                  <SYMBOL_FUNCTION_CALL line1="51" col1="19" line2="51" col2="22" start="8995" end="8998">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="51" col1="23" line2="51" col2="23" start="8999" end="8999">(</OP-LEFT-PAREN>
                <expr line1="51" col1="24" line2="51" col2="29" start="9000" end="9005">
                  <SYMBOL line1="51" col1="24" line2="51" col2="29" start="9000" end="9005">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="51" col1="30" line2="51" col2="30" start="9006" end="9006">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="52" col1="9" line2="52" col2="37" start="9161" end="9189">
              <expr line1="52" col1="9" line2="52" col2="21" start="9161" end="9173">
                <expr line1="52" col1="9" line2="52" col2="13" start="9161" end="9165">
                  <SYMBOL_FUNCTION_CALL line1="52" col1="9" line2="52" col2="13" start="9161" end="9165">names</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="52" col1="14" line2="52" col2="14" start="9166" end="9166">(</OP-LEFT-PAREN>
                <expr line1="52" col1="15" line2="52" col2="20" start="9167" end="9172">
                  <SYMBOL line1="52" col1="15" line2="52" col2="20" start="9167" end="9172">assays</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="52" col1="21" line2="52" col2="21" start="9173" end="9173">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="52" col1="23" line2="52" col2="24" start="9175" end="9176">&lt;-</LEFT_ASSIGN>
              <expr line1="52" col1="26" line2="52" col2="37" start="9178" end="9189">
                <SYMBOL line1="52" col1="26" line2="52" col2="37" start="9178" end="9189">exprs_values</SYMBOL>
              </expr>
            </expr>
            <expr line1="53" col1="9" line2="53" col2="46" start="9337" end="9374">
              <expr line1="53" col1="9" line2="53" col2="14" start="9337" end="9342">
                <SYMBOL line1="53" col1="9" line2="53" col2="14" start="9337" end="9342">object</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="53" col1="16" line2="53" col2="17" start="9344" end="9345">&lt;-</LEFT_ASSIGN>
              <expr line1="53" col1="19" line2="53" col2="46" start="9347" end="9374">
                <expr line1="53" col1="19" line2="53" col2="38" start="9347" end="9366">
                  <SYMBOL_FUNCTION_CALL line1="53" col1="19" line2="53" col2="38" start="9347" end="9366">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="53" col1="39" line2="53" col2="39" start="9367" end="9367">(</OP-LEFT-PAREN>
                <expr line1="53" col1="40" line2="53" col2="45" start="9368" end="9373">
                  <SYMBOL line1="53" col1="40" line2="53" col2="45" start="9368" end="9373">assays</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="53" col1="46" line2="53" col2="46" start="9374" end="9374">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="54" col1="5" line2="54" col2="5" start="9509" end="9509">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="56" col1="5" line2="56" col2="34" start="9861" end="9890"># Setting up the size factors.</COMMENT>
        <expr line1="57" col1="5" line2="57" col2="61" start="10037" end="10093">
          <expr line1="57" col1="5" line2="57" col2="10" start="10037" end="10042">
            <SYMBOL line1="57" col1="5" line2="57" col2="10" start="10037" end="10042">object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="57" col1="12" line2="57" col2="13" start="10044" end="10045">&lt;-</LEFT_ASSIGN>
          <expr line1="57" col1="15" line2="57" col2="61" start="10047" end="10093">
            <expr line1="57" col1="15" line2="57" col2="35" start="10047" end="10067">
              <SYMBOL_FUNCTION_CALL line1="57" col1="15" line2="57" col2="35" start="10047" end="10067">.replace_size_factors</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="57" col1="36" line2="57" col2="36" start="10068" end="10068">(</OP-LEFT-PAREN>
            <expr line1="57" col1="37" line2="57" col2="42" start="10069" end="10074">
              <SYMBOL line1="57" col1="37" line2="57" col2="42" start="10069" end="10074">object</SYMBOL>
            </expr>
            <OP-COMMA line1="57" col1="43" line2="57" col2="43" start="10075" end="10075">,</OP-COMMA>
            <expr line1="57" col1="45" line2="57" col2="60" start="10077" end="10092">
              <SYMBOL line1="57" col1="45" line2="57" col2="60" start="10077" end="10092">use_size_factors</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="57" col1="61" line2="57" col2="61" start="10093" end="10093">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="58" col1="5" line2="60" col2="5" start="10213" end="10565">
          <IF line1="58" col1="5" line2="58" col2="6" start="10213" end="10214">if</IF>
          <OP-LEFT-PAREN line1="58" col1="8" line2="58" col2="8" start="10216" end="10216">(</OP-LEFT-PAREN>
          <expr line1="58" col1="9" line2="58" col2="36" start="10217" end="10244">
            <expr line1="58" col1="9" line2="58" col2="15" start="10217" end="10223">
              <SYMBOL_FUNCTION_CALL line1="58" col1="9" line2="58" col2="15" start="10217" end="10223">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="58" col1="16" line2="58" col2="16" start="10224" end="10224">(</OP-LEFT-PAREN>
            <expr line1="58" col1="17" line2="58" col2="35" start="10225" end="10243">
              <expr line1="58" col1="17" line2="58" col2="27" start="10225" end="10235">
                <SYMBOL_FUNCTION_CALL line1="58" col1="17" line2="58" col2="27" start="10225" end="10235">sizeFactors</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="58" col1="28" line2="58" col2="28" start="10236" end="10236">(</OP-LEFT-PAREN>
              <expr line1="58" col1="29" line2="58" col2="34" start="10237" end="10242">
                <SYMBOL line1="58" col1="29" line2="58" col2="34" start="10237" end="10242">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="58" col1="35" line2="58" col2="35" start="10243" end="10243">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="58" col1="36" line2="58" col2="36" start="10244" end="10244">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="58" col1="37" line2="58" col2="37" start="10245" end="10245">)</OP-RIGHT-PAREN>
          <expr line1="58" col1="39" line2="60" col2="5" start="10247" end="10565">
            <OP-LEFT-BRACE line1="58" col1="39" line2="58" col2="39" start="10247" end="10247">{</OP-LEFT-BRACE>
            <expr line1="59" col1="9" line2="59" col2="57" start="10393" end="10441">
              <expr line1="59" col1="9" line2="59" col2="27" start="10393" end="10411">
                <expr line1="59" col1="9" line2="59" col2="19" start="10393" end="10403">
                  <SYMBOL_FUNCTION_CALL line1="59" col1="9" line2="59" col2="19" start="10393" end="10403">sizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="59" col1="20" line2="59" col2="20" start="10404" end="10404">(</OP-LEFT-PAREN>
                <expr line1="59" col1="21" line2="59" col2="26" start="10405" end="10410">
                  <SYMBOL line1="59" col1="21" line2="59" col2="26" start="10405" end="10410">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="59" col1="27" line2="59" col2="27" start="10411" end="10411">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="59" col1="29" line2="59" col2="30" start="10413" end="10414">&lt;-</LEFT_ASSIGN>
              <expr line1="59" col1="32" line2="59" col2="57" start="10416" end="10441">
                <expr line1="59" col1="32" line2="59" col2="49" start="10416" end="10433">
                  <SYMBOL_FUNCTION_CALL line1="59" col1="32" line2="59" col2="49" start="10416" end="10433">librarySizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="59" col1="50" line2="59" col2="50" start="10434" end="10434">(</OP-LEFT-PAREN>
                <expr line1="59" col1="51" line2="59" col2="56" start="10435" end="10440">
                  <SYMBOL line1="59" col1="51" line2="59" col2="56" start="10435" end="10440">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="59" col1="57" line2="59" col2="57" start="10441" end="10441">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="60" col1="5" line2="60" col2="5" start="10565" end="10565">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="62" col1="5" line2="62" col2="72" start="10917" end="10984">
          <expr line1="62" col1="5" line2="62" col2="10" start="10917" end="10922">
            <SYMBOL line1="62" col1="5" line2="62" col2="10" start="10917" end="10922">object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="62" col1="12" line2="62" col2="13" start="10924" end="10925">&lt;-</LEFT_ASSIGN>
          <expr line1="62" col1="15" line2="62" col2="72" start="10927" end="10984">
            <expr line1="62" col1="15" line2="62" col2="31" start="10927" end="10943">
              <SYMBOL_FUNCTION_CALL line1="62" col1="15" line2="62" col2="31" start="10927" end="10943">centreSizeFactors</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="62" col1="32" line2="62" col2="32" start="10944" end="10944">(</OP-LEFT-PAREN>
            <expr line1="62" col1="33" line2="62" col2="38" start="10945" end="10950">
              <SYMBOL line1="62" col1="33" line2="62" col2="38" start="10945" end="10950">object</SYMBOL>
            </expr>
            <OP-COMMA line1="62" col1="39" line2="62" col2="39" start="10951" end="10951">,</OP-COMMA>
            <SYMBOL_SUB line1="62" col1="41" line2="62" col2="48" start="10953" end="10960">grouping</SYMBOL_SUB>
            <EQ_SUB line1="62" col1="50" line2="62" col2="50" start="10962" end="10962">=</EQ_SUB>
            <expr line1="62" col1="52" line2="62" col2="71" start="10964" end="10983">
              <SYMBOL line1="62" col1="52" line2="62" col2="71" start="10964" end="10983">size_factor_grouping</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="62" col1="72" line2="62" col2="72" start="10984" end="10984">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="63" col1="5" line2="63" col2="39" start="11093" end="11127">
          <expr line1="63" col1="5" line2="63" col2="11" start="11093" end="11099">
            <SYMBOL line1="63" col1="5" line2="63" col2="11" start="11093" end="11099">sf_list</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="63" col1="13" line2="63" col2="14" start="11101" end="11102">&lt;-</LEFT_ASSIGN>
          <expr line1="63" col1="16" line2="63" col2="39" start="11104" end="11127">
            <expr line1="63" col1="16" line2="63" col2="31" start="11104" end="11119">
              <SYMBOL_FUNCTION_CALL line1="63" col1="16" line2="63" col2="31" start="11104" end="11119">.get_all_sf_sets</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="63" col1="32" line2="63" col2="32" start="11120" end="11120">(</OP-LEFT-PAREN>
            <expr line1="63" col1="33" line2="63" col2="38" start="11121" end="11126">
              <SYMBOL line1="63" col1="33" line2="63" col2="38" start="11121" end="11126">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="63" col1="39" line2="63" col2="39" start="11127" end="11127">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="65" col1="5" line2="65" col2="77" start="11445" end="11517"># Computes the average count, adjusting for size factors or library size.</COMMENT>
        <expr line1="66" col1="5" line2="66" col2="44" start="11621" end="11660">
          <expr line1="66" col1="5" line2="66" col2="13" start="11621" end="11629">
            <SYMBOL line1="66" col1="5" line2="66" col2="13" start="11621" end="11629">extracted</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="66" col1="15" line2="66" col2="16" start="11631" end="11632">&lt;-</LEFT_ASSIGN>
          <expr line1="66" col1="18" line2="66" col2="44" start="11634" end="11660">
            <expr line1="66" col1="18" line2="66" col2="22" start="11634" end="11638">
              <SYMBOL_FUNCTION_CALL line1="66" col1="18" line2="66" col2="22" start="11634" end="11638">assay</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="66" col1="23" line2="66" col2="23" start="11639" end="11639">(</OP-LEFT-PAREN>
            <expr line1="66" col1="24" line2="66" col2="29" start="11640" end="11645">
              <SYMBOL line1="66" col1="24" line2="66" col2="29" start="11640" end="11645">object</SYMBOL>
            </expr>
            <OP-COMMA line1="66" col1="30" line2="66" col2="30" start="11646" end="11646">,</OP-COMMA>
            <expr line1="66" col1="32" line2="66" col2="43" start="11648" end="11659">
              <SYMBOL line1="66" col1="32" line2="66" col2="43" start="11648" end="11659">exprs_values</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="66" col1="44" line2="66" col2="44" start="11660" end="11660">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="67" col1="5" line2="71" col2="53" start="11797" end="12549">
          <expr line1="67" col1="5" line2="67" col2="10" start="11797" end="11802">
            <SYMBOL line1="67" col1="5" line2="67" col2="10" start="11797" end="11802">normed</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="67" col1="12" line2="67" col2="13" start="11804" end="11805">&lt;-</LEFT_ASSIGN>
          <expr line1="67" col1="15" line2="71" col2="53" start="11807" end="12549">
            <expr line1="67" col1="15" line2="67" col2="28" start="11807" end="11820">
              <SYMBOL_FUNCTION_CALL line1="67" col1="15" line2="67" col2="28" start="11807" end="11820">.compute_exprs</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="67" col1="29" line2="67" col2="29" start="11821" end="11821">(</OP-LEFT-PAREN>
            <expr line1="67" col1="30" line2="67" col2="38" start="11822" end="11830">
              <SYMBOL line1="67" col1="30" line2="67" col2="38" start="11822" end="11830">extracted</SYMBOL>
            </expr>
            <OP-COMMA line1="67" col1="39" line2="67" col2="39" start="11831" end="11831">,</OP-COMMA>
            <SYMBOL_SUB line1="68" col1="30" line2="68" col2="44" start="11998" end="12012">size_factor_val</SYMBOL_SUB>
            <EQ_SUB line1="68" col1="46" line2="68" col2="46" start="12014" end="12014">=</EQ_SUB>
            <expr line1="68" col1="48" line2="68" col2="67" start="12016" end="12035">
              <expr line1="68" col1="48" line2="68" col2="54" start="12016" end="12022">
                <SYMBOL line1="68" col1="48" line2="68" col2="54" start="12016" end="12022">sf_list</SYMBOL>
              </expr>
              <OP-DOLLAR line1="68" col1="55" line2="68" col2="55" start="12023" end="12023">$</OP-DOLLAR>
              <SYMBOL line1="68" col1="56" line2="68" col2="67" start="12024" end="12035">size.factors</SYMBOL>
            </expr>
            <OP-COMMA line1="68" col1="68" line2="68" col2="68" start="12036" end="12036">,</OP-COMMA>
            <SYMBOL_SUB line1="69" col1="30" line2="69" col2="44" start="12174" end="12188">size_factor_idx</SYMBOL_SUB>
            <EQ_SUB line1="69" col1="46" line2="69" col2="46" start="12190" end="12190">=</EQ_SUB>
            <expr line1="69" col1="48" line2="69" col2="60" start="12192" end="12204">
              <expr line1="69" col1="48" line2="69" col2="54" start="12192" end="12198">
                <SYMBOL line1="69" col1="48" line2="69" col2="54" start="12192" end="12198">sf_list</SYMBOL>
              </expr>
              <OP-DOLLAR line1="69" col1="55" line2="69" col2="55" start="12199" end="12199">$</OP-DOLLAR>
              <SYMBOL line1="69" col1="56" line2="69" col2="60" start="12200" end="12204">index</SYMBOL>
            </expr>
            <OP-COMMA line1="69" col1="61" line2="69" col2="61" start="12205" end="12205">,</OP-COMMA>
            <SYMBOL_SUB line1="70" col1="30" line2="70" col2="32" start="12350" end="12352">log</SYMBOL_SUB>
            <EQ_SUB line1="70" col1="34" line2="70" col2="34" start="12354" end="12354">=</EQ_SUB>
            <expr line1="70" col1="36" line2="70" col2="40" start="12356" end="12360">
              <NUM_CONST line1="70" col1="36" line2="70" col2="40" start="12356" end="12360">FALSE</NUM_CONST>
            </expr>
            <OP-COMMA line1="70" col1="41" line2="70" col2="41" start="12361" end="12361">,</OP-COMMA>
            <SYMBOL_SUB line1="70" col1="43" line2="70" col2="45" start="12363" end="12365">sum</SYMBOL_SUB>
            <EQ_SUB line1="70" col1="47" line2="70" col2="47" start="12367" end="12367">=</EQ_SUB>
            <expr line1="70" col1="49" line2="70" col2="53" start="12369" end="12373">
              <NUM_CONST line1="70" col1="49" line2="70" col2="53" start="12369" end="12373">FALSE</NUM_CONST>
            </expr>
            <OP-COMMA line1="70" col1="54" line2="70" col2="54" start="12374" end="12374">,</OP-COMMA>
            <SYMBOL_SUB line1="70" col1="56" line2="70" col2="69" start="12376" end="12389">logExprsOffset</SYMBOL_SUB>
            <EQ_SUB line1="70" col1="71" line2="70" col2="71" start="12391" end="12391">=</EQ_SUB>
            <expr line1="70" col1="73" line2="70" col2="73" start="12393" end="12393">
              <NUM_CONST line1="70" col1="73" line2="70" col2="73" start="12393" end="12393">0</NUM_CONST>
            </expr>
            <OP-COMMA line1="70" col1="74" line2="70" col2="74" start="12394" end="12394">,</OP-COMMA>
            <SYMBOL_SUB line1="71" col1="30" line2="71" col2="39" start="12526" end="12535">subset_row</SYMBOL_SUB>
            <EQ_SUB line1="71" col1="41" line2="71" col2="41" start="12537" end="12537">=</EQ_SUB>
            <expr line1="71" col1="43" line2="71" col2="52" start="12539" end="12548">
              <SYMBOL line1="71" col1="43" line2="71" col2="52" start="12539" end="12548">subset_row</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="71" col1="53" line2="71" col2="53" start="12549" end="12549">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="73" col1="5" line2="73" col2="50" start="12853" end="12898">
          <expr line1="73" col1="5" line2="73" col2="13" start="12853" end="12861">
            <SYMBOL line1="73" col1="5" line2="73" col2="13" start="12853" end="12861">lib_sizes</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="73" col1="15" line2="73" col2="16" start="12863" end="12864">&lt;-</LEFT_ASSIGN>
          <expr line1="73" col1="18" line2="73" col2="50" start="12866" end="12898">
            <expr line1="73" col1="18" line2="73" col2="25" start="12866" end="12873">
              <SYMBOL_FUNCTION_CALL line1="73" col1="18" line2="73" col2="25" start="12866" end="12873">colSums2</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="73" col1="26" line2="73" col2="26" start="12874" end="12874">(</OP-LEFT-PAREN>
            <expr line1="73" col1="27" line2="73" col2="49" start="12875" end="12897">
              <expr line1="73" col1="27" line2="73" col2="38" start="12875" end="12886">
                <SYMBOL_FUNCTION_CALL line1="73" col1="27" line2="73" col2="38" start="12875" end="12886">DelayedArray</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="73" col1="39" line2="73" col2="39" start="12887" end="12887">(</OP-LEFT-PAREN>
              <expr line1="73" col1="40" line2="73" col2="48" start="12888" end="12896">
                <SYMBOL line1="73" col1="40" line2="73" col2="48" start="12888" end="12896">extracted</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="73" col1="49" line2="73" col2="49" start="12897" end="12897">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="73" col1="50" line2="73" col2="50" start="12898" end="12898">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="74" col1="5" line2="74" col2="45" start="13029" end="13069">
          <expr line1="74" col1="5" line2="74" col2="11" start="13029" end="13035">
            <SYMBOL line1="74" col1="5" line2="74" col2="11" start="13029" end="13035">cpm_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="74" col1="13" line2="74" col2="14" start="13037" end="13038">&lt;-</LEFT_ASSIGN>
          <expr line1="74" col1="16" line2="74" col2="45" start="13040" end="13069">
            <expr line1="74" col1="16" line2="74" col2="21" start="13040" end="13045">
              <SYMBOL line1="74" col1="16" line2="74" col2="21" start="13040" end="13045">normed</SYMBOL>
            </expr>
            <OP-SLASH line1="74" col1="23" line2="74" col2="23" start="13047" end="13047">/</OP-SLASH>
            <expr line1="74" col1="25" line2="74" col2="45" start="13049" end="13069">
              <OP-LEFT-PAREN line1="74" col1="25" line2="74" col2="25" start="13049" end="13049">(</OP-LEFT-PAREN>
              <expr line1="74" col1="26" line2="74" col2="44" start="13050" end="13068">
                <expr line1="74" col1="26" line2="74" col2="40" start="13050" end="13064">
                  <expr line1="74" col1="26" line2="74" col2="29" start="13050" end="13053">
                    <SYMBOL_FUNCTION_CALL line1="74" col1="26" line2="74" col2="29" start="13050" end="13053">mean</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="74" col1="30" line2="74" col2="30" start="13054" end="13054">(</OP-LEFT-PAREN>
                  <expr line1="74" col1="31" line2="74" col2="39" start="13055" end="13063">
                    <SYMBOL line1="74" col1="31" line2="74" col2="39" start="13055" end="13063">lib_sizes</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="74" col1="40" line2="74" col2="40" start="13064" end="13064">)</OP-RIGHT-PAREN>
                </expr>
                <OP-SLASH line1="74" col1="41" line2="74" col2="41" start="13065" end="13065">/</OP-SLASH>
                <expr line1="74" col1="42" line2="74" col2="44" start="13066" end="13068">
                  <NUM_CONST line1="74" col1="42" line2="74" col2="44" start="13066" end="13068">1e6</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="74" col1="45" line2="74" col2="45" start="13069" end="13069">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="75" col1="5" line2="75" col2="19" start="13205" end="13219">
          <expr line1="75" col1="5" line2="75" col2="10" start="13205" end="13210">
            <SYMBOL_FUNCTION_CALL line1="75" col1="5" line2="75" col2="10" start="13205" end="13210">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="75" col1="11" line2="75" col2="11" start="13211" end="13211">(</OP-LEFT-PAREN>
          <expr line1="75" col1="12" line2="75" col2="18" start="13212" end="13218">
            <SYMBOL line1="75" col1="12" line2="75" col2="18" start="13212" end="13218">cpm_mat</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="75" col1="19" line2="75" col2="19" start="13219" end="13219">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="76" col1="1" line2="76" col2="1" start="13377" end="13377">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

