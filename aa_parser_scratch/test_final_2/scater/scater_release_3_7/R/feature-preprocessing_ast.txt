<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="34" start="159" end="192">## summarise and annotate features</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="80" start="475" end="554">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="62" start="791" end="852">## Function to get feature annotation information from biomaRt</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="50" start="1107" end="1156">#' Get feature annotation information from Biomart</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="3" start="1265" end="1267">#' </COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="113" start="1423" end="1535">#' Use the \pkg{biomaRt} package to add feature annotation information to an \code{\link{SingleCellExperiment}}. </COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="3" start="1581" end="1583">#' </COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="54" start="1739" end="1792">#' @param object A \code{SingleCellExperiment} object.</COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="109" start="1897" end="2005">#' @param filters Character vector defining the filters to pass to the \code{\link[biomaRt]{getBM}} function.</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="102" start="2055" end="2156">#' @param attributes Character vector defining the attributes to pass to \code{\link[biomaRt]{getBM}}.</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="117" start="2213" end="2329">#' @param feature_symbol String specifying the attribute to be used to define the symbol to be used for each feature </COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="132" start="2371" end="2502">#' Default is \code{"mgi_symbol"}, using gene symbols for mouse - this should be changed if the organism is not \emph{Mus musculus}.</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="109" start="2529" end="2637">#' @param feature_id String specifying the attribute to be used to define the ID to be used for each feature.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="67" start="2687" end="2753">#' Default is \code{"ensembl_gene_id"}, using the Ensembl gene IDs.</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="105" start="2845" end="2949">#' @param biomart String defining the biomaRt to be used, to be passed to \code{\link[biomaRt]{useMart}}.</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="44" start="3003" end="3046">#' Default is \code{"ENSEMBL_MART_ENSEMBL"}.</COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="101" start="3161" end="3261">#' @param dataset String defining the dataset to use, to be passed to \code{\link[biomaRt]{useMart}}.</COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="100" start="3319" end="3418">#' Default is \code{"mmusculus_gene_ensembl"}, which should be changed if the organism is not mouse.</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="138" start="3477" end="3614">#' @param host Character string argument which can be used to select a particular \code{"host"} to pass to \code{\link[biomaRt]{useMart}}.</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="59" start="3635" end="3693">#' Useful for accessing archived versions of biomaRt data. </COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="121" start="3793" end="3913">#' Default is \code{"www.ensembl.org"}, in which case the current version of the biomaRt (now hosted by Ensembl) is used.</COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="3" start="3951" end="3953">#' </COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="71" start="4109" end="4179">#' @return A SingleCellExperiment object containing feature annotation.</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="121" start="4267" end="4387">#' The input \code{feature_symbol} appears as the \code{feature_symbol} field in the \code{rowData} of the output object.</COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="3" start="4425" end="4427">#' </COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="10" start="4583" end="4592">#' @export</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="3" start="4741" end="4743">#' </COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="12" start="4899" end="4910">#' @examples</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="12" start="5057" end="5068">#' \dontrun{</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="38" start="5215" end="5252">#' object &lt;- getBMFeatureAnnos(object)</COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="4" start="5373" end="5376">#' }</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="3" start="5531" end="5533">#' </COMMENT>
  <expr line1="36" col1="1" line2="91" col2="1" start="5689" end="14379">
    <expr line1="36" col1="1" line2="36" col2="17" start="5689" end="5705">
      <SYMBOL line1="36" col1="1" line2="36" col2="17" start="5689" end="5705">getBMFeatureAnnos</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="36" col1="19" line2="36" col2="20" start="5707" end="5708">&lt;-</LEFT_ASSIGN>
    <expr line1="36" col1="22" line2="91" col2="1" start="5710" end="14379">
      <FUNCTION line1="36" col1="22" line2="36" col2="29" start="5710" end="5717">function</FUNCTION>
      <OP-LEFT-PAREN line1="36" col1="30" line2="36" col2="30" start="5718" end="5718">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="36" col1="31" line2="36" col2="36" start="5719" end="5724">object</SYMBOL_FORMALS>
      <OP-COMMA line1="36" col1="37" line2="36" col2="37" start="5725" end="5725">,</OP-COMMA>
      <SYMBOL_FORMALS line1="36" col1="39" line2="36" col2="45" start="5727" end="5733">filters</SYMBOL_FORMALS>
      <EQ_FORMALS line1="36" col1="46" line2="36" col2="46" start="5734" end="5734">=</EQ_FORMALS>
      <expr line1="36" col1="47" line2="36" col2="69" start="5735" end="5757">
        <STR_CONST line1="36" col1="47" line2="36" col2="69" start="5735" end="5757">"ensembl_transcript_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="36" col1="70" line2="36" col2="70" start="5758" end="5758">,</OP-COMMA>
      <SYMBOL_FORMALS line1="37" col1="31" line2="37" col2="40" start="5877" end="5886">attributes</SYMBOL_FORMALS>
      <EQ_FORMALS line1="37" col1="41" line2="37" col2="41" start="5887" end="5887">=</EQ_FORMALS>
      <expr line1="37" col1="42" line2="41" col2="62" start="5888" end="6540">
        <expr line1="37" col1="42" line2="37" col2="42" start="5888" end="5888">
          <SYMBOL_FUNCTION_CALL line1="37" col1="42" line2="37" col2="42" start="5888" end="5888">c</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="37" col1="43" line2="37" col2="43" start="5889" end="5889">(</OP-LEFT-PAREN>
        <expr line1="37" col1="44" line2="37" col2="66" start="5890" end="5912">
          <STR_CONST line1="37" col1="44" line2="37" col2="66" start="5890" end="5912">"ensembl_transcript_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="37" col1="67" line2="37" col2="67" start="5913" end="5913">,</OP-COMMA>
        <expr line1="38" col1="44" line2="38" col2="60" start="6048" end="6064">
          <STR_CONST line1="38" col1="44" line2="38" col2="60" start="6048" end="6064">"ensembl_gene_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="38" col1="61" line2="38" col2="61" start="6065" end="6065">,</OP-COMMA>
        <expr line1="38" col1="63" line2="38" col2="76" start="6067" end="6080">
          <SYMBOL line1="38" col1="63" line2="38" col2="76" start="6067" end="6080">feature_symbol</SYMBOL>
        </expr>
        <OP-COMMA line1="38" col1="77" line2="38" col2="77" start="6081" end="6081">,</OP-COMMA>
        <expr line1="39" col1="44" line2="39" col2="60" start="6206" end="6222">
          <STR_CONST line1="39" col1="44" line2="39" col2="60" start="6206" end="6222">"chromosome_name"</STR_CONST>
        </expr>
        <OP-COMMA line1="39" col1="61" line2="39" col2="61" start="6223" end="6223">,</OP-COMMA>
        <expr line1="39" col1="63" line2="39" col2="82" start="6225" end="6244">
          <STR_CONST line1="39" col1="63" line2="39" col2="82" start="6225" end="6244">"transcript_biotype"</STR_CONST>
        </expr>
        <OP-COMMA line1="39" col1="83" line2="39" col2="83" start="6245" end="6245">,</OP-COMMA>
        <expr line1="40" col1="44" line2="40" col2="61" start="6364" end="6381">
          <STR_CONST line1="40" col1="44" line2="40" col2="61" start="6364" end="6381">"transcript_start"</STR_CONST>
        </expr>
        <OP-COMMA line1="40" col1="62" line2="40" col2="62" start="6382" end="6382">,</OP-COMMA>
        <expr line1="40" col1="64" line2="40" col2="79" start="6384" end="6399">
          <STR_CONST line1="40" col1="64" line2="40" col2="79" start="6384" end="6399">"transcript_end"</STR_CONST>
        </expr>
        <OP-COMMA line1="40" col1="80" line2="40" col2="80" start="6400" end="6400">,</OP-COMMA>
        <expr line1="41" col1="44" line2="41" col2="61" start="6522" end="6539">
          <STR_CONST line1="41" col1="44" line2="41" col2="61" start="6522" end="6539">"transcript_count"</STR_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="41" col1="62" line2="41" col2="62" start="6540" end="6540">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="41" col1="63" line2="41" col2="63" start="6541" end="6541">,</OP-COMMA>
      <SYMBOL_FORMALS line1="42" col1="31" line2="42" col2="44" start="6667" end="6680">feature_symbol</SYMBOL_FORMALS>
      <EQ_FORMALS line1="42" col1="45" line2="42" col2="45" start="6681" end="6681">=</EQ_FORMALS>
      <expr line1="42" col1="46" line2="42" col2="57" start="6682" end="6693">
        <STR_CONST line1="42" col1="46" line2="42" col2="57" start="6682" end="6693">"mgi_symbol"</STR_CONST>
      </expr>
      <OP-COMMA line1="42" col1="58" line2="42" col2="58" start="6694" end="6694">,</OP-COMMA>
      <SYMBOL_FORMALS line1="43" col1="31" line2="43" col2="40" start="6825" end="6834">feature_id</SYMBOL_FORMALS>
      <EQ_FORMALS line1="43" col1="41" line2="43" col2="41" start="6835" end="6835">=</EQ_FORMALS>
      <expr line1="43" col1="42" line2="43" col2="58" start="6836" end="6852">
        <STR_CONST line1="43" col1="42" line2="43" col2="58" start="6836" end="6852">"ensembl_gene_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="43" col1="59" line2="43" col2="59" start="6853" end="6853">,</OP-COMMA>
      <SYMBOL_FORMALS line1="44" col1="31" line2="44" col2="37" start="6983" end="6989">biomart</SYMBOL_FORMALS>
      <EQ_FORMALS line1="44" col1="38" line2="44" col2="38" start="6990" end="6990">=</EQ_FORMALS>
      <expr line1="44" col1="39" line2="44" col2="60" start="6991" end="7012">
        <STR_CONST line1="44" col1="39" line2="44" col2="60" start="6991" end="7012">"ENSEMBL_MART_ENSEMBL"</STR_CONST>
      </expr>
      <OP-COMMA line1="44" col1="61" line2="44" col2="61" start="7013" end="7013">,</OP-COMMA>
      <SYMBOL_FORMALS line1="45" col1="31" line2="45" col2="37" start="7141" end="7147">dataset</SYMBOL_FORMALS>
      <EQ_FORMALS line1="45" col1="38" line2="45" col2="38" start="7148" end="7148">=</EQ_FORMALS>
      <expr line1="45" col1="39" line2="45" col2="62" start="7149" end="7172">
        <STR_CONST line1="45" col1="39" line2="45" col2="62" start="7149" end="7172">"mmusculus_gene_ensembl"</STR_CONST>
      </expr>
      <OP-COMMA line1="45" col1="63" line2="45" col2="63" start="7173" end="7173">,</OP-COMMA>
      <SYMBOL_FORMALS line1="46" col1="31" line2="46" col2="34" start="7299" end="7302">host</SYMBOL_FORMALS>
      <EQ_FORMALS line1="46" col1="35" line2="46" col2="35" start="7303" end="7303">=</EQ_FORMALS>
      <expr line1="46" col1="36" line2="46" col2="52" start="7304" end="7320">
        <STR_CONST line1="46" col1="36" line2="46" col2="52" start="7304" end="7320">"www.ensembl.org"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="46" col1="53" line2="46" col2="53" start="7321" end="7321">)</OP-RIGHT-PAREN>
      <expr line1="46" col1="55" line2="91" col2="1" start="7323" end="14379">
        <OP-LEFT-BRACE line1="46" col1="55" line2="46" col2="55" start="7323" end="7323">{</OP-LEFT-BRACE>
        <COMMENT line1="47" col1="5" line2="47" col2="33" start="7431" end="7459">## Define Biomart Mart to use</COMMENT>
        <expr line1="48" col1="5" line2="52" col2="46" start="7589" end="8262">
          <IF line1="48" col1="5" line2="48" col2="6" start="7589" end="7590">if</IF>
          <OP-LEFT-PAREN line1="48" col1="8" line2="48" col2="8" start="7592" end="7592">(</OP-LEFT-PAREN>
          <expr line1="48" col1="10" line2="48" col2="22" start="7594" end="7606">
            <expr line1="48" col1="10" line2="48" col2="16" start="7594" end="7600">
              <SYMBOL_FUNCTION_CALL line1="48" col1="10" line2="48" col2="16" start="7594" end="7600">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="48" col1="17" line2="48" col2="17" start="7601" end="7601">(</OP-LEFT-PAREN>
            <expr line1="48" col1="18" line2="48" col2="21" start="7602" end="7605">
              <SYMBOL line1="48" col1="18" line2="48" col2="21" start="7602" end="7605">host</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="48" col1="22" line2="48" col2="22" start="7606" end="7606">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="48" col1="24" line2="48" col2="24" start="7608" end="7608">)</OP-RIGHT-PAREN>
          <expr line1="49" col1="9" line2="49" col2="71" start="7751" end="7813">
            <expr line1="49" col1="9" line2="49" col2="13" start="7751" end="7755">
              <SYMBOL line1="49" col1="9" line2="49" col2="13" start="7751" end="7755">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="49" col1="15" line2="49" col2="16" start="7757" end="7758">&lt;-</LEFT_ASSIGN>
            <expr line1="49" col1="18" line2="49" col2="71" start="7760" end="7813">
              <expr line1="49" col1="18" line2="49" col2="33" start="7760" end="7775">
                <SYMBOL_PACKAGE line1="49" col1="18" line2="49" col2="24" start="7760" end="7766">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="49" col1="25" line2="49" col2="26" start="7767" end="7768">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="49" col1="27" line2="49" col2="33" start="7769" end="7775">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="49" col1="34" line2="49" col2="34" start="7776" end="7776">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="49" col1="35" line2="49" col2="41" start="7777" end="7783">biomart</SYMBOL_SUB>
              <EQ_SUB line1="49" col1="43" line2="49" col2="43" start="7785" end="7785">=</EQ_SUB>
              <expr line1="49" col1="45" line2="49" col2="51" start="7787" end="7793">
                <SYMBOL line1="49" col1="45" line2="49" col2="51" start="7787" end="7793">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="49" col1="52" line2="49" col2="52" start="7794" end="7794">,</OP-COMMA>
              <SYMBOL_SUB line1="49" col1="54" line2="49" col2="60" start="7796" end="7802">dataset</SYMBOL_SUB>
              <EQ_SUB line1="49" col1="62" line2="49" col2="62" start="7804" end="7804">=</EQ_SUB>
              <expr line1="49" col1="64" line2="49" col2="70" start="7806" end="7812">
                <SYMBOL line1="49" col1="64" line2="49" col2="70" start="7806" end="7812">dataset</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="49" col1="71" line2="49" col2="71" start="7813" end="7813">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <ELSE line1="50" col1="5" line2="50" col2="8" start="7905" end="7908">else</ELSE>
          <expr line1="51" col1="9" line2="52" col2="46" start="8067" end="8262">
            <expr line1="51" col1="9" line2="51" col2="13" start="8067" end="8071">
              <SYMBOL line1="51" col1="9" line2="51" col2="13" start="8067" end="8071">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="51" col1="15" line2="51" col2="16" start="8073" end="8074">&lt;-</LEFT_ASSIGN>
            <expr line1="51" col1="18" line2="52" col2="46" start="8076" end="8262">
              <expr line1="51" col1="18" line2="51" col2="33" start="8076" end="8091">
                <SYMBOL_PACKAGE line1="51" col1="18" line2="51" col2="24" start="8076" end="8082">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="51" col1="25" line2="51" col2="26" start="8083" end="8084">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="51" col1="27" line2="51" col2="33" start="8085" end="8091">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="51" col1="34" line2="51" col2="34" start="8092" end="8092">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="51" col1="35" line2="51" col2="41" start="8093" end="8099">biomart</SYMBOL_SUB>
              <EQ_SUB line1="51" col1="43" line2="51" col2="43" start="8101" end="8101">=</EQ_SUB>
              <expr line1="51" col1="45" line2="51" col2="51" start="8103" end="8109">
                <SYMBOL line1="51" col1="45" line2="51" col2="51" start="8103" end="8109">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="51" col1="52" line2="51" col2="52" start="8110" end="8110">,</OP-COMMA>
              <SYMBOL_SUB line1="51" col1="54" line2="51" col2="60" start="8112" end="8118">dataset</SYMBOL_SUB>
              <EQ_SUB line1="51" col1="62" line2="51" col2="62" start="8120" end="8120">=</EQ_SUB>
              <expr line1="51" col1="64" line2="51" col2="70" start="8122" end="8128">
                <SYMBOL line1="51" col1="64" line2="51" col2="70" start="8122" end="8128">dataset</SYMBOL>
              </expr>
              <OP-COMMA line1="51" col1="71" line2="51" col2="71" start="8129" end="8129">,</OP-COMMA>
              <SYMBOL_SUB line1="52" col1="35" line2="52" col2="38" start="8251" end="8254">host</SYMBOL_SUB>
              <EQ_SUB line1="52" col1="40" line2="52" col2="40" start="8256" end="8256">=</EQ_SUB>
              <expr line1="52" col1="42" line2="52" col2="45" start="8258" end="8261">
                <SYMBOL line1="52" col1="42" line2="52" col2="45" start="8258" end="8261">host</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="52" col1="46" line2="52" col2="46" start="8262" end="8262">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="53" col1="5" line2="53" col2="58" start="8379" end="8432">## Define feature IDs from SingleCellExperiment object</COMMENT>
        <expr line1="54" col1="5" line2="54" col2="35" start="8537" end="8567">
          <expr line1="54" col1="5" line2="54" col2="15" start="8537" end="8547">
            <SYMBOL line1="54" col1="5" line2="54" col2="15" start="8537" end="8547">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="54" col1="17" line2="54" col2="18" start="8549" end="8550">&lt;-</LEFT_ASSIGN>
          <expr line1="54" col1="20" line2="54" col2="35" start="8552" end="8567">
            <expr line1="54" col1="20" line2="54" col2="27" start="8552" end="8559">
              <SYMBOL_FUNCTION_CALL line1="54" col1="20" line2="54" col2="27" start="8552" end="8559">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="54" col1="28" line2="54" col2="28" start="8560" end="8560">(</OP-LEFT-PAREN>
            <expr line1="54" col1="29" line2="54" col2="34" start="8561" end="8566">
              <SYMBOL line1="54" col1="29" line2="54" col2="34" start="8561" end="8566">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="54" col1="35" line2="54" col2="35" start="8567" end="8567">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="55" col1="5" line2="55" col2="104" start="8695" end="8794">## Remove transcript ID artifacts from runKallisto (eg. ENSMUST00000201087.11 -&gt; ENSMUST00000201087)</COMMENT>
        <expr line1="56" col1="5" line2="56" col2="81" start="8853" end="8929">
          <expr line1="56" col1="5" line2="56" col2="15" start="8853" end="8863">
            <SYMBOL line1="56" col1="5" line2="56" col2="15" start="8853" end="8863">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="56" col1="17" line2="56" col2="18" start="8865" end="8866">&lt;-</LEFT_ASSIGN>
          <expr line1="56" col1="20" line2="56" col2="81" start="8868" end="8929">
            <expr line1="56" col1="20" line2="56" col2="23" start="8868" end="8871">
              <SYMBOL_FUNCTION_CALL line1="56" col1="20" line2="56" col2="23" start="8868" end="8871">gsub</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="56" col1="24" line2="56" col2="24" start="8872" end="8872">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="56" col1="25" line2="56" col2="31" start="8873" end="8879">pattern</SYMBOL_SUB>
            <EQ_SUB line1="56" col1="33" line2="56" col2="33" start="8881" end="8881">=</EQ_SUB>
            <expr line1="56" col1="35" line2="56" col2="45" start="8883" end="8893">
              <STR_CONST line1="56" col1="35" line2="56" col2="45" start="8883" end="8893">"\\.[0-9]+"</STR_CONST>
            </expr>
            <OP-COMMA line1="56" col1="46" line2="56" col2="46" start="8894" end="8894">,</OP-COMMA>
            <SYMBOL_SUB line1="56" col1="48" line2="56" col2="58" start="8896" end="8906">replacement</SYMBOL_SUB>
            <EQ_SUB line1="56" col1="60" line2="56" col2="60" start="8908" end="8908">=</EQ_SUB>
            <expr line1="56" col1="62" line2="56" col2="63" start="8910" end="8911">
              <STR_CONST line1="56" col1="62" line2="56" col2="63" start="8910" end="8911">""</STR_CONST>
            </expr>
            <OP-COMMA line1="56" col1="64" line2="56" col2="64" start="8912" end="8912">,</OP-COMMA>
            <SYMBOL_SUB line1="56" col1="66" line2="56" col2="66" start="8914" end="8914">x</SYMBOL_SUB>
            <EQ_SUB line1="56" col1="68" line2="56" col2="68" start="8916" end="8916">=</EQ_SUB>
            <expr line1="56" col1="70" line2="56" col2="80" start="8918" end="8928">
              <SYMBOL line1="56" col1="70" line2="56" col2="80" start="8918" end="8928">feature_ids</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="56" col1="81" line2="56" col2="81" start="8929" end="8929">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="57" col1="5" line2="57" col2="35" start="9011" end="9041">## Get annotations from biomaRt</COMMENT>
        <expr line1="58" col1="5" line2="60" col2="70" start="9169" end="9550">
          <expr line1="58" col1="5" line2="58" col2="16" start="9169" end="9180">
            <SYMBOL line1="58" col1="5" line2="58" col2="16" start="9169" end="9180">feature_info</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="58" col1="18" line2="58" col2="19" start="9182" end="9183">&lt;-</LEFT_ASSIGN>
          <expr line1="58" col1="21" line2="60" col2="70" start="9185" end="9550">
            <expr line1="58" col1="21" line2="58" col2="34" start="9185" end="9198">
              <SYMBOL_PACKAGE line1="58" col1="21" line2="58" col2="27" start="9185" end="9191">biomaRt</SYMBOL_PACKAGE>
              <NS_GET line1="58" col1="28" line2="58" col2="29" start="9192" end="9193">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="58" col1="30" line2="58" col2="34" start="9194" end="9198">getBM</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="58" col1="35" line2="58" col2="35" start="9199" end="9199">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="58" col1="36" line2="58" col2="45" start="9200" end="9209">attributes</SYMBOL_SUB>
            <EQ_SUB line1="58" col1="47" line2="58" col2="47" start="9211" end="9211">=</EQ_SUB>
            <expr line1="58" col1="49" line2="58" col2="58" start="9213" end="9222">
              <SYMBOL line1="58" col1="49" line2="58" col2="58" start="9213" end="9222">attributes</SYMBOL>
            </expr>
            <OP-COMMA line1="58" col1="59" line2="58" col2="59" start="9223" end="9223">,</OP-COMMA>
            <SYMBOL_SUB line1="59" col1="36" line2="59" col2="42" start="9358" end="9364">filters</SYMBOL_SUB>
            <EQ_SUB line1="59" col1="44" line2="59" col2="44" start="9366" end="9366">=</EQ_SUB>
            <expr line1="59" col1="46" line2="59" col2="52" start="9368" end="9374">
              <SYMBOL line1="59" col1="46" line2="59" col2="52" start="9368" end="9374">filters</SYMBOL>
            </expr>
            <OP-COMMA line1="59" col1="53" line2="59" col2="53" start="9375" end="9375">,</OP-COMMA>
            <SYMBOL_SUB line1="60" col1="36" line2="60" col2="41" start="9516" end="9521">values</SYMBOL_SUB>
            <EQ_SUB line1="60" col1="43" line2="60" col2="43" start="9523" end="9523">=</EQ_SUB>
            <expr line1="60" col1="45" line2="60" col2="55" start="9525" end="9535">
              <SYMBOL line1="60" col1="45" line2="60" col2="55" start="9525" end="9535">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="60" col1="56" line2="60" col2="56" start="9536" end="9536">,</OP-COMMA>
            <SYMBOL_SUB line1="60" col1="58" line2="60" col2="61" start="9538" end="9541">mart</SYMBOL_SUB>
            <EQ_SUB line1="60" col1="63" line2="60" col2="63" start="9543" end="9543">=</EQ_SUB>
            <expr line1="60" col1="65" line2="60" col2="69" start="9545" end="9549">
              <SYMBOL line1="60" col1="65" line2="60" col2="69" start="9545" end="9549">bmart</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="60" col1="70" line2="60" col2="70" start="9550" end="9550">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="61" col1="5" line2="61" col2="77" start="9643" end="9715">## Match the feature ids to the filters ids used to get info from biomaRt</COMMENT>
        <expr line1="62" col1="5" line2="62" col2="53" start="9801" end="9849">
          <expr line1="62" col1="5" line2="62" col2="6" start="9801" end="9802">
            <SYMBOL line1="62" col1="5" line2="62" col2="6" start="9801" end="9802">mm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="62" col1="8" line2="62" col2="9" start="9804" end="9805">&lt;-</LEFT_ASSIGN>
          <expr line1="62" col1="11" line2="62" col2="53" start="9807" end="9849">
            <expr line1="62" col1="11" line2="62" col2="15" start="9807" end="9811">
              <SYMBOL_FUNCTION_CALL line1="62" col1="11" line2="62" col2="15" start="9807" end="9811">match</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="62" col1="16" line2="62" col2="16" start="9812" end="9812">(</OP-LEFT-PAREN>
            <expr line1="62" col1="17" line2="62" col2="27" start="9813" end="9823">
              <SYMBOL line1="62" col1="17" line2="62" col2="27" start="9813" end="9823">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="62" col1="28" line2="62" col2="28" start="9824" end="9824">,</OP-COMMA>
            <expr line1="62" col1="30" line2="62" col2="52" start="9826" end="9848">
              <expr line1="62" col1="30" line2="62" col2="41" start="9826" end="9837">
                <SYMBOL line1="62" col1="30" line2="62" col2="41" start="9826" end="9837">feature_info</SYMBOL>
              </expr>
              <LBB line1="62" col1="42" line2="62" col2="43" start="9838" end="9839">[[</LBB>
              <expr line1="62" col1="44" line2="62" col2="50" start="9840" end="9846">
                <SYMBOL line1="62" col1="44" line2="62" col2="50" start="9840" end="9846">filters</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="62" col1="51" line2="62" col2="51" start="9847" end="9847">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="62" col1="52" line2="62" col2="52" start="9848" end="9848">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="62" col1="53" line2="62" col2="53" start="9849" end="9849">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="63" col1="5" line2="63" col2="43" start="9959" end="9997">
          <expr line1="63" col1="5" line2="63" col2="21" start="9959" end="9975">
            <SYMBOL line1="63" col1="5" line2="63" col2="21" start="9959" end="9975">feature_info_full</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="63" col1="23" line2="63" col2="24" start="9977" end="9978">&lt;-</LEFT_ASSIGN>
          <expr line1="63" col1="26" line2="63" col2="43" start="9980" end="9997">
            <expr line1="63" col1="26" line2="63" col2="37" start="9980" end="9991">
              <SYMBOL line1="63" col1="26" line2="63" col2="37" start="9980" end="9991">feature_info</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="63" col1="38" line2="63" col2="38" start="9992" end="9992">[</OP-LEFT-BRACKET>
            <expr line1="63" col1="39" line2="63" col2="40" start="9993" end="9994">
              <SYMBOL line1="63" col1="39" line2="63" col2="40" start="9993" end="9994">mm</SYMBOL>
            </expr>
            <OP-COMMA line1="63" col1="41" line2="63" col2="41" start="9995" end="9995">,</OP-COMMA>
            <OP-RIGHT-BRACKET line1="63" col1="43" line2="63" col2="43" start="9997" end="9997">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="64" col1="5" line2="64" col2="46" start="10117" end="10158">
          <expr line1="64" col1="5" line2="64" col2="31" start="10117" end="10143">
            <expr line1="64" col1="5" line2="64" col2="12" start="10117" end="10124">
              <SYMBOL_FUNCTION_CALL line1="64" col1="5" line2="64" col2="12" start="10117" end="10124">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="64" col1="13" line2="64" col2="13" start="10125" end="10125">(</OP-LEFT-PAREN>
            <expr line1="64" col1="14" line2="64" col2="30" start="10126" end="10142">
              <SYMBOL line1="64" col1="14" line2="64" col2="30" start="10126" end="10142">feature_info_full</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="64" col1="31" line2="64" col2="31" start="10143" end="10143">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="64" col1="33" line2="64" col2="34" start="10145" end="10146">&lt;-</LEFT_ASSIGN>
          <expr line1="64" col1="36" line2="64" col2="46" start="10148" end="10158">
            <SYMBOL line1="64" col1="36" line2="64" col2="46" start="10148" end="10158">feature_ids</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="65" col1="5" line2="65" col2="37" start="10275" end="10307">## Define gene symbol and gene id</COMMENT>
        <expr line1="66" col1="5" line2="66" col2="75" start="10433" end="10503">
          <expr line1="66" col1="5" line2="66" col2="36" start="10433" end="10464">
            <expr line1="66" col1="5" line2="66" col2="21" start="10433" end="10449">
              <SYMBOL line1="66" col1="5" line2="66" col2="21" start="10433" end="10449">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="66" col1="22" line2="66" col2="22" start="10450" end="10450">$</OP-DOLLAR>
            <SYMBOL line1="66" col1="23" line2="66" col2="36" start="10451" end="10464">feature_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="66" col1="38" line2="66" col2="39" start="10466" end="10467">&lt;-</LEFT_ASSIGN>
          <expr line1="66" col1="41" line2="66" col2="75" start="10469" end="10503">
            <expr line1="66" col1="41" line2="66" col2="57" start="10469" end="10485">
              <SYMBOL line1="66" col1="41" line2="66" col2="57" start="10469" end="10485">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="66" col1="58" line2="66" col2="59" start="10486" end="10487">[[</LBB>
            <expr line1="66" col1="60" line2="66" col2="73" start="10488" end="10501">
              <SYMBOL line1="66" col1="60" line2="66" col2="73" start="10488" end="10501">feature_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="66" col1="74" line2="66" col2="74" start="10502" end="10502">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="66" col1="75" line2="66" col2="75" start="10503" end="10503">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="67" col1="5" line2="67" col2="67" start="10591" end="10653">
          <expr line1="67" col1="5" line2="67" col2="32" start="10591" end="10618">
            <expr line1="67" col1="5" line2="67" col2="21" start="10591" end="10607">
              <SYMBOL line1="67" col1="5" line2="67" col2="21" start="10591" end="10607">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="67" col1="22" line2="67" col2="22" start="10608" end="10608">$</OP-DOLLAR>
            <SYMBOL line1="67" col1="23" line2="67" col2="32" start="10609" end="10618">feature_id</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="67" col1="34" line2="67" col2="35" start="10620" end="10621">&lt;-</LEFT_ASSIGN>
          <expr line1="67" col1="37" line2="67" col2="67" start="10623" end="10653">
            <expr line1="67" col1="37" line2="67" col2="53" start="10623" end="10639">
              <SYMBOL line1="67" col1="37" line2="67" col2="53" start="10623" end="10639">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="67" col1="54" line2="67" col2="55" start="10640" end="10641">[[</LBB>
            <expr line1="67" col1="56" line2="67" col2="65" start="10642" end="10651">
              <SYMBOL line1="67" col1="56" line2="67" col2="65" start="10642" end="10651">feature_id</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="67" col1="66" line2="67" col2="66" start="10652" end="10652">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="67" col1="67" line2="67" col2="67" start="10653" end="10653">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="68" col1="5" line2="68" col2="61" start="10749" end="10805">## Use rownames for gene symbol if gene symbol is missing</COMMENT>
        <expr line1="69" col1="5" line2="70" col2="61" start="10907" end="11121">
          <expr line1="69" col1="5" line2="69" col2="13" start="10907" end="10915">
            <SYMBOL line1="69" col1="5" line2="69" col2="13" start="10907" end="10915">na_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="69" col1="15" line2="69" col2="16" start="10917" end="10918">&lt;-</LEFT_ASSIGN>
          <expr line1="69" col1="18" line2="70" col2="61" start="10920" end="11121">
            <OP-LEFT-PAREN line1="69" col1="18" line2="69" col2="18" start="10920" end="10920">(</OP-LEFT-PAREN>
            <expr line1="69" col1="19" line2="70" col2="60" start="10921" end="11120">
              <expr line1="69" col1="19" line2="69" col2="57" start="10921" end="10959">
                <expr line1="69" col1="19" line2="69" col2="23" start="10921" end="10925">
                  <SYMBOL_FUNCTION_CALL line1="69" col1="19" line2="69" col2="23" start="10921" end="10925">is.na</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="69" col1="24" line2="69" col2="24" start="10926" end="10926">(</OP-LEFT-PAREN>
                <expr line1="69" col1="25" line2="69" col2="56" start="10927" end="10958">
                  <expr line1="69" col1="25" line2="69" col2="41" start="10927" end="10943">
                    <SYMBOL line1="69" col1="25" line2="69" col2="41" start="10927" end="10943">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="69" col1="42" line2="69" col2="42" start="10944" end="10944">$</OP-DOLLAR>
                  <SYMBOL line1="69" col1="43" line2="69" col2="56" start="10945" end="10958">feature_symbol</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="69" col1="57" line2="69" col2="57" start="10959" end="10959">)</OP-RIGHT-PAREN>
              </expr>
              <OR line1="69" col1="59" line2="69" col2="59" start="10961" end="10961">|</OR>
              <expr line1="70" col1="23" line2="70" col2="60" start="11083" end="11120">
                <expr line1="70" col1="23" line2="70" col2="54" start="11083" end="11114">
                  <expr line1="70" col1="23" line2="70" col2="39" start="11083" end="11099">
                    <SYMBOL line1="70" col1="23" line2="70" col2="39" start="11083" end="11099">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="70" col1="40" line2="70" col2="40" start="11100" end="11100">$</OP-DOLLAR>
                  <SYMBOL line1="70" col1="41" line2="70" col2="54" start="11101" end="11114">feature_symbol</SYMBOL>
                </expr>
                <EQ line1="70" col1="56" line2="70" col2="57" start="11116" end="11117">==</EQ>
                <expr line1="70" col1="59" line2="70" col2="60" start="11119" end="11120">
                  <STR_CONST line1="70" col1="59" line2="70" col2="60" start="11119" end="11120">""</STR_CONST>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="70" col1="61" line2="70" col2="61" start="11121" end="11121">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="71" col1="5" line2="72" col2="46" start="11223" end="11422">
          <expr line1="71" col1="5" line2="71" col2="47" start="11223" end="11265">
            <expr line1="71" col1="5" line2="71" col2="36" start="11223" end="11254">
              <expr line1="71" col1="5" line2="71" col2="21" start="11223" end="11239">
                <SYMBOL line1="71" col1="5" line2="71" col2="21" start="11223" end="11239">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="71" col1="22" line2="71" col2="22" start="11240" end="11240">$</OP-DOLLAR>
              <SYMBOL line1="71" col1="23" line2="71" col2="36" start="11241" end="11254">feature_symbol</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="71" col1="37" line2="71" col2="37" start="11255" end="11255">[</OP-LEFT-BRACKET>
            <expr line1="71" col1="38" line2="71" col2="46" start="11256" end="11264">
              <SYMBOL line1="71" col1="38" line2="71" col2="46" start="11256" end="11264">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="71" col1="47" line2="71" col2="47" start="11265" end="11265">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="71" col1="49" line2="71" col2="50" start="11267" end="11268">&lt;-</LEFT_ASSIGN>
          <expr line1="72" col1="9" line2="72" col2="46" start="11385" end="11422">
            <expr line1="72" col1="9" line2="72" col2="35" start="11385" end="11411">
              <expr line1="72" col1="9" line2="72" col2="16" start="11385" end="11392">
                <SYMBOL_FUNCTION_CALL line1="72" col1="9" line2="72" col2="16" start="11385" end="11392">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="72" col1="17" line2="72" col2="17" start="11393" end="11393">(</OP-LEFT-PAREN>
              <expr line1="72" col1="18" line2="72" col2="34" start="11394" end="11410">
                <SYMBOL line1="72" col1="18" line2="72" col2="34" start="11394" end="11410">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="72" col1="35" line2="72" col2="35" start="11411" end="11411">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="72" col1="36" line2="72" col2="36" start="11412" end="11412">[</OP-LEFT-BRACKET>
            <expr line1="72" col1="37" line2="72" col2="45" start="11413" end="11421">
              <SYMBOL line1="72" col1="37" line2="72" col2="45" start="11413" end="11421">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="72" col1="46" line2="72" col2="46" start="11422" end="11422">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="73" col1="5" line2="73" col2="87" start="11539" end="11621">## Use rownames from SingleCellExperiment object (feature IDs) for feature_id if na</COMMENT>
        <expr line1="74" col1="5" line2="75" col2="72" start="11697" end="11922">
          <expr line1="74" col1="5" line2="74" col2="69" start="11697" end="11761">
            <expr line1="74" col1="5" line2="74" col2="32" start="11697" end="11724">
              <expr line1="74" col1="5" line2="74" col2="21" start="11697" end="11713">
                <SYMBOL line1="74" col1="5" line2="74" col2="21" start="11697" end="11713">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="74" col1="22" line2="74" col2="22" start="11714" end="11714">$</OP-DOLLAR>
              <SYMBOL line1="74" col1="23" line2="74" col2="32" start="11715" end="11724">feature_id</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="74" col1="33" line2="74" col2="33" start="11725" end="11725">[</OP-LEFT-BRACKET>
            <expr line1="74" col1="34" line2="74" col2="68" start="11726" end="11760">
              <expr line1="74" col1="34" line2="74" col2="38" start="11726" end="11730">
                <SYMBOL_FUNCTION_CALL line1="74" col1="34" line2="74" col2="38" start="11726" end="11730">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="74" col1="39" line2="74" col2="39" start="11731" end="11731">(</OP-LEFT-PAREN>
              <expr line1="74" col1="40" line2="74" col2="67" start="11732" end="11759">
                <expr line1="74" col1="40" line2="74" col2="56" start="11732" end="11748">
                  <SYMBOL line1="74" col1="40" line2="74" col2="56" start="11732" end="11748">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="74" col1="57" line2="74" col2="57" start="11749" end="11749">$</OP-DOLLAR>
                <SYMBOL line1="74" col1="58" line2="74" col2="67" start="11750" end="11759">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="74" col1="68" line2="74" col2="68" start="11760" end="11760">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="74" col1="69" line2="74" col2="69" start="11761" end="11761">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="74" col1="71" line2="74" col2="72" start="11763" end="11764">&lt;-</LEFT_ASSIGN>
          <expr line1="75" col1="9" line2="75" col2="72" start="11859" end="11922">
            <expr line1="75" col1="9" line2="75" col2="35" start="11859" end="11885">
              <expr line1="75" col1="9" line2="75" col2="16" start="11859" end="11866">
                <SYMBOL_FUNCTION_CALL line1="75" col1="9" line2="75" col2="16" start="11859" end="11866">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="75" col1="17" line2="75" col2="17" start="11867" end="11867">(</OP-LEFT-PAREN>
              <expr line1="75" col1="18" line2="75" col2="34" start="11868" end="11884">
                <SYMBOL line1="75" col1="18" line2="75" col2="34" start="11868" end="11884">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="75" col1="35" line2="75" col2="35" start="11885" end="11885">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="75" col1="36" line2="75" col2="36" start="11886" end="11886">[</OP-LEFT-BRACKET>
            <expr line1="75" col1="37" line2="75" col2="71" start="11887" end="11921">
              <expr line1="75" col1="37" line2="75" col2="41" start="11887" end="11891">
                <SYMBOL_FUNCTION_CALL line1="75" col1="37" line2="75" col2="41" start="11887" end="11891">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="75" col1="42" line2="75" col2="42" start="11892" end="11892">(</OP-LEFT-PAREN>
              <expr line1="75" col1="43" line2="75" col2="70" start="11893" end="11920">
                <expr line1="75" col1="43" line2="75" col2="59" start="11893" end="11909">
                  <SYMBOL line1="75" col1="43" line2="75" col2="59" start="11893" end="11909">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="75" col1="60" line2="75" col2="60" start="11910" end="11910">$</OP-DOLLAR>
                <SYMBOL line1="75" col1="61" line2="75" col2="70" start="11911" end="11920">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="75" col1="71" line2="75" col2="71" start="11921" end="11921">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="75" col1="72" line2="75" col2="72" start="11922" end="11922">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="76" col1="5" line2="76" col2="66" start="12013" end="12074">## Need to drop any duplicated columns that we want to replace</COMMENT>
        <expr line1="77" col1="5" line2="77" col2="32" start="12171" end="12198">
          <expr line1="77" col1="5" line2="77" col2="13" start="12171" end="12179">
            <SYMBOL line1="77" col1="5" line2="77" col2="13" start="12171" end="12179">old_rdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="77" col1="15" line2="77" col2="16" start="12181" end="12182">&lt;-</LEFT_ASSIGN>
          <expr line1="77" col1="18" line2="77" col2="32" start="12184" end="12198">
            <expr line1="77" col1="18" line2="77" col2="24" start="12184" end="12190">
              <SYMBOL_FUNCTION_CALL line1="77" col1="18" line2="77" col2="24" start="12184" end="12190">rowData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="77" col1="25" line2="77" col2="25" start="12191" end="12191">(</OP-LEFT-PAREN>
            <expr line1="77" col1="26" line2="77" col2="31" start="12192" end="12197">
              <SYMBOL line1="77" col1="26" line2="77" col2="31" start="12192" end="12197">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="77" col1="32" line2="77" col2="32" start="12198" end="12198">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="78" col1="5" line2="79" col2="69" start="12329" end="12551">
          <expr line1="78" col1="5" line2="78" col2="13" start="12329" end="12337">
            <SYMBOL line1="78" col1="5" line2="78" col2="13" start="12329" end="12337">keep_cols</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="78" col1="15" line2="78" col2="16" start="12339" end="12340">&lt;-</LEFT_ASSIGN>
          <expr line1="78" col1="18" line2="79" col2="69" start="12342" end="12551">
            <OP-EXCLAMATION line1="78" col1="18" line2="78" col2="18" start="12342" end="12342">!</OP-EXCLAMATION>
            <expr line1="78" col1="19" line2="79" col2="69" start="12343" end="12551">
              <OP-LEFT-PAREN line1="78" col1="19" line2="78" col2="19" start="12343" end="12343">(</OP-LEFT-PAREN>
              <expr line1="78" col1="20" line2="79" col2="68" start="12344" end="12550">
                <expr line1="78" col1="20" line2="78" col2="38" start="12344" end="12362">
                  <expr line1="78" col1="20" line2="78" col2="27" start="12344" end="12351">
                    <SYMBOL_FUNCTION_CALL line1="78" col1="20" line2="78" col2="27" start="12344" end="12351">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="78" col1="28" line2="78" col2="28" start="12352" end="12352">(</OP-LEFT-PAREN>
                  <expr line1="78" col1="29" line2="78" col2="37" start="12353" end="12361">
                    <SYMBOL line1="78" col1="29" line2="78" col2="37" start="12353" end="12361">old_rdata</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="78" col1="38" line2="78" col2="38" start="12362" end="12362">)</OP-RIGHT-PAREN>
                </expr>
                <SPECIAL line1="78" col1="40" line2="78" col2="43" start="12364" end="12367">%in%</SPECIAL>
                <expr line1="79" col1="24" line2="79" col2="68" start="12506" end="12550">
                  <expr line1="79" col1="24" line2="79" col2="24" start="12506" end="12506">
                    <SYMBOL_FUNCTION_CALL line1="79" col1="24" line2="79" col2="24" start="12506" end="12506">c</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="79" col1="25" line2="79" col2="25" start="12507" end="12507">(</OP-LEFT-PAREN>
                  <expr line1="79" col1="26" line2="79" col2="41" start="12508" end="12523">
                    <STR_CONST line1="79" col1="26" line2="79" col2="41" start="12508" end="12523">"feature_symbol"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="79" col1="42" line2="79" col2="42" start="12524" end="12524">,</OP-COMMA>
                  <expr line1="79" col1="44" line2="79" col2="55" start="12526" end="12537">
                    <STR_CONST line1="79" col1="44" line2="79" col2="55" start="12526" end="12537">"feature_id"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="79" col1="56" line2="79" col2="56" start="12538" end="12538">,</OP-COMMA>
                  <expr line1="79" col1="58" line2="79" col2="67" start="12540" end="12549">
                    <SYMBOL line1="79" col1="58" line2="79" col2="67" start="12540" end="12549">attributes</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="79" col1="68" line2="79" col2="68" start="12550" end="12550">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="79" col1="69" line2="79" col2="69" start="12551" end="12551">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="80" col1="5" line2="86" col2="38" start="12645" end="13626">
          <IF line1="80" col1="5" line2="80" col2="6" start="12645" end="12646">if</IF>
          <OP-LEFT-PAREN line1="80" col1="8" line2="80" col2="8" start="12648" end="12648">(</OP-LEFT-PAREN>
          <expr line1="80" col1="9" line2="80" col2="26" start="12649" end="12666">
            <expr line1="80" col1="9" line2="80" col2="22" start="12649" end="12662">
              <expr line1="80" col1="9" line2="80" col2="11" start="12649" end="12651">
                <SYMBOL_FUNCTION_CALL line1="80" col1="9" line2="80" col2="11" start="12649" end="12651">sum</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="80" col1="12" line2="80" col2="12" start="12652" end="12652">(</OP-LEFT-PAREN>
              <expr line1="80" col1="13" line2="80" col2="21" start="12653" end="12661">
                <SYMBOL line1="80" col1="13" line2="80" col2="21" start="12653" end="12661">keep_cols</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="80" col1="22" line2="80" col2="22" start="12662" end="12662">)</OP-RIGHT-PAREN>
            </expr>
            <GT line1="80" col1="24" line2="80" col2="24" start="12664" end="12664">&gt;</GT>
            <expr line1="80" col1="26" line2="80" col2="26" start="12666" end="12666">
              <NUM_CONST line1="80" col1="26" line2="80" col2="26" start="12666" end="12666">0</NUM_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="80" col1="27" line2="80" col2="27" start="12667" end="12667">)</OP-RIGHT-PAREN>
          <expr line1="80" col1="29" line2="85" col2="5" start="12669" end="13435">
            <OP-LEFT-BRACE line1="80" col1="29" line2="80" col2="29" start="12669" end="12669">{</OP-LEFT-BRACE>
            <expr line1="81" col1="9" line2="81" col2="49" start="12807" end="12847">
              <expr line1="81" col1="9" line2="81" col2="26" start="12807" end="12824">
                <SYMBOL line1="81" col1="9" line2="81" col2="26" start="12807" end="12824">colnames_old_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="81" col1="28" line2="81" col2="29" start="12826" end="12827">&lt;-</LEFT_ASSIGN>
              <expr line1="81" col1="31" line2="81" col2="49" start="12829" end="12847">
                <expr line1="81" col1="31" line2="81" col2="38" start="12829" end="12836">
                  <SYMBOL_FUNCTION_CALL line1="81" col1="31" line2="81" col2="38" start="12829" end="12836">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="81" col1="39" line2="81" col2="39" start="12837" end="12837">(</OP-LEFT-PAREN>
                <expr line1="81" col1="40" line2="81" col2="48" start="12838" end="12846">
                  <SYMBOL line1="81" col1="40" line2="81" col2="48" start="12838" end="12846">old_rdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="81" col1="49" line2="81" col2="49" start="12847" end="12847">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="82" col1="9" line2="82" col2="58" start="12965" end="13014">
              <expr line1="82" col1="9" line2="82" col2="17" start="12965" end="12973">
                <SYMBOL line1="82" col1="9" line2="82" col2="17" start="12965" end="12973">old_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="82" col1="19" line2="82" col2="20" start="12975" end="12976">&lt;-</LEFT_ASSIGN>
              <expr line1="82" col1="22" line2="82" col2="58" start="12978" end="13014">
                <expr line1="82" col1="22" line2="82" col2="34" start="12978" end="12990">
                  <SYMBOL_FUNCTION_CALL line1="82" col1="22" line2="82" col2="34" start="12978" end="12990">as.data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="82" col1="35" line2="82" col2="35" start="12991" end="12991">(</OP-LEFT-PAREN>
                <expr line1="82" col1="36" line2="82" col2="57" start="12992" end="13013">
                  <expr line1="82" col1="36" line2="82" col2="44" start="12992" end="13000">
                    <SYMBOL line1="82" col1="36" line2="82" col2="44" start="12992" end="13000">old_rdata</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="82" col1="45" line2="82" col2="45" start="13001" end="13001">[</OP-LEFT-BRACKET>
                  <OP-COMMA line1="82" col1="46" line2="82" col2="46" start="13002" end="13002">,</OP-COMMA>
                  <expr line1="82" col1="48" line2="82" col2="56" start="13004" end="13012">
                    <SYMBOL line1="82" col1="48" line2="82" col2="56" start="13004" end="13012">keep_cols</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="82" col1="57" line2="82" col2="57" start="13013" end="13013">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="82" col1="58" line2="82" col2="58" start="13014" end="13014">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="83" col1="9" line2="83" col2="60" start="13123" end="13174">
              <expr line1="83" col1="9" line2="83" col2="27" start="13123" end="13141">
                <expr line1="83" col1="9" line2="83" col2="16" start="13123" end="13130">
                  <SYMBOL_FUNCTION_CALL line1="83" col1="9" line2="83" col2="16" start="13123" end="13130">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="83" col1="17" line2="83" col2="17" start="13131" end="13131">(</OP-LEFT-PAREN>
                <expr line1="83" col1="18" line2="83" col2="26" start="13132" end="13140">
                  <SYMBOL line1="83" col1="18" line2="83" col2="26" start="13132" end="13140">old_rdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="83" col1="27" line2="83" col2="27" start="13141" end="13141">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="83" col1="29" line2="83" col2="30" start="13143" end="13144">&lt;-</LEFT_ASSIGN>
              <expr line1="83" col1="32" line2="83" col2="60" start="13146" end="13174">
                <expr line1="83" col1="32" line2="83" col2="49" start="13146" end="13163">
                  <SYMBOL line1="83" col1="32" line2="83" col2="49" start="13146" end="13163">colnames_old_rdata</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="83" col1="50" line2="83" col2="50" start="13164" end="13164">[</OP-LEFT-BRACKET>
                <expr line1="83" col1="51" line2="83" col2="59" start="13165" end="13173">
                  <SYMBOL line1="83" col1="51" line2="83" col2="59" start="13165" end="13173">keep_cols</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="83" col1="60" line2="83" col2="60" start="13174" end="13174">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="84" col1="9" line2="84" col2="56" start="13281" end="13328">
              <expr line1="84" col1="9" line2="84" col2="17" start="13281" end="13289">
                <SYMBOL line1="84" col1="9" line2="84" col2="17" start="13281" end="13289">new_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="84" col1="19" line2="84" col2="20" start="13291" end="13292">&lt;-</LEFT_ASSIGN>
              <expr line1="84" col1="22" line2="84" col2="56" start="13294" end="13328">
                <expr line1="84" col1="22" line2="84" col2="26" start="13294" end="13298">
                  <SYMBOL_FUNCTION_CALL line1="84" col1="22" line2="84" col2="26" start="13294" end="13298">cbind</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="84" col1="27" line2="84" col2="27" start="13299" end="13299">(</OP-LEFT-PAREN>
                <expr line1="84" col1="28" line2="84" col2="36" start="13300" end="13308">
                  <SYMBOL line1="84" col1="28" line2="84" col2="36" start="13300" end="13308">old_rdata</SYMBOL>
                </expr>
                <OP-COMMA line1="84" col1="37" line2="84" col2="37" start="13309" end="13309">,</OP-COMMA>
                <expr line1="84" col1="39" line2="84" col2="55" start="13311" end="13327">
                  <SYMBOL line1="84" col1="39" line2="84" col2="55" start="13311" end="13327">feature_info_full</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="84" col1="56" line2="84" col2="56" start="13328" end="13328">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="85" col1="5" line2="85" col2="5" start="13435" end="13435">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="85" col1="7" line2="85" col2="10" start="13437" end="13440">else</ELSE>
          <expr line1="86" col1="9" line2="86" col2="38" start="13597" end="13626">
            <expr line1="86" col1="9" line2="86" col2="17" start="13597" end="13605">
              <SYMBOL line1="86" col1="9" line2="86" col2="17" start="13597" end="13605">new_rdata</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="86" col1="19" line2="86" col2="20" start="13607" end="13608">&lt;-</LEFT_ASSIGN>
            <expr line1="86" col1="22" line2="86" col2="38" start="13610" end="13626">
              <SYMBOL line1="86" col1="22" line2="86" col2="38" start="13610" end="13626">feature_info_full</SYMBOL>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="87" col1="5" line2="87" col2="65" start="13751" end="13811">## Add new feature annotations to SingleCellExperiment object</COMMENT>
        <expr line1="88" col1="5" line2="88" col2="32" start="13909" end="13936">
          <expr line1="88" col1="5" line2="88" col2="19" start="13909" end="13923">
            <expr line1="88" col1="5" line2="88" col2="11" start="13909" end="13915">
              <SYMBOL_FUNCTION_CALL line1="88" col1="5" line2="88" col2="11" start="13909" end="13915">rowData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="88" col1="12" line2="88" col2="12" start="13916" end="13916">(</OP-LEFT-PAREN>
            <expr line1="88" col1="13" line2="88" col2="18" start="13917" end="13922">
              <SYMBOL line1="88" col1="13" line2="88" col2="18" start="13917" end="13922">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="88" col1="19" line2="88" col2="19" start="13923" end="13923">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="88" col1="21" line2="88" col2="22" start="13925" end="13926">&lt;-</LEFT_ASSIGN>
          <expr line1="88" col1="24" line2="88" col2="32" start="13928" end="13936">
            <SYMBOL line1="88" col1="24" line2="88" col2="32" start="13928" end="13936">new_rdata</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="89" col1="5" line2="89" col2="41" start="14067" end="14103">## Return SingleCellExperiment object</COMMENT>
        <expr line1="90" col1="5" line2="90" col2="10" start="14225" end="14230">
          <SYMBOL line1="90" col1="5" line2="90" col2="10" start="14225" end="14230">object</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="91" col1="1" line2="91" col2="1" start="14379" end="14379">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="93" col1="1" line2="93" col2="80" start="14695" end="14774">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="95" col1="1" line2="95" col2="51" start="15011" end="15061">## Function to summarise expression across features</COMMENT>
  <COMMENT line1="97" col1="1" line2="97" col2="45" start="15327" end="15371">#' Summarise expression values across feature</COMMENT>
  <COMMENT line1="98" col1="1" line2="98" col2="3" start="15485" end="15487">#' </COMMENT>
  <COMMENT line1="99" col1="1" line2="99" col2="97" start="15643" end="15739">#' Create a new \code{\link{SingleCellExperiment}} with counts summarised at a different feature </COMMENT>
  <COMMENT line1="100" col1="1" line2="100" col2="77" start="15801" end="15877">#' level. A typical use would be to summarise transcript-level counts at gene</COMMENT>
  <COMMENT line1="101" col1="1" line2="101" col2="9" start="15959" end="15967">#' level.</COMMENT>
  <COMMENT line1="102" col1="1" line2="102" col2="3" start="16117" end="16119">#' </COMMENT>
  <COMMENT line1="103" col1="1" line2="103" col2="55" start="16275" end="16329">#' @param object an \code{SingleCellExperiment} object.</COMMENT>
  <COMMENT line1="104" col1="1" line2="104" col2="69" start="16433" end="16501">#' @param exprs_values character string indicating which slot of the </COMMENT>
  <COMMENT line1="105" col1="1" line2="105" col2="94" start="16591" end="16684">#' assayData from the \code{SingleCellExperiment} object should be used as expression values. </COMMENT>
  <COMMENT line1="106" col1="1" line2="106" col2="71" start="16749" end="16819">#' Valid options are \code{'counts'} the counts slot, \code{'tpm'} the </COMMENT>
  <COMMENT line1="107" col1="1" line2="107" col2="63" start="16907" end="16969">#' transcripts-per-million slot or \code{'fpkm'} the FPKM slot.</COMMENT>
  <COMMENT line1="108" col1="1" line2="108" col2="83" start="17065" end="17147">#' @param summarise_by character string giving the column of \code{rowData(object)}</COMMENT>
  <COMMENT line1="109" col1="1" line2="109" col2="80" start="17223" end="17302">#' that will be used as the features for which summarised expression levels are </COMMENT>
  <COMMENT line1="110" col1="1" line2="110" col2="50" start="17381" end="17430">#' to be produced. Default is \code{'feature_id'}.</COMMENT>
  <COMMENT line1="111" col1="1" line2="111" col2="73" start="17539" end="17611">#' @param scaled_tpm_counts logical, should feature-summarised counts be </COMMENT>
  <COMMENT line1="112" col1="1" line2="112" col2="78" start="17697" end="17774">#' computed from summed TPM values scaled by total library size? This approach</COMMENT>
  <COMMENT line1="113" col1="1" line2="113" col2="78" start="17855" end="17932">#' is recommended (see \url{https://f1000research.com/articles/4-1521/v2}), so</COMMENT>
  <COMMENT line1="114" col1="1" line2="114" col2="78" start="18013" end="18090">#' the default is \code{TRUE} and it is applied if TPM values are available in</COMMENT>
  <COMMENT line1="115" col1="1" line2="115" col2="14" start="18171" end="18184">#' the object.</COMMENT>
  <COMMENT line1="116" col1="1" line2="116" col2="75" start="18329" end="18403">#' @param lib_size optional vector of numeric values of same length as the </COMMENT>
  <COMMENT line1="117" col1="1" line2="117" col2="91" start="18487" end="18577">#' number of columns in the \code{SingleCellExperiment} object providing the total library </COMMENT>
  <COMMENT line1="118" col1="1" line2="118" col2="60" start="18645" end="18704">#' size (e.g. "count of mapped reads") for each cell/sample.</COMMENT>
  <COMMENT line1="119" col1="1" line2="119" col2="3" start="18803" end="18805">#' </COMMENT>
  <COMMENT line1="120" col1="1" line2="120" col2="77" start="18961" end="19037">#' @details Only transcripts-per-million (TPM) and fragments per kilobase of </COMMENT>
  <COMMENT line1="121" col1="1" line2="121" col2="79" start="19119" end="19197">#' exon per million reads mapped (FPKM) expression values should be aggregated </COMMENT>
  <COMMENT line1="122" col1="1" line2="122" col2="78" start="19277" end="19354">#' across features. Since counts are not scaled by the length of the feature, </COMMENT>
  <COMMENT line1="123" col1="1" line2="123" col2="73" start="19435" end="19507">#' expression in counts units are not comparable within a sample without </COMMENT>
  <COMMENT line1="124" col1="1" line2="124" col2="74" start="19593" end="19666">#' adjusting for feature length. Thus, we cannot sum counts over a set of </COMMENT>
  <COMMENT line1="125" col1="1" line2="125" col2="80" start="19751" end="19830">#' features to get the expression of that set (for example, we cannot sum counts</COMMENT>
  <COMMENT line1="126" col1="1" line2="126" col2="78" start="19909" end="19986">#' over transcripts to get accurate expression estimates for a gene). See the </COMMENT>
  <COMMENT line1="127" col1="1" line2="127" col2="82" start="20067" end="20148">#' following link for a discussion of RNA-seq expression units by Harold Pimentel:</COMMENT>
  <COMMENT line1="128" col1="1" line2="128" col2="157" start="20225" end="20381">#' \url{https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/}. For more details about the effects of summarising </COMMENT>
  <COMMENT line1="129" col1="1" line2="129" col2="74" start="20383" end="20456">#' transcript expression values at the gene level see Sonesen et al, 2016 </COMMENT>
  <COMMENT line1="130" col1="1" line2="130" col2="56" start="20541" end="20596">#' (\url{https://f1000research.com/articles/4-1521/v2}).</COMMENT>
  <COMMENT line1="131" col1="1" line2="131" col2="3" start="20699" end="20701">#' </COMMENT>
  <COMMENT line1="132" col1="1" line2="132" col2="41" start="20857" end="20897">#' @return an SingleCellExperiment object</COMMENT>
  <COMMENT line1="133" col1="1" line2="133" col2="3" start="21015" end="21017">#' </COMMENT>
  <COMMENT line1="134" col1="1" line2="134" col2="10" start="21173" end="21182">#' @export</COMMENT>
  <COMMENT line1="135" col1="1" line2="135" col2="3" start="21331" end="21333">#' </COMMENT>
  <COMMENT line1="136" col1="1" line2="136" col2="12" start="21489" end="21500">#' @examples</COMMENT>
  <COMMENT line1="137" col1="1" line2="137" col2="28" start="21647" end="21674">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="138" col1="1" line2="138" col2="31" start="21805" end="21835">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="139" col1="1" line2="139" col2="39" start="21963" end="22001">#' example_sce &lt;- SingleCellExperiment(</COMMENT>
  <COMMENT line1="140" col1="1" line2="140" col2="77" start="22121" end="22197">#' assays = list(counts = sc_example_counts), colData = sc_example_cell_info)</COMMENT>
  <COMMENT line1="141" col1="1" line2="141" col2="53" start="22279" end="22331">#' rd &lt;- data.frame(gene_id = rownames(example_sce), </COMMENT>
  <COMMENT line1="142" col1="1" line2="142" col2="66" start="22437" end="22502">#' feature_id = paste("feature", rep(1:500, each = 4), sep = "_"))</COMMENT>
  <COMMENT line1="143" col1="1" line2="143" col2="40" start="22595" end="22634">#' rownames(rd) &lt;- rownames(example_sce)</COMMENT>
  <COMMENT line1="144" col1="1" line2="144" col2="29" start="22753" end="22781">#' rowData(example_sce) &lt;- rd</COMMENT>
  <COMMENT line1="145" col1="1" line2="145" col2="55" start="22911" end="22965">#' effective_length &lt;- rep(c(1000, 2000), times = 1000)</COMMENT>
  <COMMENT line1="146" col1="1" line2="146" col2="88" start="23069" end="23156">#' tpm(example_sce) &lt;- calculateTPM(example_sce, effective_length, calc_from = "counts")</COMMENT>
  <COMMENT line1="147" col1="1" line2="147" col2="3" start="23227" end="23229">#' </COMMENT>
  <COMMENT line1="148" col1="1" line2="148" col2="32" start="23385" end="23416">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="149" col1="1" line2="149" col2="66" start="23543" end="23608">#' summariseExprsAcrossFeatures(example_sce, exprs_values = "tpm")</COMMENT>
  <COMMENT line1="150" col1="1" line2="150" col2="32" start="23701" end="23732">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="151" col1="1" line2="151" col2="69" start="23859" end="23927">#' summariseExprsAcrossFeatures(example_sce, exprs_values = "counts")</COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="3" start="24017" end="24019">#' </COMMENT>
  <expr line1="153" col1="1" line2="253" col2="1" start="24175" end="39975">
    <expr line1="153" col1="1" line2="153" col2="28" start="24175" end="24202">
      <SYMBOL line1="153" col1="1" line2="153" col2="28" start="24175" end="24202">summariseExprsAcrossFeatures</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="153" col1="30" line2="153" col2="31" start="24204" end="24205">&lt;-</LEFT_ASSIGN>
    <expr line1="153" col1="33" line2="253" col2="1" start="24207" end="39975">
      <FUNCTION line1="153" col1="33" line2="153" col2="40" start="24207" end="24214">function</FUNCTION>
      <OP-LEFT-PAREN line1="153" col1="41" line2="153" col2="41" start="24215" end="24215">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="153" col1="42" line2="153" col2="47" start="24216" end="24221">object</SYMBOL_FORMALS>
      <OP-COMMA line1="153" col1="48" line2="153" col2="48" start="24222" end="24222">,</OP-COMMA>
      <SYMBOL_FORMALS line1="153" col1="50" line2="153" col2="61" start="24224" end="24235">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="153" col1="63" line2="153" col2="63" start="24237" end="24237">=</EQ_FORMALS>
      <expr line1="153" col1="65" line2="153" col2="69" start="24239" end="24243">
        <STR_CONST line1="153" col1="65" line2="153" col2="69" start="24239" end="24243">"tpm"</STR_CONST>
      </expr>
      <OP-COMMA line1="153" col1="70" line2="153" col2="70" start="24244" end="24244">,</OP-COMMA>
      <SYMBOL_FORMALS line1="154" col1="42" line2="154" col2="53" start="24374" end="24385">summarise_by</SYMBOL_FORMALS>
      <EQ_FORMALS line1="154" col1="55" line2="154" col2="55" start="24387" end="24387">=</EQ_FORMALS>
      <expr line1="154" col1="57" line2="154" col2="68" start="24389" end="24400">
        <STR_CONST line1="154" col1="57" line2="154" col2="68" start="24389" end="24400">"feature_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="154" col1="69" line2="154" col2="69" start="24401" end="24401">,</OP-COMMA>
      <SYMBOL_FORMALS line1="155" col1="42" line2="155" col2="58" start="24532" end="24548">scaled_tpm_counts</SYMBOL_FORMALS>
      <EQ_FORMALS line1="155" col1="60" line2="155" col2="60" start="24550" end="24550">=</EQ_FORMALS>
      <expr line1="155" col1="62" line2="155" col2="65" start="24552" end="24555">
        <NUM_CONST line1="155" col1="62" line2="155" col2="65" start="24552" end="24555">TRUE</NUM_CONST>
      </expr>
      <OP-COMMA line1="155" col1="66" line2="155" col2="66" start="24556" end="24556">,</OP-COMMA>
      <SYMBOL_FORMALS line1="156" col1="42" line2="156" col2="49" start="24690" end="24697">lib_size</SYMBOL_FORMALS>
      <EQ_FORMALS line1="156" col1="51" line2="156" col2="51" start="24699" end="24699">=</EQ_FORMALS>
      <expr line1="156" col1="53" line2="156" col2="56" start="24701" end="24704">
        <NULL_CONST line1="156" col1="53" line2="156" col2="56" start="24701" end="24704">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="156" col1="57" line2="156" col2="57" start="24705" end="24705">)</OP-RIGHT-PAREN>
      <expr line1="156" col1="59" line2="253" col2="1" start="24707" end="39975">
        <OP-LEFT-BRACE line1="156" col1="59" line2="156" col2="59" start="24707" end="24707">{</OP-LEFT-BRACE>
        <expr line1="157" col1="5" line2="158" col2="53" start="24811" end="25017">
          <IF line1="157" col1="5" line2="157" col2="6" start="24811" end="24812">if</IF>
          <OP-LEFT-PAREN line1="157" col1="8" line2="157" col2="8" start="24814" end="24814">(</OP-LEFT-PAREN>
          <expr line1="157" col1="10" line2="157" col2="53" start="24816" end="24859">
            <OP-EXCLAMATION line1="157" col1="10" line2="157" col2="10" start="24816" end="24816">!</OP-EXCLAMATION>
            <expr line1="157" col1="11" line2="157" col2="53" start="24817" end="24859">
              <expr line1="157" col1="11" line2="157" col2="21" start="24817" end="24827">
                <SYMBOL_PACKAGE line1="157" col1="11" line2="157" col2="17" start="24817" end="24823">methods</SYMBOL_PACKAGE>
                <NS_GET line1="157" col1="18" line2="157" col2="19" start="24824" end="24825">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="157" col1="20" line2="157" col2="21" start="24826" end="24827">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="157" col1="22" line2="157" col2="22" start="24828" end="24828">(</OP-LEFT-PAREN>
              <expr line1="157" col1="23" line2="157" col2="28" start="24829" end="24834">
                <SYMBOL line1="157" col1="23" line2="157" col2="28" start="24829" end="24834">object</SYMBOL>
              </expr>
              <OP-COMMA line1="157" col1="29" line2="157" col2="29" start="24835" end="24835">,</OP-COMMA>
              <expr line1="157" col1="31" line2="157" col2="52" start="24837" end="24858">
                <STR_CONST line1="157" col1="31" line2="157" col2="52" start="24837" end="24858">"SingleCellExperiment"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="157" col1="53" line2="157" col2="53" start="24859" end="24859">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="157" col1="55" line2="157" col2="55" start="24861" end="24861">)</OP-RIGHT-PAREN>
          <expr line1="158" col1="9" line2="158" col2="53" start="24973" end="25017">
            <expr line1="158" col1="9" line2="158" col2="12" start="24973" end="24976">
              <SYMBOL_FUNCTION_CALL line1="158" col1="9" line2="158" col2="12" start="24973" end="24976">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="158" col1="13" line2="158" col2="13" start="24977" end="24977">(</OP-LEFT-PAREN>
            <expr line1="158" col1="14" line2="158" col2="52" start="24978" end="25016">
              <STR_CONST line1="158" col1="14" line2="158" col2="52" start="24978" end="25016">"Object must be a SingleCellExperiment"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="158" col1="53" line2="158" col2="53" start="25017" end="25017">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="159" col1="5" line2="159" col2="72" start="25127" end="25194">## Define an expression matrix depending on which values we're using</COMMENT>
        <expr line1="160" col1="5" line2="160" col2="71" start="25285" end="25351">
          <expr line1="160" col1="5" line2="160" col2="16" start="25285" end="25296">
            <SYMBOL line1="160" col1="5" line2="160" col2="16" start="25285" end="25296">exprs_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="160" col1="18" line2="160" col2="19" start="25298" end="25299">&lt;-</LEFT_ASSIGN>
          <expr line1="160" col1="21" line2="160" col2="71" start="25301" end="25351">
            <expr line1="160" col1="21" line2="160" col2="29" start="25301" end="25309">
              <SYMBOL_FUNCTION_CALL line1="160" col1="21" line2="160" col2="29" start="25301" end="25309">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="160" col1="30" line2="160" col2="30" start="25310" end="25310">(</OP-LEFT-PAREN>
            <expr line1="160" col1="31" line2="160" col2="42" start="25311" end="25322">
              <SYMBOL line1="160" col1="31" line2="160" col2="42" start="25311" end="25322">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="160" col1="43" line2="160" col2="43" start="25323" end="25323">,</OP-COMMA>
            <expr line1="160" col1="45" line2="160" col2="70" start="25325" end="25350">
              <expr line1="160" col1="45" line2="160" col2="45" start="25325" end="25325">
                <SYMBOL_FUNCTION_CALL line1="160" col1="45" line2="160" col2="45" start="25325" end="25325">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="160" col1="46" line2="160" col2="46" start="25326" end="25326">(</OP-LEFT-PAREN>
              <expr line1="160" col1="47" line2="160" col2="51" start="25327" end="25331">
                <STR_CONST line1="160" col1="47" line2="160" col2="51" start="25327" end="25331">"tpm"</STR_CONST>
              </expr>
              <OP-COMMA line1="160" col1="52" line2="160" col2="52" start="25332" end="25332">,</OP-COMMA>
              <expr line1="160" col1="54" line2="160" col2="59" start="25334" end="25339">
                <STR_CONST line1="160" col1="54" line2="160" col2="59" start="25334" end="25339">"fpkm"</STR_CONST>
              </expr>
              <OP-COMMA line1="160" col1="60" line2="160" col2="60" start="25340" end="25340">,</OP-COMMA>
              <expr line1="160" col1="62" line2="160" col2="69" start="25342" end="25349">
                <STR_CONST line1="160" col1="62" line2="160" col2="69" start="25342" end="25349">"counts"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="160" col1="70" line2="160" col2="70" start="25350" end="25350">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="160" col1="71" line2="160" col2="71" start="25351" end="25351">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="161" col1="5" line2="164" col2="48" start="25443" end="25960">
          <expr line1="161" col1="5" line2="161" col2="13" start="25443" end="25451">
            <SYMBOL line1="161" col1="5" line2="161" col2="13" start="25443" end="25451">exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="161" col1="15" line2="161" col2="16" start="25453" end="25454">&lt;-</LEFT_ASSIGN>
          <expr line1="161" col1="18" line2="164" col2="48" start="25456" end="25960">
            <expr line1="161" col1="18" line2="161" col2="23" start="25456" end="25461">
              <SYMBOL_FUNCTION_CALL line1="161" col1="18" line2="161" col2="23" start="25456" end="25461">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="161" col1="24" line2="161" col2="24" start="25462" end="25462">(</OP-LEFT-PAREN>
            <expr line1="161" col1="25" line2="161" col2="36" start="25463" end="25474">
              <SYMBOL line1="161" col1="25" line2="161" col2="36" start="25463" end="25474">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="161" col1="37" line2="161" col2="37" start="25475" end="25475">,</OP-COMMA>
            <SYMBOL_SUB line1="162" col1="25" line2="162" col2="27" start="25621" end="25623">tpm</SYMBOL_SUB>
            <EQ_SUB line1="162" col1="29" line2="162" col2="29" start="25625" end="25625">=</EQ_SUB>
            <expr line1="162" col1="31" line2="162" col2="41" start="25627" end="25637">
              <expr line1="162" col1="31" line2="162" col2="33" start="25627" end="25629">
                <SYMBOL_FUNCTION_CALL line1="162" col1="31" line2="162" col2="33" start="25627" end="25629">tpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="162" col1="34" line2="162" col2="34" start="25630" end="25630">(</OP-LEFT-PAREN>
              <expr line1="162" col1="35" line2="162" col2="40" start="25631" end="25636">
                <SYMBOL line1="162" col1="35" line2="162" col2="40" start="25631" end="25636">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="162" col1="41" line2="162" col2="41" start="25637" end="25637">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="162" col1="42" line2="162" col2="42" start="25638" end="25638">,</OP-COMMA>
            <SYMBOL_SUB line1="163" col1="25" line2="163" col2="28" start="25779" end="25782">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="163" col1="30" line2="163" col2="30" start="25784" end="25784">=</EQ_SUB>
            <expr line1="163" col1="32" line2="163" col2="43" start="25786" end="25797">
              <expr line1="163" col1="32" line2="163" col2="35" start="25786" end="25789">
                <SYMBOL_FUNCTION_CALL line1="163" col1="32" line2="163" col2="35" start="25786" end="25789">fpkm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="163" col1="36" line2="163" col2="36" start="25790" end="25790">(</OP-LEFT-PAREN>
              <expr line1="163" col1="37" line2="163" col2="42" start="25791" end="25796">
                <SYMBOL line1="163" col1="37" line2="163" col2="42" start="25791" end="25796">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="163" col1="43" line2="163" col2="43" start="25797" end="25797">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="163" col1="44" line2="163" col2="44" start="25798" end="25798">,</OP-COMMA>
            <SYMBOL_SUB line1="164" col1="25" line2="164" col2="30" start="25937" end="25942">counts</SYMBOL_SUB>
            <EQ_SUB line1="164" col1="32" line2="164" col2="32" start="25944" end="25944">=</EQ_SUB>
            <expr line1="164" col1="34" line2="164" col2="47" start="25946" end="25959">
              <expr line1="164" col1="34" line2="164" col2="39" start="25946" end="25951">
                <SYMBOL_FUNCTION_CALL line1="164" col1="34" line2="164" col2="39" start="25946" end="25951">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="164" col1="40" line2="164" col2="40" start="25952" end="25952">(</OP-LEFT-PAREN>
              <expr line1="164" col1="41" line2="164" col2="46" start="25953" end="25958">
                <SYMBOL line1="164" col1="41" line2="164" col2="46" start="25953" end="25958">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="164" col1="47" line2="164" col2="47" start="25959" end="25959">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="164" col1="48" line2="164" col2="48" start="25960" end="25960">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="165" col1="5" line2="166" col2="77" start="26075" end="26305">
          <IF line1="165" col1="5" line2="165" col2="6" start="26075" end="26076">if</IF>
          <OP-LEFT-PAREN line1="165" col1="8" line2="165" col2="8" start="26078" end="26078">(</OP-LEFT-PAREN>
          <expr line1="165" col1="10" line2="165" col2="55" start="26080" end="26125">
            <OP-EXCLAMATION line1="165" col1="10" line2="165" col2="10" start="26080" end="26080">!</OP-EXCLAMATION>
            <expr line1="165" col1="11" line2="165" col2="55" start="26081" end="26125">
              <OP-LEFT-PAREN line1="165" col1="11" line2="165" col2="11" start="26081" end="26081">(</OP-LEFT-PAREN>
              <expr line1="165" col1="12" line2="165" col2="54" start="26082" end="26124">
                <expr line1="165" col1="12" line2="165" col2="23" start="26082" end="26093">
                  <SYMBOL line1="165" col1="12" line2="165" col2="23" start="26082" end="26093">summarise_by</SYMBOL>
                </expr>
                <SPECIAL line1="165" col1="25" line2="165" col2="28" start="26095" end="26098">%in%</SPECIAL>
                <expr line1="165" col1="30" line2="165" col2="54" start="26100" end="26124">
                  <expr line1="165" col1="30" line2="165" col2="37" start="26100" end="26107">
                    <SYMBOL_FUNCTION_CALL line1="165" col1="30" line2="165" col2="37" start="26100" end="26107">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="165" col1="38" line2="165" col2="38" start="26108" end="26108">(</OP-LEFT-PAREN>
                  <expr line1="165" col1="39" line2="165" col2="53" start="26109" end="26123">
                    <expr line1="165" col1="39" line2="165" col2="45" start="26109" end="26115">
                      <SYMBOL_FUNCTION_CALL line1="165" col1="39" line2="165" col2="45" start="26109" end="26115">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="165" col1="46" line2="165" col2="46" start="26116" end="26116">(</OP-LEFT-PAREN>
                    <expr line1="165" col1="47" line2="165" col2="52" start="26117" end="26122">
                      <SYMBOL line1="165" col1="47" line2="165" col2="52" start="26117" end="26122">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="165" col1="53" line2="165" col2="53" start="26123" end="26123">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="165" col1="54" line2="165" col2="54" start="26124" end="26124">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="165" col1="55" line2="165" col2="55" start="26125" end="26125">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="165" col1="57" line2="165" col2="57" start="26127" end="26127">)</OP-RIGHT-PAREN>
          <expr line1="166" col1="9" line2="166" col2="77" start="26237" end="26305">
            <expr line1="166" col1="9" line2="166" col2="12" start="26237" end="26240">
              <SYMBOL_FUNCTION_CALL line1="166" col1="9" line2="166" col2="12" start="26237" end="26240">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="166" col1="13" line2="166" col2="13" start="26241" end="26241">(</OP-LEFT-PAREN>
            <expr line1="166" col1="14" line2="166" col2="76" start="26242" end="26304">
              <STR_CONST line1="166" col1="14" line2="166" col2="76" start="26242" end="26304">"The summarise_by argument is not a column of rowData(object)."</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="166" col1="77" line2="166" col2="77" start="26305" end="26305">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="168" col1="5" line2="168" col2="67" start="26549" end="26611">## Use reshape2 to make a long version of the expression matrix</COMMENT>
        <expr line1="169" col1="5" line2="169" col2="81" start="26707" end="26783">
          <expr line1="169" col1="5" line2="169" col2="13" start="26707" end="26715">
            <SYMBOL line1="169" col1="5" line2="169" col2="13" start="26707" end="26715">tmp_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="169" col1="15" line2="169" col2="16" start="26717" end="26718">&lt;-</LEFT_ASSIGN>
          <expr line1="169" col1="18" line2="169" col2="81" start="26720" end="26783">
            <expr line1="169" col1="18" line2="169" col2="27" start="26720" end="26729">
              <SYMBOL_FUNCTION_CALL line1="169" col1="18" line2="169" col2="27" start="26720" end="26729">data.frame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="169" col1="28" line2="169" col2="28" start="26730" end="26730">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="169" col1="29" line2="169" col2="35" start="26731" end="26737">feature</SYMBOL_SUB>
            <EQ_SUB line1="169" col1="37" line2="169" col2="37" start="26739" end="26739">=</EQ_SUB>
            <expr line1="169" col1="39" line2="169" col2="69" start="26741" end="26771">
              <expr line1="169" col1="39" line2="169" col2="53" start="26741" end="26755">
                <expr line1="169" col1="39" line2="169" col2="45" start="26741" end="26747">
                  <SYMBOL_FUNCTION_CALL line1="169" col1="39" line2="169" col2="45" start="26741" end="26747">rowData</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="169" col1="46" line2="169" col2="46" start="26748" end="26748">(</OP-LEFT-PAREN>
                <expr line1="169" col1="47" line2="169" col2="52" start="26749" end="26754">
                  <SYMBOL line1="169" col1="47" line2="169" col2="52" start="26749" end="26754">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="169" col1="53" line2="169" col2="53" start="26755" end="26755">)</OP-RIGHT-PAREN>
              </expr>
              <LBB line1="169" col1="54" line2="169" col2="55" start="26756" end="26757">[[</LBB>
              <expr line1="169" col1="56" line2="169" col2="67" start="26758" end="26769">
                <SYMBOL line1="169" col1="56" line2="169" col2="67" start="26758" end="26769">summarise_by</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="169" col1="68" line2="169" col2="68" start="26770" end="26770">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="169" col1="69" line2="169" col2="69" start="26771" end="26771">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-COMMA line1="169" col1="70" line2="169" col2="70" start="26772" end="26772">,</OP-COMMA>
            <expr line1="169" col1="72" line2="169" col2="80" start="26774" end="26782">
              <SYMBOL line1="169" col1="72" line2="169" col2="80" start="26774" end="26782">exprs_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="169" col1="81" line2="169" col2="81" start="26783" end="26783">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="170" col1="5" line2="170" col2="65" start="26865" end="26925">
          <expr line1="170" col1="5" line2="170" col2="18" start="26865" end="26878">
            <SYMBOL line1="170" col1="5" line2="170" col2="18" start="26865" end="26878">tmp_exprs_long</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="170" col1="20" line2="170" col2="21" start="26880" end="26881">&lt;-</LEFT_ASSIGN>
          <expr line1="170" col1="23" line2="170" col2="65" start="26883" end="26925">
            <expr line1="170" col1="23" line2="170" col2="38" start="26883" end="26898">
              <SYMBOL_FUNCTION_CALL line1="170" col1="23" line2="170" col2="38" start="26883" end="26898">suppressMessages</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="170" col1="39" line2="170" col2="39" start="26899" end="26899">(</OP-LEFT-PAREN>
            <expr line1="170" col1="40" line2="170" col2="64" start="26900" end="26924">
              <expr line1="170" col1="40" line2="170" col2="53" start="26900" end="26913">
                <SYMBOL_PACKAGE line1="170" col1="40" line2="170" col2="47" start="26900" end="26907">reshape2</SYMBOL_PACKAGE>
                <NS_GET line1="170" col1="48" line2="170" col2="49" start="26908" end="26909">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="170" col1="50" line2="170" col2="53" start="26910" end="26913">melt</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="170" col1="54" line2="170" col2="54" start="26914" end="26914">(</OP-LEFT-PAREN>
              <expr line1="170" col1="55" line2="170" col2="63" start="26915" end="26923">
                <SYMBOL line1="170" col1="55" line2="170" col2="63" start="26915" end="26923">tmp_exprs</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="170" col1="64" line2="170" col2="64" start="26924" end="26924">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="170" col1="65" line2="170" col2="65" start="26925" end="26925">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="171" col1="5" line2="171" col2="73" start="27023" end="27091">
          <expr line1="171" col1="5" line2="171" col2="13" start="27023" end="27031">
            <SYMBOL line1="171" col1="5" line2="171" col2="13" start="27023" end="27031">exprs_new</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="171" col1="15" line2="171" col2="16" start="27033" end="27034">&lt;-</LEFT_ASSIGN>
          <expr line1="171" col1="18" line2="171" col2="73" start="27036" end="27091">
            <expr line1="171" col1="18" line2="171" col2="32" start="27036" end="27050">
              <SYMBOL_PACKAGE line1="171" col1="18" line2="171" col2="25" start="27036" end="27043">reshape2</SYMBOL_PACKAGE>
              <NS_GET line1="171" col1="26" line2="171" col2="27" start="27044" end="27045">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="171" col1="28" line2="171" col2="32" start="27046" end="27050">acast</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="171" col1="33" line2="171" col2="33" start="27051" end="27051">(</OP-LEFT-PAREN>
            <expr line1="171" col1="34" line2="171" col2="47" start="27052" end="27065">
              <SYMBOL line1="171" col1="34" line2="171" col2="47" start="27052" end="27065">tmp_exprs_long</SYMBOL>
            </expr>
            <OP-COMMA line1="171" col1="48" line2="171" col2="48" start="27066" end="27066">,</OP-COMMA>
            <expr line1="171" col1="50" line2="171" col2="67" start="27068" end="27085">
              <expr line1="171" col1="50" line2="171" col2="56" start="27068" end="27074">
                <SYMBOL line1="171" col1="50" line2="171" col2="56" start="27068" end="27074">feature</SYMBOL>
              </expr>
              <OP-TILDE line1="171" col1="58" line2="171" col2="58" start="27076" end="27076">~</OP-TILDE>
              <expr line1="171" col1="60" line2="171" col2="67" start="27078" end="27085">
                <SYMBOL line1="171" col1="60" line2="171" col2="67" start="27078" end="27085">variable</SYMBOL>
              </expr>
            </expr>
            <OP-COMMA line1="171" col1="68" line2="171" col2="68" start="27086" end="27086">,</OP-COMMA>
            <expr line1="171" col1="70" line2="171" col2="72" start="27088" end="27090">
              <SYMBOL line1="171" col1="70" line2="171" col2="72" start="27088" end="27090">sum</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="171" col1="73" line2="171" col2="73" start="27091" end="27091">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="172" col1="5" line2="172" col2="65" start="27181" end="27241">
          <expr line1="172" col1="5" line2="172" col2="7" start="27181" end="27183">
            <SYMBOL_FUNCTION_CALL line1="172" col1="5" line2="172" col2="7" start="27181" end="27183">cat</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="172" col1="8" line2="172" col2="8" start="27184" end="27184">(</OP-LEFT-PAREN>
          <expr line1="172" col1="9" line2="172" col2="34" start="27185" end="27210">
            <STR_CONST line1="172" col1="9" line2="172" col2="34" start="27185" end="27210">"Collapsing expression to"</STR_CONST>
          </expr>
          <OP-COMMA line1="172" col1="35" line2="172" col2="35" start="27211" end="27211">,</OP-COMMA>
          <expr line1="172" col1="37" line2="172" col2="51" start="27213" end="27227">
            <expr line1="172" col1="37" line2="172" col2="40" start="27213" end="27216">
              <SYMBOL_FUNCTION_CALL line1="172" col1="37" line2="172" col2="40" start="27213" end="27216">nrow</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="172" col1="41" line2="172" col2="41" start="27217" end="27217">(</OP-LEFT-PAREN>
            <expr line1="172" col1="42" line2="172" col2="50" start="27218" end="27226">
              <SYMBOL line1="172" col1="42" line2="172" col2="50" start="27218" end="27226">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="172" col1="51" line2="172" col2="51" start="27227" end="27227">)</OP-RIGHT-PAREN>
          </expr>
          <OP-COMMA line1="172" col1="52" line2="172" col2="52" start="27228" end="27228">,</OP-COMMA>
          <expr line1="172" col1="54" line2="172" col2="64" start="27230" end="27240">
            <STR_CONST line1="172" col1="54" line2="172" col2="64" start="27230" end="27240">"features."</STR_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="172" col1="65" line2="172" col2="65" start="27241" end="27241">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="174" col1="5" line2="174" col2="49" start="27497" end="27541">## ensure sample names haven't been corrupted</COMMENT>
        <expr line1="175" col1="5" line2="175" col2="43" start="27655" end="27693">
          <expr line1="175" col1="5" line2="175" col2="23" start="27655" end="27673">
            <expr line1="175" col1="5" line2="175" col2="12" start="27655" end="27662">
              <SYMBOL_FUNCTION_CALL line1="175" col1="5" line2="175" col2="12" start="27655" end="27662">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="175" col1="13" line2="175" col2="13" start="27663" end="27663">(</OP-LEFT-PAREN>
            <expr line1="175" col1="14" line2="175" col2="22" start="27664" end="27672">
              <SYMBOL line1="175" col1="14" line2="175" col2="22" start="27664" end="27672">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="175" col1="23" line2="175" col2="23" start="27673" end="27673">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="175" col1="25" line2="175" col2="26" start="27675" end="27676">&lt;-</LEFT_ASSIGN>
          <expr line1="175" col1="28" line2="175" col2="43" start="27678" end="27693">
            <expr line1="175" col1="28" line2="175" col2="35" start="27678" end="27685">
              <SYMBOL_FUNCTION_CALL line1="175" col1="28" line2="175" col2="35" start="27678" end="27685">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="175" col1="36" line2="175" col2="36" start="27686" end="27686">(</OP-LEFT-PAREN>
            <expr line1="175" col1="37" line2="175" col2="42" start="27687" end="27692">
              <SYMBOL line1="175" col1="37" line2="175" col2="42" start="27687" end="27692">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="175" col1="43" line2="175" col2="43" start="27693" end="27693">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="177" col1="5" line2="177" col2="30" start="27971" end="27996">## Create a new SCE object</COMMENT>
        <expr line1="178" col1="5" line2="178" col2="25" start="28129" end="28149">
          <expr line1="178" col1="5" line2="178" col2="6" start="28129" end="28130">
            <SYMBOL line1="178" col1="5" line2="178" col2="6" start="28129" end="28130">pd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="178" col1="8" line2="178" col2="9" start="28132" end="28133">&lt;-</LEFT_ASSIGN>
          <expr line1="178" col1="11" line2="178" col2="25" start="28135" end="28149">
            <expr line1="178" col1="11" line2="178" col2="17" start="28135" end="28141">
              <SYMBOL_FUNCTION_CALL line1="178" col1="11" line2="178" col2="17" start="28135" end="28141">colData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="178" col1="18" line2="178" col2="18" start="28142" end="28142">(</OP-LEFT-PAREN>
            <expr line1="178" col1="19" line2="178" col2="24" start="28143" end="28148">
              <SYMBOL line1="178" col1="19" line2="178" col2="24" start="28143" end="28148">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="178" col1="25" line2="178" col2="25" start="28149" end="28149">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="179" col1="5" line2="179" col2="62" start="28287" end="28344">
          <expr line1="179" col1="5" line2="179" col2="6" start="28287" end="28288">
            <SYMBOL line1="179" col1="5" line2="179" col2="6" start="28287" end="28288">fd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="179" col1="8" line2="179" col2="9" start="28290" end="28291">&lt;-</LEFT_ASSIGN>
          <expr line1="179" col1="11" line2="179" col2="62" start="28293" end="28344">
            <expr line1="179" col1="11" line2="179" col2="20" start="28293" end="28302">
              <SYMBOL_FUNCTION_CALL line1="179" col1="11" line2="179" col2="20" start="28293" end="28302">data.frame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="179" col1="21" line2="179" col2="21" start="28303" end="28303">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="179" col1="22" line2="179" col2="39" start="28304" end="28321">exprs_collapsed_to</SYMBOL_SUB>
            <EQ_SUB line1="179" col1="41" line2="179" col2="41" start="28323" end="28323">=</EQ_SUB>
            <expr line1="179" col1="43" line2="179" col2="61" start="28325" end="28343">
              <expr line1="179" col1="43" line2="179" col2="50" start="28325" end="28332">
                <SYMBOL_FUNCTION_CALL line1="179" col1="43" line2="179" col2="50" start="28325" end="28332">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="179" col1="51" line2="179" col2="51" start="28333" end="28333">(</OP-LEFT-PAREN>
              <expr line1="179" col1="52" line2="179" col2="60" start="28334" end="28342">
                <SYMBOL line1="179" col1="52" line2="179" col2="60" start="28334" end="28342">exprs_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="179" col1="61" line2="179" col2="61" start="28343" end="28343">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="179" col1="62" line2="179" col2="62" start="28344" end="28344">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="180" col1="5" line2="180" col2="39" start="28445" end="28479">
          <expr line1="180" col1="5" line2="180" col2="16" start="28445" end="28456">
            <expr line1="180" col1="5" line2="180" col2="12" start="28445" end="28452">
              <SYMBOL_FUNCTION_CALL line1="180" col1="5" line2="180" col2="12" start="28445" end="28452">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="180" col1="13" line2="180" col2="13" start="28453" end="28453">(</OP-LEFT-PAREN>
            <expr line1="180" col1="14" line2="180" col2="15" start="28454" end="28455">
              <SYMBOL line1="180" col1="14" line2="180" col2="15" start="28454" end="28455">fd</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="180" col1="16" line2="180" col2="16" start="28456" end="28456">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="180" col1="18" line2="180" col2="19" start="28458" end="28459">&lt;-</LEFT_ASSIGN>
          <expr line1="180" col1="21" line2="180" col2="39" start="28461" end="28479">
            <expr line1="180" col1="21" line2="180" col2="28" start="28461" end="28468">
              <SYMBOL_FUNCTION_CALL line1="180" col1="21" line2="180" col2="28" start="28461" end="28468">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="180" col1="29" line2="180" col2="29" start="28469" end="28469">(</OP-LEFT-PAREN>
            <expr line1="180" col1="30" line2="180" col2="38" start="28470" end="28478">
              <SYMBOL line1="180" col1="30" line2="180" col2="38" start="28470" end="28478">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="180" col1="39" line2="180" col2="39" start="28479" end="28479">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="182" col1="5" line2="188" col2="80" start="28761" end="29784">
          <expr line1="182" col1="5" line2="182" col2="11" start="28761" end="28767">
            <SYMBOL line1="182" col1="5" line2="182" col2="11" start="28761" end="28767">sce_out</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="182" col1="13" line2="182" col2="14" start="28769" end="28770">&lt;-</LEFT_ASSIGN>
          <expr line1="182" col1="16" line2="188" col2="80" start="28772" end="29784">
            <expr line1="182" col1="16" line2="182" col2="21" start="28772" end="28777">
              <SYMBOL_FUNCTION_CALL line1="182" col1="16" line2="182" col2="21" start="28772" end="28777">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="182" col1="22" line2="182" col2="22" start="28778" end="28778">(</OP-LEFT-PAREN>
            <expr line1="182" col1="23" line2="182" col2="34" start="28779" end="28790">
              <SYMBOL line1="182" col1="23" line2="182" col2="34" start="28779" end="28790">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="182" col1="35" line2="182" col2="35" start="28791" end="28791">,</OP-COMMA>
            <SYMBOL_SUB line1="183" col1="23" line2="183" col2="25" start="28937" end="28939">tpm</SYMBOL_SUB>
            <EQ_SUB line1="183" col1="27" line2="183" col2="27" start="28941" end="28941">=</EQ_SUB>
            <expr line1="183" col1="29" line2="184" col2="76" start="28943" end="29148">
              <expr line1="183" col1="29" line2="183" col2="48" start="28943" end="28962">
                <SYMBOL_FUNCTION_CALL line1="183" col1="29" line2="183" col2="48" start="28943" end="28962">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="183" col1="49" line2="183" col2="49" start="28963" end="28963">(</OP-LEFT-PAREN>
              <expr line1="184" col1="27" line2="184" col2="47" start="29099" end="29119">
                <expr line1="184" col1="27" line2="184" col2="30" start="29099" end="29102">
                  <SYMBOL_FUNCTION_CALL line1="184" col1="27" line2="184" col2="30" start="29099" end="29102">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="184" col1="31" line2="184" col2="31" start="29103" end="29103">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="184" col1="32" line2="184" col2="34" start="29104" end="29106">tpm</SYMBOL_SUB>
                <EQ_SUB line1="184" col1="36" line2="184" col2="36" start="29108" end="29108">=</EQ_SUB>
                <expr line1="184" col1="38" line2="184" col2="46" start="29110" end="29118">
                  <SYMBOL line1="184" col1="38" line2="184" col2="46" start="29110" end="29118">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="184" col1="47" line2="184" col2="47" start="29119" end="29119">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="184" col1="48" line2="184" col2="48" start="29120" end="29120">,</OP-COMMA>
              <SYMBOL_SUB line1="184" col1="50" line2="184" col2="56" start="29122" end="29128">colData</SYMBOL_SUB>
              <EQ_SUB line1="184" col1="58" line2="184" col2="58" start="29130" end="29130">=</EQ_SUB>
              <expr line1="184" col1="60" line2="184" col2="61" start="29132" end="29133">
                <SYMBOL line1="184" col1="60" line2="184" col2="61" start="29132" end="29133">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="184" col1="62" line2="184" col2="62" start="29134" end="29134">,</OP-COMMA>
              <SYMBOL_SUB line1="184" col1="64" line2="184" col2="70" start="29136" end="29142">rowData</SYMBOL_SUB>
              <EQ_SUB line1="184" col1="72" line2="184" col2="72" start="29144" end="29144">=</EQ_SUB>
              <expr line1="184" col1="74" line2="184" col2="75" start="29146" end="29147">
                <SYMBOL line1="184" col1="74" line2="184" col2="75" start="29146" end="29147">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="184" col1="76" line2="184" col2="76" start="29148" end="29148">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="184" col1="77" line2="184" col2="77" start="29149" end="29149">,</OP-COMMA>
            <SYMBOL_SUB line1="185" col1="23" line2="185" col2="26" start="29253" end="29256">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="185" col1="28" line2="185" col2="28" start="29258" end="29258">=</EQ_SUB>
            <expr line1="185" col1="30" line2="186" col2="77" start="29260" end="29465">
              <expr line1="185" col1="30" line2="185" col2="49" start="29260" end="29279">
                <SYMBOL_FUNCTION_CALL line1="185" col1="30" line2="185" col2="49" start="29260" end="29279">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="185" col1="50" line2="185" col2="50" start="29280" end="29280">(</OP-LEFT-PAREN>
              <expr line1="186" col1="27" line2="186" col2="48" start="29415" end="29436">
                <expr line1="186" col1="27" line2="186" col2="30" start="29415" end="29418">
                  <SYMBOL_FUNCTION_CALL line1="186" col1="27" line2="186" col2="30" start="29415" end="29418">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="186" col1="31" line2="186" col2="31" start="29419" end="29419">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="186" col1="32" line2="186" col2="35" start="29420" end="29423">fpkm</SYMBOL_SUB>
                <EQ_SUB line1="186" col1="37" line2="186" col2="37" start="29425" end="29425">=</EQ_SUB>
                <expr line1="186" col1="39" line2="186" col2="47" start="29427" end="29435">
                  <SYMBOL line1="186" col1="39" line2="186" col2="47" start="29427" end="29435">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="186" col1="48" line2="186" col2="48" start="29436" end="29436">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="186" col1="49" line2="186" col2="49" start="29437" end="29437">,</OP-COMMA>
              <SYMBOL_SUB line1="186" col1="51" line2="186" col2="57" start="29439" end="29445">colData</SYMBOL_SUB>
              <EQ_SUB line1="186" col1="59" line2="186" col2="59" start="29447" end="29447">=</EQ_SUB>
              <expr line1="186" col1="61" line2="186" col2="62" start="29449" end="29450">
                <SYMBOL line1="186" col1="61" line2="186" col2="62" start="29449" end="29450">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="186" col1="63" line2="186" col2="63" start="29451" end="29451">,</OP-COMMA>
              <SYMBOL_SUB line1="186" col1="65" line2="186" col2="71" start="29453" end="29459">rowData</SYMBOL_SUB>
              <EQ_SUB line1="186" col1="73" line2="186" col2="73" start="29461" end="29461">=</EQ_SUB>
              <expr line1="186" col1="75" line2="186" col2="76" start="29463" end="29464">
                <SYMBOL line1="186" col1="75" line2="186" col2="76" start="29463" end="29464">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="186" col1="77" line2="186" col2="77" start="29465" end="29465">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="186" col1="78" line2="186" col2="78" start="29466" end="29466">,</OP-COMMA>
            <SYMBOL_SUB line1="187" col1="23" line2="187" col2="28" start="29569" end="29574">counts</SYMBOL_SUB>
            <EQ_SUB line1="187" col1="30" line2="187" col2="30" start="29576" end="29576">=</EQ_SUB>
            <expr line1="187" col1="32" line2="188" col2="79" start="29578" end="29783">
              <expr line1="187" col1="32" line2="187" col2="51" start="29578" end="29597">
                <SYMBOL_FUNCTION_CALL line1="187" col1="32" line2="187" col2="51" start="29578" end="29597">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="187" col1="52" line2="187" col2="52" start="29598" end="29598">(</OP-LEFT-PAREN>
              <expr line1="188" col1="27" line2="188" col2="50" start="29731" end="29754">
                <expr line1="188" col1="27" line2="188" col2="30" start="29731" end="29734">
                  <SYMBOL_FUNCTION_CALL line1="188" col1="27" line2="188" col2="30" start="29731" end="29734">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="188" col1="31" line2="188" col2="31" start="29735" end="29735">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="188" col1="32" line2="188" col2="37" start="29736" end="29741">counts</SYMBOL_SUB>
                <EQ_SUB line1="188" col1="39" line2="188" col2="39" start="29743" end="29743">=</EQ_SUB>
                <expr line1="188" col1="41" line2="188" col2="49" start="29745" end="29753">
                  <SYMBOL line1="188" col1="41" line2="188" col2="49" start="29745" end="29753">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="188" col1="50" line2="188" col2="50" start="29754" end="29754">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="188" col1="51" line2="188" col2="51" start="29755" end="29755">,</OP-COMMA>
              <SYMBOL_SUB line1="188" col1="53" line2="188" col2="59" start="29757" end="29763">colData</SYMBOL_SUB>
              <EQ_SUB line1="188" col1="61" line2="188" col2="61" start="29765" end="29765">=</EQ_SUB>
              <expr line1="188" col1="63" line2="188" col2="64" start="29767" end="29768">
                <SYMBOL line1="188" col1="63" line2="188" col2="64" start="29767" end="29768">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="188" col1="65" line2="188" col2="65" start="29769" end="29769">,</OP-COMMA>
              <SYMBOL_SUB line1="188" col1="67" line2="188" col2="73" start="29771" end="29777">rowData</SYMBOL_SUB>
              <EQ_SUB line1="188" col1="75" line2="188" col2="75" start="29779" end="29779">=</EQ_SUB>
              <expr line1="188" col1="77" line2="188" col2="78" start="29781" end="29782">
                <SYMBOL line1="188" col1="77" line2="188" col2="78" start="29781" end="29782">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="188" col1="79" line2="188" col2="79" start="29783" end="29783">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="188" col1="80" line2="188" col2="80" start="29784" end="29784">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="189" col1="5" line2="189" col2="52" start="29867" end="29914">## Summarise other data in the object if present</COMMENT>
        <COMMENT line1="190" col1="5" line2="190" col2="13" start="30025" end="30033">## counts</COMMENT>
        <expr line1="191" col1="5" line2="191" col2="73" start="30183" end="30251">
          <expr line1="191" col1="5" line2="191" col2="14" start="30183" end="30192">
            <SYMBOL line1="191" col1="5" line2="191" col2="14" start="30183" end="30192">tpm_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="191" col1="16" line2="191" col2="17" start="30194" end="30195">&lt;-</LEFT_ASSIGN>
          <expr line1="191" col1="19" line2="191" col2="73" start="30197" end="30251">
            <expr line1="191" col1="19" line2="191" col2="26" start="30197" end="30204">
              <SYMBOL_FUNCTION_CALL line1="191" col1="19" line2="191" col2="26" start="30197" end="30204">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="191" col1="27" line2="191" col2="27" start="30205" end="30205">(</OP-LEFT-PAREN>
            <expr line1="191" col1="28" line2="191" col2="38" start="30206" end="30216">
              <expr line1="191" col1="28" line2="191" col2="30" start="30206" end="30208">
                <SYMBOL_FUNCTION_CALL line1="191" col1="28" line2="191" col2="30" start="30206" end="30208">tpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="191" col1="31" line2="191" col2="31" start="30209" end="30209">(</OP-LEFT-PAREN>
              <expr line1="191" col1="32" line2="191" col2="37" start="30210" end="30215">
                <SYMBOL line1="191" col1="32" line2="191" col2="37" start="30210" end="30215">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="191" col1="38" line2="191" col2="38" start="30216" end="30216">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="191" col1="39" line2="191" col2="39" start="30217" end="30217">,</OP-COMMA>
            <SYMBOL_SUB line1="191" col1="41" line2="191" col2="45" start="30219" end="30223">error</SYMBOL_SUB>
            <EQ_SUB line1="191" col1="47" line2="191" col2="47" start="30225" end="30225">=</EQ_SUB>
            <expr line1="191" col1="49" line2="191" col2="72" start="30227" end="30250">
              <FUNCTION line1="191" col1="49" line2="191" col2="56" start="30227" end="30234">function</FUNCTION>
              <OP-LEFT-PAREN line1="191" col1="57" line2="191" col2="57" start="30235" end="30235">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="191" col1="58" line2="191" col2="58" start="30236" end="30236">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="191" col1="59" line2="191" col2="59" start="30237" end="30237">)</OP-RIGHT-PAREN>
              <expr line1="191" col1="61" line2="191" col2="72" start="30239" end="30250">
                <expr line1="191" col1="61" line2="191" col2="66" start="30239" end="30244">
                  <SYMBOL_FUNCTION_CALL line1="191" col1="61" line2="191" col2="66" start="30239" end="30244">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="191" col1="67" line2="191" col2="67" start="30245" end="30245">(</OP-LEFT-PAREN>
                <expr line1="191" col1="68" line2="191" col2="71" start="30246" end="30249">
                  <NULL_CONST line1="191" col1="68" line2="191" col2="71" start="30246" end="30249">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="191" col1="72" line2="191" col2="72" start="30250" end="30250">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="191" col1="73" line2="191" col2="73" start="30251" end="30251">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="192" col1="5" line2="192" col2="79" start="30341" end="30415">
          <expr line1="192" col1="5" line2="192" col2="17" start="30341" end="30353">
            <SYMBOL line1="192" col1="5" line2="192" col2="17" start="30341" end="30353">counts_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="192" col1="19" line2="192" col2="20" start="30355" end="30356">&lt;-</LEFT_ASSIGN>
          <expr line1="192" col1="22" line2="192" col2="79" start="30358" end="30415">
            <expr line1="192" col1="22" line2="192" col2="29" start="30358" end="30365">
              <SYMBOL_FUNCTION_CALL line1="192" col1="22" line2="192" col2="29" start="30358" end="30365">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="192" col1="30" line2="192" col2="30" start="30366" end="30366">(</OP-LEFT-PAREN>
            <expr line1="192" col1="31" line2="192" col2="44" start="30367" end="30380">
              <expr line1="192" col1="31" line2="192" col2="36" start="30367" end="30372">
                <SYMBOL_FUNCTION_CALL line1="192" col1="31" line2="192" col2="36" start="30367" end="30372">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="192" col1="37" line2="192" col2="37" start="30373" end="30373">(</OP-LEFT-PAREN>
              <expr line1="192" col1="38" line2="192" col2="43" start="30374" end="30379">
                <SYMBOL line1="192" col1="38" line2="192" col2="43" start="30374" end="30379">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="192" col1="44" line2="192" col2="44" start="30380" end="30380">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="192" col1="45" line2="192" col2="45" start="30381" end="30381">,</OP-COMMA>
            <SYMBOL_SUB line1="192" col1="47" line2="192" col2="51" start="30383" end="30387">error</SYMBOL_SUB>
            <EQ_SUB line1="192" col1="53" line2="192" col2="53" start="30389" end="30389">=</EQ_SUB>
            <expr line1="192" col1="55" line2="192" col2="78" start="30391" end="30414">
              <FUNCTION line1="192" col1="55" line2="192" col2="62" start="30391" end="30398">function</FUNCTION>
              <OP-LEFT-PAREN line1="192" col1="63" line2="192" col2="63" start="30399" end="30399">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="192" col1="64" line2="192" col2="64" start="30400" end="30400">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="192" col1="65" line2="192" col2="65" start="30401" end="30401">)</OP-RIGHT-PAREN>
              <expr line1="192" col1="67" line2="192" col2="78" start="30403" end="30414">
                <expr line1="192" col1="67" line2="192" col2="72" start="30403" end="30408">
                  <SYMBOL_FUNCTION_CALL line1="192" col1="67" line2="192" col2="72" start="30403" end="30408">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="192" col1="73" line2="192" col2="73" start="30409" end="30409">(</OP-LEFT-PAREN>
                <expr line1="192" col1="74" line2="192" col2="77" start="30410" end="30413">
                  <NULL_CONST line1="192" col1="74" line2="192" col2="77" start="30410" end="30413">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="192" col1="78" line2="192" col2="78" start="30414" end="30414">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="192" col1="79" line2="192" col2="79" start="30415" end="30415">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="193" col1="5" line2="222" col2="5" start="30499" end="35081">
          <IF line1="193" col1="5" line2="193" col2="6" start="30499" end="30500">if</IF>
          <OP-LEFT-PAREN line1="193" col1="8" line2="193" col2="8" start="30502" end="30502">(</OP-LEFT-PAREN>
          <expr line1="193" col1="10" line2="193" col2="50" start="30504" end="30544">
            <expr line1="193" col1="10" line2="193" col2="29" start="30504" end="30523">
              <OP-EXCLAMATION line1="193" col1="10" line2="193" col2="10" start="30504" end="30504">!</OP-EXCLAMATION>
              <expr line1="193" col1="11" line2="193" col2="29" start="30505" end="30523">
                <expr line1="193" col1="11" line2="193" col2="17" start="30505" end="30511">
                  <SYMBOL_FUNCTION_CALL line1="193" col1="11" line2="193" col2="17" start="30505" end="30511">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="193" col1="18" line2="193" col2="18" start="30512" end="30512">(</OP-LEFT-PAREN>
                <expr line1="193" col1="19" line2="193" col2="28" start="30513" end="30522">
                  <SYMBOL line1="193" col1="19" line2="193" col2="28" start="30513" end="30522">tpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="193" col1="29" line2="193" col2="29" start="30523" end="30523">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <AND2 line1="193" col1="31" line2="193" col2="32" start="30525" end="30526">&amp;&amp;</AND2>
            <expr line1="193" col1="34" line2="193" col2="50" start="30528" end="30544">
              <SYMBOL line1="193" col1="34" line2="193" col2="50" start="30528" end="30544">scaled_tpm_counts</SYMBOL>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="193" col1="52" line2="193" col2="52" start="30546" end="30546">)</OP-RIGHT-PAREN>
          <expr line1="193" col1="54" line2="212" col2="5" start="30548" end="33501">
            <OP-LEFT-BRACE line1="193" col1="54" line2="193" col2="54" start="30548" end="30548">{</OP-LEFT-BRACE>
            <expr line1="194" col1="9" line2="202" col2="9" start="30661" end="31925">
              <IF line1="194" col1="9" line2="194" col2="10" start="30661" end="30662">if</IF>
              <OP-LEFT-PAREN line1="194" col1="12" line2="194" col2="12" start="30664" end="30664">(</OP-LEFT-PAREN>
              <expr line1="194" col1="14" line2="194" col2="30" start="30666" end="30682">
                <expr line1="194" col1="14" line2="194" col2="20" start="30666" end="30672">
                  <SYMBOL_FUNCTION_CALL line1="194" col1="14" line2="194" col2="20" start="30666" end="30672">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="194" col1="21" line2="194" col2="21" start="30673" end="30673">(</OP-LEFT-PAREN>
                <expr line1="194" col1="22" line2="194" col2="29" start="30674" end="30681">
                  <SYMBOL line1="194" col1="22" line2="194" col2="29" start="30674" end="30681">lib_size</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="194" col1="30" line2="194" col2="30" start="30682" end="30682">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="194" col1="32" line2="194" col2="32" start="30684" end="30684">)</OP-RIGHT-PAREN>
              <expr line1="194" col1="34" line2="199" col2="9" start="30686" end="31451">
                <OP-LEFT-BRACE line1="194" col1="34" line2="194" col2="34" start="30686" end="30686">{</OP-LEFT-BRACE>
                <expr line1="195" col1="13" line2="198" col2="52" start="30823" end="31336">
                  <IF line1="195" col1="13" line2="195" col2="14" start="30823" end="30824">if</IF>
                  <OP-LEFT-PAREN line1="195" col1="16" line2="195" col2="16" start="30826" end="30826">(</OP-LEFT-PAREN>
                  <expr line1="195" col1="18" line2="195" col2="39" start="30828" end="30849">
                    <expr line1="195" col1="18" line2="195" col2="24" start="30828" end="30834">
                      <SYMBOL_FUNCTION_CALL line1="195" col1="18" line2="195" col2="24" start="30828" end="30834">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="195" col1="25" line2="195" col2="25" start="30835" end="30835">(</OP-LEFT-PAREN>
                    <expr line1="195" col1="26" line2="195" col2="38" start="30836" end="30848">
                      <SYMBOL line1="195" col1="26" line2="195" col2="38" start="30836" end="30848">counts_object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="195" col1="39" line2="195" col2="39" start="30849" end="30849">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="195" col1="41" line2="195" col2="41" start="30851" end="30851">)</OP-RIGHT-PAREN>
                  <expr line1="196" col1="17" line2="196" col2="100" start="30985" end="31068">
                    <expr line1="196" col1="17" line2="196" col2="20" start="30985" end="30988">
                      <SYMBOL_FUNCTION_CALL line1="196" col1="17" line2="196" col2="20" start="30985" end="30988">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="196" col1="21" line2="196" col2="21" start="30989" end="30989">(</OP-LEFT-PAREN>
                    <expr line1="196" col1="22" line2="196" col2="99" start="30990" end="31067">
                      <STR_CONST line1="196" col1="22" line2="196" col2="99" start="30990" end="31067">"If object does not contain count values, lib_size argument must be provided."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="196" col1="100" line2="196" col2="100" start="31068" end="31068">)</OP-RIGHT-PAREN>
                  </expr>
                  <ELSE line1="197" col1="13" line2="197" col2="16" start="31139" end="31142">else</ELSE>
                  <expr line1="198" col1="17" line2="198" col2="52" start="31301" end="31336">
                    <expr line1="198" col1="17" line2="198" col2="24" start="31301" end="31308">
                      <SYMBOL line1="198" col1="17" line2="198" col2="24" start="31301" end="31308">lib_size</SYMBOL>
                    </expr>
                    <LEFT_ASSIGN line1="198" col1="26" line2="198" col2="27" start="31310" end="31311">&lt;-</LEFT_ASSIGN>
                    <expr line1="198" col1="29" line2="198" col2="52" start="31313" end="31336">
                      <expr line1="198" col1="29" line2="198" col2="36" start="31313" end="31320">
                        <SYMBOL_FUNCTION_CALL line1="198" col1="29" line2="198" col2="36" start="31313" end="31320">.colSums</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="198" col1="37" line2="198" col2="37" start="31321" end="31321">(</OP-LEFT-PAREN>
                      <expr line1="198" col1="38" line2="198" col2="51" start="31322" end="31335">
                        <expr line1="198" col1="38" line2="198" col2="43" start="31322" end="31327">
                          <SYMBOL_FUNCTION_CALL line1="198" col1="38" line2="198" col2="43" start="31322" end="31327">counts</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="198" col1="44" line2="198" col2="44" start="31328" end="31328">(</OP-LEFT-PAREN>
                        <expr line1="198" col1="45" line2="198" col2="50" start="31329" end="31334">
                          <SYMBOL line1="198" col1="45" line2="198" col2="50" start="31329" end="31334">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="198" col1="51" line2="198" col2="51" start="31335" end="31335">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="198" col1="52" line2="198" col2="52" start="31336" end="31336">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="199" col1="9" line2="199" col2="9" start="31451" end="31451">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="199" col1="11" line2="199" col2="14" start="31453" end="31456">else</ELSE>
              <expr line1="199" col1="16" line2="202" col2="9" start="31458" end="31925">
                <OP-LEFT-BRACE line1="199" col1="16" line2="199" col2="16" start="31458" end="31458">{</OP-LEFT-BRACE>
                <expr line1="200" col1="13" line2="201" col2="96" start="31613" end="31854">
                  <IF line1="200" col1="13" line2="200" col2="14" start="31613" end="31614">if</IF>
                  <OP-LEFT-PAREN line1="200" col1="16" line2="200" col2="16" start="31616" end="31616">(</OP-LEFT-PAREN>
                  <expr line1="200" col1="18" line2="200" col2="49" start="31618" end="31649">
                    <expr line1="200" col1="18" line2="200" col2="33" start="31618" end="31633">
                      <expr line1="200" col1="18" line2="200" col2="23" start="31618" end="31623">
                        <SYMBOL_FUNCTION_CALL line1="200" col1="18" line2="200" col2="23" start="31618" end="31623">length</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="200" col1="24" line2="200" col2="24" start="31624" end="31624">(</OP-LEFT-PAREN>
                      <expr line1="200" col1="25" line2="200" col2="32" start="31625" end="31632">
                        <SYMBOL line1="200" col1="25" line2="200" col2="32" start="31625" end="31632">lib_size</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="200" col1="33" line2="200" col2="33" start="31633" end="31633">)</OP-RIGHT-PAREN>
                    </expr>
                    <NE line1="200" col1="35" line2="200" col2="36" start="31635" end="31636">!=</NE>
                    <expr line1="200" col1="38" line2="200" col2="49" start="31638" end="31649">
                      <expr line1="200" col1="38" line2="200" col2="41" start="31638" end="31641">
                        <SYMBOL_FUNCTION_CALL line1="200" col1="38" line2="200" col2="41" start="31638" end="31641">ncol</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="200" col1="42" line2="200" col2="42" start="31642" end="31642">(</OP-LEFT-PAREN>
                      <expr line1="200" col1="43" line2="200" col2="48" start="31643" end="31648">
                        <SYMBOL line1="200" col1="43" line2="200" col2="48" start="31643" end="31648">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="200" col1="49" line2="200" col2="49" start="31649" end="31649">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="200" col1="50" line2="200" col2="50" start="31650" end="31650">)</OP-RIGHT-PAREN>
                  <expr line1="201" col1="17" line2="201" col2="96" start="31775" end="31854">
                    <expr line1="201" col1="17" line2="201" col2="20" start="31775" end="31778">
                      <SYMBOL_FUNCTION_CALL line1="201" col1="17" line2="201" col2="20" start="31775" end="31778">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="201" col1="21" line2="201" col2="21" start="31779" end="31779">(</OP-LEFT-PAREN>
                    <expr line1="201" col1="22" line2="201" col2="95" start="31780" end="31853">
                      <STR_CONST line1="201" col1="22" line2="201" col2="95" start="31780" end="31853">"lib_size argument must have length equal to number of columns of object."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="201" col1="96" line2="201" col2="96" start="31854" end="31854">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="202" col1="9" line2="202" col2="9" start="31925" end="31925">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="203" col1="9" line2="204" col2="44" start="32083" end="32276">
              <expr line1="203" col1="9" line2="203" col2="17" start="32083" end="32091">
                <SYMBOL line1="203" col1="9" line2="203" col2="17" start="32083" end="32091">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="203" col1="19" line2="203" col2="20" start="32093" end="32094">&lt;-</LEFT_ASSIGN>
              <expr line1="203" col1="22" line2="204" col2="44" start="32096" end="32276">
                <expr line1="203" col1="22" line2="203" col2="31" start="32096" end="32105">
                  <SYMBOL_FUNCTION_CALL line1="203" col1="22" line2="203" col2="31" start="32096" end="32105">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="203" col1="32" line2="203" col2="32" start="32106" end="32106">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="203" col1="33" line2="203" col2="39" start="32107" end="32113">feature</SYMBOL_SUB>
                <EQ_SUB line1="203" col1="41" line2="203" col2="41" start="32115" end="32115">=</EQ_SUB>
                <expr line1="203" col1="43" line2="203" col2="73" start="32117" end="32147">
                  <expr line1="203" col1="43" line2="203" col2="57" start="32117" end="32131">
                    <expr line1="203" col1="43" line2="203" col2="49" start="32117" end="32123">
                      <SYMBOL_FUNCTION_CALL line1="203" col1="43" line2="203" col2="49" start="32117" end="32123">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="203" col1="50" line2="203" col2="50" start="32124" end="32124">(</OP-LEFT-PAREN>
                    <expr line1="203" col1="51" line2="203" col2="56" start="32125" end="32130">
                      <SYMBOL line1="203" col1="51" line2="203" col2="56" start="32125" end="32130">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="203" col1="57" line2="203" col2="57" start="32131" end="32131">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="203" col1="58" line2="203" col2="59" start="32132" end="32133">[[</LBB>
                  <expr line1="203" col1="60" line2="203" col2="71" start="32134" end="32145">
                    <SYMBOL line1="203" col1="60" line2="203" col2="71" start="32134" end="32145">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="203" col1="72" line2="203" col2="72" start="32146" end="32146">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="203" col1="73" line2="203" col2="73" start="32147" end="32147">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="203" col1="74" line2="203" col2="74" start="32148" end="32148">,</OP-COMMA>
                <expr line1="204" col1="33" line2="204" col2="43" start="32265" end="32275">
                  <expr line1="204" col1="33" line2="204" col2="35" start="32265" end="32267">
                    <SYMBOL_FUNCTION_CALL line1="204" col1="33" line2="204" col2="35" start="32265" end="32267">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="204" col1="36" line2="204" col2="36" start="32268" end="32268">(</OP-LEFT-PAREN>
                  <expr line1="204" col1="37" line2="204" col2="42" start="32269" end="32274">
                    <SYMBOL line1="204" col1="37" line2="204" col2="42" start="32269" end="32274">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="204" col1="43" line2="204" col2="43" start="32275" end="32275">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="204" col1="44" line2="204" col2="44" start="32276" end="32276">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="205" col1="9" line2="205" col2="51" start="32399" end="32441">
              <expr line1="205" col1="9" line2="205" col2="22" start="32399" end="32412">
                <SYMBOL line1="205" col1="9" line2="205" col2="22" start="32399" end="32412">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="205" col1="24" line2="205" col2="25" start="32414" end="32415">&lt;-</LEFT_ASSIGN>
              <expr line1="205" col1="27" line2="205" col2="51" start="32417" end="32441">
                <expr line1="205" col1="27" line2="205" col2="40" start="32417" end="32430">
                  <SYMBOL_PACKAGE line1="205" col1="27" line2="205" col2="34" start="32417" end="32424">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="205" col1="35" line2="205" col2="36" start="32425" end="32426">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="205" col1="37" line2="205" col2="40" start="32427" end="32430">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="205" col1="41" line2="205" col2="41" start="32431" end="32431">(</OP-LEFT-PAREN>
                <expr line1="205" col1="42" line2="205" col2="50" start="32432" end="32440">
                  <SYMBOL line1="205" col1="42" line2="205" col2="50" start="32432" end="32440">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="205" col1="51" line2="205" col2="51" start="32441" end="32441">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="206" col1="9" line2="206" col2="78" start="32557" end="32626">
              <expr line1="206" col1="9" line2="206" col2="18" start="32557" end="32566">
                <SYMBOL line1="206" col1="9" line2="206" col2="18" start="32557" end="32566">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="206" col1="20" line2="206" col2="21" start="32568" end="32569">&lt;-</LEFT_ASSIGN>
              <expr line1="206" col1="23" line2="206" col2="78" start="32571" end="32626">
                <expr line1="206" col1="23" line2="206" col2="37" start="32571" end="32585">
                  <SYMBOL_PACKAGE line1="206" col1="23" line2="206" col2="30" start="32571" end="32578">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="206" col1="31" line2="206" col2="32" start="32579" end="32580">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="206" col1="33" line2="206" col2="37" start="32581" end="32585">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="206" col1="38" line2="206" col2="38" start="32586" end="32586">(</OP-LEFT-PAREN>
                <expr line1="206" col1="39" line2="206" col2="52" start="32587" end="32600">
                  <SYMBOL line1="206" col1="39" line2="206" col2="52" start="32587" end="32600">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="206" col1="53" line2="206" col2="53" start="32601" end="32601">,</OP-COMMA>
                <expr line1="206" col1="55" line2="206" col2="72" start="32603" end="32620">
                  <expr line1="206" col1="55" line2="206" col2="61" start="32603" end="32609">
                    <SYMBOL line1="206" col1="55" line2="206" col2="61" start="32603" end="32609">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="206" col1="63" line2="206" col2="63" start="32611" end="32611">~</OP-TILDE>
                  <expr line1="206" col1="65" line2="206" col2="72" start="32613" end="32620">
                    <SYMBOL line1="206" col1="65" line2="206" col2="72" start="32613" end="32620">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="206" col1="73" line2="206" col2="73" start="32621" end="32621">,</OP-COMMA>
                <expr line1="206" col1="75" line2="206" col2="77" start="32623" end="32625">
                  <SYMBOL line1="206" col1="75" line2="206" col2="77" start="32623" end="32625">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="206" col1="78" line2="206" col2="78" start="32626" end="32626">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <COMMENT line1="207" col1="9" line2="207" col2="63" start="32715" end="32769">## scale TPM by total library size to get scaled counts</COMMENT>
            <expr line1="208" col1="9" line2="208" col2="57" start="32873" end="32921">
              <expr line1="208" col1="9" line2="208" col2="18" start="32873" end="32882">
                <SYMBOL line1="208" col1="9" line2="208" col2="18" start="32873" end="32882">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="208" col1="20" line2="208" col2="21" start="32884" end="32885">&lt;-</LEFT_ASSIGN>
              <expr line1="208" col1="23" line2="208" col2="57" start="32887" end="32921">
                <expr line1="208" col1="23" line2="208" col2="23" start="32887" end="32887">
                  <SYMBOL_FUNCTION_CALL line1="208" col1="23" line2="208" col2="23" start="32887" end="32887">t</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="208" col1="24" line2="208" col2="24" start="32888" end="32888">(</OP-LEFT-PAREN>
                <expr line1="208" col1="25" line2="208" col2="56" start="32889" end="32920">
                  <expr line1="208" col1="25" line2="208" col2="48" start="32889" end="32912">
                    <expr line1="208" col1="25" line2="208" col2="37" start="32889" end="32901">
                      <expr line1="208" col1="25" line2="208" col2="25" start="32889" end="32889">
                        <SYMBOL_FUNCTION_CALL line1="208" col1="25" line2="208" col2="25" start="32889" end="32889">t</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="208" col1="26" line2="208" col2="26" start="32890" end="32890">(</OP-LEFT-PAREN>
                      <expr line1="208" col1="27" line2="208" col2="36" start="32891" end="32900">
                        <SYMBOL line1="208" col1="27" line2="208" col2="36" start="32891" end="32900">counts_new</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="208" col1="37" line2="208" col2="37" start="32901" end="32901">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-STAR line1="208" col1="39" line2="208" col2="39" start="32903" end="32903">*</OP-STAR>
                    <expr line1="208" col1="41" line2="208" col2="48" start="32905" end="32912">
                      <SYMBOL line1="208" col1="41" line2="208" col2="48" start="32905" end="32912">lib_size</SYMBOL>
                    </expr>
                  </expr>
                  <OP-STAR line1="208" col1="50" line2="208" col2="50" start="32914" end="32914">*</OP-STAR>
                  <expr line1="208" col1="52" line2="208" col2="56" start="32916" end="32920">
                    <NUM_CONST line1="208" col1="52" line2="208" col2="56" start="32916" end="32920">1e-06</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="208" col1="57" line2="208" col2="57" start="32921" end="32921">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="209" col1="9" line2="209" col2="48" start="33031" end="33070">
              <expr line1="209" col1="9" line2="209" col2="28" start="33031" end="33050">
                <expr line1="209" col1="9" line2="209" col2="16" start="33031" end="33038">
                  <SYMBOL_FUNCTION_CALL line1="209" col1="9" line2="209" col2="16" start="33031" end="33038">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="209" col1="17" line2="209" col2="17" start="33039" end="33039">(</OP-LEFT-PAREN>
                <expr line1="209" col1="18" line2="209" col2="27" start="33040" end="33049">
                  <SYMBOL line1="209" col1="18" line2="209" col2="27" start="33040" end="33049">counts_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="209" col1="28" line2="209" col2="28" start="33050" end="33050">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="209" col1="30" line2="209" col2="31" start="33052" end="33053">&lt;-</LEFT_ASSIGN>
              <expr line1="209" col1="33" line2="209" col2="48" start="33055" end="33070">
                <expr line1="209" col1="33" line2="209" col2="40" start="33055" end="33062">
                  <SYMBOL_FUNCTION_CALL line1="209" col1="33" line2="209" col2="40" start="33055" end="33062">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="209" col1="41" line2="209" col2="41" start="33063" end="33063">(</OP-LEFT-PAREN>
                <expr line1="209" col1="42" line2="209" col2="47" start="33064" end="33069">
                  <SYMBOL line1="209" col1="42" line2="209" col2="47" start="33064" end="33069">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="209" col1="48" line2="209" col2="48" start="33070" end="33070">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="210" col1="9" line2="210" col2="37" start="33189" end="33217">
              <expr line1="210" col1="9" line2="210" col2="23" start="33189" end="33203">
                <expr line1="210" col1="9" line2="210" col2="14" start="33189" end="33194">
                  <SYMBOL_FUNCTION_CALL line1="210" col1="9" line2="210" col2="14" start="33189" end="33194">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="210" col1="15" line2="210" col2="15" start="33195" end="33195">(</OP-LEFT-PAREN>
                <expr line1="210" col1="16" line2="210" col2="22" start="33196" end="33202">
                  <SYMBOL line1="210" col1="16" line2="210" col2="22" start="33196" end="33202">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="210" col1="23" line2="210" col2="23" start="33203" end="33203">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="210" col1="25" line2="210" col2="26" start="33205" end="33206">&lt;-</LEFT_ASSIGN>
              <expr line1="210" col1="28" line2="210" col2="37" start="33208" end="33217">
                <SYMBOL line1="210" col1="28" line2="210" col2="37" start="33208" end="33217">counts_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="211" col1="9" line2="211" col2="22" start="33347" end="33360">
              <expr line1="211" col1="9" line2="211" col2="10" start="33347" end="33348">
                <SYMBOL_FUNCTION_CALL line1="211" col1="9" line2="211" col2="10" start="33347" end="33348">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="211" col1="11" line2="211" col2="11" start="33349" end="33349">(</OP-LEFT-PAREN>
              <expr line1="211" col1="12" line2="211" col2="21" start="33350" end="33359">
                <SYMBOL line1="211" col1="12" line2="211" col2="21" start="33350" end="33359">counts_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="211" col1="22" line2="211" col2="22" start="33360" end="33360">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="212" col1="5" line2="212" col2="5" start="33501" end="33501">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="212" col1="7" line2="212" col2="10" start="33503" end="33506">else</ELSE>
          <expr line1="212" col1="12" line2="222" col2="5" start="33508" end="35081">
            <OP-LEFT-BRACE line1="212" col1="12" line2="212" col2="12" start="33508" end="33508">{</OP-LEFT-BRACE>
            <expr line1="213" col1="9" line2="221" col2="9" start="33663" end="34927">
              <IF line1="213" col1="9" line2="213" col2="10" start="33663" end="33664">if</IF>
              <OP-LEFT-PAREN line1="213" col1="12" line2="213" col2="12" start="33666" end="33666">(</OP-LEFT-PAREN>
              <expr line1="213" col1="14" line2="213" col2="64" start="33668" end="33718">
                <expr line1="213" col1="14" line2="213" col2="37" start="33668" end="33691">
                  <expr line1="213" col1="14" line2="213" col2="25" start="33668" end="33679">
                    <SYMBOL line1="213" col1="14" line2="213" col2="25" start="33668" end="33679">exprs_values</SYMBOL>
                  </expr>
                  <NE line1="213" col1="27" line2="213" col2="28" start="33681" end="33682">!=</NE>
                  <expr line1="213" col1="30" line2="213" col2="37" start="33684" end="33691">
                    <STR_CONST line1="213" col1="30" line2="213" col2="37" start="33684" end="33691">"counts"</STR_CONST>
                  </expr>
                </expr>
                <AND2 line1="213" col1="39" line2="213" col2="40" start="33693" end="33694">&amp;&amp;</AND2>
                <expr line1="213" col1="42" line2="213" col2="64" start="33696" end="33718">
                  <OP-EXCLAMATION line1="213" col1="42" line2="213" col2="42" start="33696" end="33696">!</OP-EXCLAMATION>
                  <expr line1="213" col1="43" line2="213" col2="64" start="33697" end="33718">
                    <expr line1="213" col1="43" line2="213" col2="49" start="33697" end="33703">
                      <SYMBOL_FUNCTION_CALL line1="213" col1="43" line2="213" col2="49" start="33697" end="33703">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="213" col1="50" line2="213" col2="50" start="33704" end="33704">(</OP-LEFT-PAREN>
                    <expr line1="213" col1="51" line2="213" col2="63" start="33705" end="33717">
                      <SYMBOL line1="213" col1="51" line2="213" col2="63" start="33705" end="33717">counts_object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="213" col1="64" line2="213" col2="64" start="33718" end="33718">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="213" col1="66" line2="213" col2="66" start="33720" end="33720">)</OP-RIGHT-PAREN>
              <expr line1="213" col1="68" line2="221" col2="9" start="33722" end="34927">
                <OP-LEFT-BRACE line1="213" col1="68" line2="213" col2="68" start="33722" end="33722">{</OP-LEFT-BRACE>
                <expr line1="214" col1="13" line2="215" col2="51" start="33825" end="34021">
                  <expr line1="214" col1="13" line2="214" col2="21" start="33825" end="33833">
                    <SYMBOL line1="214" col1="13" line2="214" col2="21" start="33825" end="33833">tmp_exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="214" col1="23" line2="214" col2="24" start="33835" end="33836">&lt;-</LEFT_ASSIGN>
                  <expr line1="214" col1="26" line2="215" col2="51" start="33838" end="34021">
                    <expr line1="214" col1="26" line2="214" col2="35" start="33838" end="33847">
                      <SYMBOL_FUNCTION_CALL line1="214" col1="26" line2="214" col2="35" start="33838" end="33847">data.frame</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="214" col1="36" line2="214" col2="36" start="33848" end="33848">(</OP-LEFT-PAREN>
                    <SYMBOL_SUB line1="214" col1="37" line2="214" col2="43" start="33849" end="33855">feature</SYMBOL_SUB>
                    <EQ_SUB line1="214" col1="45" line2="214" col2="45" start="33857" end="33857">=</EQ_SUB>
                    <expr line1="214" col1="47" line2="214" col2="77" start="33859" end="33889">
                      <expr line1="214" col1="47" line2="214" col2="61" start="33859" end="33873">
                        <expr line1="214" col1="47" line2="214" col2="53" start="33859" end="33865">
                          <SYMBOL_FUNCTION_CALL line1="214" col1="47" line2="214" col2="53" start="33859" end="33865">rowData</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="214" col1="54" line2="214" col2="54" start="33866" end="33866">(</OP-LEFT-PAREN>
                        <expr line1="214" col1="55" line2="214" col2="60" start="33867" end="33872">
                          <SYMBOL line1="214" col1="55" line2="214" col2="60" start="33867" end="33872">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="214" col1="61" line2="214" col2="61" start="33873" end="33873">)</OP-RIGHT-PAREN>
                      </expr>
                      <LBB line1="214" col1="62" line2="214" col2="63" start="33874" end="33875">[[</LBB>
                      <expr line1="214" col1="64" line2="214" col2="75" start="33876" end="33887">
                        <SYMBOL line1="214" col1="64" line2="214" col2="75" start="33876" end="33887">summarise_by</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="214" col1="76" line2="214" col2="76" start="33888" end="33888">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="214" col1="77" line2="214" col2="77" start="33889" end="33889">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="214" col1="78" line2="214" col2="78" start="33890" end="33890">,</OP-COMMA>
                    <expr line1="215" col1="37" line2="215" col2="50" start="34007" end="34020">
                      <expr line1="215" col1="37" line2="215" col2="42" start="34007" end="34012">
                        <SYMBOL_FUNCTION_CALL line1="215" col1="37" line2="215" col2="42" start="34007" end="34012">counts</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="215" col1="43" line2="215" col2="43" start="34013" end="34013">(</OP-LEFT-PAREN>
                      <expr line1="215" col1="44" line2="215" col2="49" start="34014" end="34019">
                        <SYMBOL line1="215" col1="44" line2="215" col2="49" start="34014" end="34019">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="215" col1="50" line2="215" col2="50" start="34020" end="34020">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="215" col1="51" line2="215" col2="51" start="34021" end="34021">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="216" col1="13" line2="216" col2="55" start="34141" end="34183">
                  <expr line1="216" col1="13" line2="216" col2="26" start="34141" end="34154">
                    <SYMBOL line1="216" col1="13" line2="216" col2="26" start="34141" end="34154">tmp_exprs_long</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="216" col1="28" line2="216" col2="29" start="34156" end="34157">&lt;-</LEFT_ASSIGN>
                  <expr line1="216" col1="31" line2="216" col2="55" start="34159" end="34183">
                    <expr line1="216" col1="31" line2="216" col2="44" start="34159" end="34172">
                      <SYMBOL_PACKAGE line1="216" col1="31" line2="216" col2="38" start="34159" end="34166">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="216" col1="39" line2="216" col2="40" start="34167" end="34168">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="216" col1="41" line2="216" col2="44" start="34169" end="34172">melt</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="216" col1="45" line2="216" col2="45" start="34173" end="34173">(</OP-LEFT-PAREN>
                    <expr line1="216" col1="46" line2="216" col2="54" start="34174" end="34182">
                      <SYMBOL line1="216" col1="46" line2="216" col2="54" start="34174" end="34182">tmp_exprs</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="216" col1="55" line2="216" col2="55" start="34183" end="34183">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="217" col1="13" line2="217" col2="82" start="34299" end="34368">
                  <expr line1="217" col1="13" line2="217" col2="22" start="34299" end="34308">
                    <SYMBOL line1="217" col1="13" line2="217" col2="22" start="34299" end="34308">counts_new</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="217" col1="24" line2="217" col2="25" start="34310" end="34311">&lt;-</LEFT_ASSIGN>
                  <expr line1="217" col1="27" line2="217" col2="82" start="34313" end="34368">
                    <expr line1="217" col1="27" line2="217" col2="41" start="34313" end="34327">
                      <SYMBOL_PACKAGE line1="217" col1="27" line2="217" col2="34" start="34313" end="34320">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="217" col1="35" line2="217" col2="36" start="34321" end="34322">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="217" col1="37" line2="217" col2="41" start="34323" end="34327">acast</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="217" col1="42" line2="217" col2="42" start="34328" end="34328">(</OP-LEFT-PAREN>
                    <expr line1="217" col1="43" line2="217" col2="56" start="34329" end="34342">
                      <SYMBOL line1="217" col1="43" line2="217" col2="56" start="34329" end="34342">tmp_exprs_long</SYMBOL>
                    </expr>
                    <OP-COMMA line1="217" col1="57" line2="217" col2="57" start="34343" end="34343">,</OP-COMMA>
                    <expr line1="217" col1="59" line2="217" col2="76" start="34345" end="34362">
                      <expr line1="217" col1="59" line2="217" col2="65" start="34345" end="34351">
                        <SYMBOL line1="217" col1="59" line2="217" col2="65" start="34345" end="34351">feature</SYMBOL>
                      </expr>
                      <OP-TILDE line1="217" col1="67" line2="217" col2="67" start="34353" end="34353">~</OP-TILDE>
                      <expr line1="217" col1="69" line2="217" col2="76" start="34355" end="34362">
                        <SYMBOL line1="217" col1="69" line2="217" col2="76" start="34355" end="34362">variable</SYMBOL>
                      </expr>
                    </expr>
                    <OP-COMMA line1="217" col1="77" line2="217" col2="77" start="34363" end="34363">,</OP-COMMA>
                    <expr line1="217" col1="79" line2="217" col2="81" start="34365" end="34367">
                      <SYMBOL line1="217" col1="79" line2="217" col2="81" start="34365" end="34367">sum</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="217" col1="82" line2="217" col2="82" start="34368" end="34368">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="218" col1="13" line2="218" col2="52" start="34457" end="34496">
                  <expr line1="218" col1="13" line2="218" col2="32" start="34457" end="34476">
                    <expr line1="218" col1="13" line2="218" col2="20" start="34457" end="34464">
                      <SYMBOL_FUNCTION_CALL line1="218" col1="13" line2="218" col2="20" start="34457" end="34464">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="218" col1="21" line2="218" col2="21" start="34465" end="34465">(</OP-LEFT-PAREN>
                    <expr line1="218" col1="22" line2="218" col2="31" start="34466" end="34475">
                      <SYMBOL line1="218" col1="22" line2="218" col2="31" start="34466" end="34475">counts_new</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="218" col1="32" line2="218" col2="32" start="34476" end="34476">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="218" col1="34" line2="218" col2="35" start="34478" end="34479">&lt;-</LEFT_ASSIGN>
                  <expr line1="218" col1="37" line2="218" col2="52" start="34481" end="34496">
                    <expr line1="218" col1="37" line2="218" col2="44" start="34481" end="34488">
                      <SYMBOL_FUNCTION_CALL line1="218" col1="37" line2="218" col2="44" start="34481" end="34488">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="218" col1="45" line2="218" col2="45" start="34489" end="34489">(</OP-LEFT-PAREN>
                    <expr line1="218" col1="46" line2="218" col2="51" start="34490" end="34495">
                      <SYMBOL line1="218" col1="46" line2="218" col2="51" start="34490" end="34495">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="218" col1="52" line2="218" col2="52" start="34496" end="34496">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="219" col1="13" line2="219" col2="41" start="34615" end="34643">
                  <expr line1="219" col1="13" line2="219" col2="27" start="34615" end="34629">
                    <expr line1="219" col1="13" line2="219" col2="18" start="34615" end="34620">
                      <SYMBOL_FUNCTION_CALL line1="219" col1="13" line2="219" col2="18" start="34615" end="34620">counts</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="219" col1="19" line2="219" col2="19" start="34621" end="34621">(</OP-LEFT-PAREN>
                    <expr line1="219" col1="20" line2="219" col2="26" start="34622" end="34628">
                      <SYMBOL line1="219" col1="20" line2="219" col2="26" start="34622" end="34628">sce_out</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="219" col1="27" line2="219" col2="27" start="34629" end="34629">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="219" col1="29" line2="219" col2="30" start="34631" end="34632">&lt;-</LEFT_ASSIGN>
                  <expr line1="219" col1="32" line2="219" col2="41" start="34634" end="34643">
                    <SYMBOL line1="219" col1="32" line2="219" col2="41" start="34634" end="34643">counts_new</SYMBOL>
                  </expr>
                </expr>
                <expr line1="220" col1="13" line2="220" col2="26" start="34773" end="34786">
                  <expr line1="220" col1="13" line2="220" col2="14" start="34773" end="34774">
                    <SYMBOL_FUNCTION_CALL line1="220" col1="13" line2="220" col2="14" start="34773" end="34774">rm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="220" col1="15" line2="220" col2="15" start="34775" end="34775">(</OP-LEFT-PAREN>
                  <expr line1="220" col1="16" line2="220" col2="25" start="34776" end="34785">
                    <SYMBOL line1="220" col1="16" line2="220" col2="25" start="34776" end="34785">counts_new</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="220" col1="26" line2="220" col2="26" start="34786" end="34786">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="221" col1="9" line2="221" col2="9" start="34927" end="34927">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="222" col1="5" line2="222" col2="5" start="35081" end="35081">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="223" col1="5" line2="231" col2="5" start="35239" end="36503">
          <IF line1="223" col1="5" line2="223" col2="6" start="35239" end="35240">if</IF>
          <OP-LEFT-PAREN line1="223" col1="8" line2="223" col2="8" start="35242" end="35242">(</OP-LEFT-PAREN>
          <expr line1="223" col1="10" line2="223" col2="54" start="35244" end="35288">
            <expr line1="223" col1="10" line2="223" col2="30" start="35244" end="35264">
              <expr line1="223" col1="10" line2="223" col2="21" start="35244" end="35255">
                <SYMBOL line1="223" col1="10" line2="223" col2="21" start="35244" end="35255">exprs_values</SYMBOL>
              </expr>
              <NE line1="223" col1="23" line2="223" col2="24" start="35257" end="35258">!=</NE>
              <expr line1="223" col1="26" line2="223" col2="30" start="35260" end="35264">
                <STR_CONST line1="223" col1="26" line2="223" col2="30" start="35260" end="35264">"tpm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="223" col1="32" line2="223" col2="33" start="35266" end="35267">&amp;&amp;</AND2>
            <expr line1="223" col1="35" line2="223" col2="54" start="35269" end="35288">
              <OP-EXCLAMATION line1="223" col1="35" line2="223" col2="35" start="35269" end="35269">!</OP-EXCLAMATION>
              <expr line1="223" col1="36" line2="223" col2="54" start="35270" end="35288">
                <expr line1="223" col1="36" line2="223" col2="42" start="35270" end="35276">
                  <SYMBOL_FUNCTION_CALL line1="223" col1="36" line2="223" col2="42" start="35270" end="35276">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="223" col1="43" line2="223" col2="43" start="35277" end="35277">(</OP-LEFT-PAREN>
                <expr line1="223" col1="44" line2="223" col2="53" start="35278" end="35287">
                  <SYMBOL line1="223" col1="44" line2="223" col2="53" start="35278" end="35287">tpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="223" col1="54" line2="223" col2="54" start="35288" end="35288">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="223" col1="56" line2="223" col2="56" start="35290" end="35290">)</OP-RIGHT-PAREN>
          <expr line1="223" col1="58" line2="231" col2="5" start="35292" end="36503">
            <OP-LEFT-BRACE line1="223" col1="58" line2="223" col2="58" start="35292" end="35292">{</OP-LEFT-BRACE>
            <expr line1="224" col1="9" line2="225" col2="44" start="35401" end="35594">
              <expr line1="224" col1="9" line2="224" col2="17" start="35401" end="35409">
                <SYMBOL line1="224" col1="9" line2="224" col2="17" start="35401" end="35409">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="224" col1="19" line2="224" col2="20" start="35411" end="35412">&lt;-</LEFT_ASSIGN>
              <expr line1="224" col1="22" line2="225" col2="44" start="35414" end="35594">
                <expr line1="224" col1="22" line2="224" col2="31" start="35414" end="35423">
                  <SYMBOL_FUNCTION_CALL line1="224" col1="22" line2="224" col2="31" start="35414" end="35423">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="224" col1="32" line2="224" col2="32" start="35424" end="35424">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="224" col1="33" line2="224" col2="39" start="35425" end="35431">feature</SYMBOL_SUB>
                <EQ_SUB line1="224" col1="41" line2="224" col2="41" start="35433" end="35433">=</EQ_SUB>
                <expr line1="224" col1="43" line2="224" col2="73" start="35435" end="35465">
                  <expr line1="224" col1="43" line2="224" col2="57" start="35435" end="35449">
                    <expr line1="224" col1="43" line2="224" col2="49" start="35435" end="35441">
                      <SYMBOL_FUNCTION_CALL line1="224" col1="43" line2="224" col2="49" start="35435" end="35441">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="224" col1="50" line2="224" col2="50" start="35442" end="35442">(</OP-LEFT-PAREN>
                    <expr line1="224" col1="51" line2="224" col2="56" start="35443" end="35448">
                      <SYMBOL line1="224" col1="51" line2="224" col2="56" start="35443" end="35448">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="224" col1="57" line2="224" col2="57" start="35449" end="35449">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="224" col1="58" line2="224" col2="59" start="35450" end="35451">[[</LBB>
                  <expr line1="224" col1="60" line2="224" col2="71" start="35452" end="35463">
                    <SYMBOL line1="224" col1="60" line2="224" col2="71" start="35452" end="35463">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="224" col1="72" line2="224" col2="72" start="35464" end="35464">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="224" col1="73" line2="224" col2="73" start="35465" end="35465">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="224" col1="74" line2="224" col2="74" start="35466" end="35466">,</OP-COMMA>
                <expr line1="225" col1="33" line2="225" col2="43" start="35583" end="35593">
                  <expr line1="225" col1="33" line2="225" col2="35" start="35583" end="35585">
                    <SYMBOL_FUNCTION_CALL line1="225" col1="33" line2="225" col2="35" start="35583" end="35585">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="225" col1="36" line2="225" col2="36" start="35586" end="35586">(</OP-LEFT-PAREN>
                  <expr line1="225" col1="37" line2="225" col2="42" start="35587" end="35592">
                    <SYMBOL line1="225" col1="37" line2="225" col2="42" start="35587" end="35592">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="225" col1="43" line2="225" col2="43" start="35593" end="35593">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="225" col1="44" line2="225" col2="44" start="35594" end="35594">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="226" col1="9" line2="226" col2="51" start="35717" end="35759">
              <expr line1="226" col1="9" line2="226" col2="22" start="35717" end="35730">
                <SYMBOL line1="226" col1="9" line2="226" col2="22" start="35717" end="35730">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="226" col1="24" line2="226" col2="25" start="35732" end="35733">&lt;-</LEFT_ASSIGN>
              <expr line1="226" col1="27" line2="226" col2="51" start="35735" end="35759">
                <expr line1="226" col1="27" line2="226" col2="40" start="35735" end="35748">
                  <SYMBOL_PACKAGE line1="226" col1="27" line2="226" col2="34" start="35735" end="35742">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="226" col1="35" line2="226" col2="36" start="35743" end="35744">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="226" col1="37" line2="226" col2="40" start="35745" end="35748">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="226" col1="41" line2="226" col2="41" start="35749" end="35749">(</OP-LEFT-PAREN>
                <expr line1="226" col1="42" line2="226" col2="50" start="35750" end="35758">
                  <SYMBOL line1="226" col1="42" line2="226" col2="50" start="35750" end="35758">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="226" col1="51" line2="226" col2="51" start="35759" end="35759">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="227" col1="9" line2="227" col2="75" start="35875" end="35941">
              <expr line1="227" col1="9" line2="227" col2="15" start="35875" end="35881">
                <SYMBOL line1="227" col1="9" line2="227" col2="15" start="35875" end="35881">tpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="227" col1="17" line2="227" col2="18" start="35883" end="35884">&lt;-</LEFT_ASSIGN>
              <expr line1="227" col1="20" line2="227" col2="75" start="35886" end="35941">
                <expr line1="227" col1="20" line2="227" col2="34" start="35886" end="35900">
                  <SYMBOL_PACKAGE line1="227" col1="20" line2="227" col2="27" start="35886" end="35893">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="227" col1="28" line2="227" col2="29" start="35894" end="35895">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="227" col1="30" line2="227" col2="34" start="35896" end="35900">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="227" col1="35" line2="227" col2="35" start="35901" end="35901">(</OP-LEFT-PAREN>
                <expr line1="227" col1="36" line2="227" col2="49" start="35902" end="35915">
                  <SYMBOL line1="227" col1="36" line2="227" col2="49" start="35902" end="35915">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="227" col1="50" line2="227" col2="50" start="35916" end="35916">,</OP-COMMA>
                <expr line1="227" col1="52" line2="227" col2="69" start="35918" end="35935">
                  <expr line1="227" col1="52" line2="227" col2="58" start="35918" end="35924">
                    <SYMBOL line1="227" col1="52" line2="227" col2="58" start="35918" end="35924">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="227" col1="60" line2="227" col2="60" start="35926" end="35926">~</OP-TILDE>
                  <expr line1="227" col1="62" line2="227" col2="69" start="35928" end="35935">
                    <SYMBOL line1="227" col1="62" line2="227" col2="69" start="35928" end="35935">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="227" col1="70" line2="227" col2="70" start="35936" end="35936">,</OP-COMMA>
                <expr line1="227" col1="72" line2="227" col2="74" start="35938" end="35940">
                  <SYMBOL line1="227" col1="72" line2="227" col2="74" start="35938" end="35940">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="227" col1="75" line2="227" col2="75" start="35941" end="35941">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="228" col1="9" line2="228" col2="45" start="36033" end="36069">
              <expr line1="228" col1="9" line2="228" col2="25" start="36033" end="36049">
                <expr line1="228" col1="9" line2="228" col2="16" start="36033" end="36040">
                  <SYMBOL_FUNCTION_CALL line1="228" col1="9" line2="228" col2="16" start="36033" end="36040">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="228" col1="17" line2="228" col2="17" start="36041" end="36041">(</OP-LEFT-PAREN>
                <expr line1="228" col1="18" line2="228" col2="24" start="36042" end="36048">
                  <SYMBOL line1="228" col1="18" line2="228" col2="24" start="36042" end="36048">tpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="228" col1="25" line2="228" col2="25" start="36049" end="36049">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="228" col1="27" line2="228" col2="28" start="36051" end="36052">&lt;-</LEFT_ASSIGN>
              <expr line1="228" col1="30" line2="228" col2="45" start="36054" end="36069">
                <expr line1="228" col1="30" line2="228" col2="37" start="36054" end="36061">
                  <SYMBOL_FUNCTION_CALL line1="228" col1="30" line2="228" col2="37" start="36054" end="36061">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="228" col1="38" line2="228" col2="38" start="36062" end="36062">(</OP-LEFT-PAREN>
                <expr line1="228" col1="39" line2="228" col2="44" start="36063" end="36068">
                  <SYMBOL line1="228" col1="39" line2="228" col2="44" start="36063" end="36068">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="228" col1="45" line2="228" col2="45" start="36069" end="36069">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="229" col1="9" line2="229" col2="31" start="36191" end="36213">
              <expr line1="229" col1="9" line2="229" col2="20" start="36191" end="36202">
                <expr line1="229" col1="9" line2="229" col2="11" start="36191" end="36193">
                  <SYMBOL_FUNCTION_CALL line1="229" col1="9" line2="229" col2="11" start="36191" end="36193">tpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="229" col1="12" line2="229" col2="12" start="36194" end="36194">(</OP-LEFT-PAREN>
                <expr line1="229" col1="13" line2="229" col2="19" start="36195" end="36201">
                  <SYMBOL line1="229" col1="13" line2="229" col2="19" start="36195" end="36201">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="229" col1="20" line2="229" col2="20" start="36202" end="36202">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="229" col1="22" line2="229" col2="23" start="36204" end="36205">&lt;-</LEFT_ASSIGN>
              <expr line1="229" col1="25" line2="229" col2="31" start="36207" end="36213">
                <SYMBOL line1="229" col1="25" line2="229" col2="31" start="36207" end="36213">tpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="230" col1="9" line2="230" col2="19" start="36349" end="36359">
              <expr line1="230" col1="9" line2="230" col2="10" start="36349" end="36350">
                <SYMBOL_FUNCTION_CALL line1="230" col1="9" line2="230" col2="10" start="36349" end="36350">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="230" col1="11" line2="230" col2="11" start="36351" end="36351">(</OP-LEFT-PAREN>
              <expr line1="230" col1="12" line2="230" col2="18" start="36352" end="36358">
                <SYMBOL line1="230" col1="12" line2="230" col2="18" start="36352" end="36358">tpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="230" col1="19" line2="230" col2="19" start="36359" end="36359">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="231" col1="5" line2="231" col2="5" start="36503" end="36503">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="232" col1="5" line2="240" col2="5" start="36661" end="37925">
          <IF line1="232" col1="5" line2="232" col2="6" start="36661" end="36662">if</IF>
          <OP-LEFT-PAREN line1="232" col1="8" line2="232" col2="8" start="36664" end="36664">(</OP-LEFT-PAREN>
          <expr line1="232" col1="10" line2="232" col2="57" start="36666" end="36713">
            <expr line1="232" col1="10" line2="232" col2="31" start="36666" end="36687">
              <expr line1="232" col1="10" line2="232" col2="21" start="36666" end="36677">
                <SYMBOL line1="232" col1="10" line2="232" col2="21" start="36666" end="36677">exprs_values</SYMBOL>
              </expr>
              <NE line1="232" col1="23" line2="232" col2="24" start="36679" end="36680">!=</NE>
              <expr line1="232" col1="26" line2="232" col2="31" start="36682" end="36687">
                <STR_CONST line1="232" col1="26" line2="232" col2="31" start="36682" end="36687">"fpkm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="232" col1="33" line2="232" col2="34" start="36689" end="36690">&amp;&amp;</AND2>
            <expr line1="232" col1="36" line2="232" col2="57" start="36692" end="36713">
              <OP-EXCLAMATION line1="232" col1="36" line2="232" col2="36" start="36692" end="36692">!</OP-EXCLAMATION>
              <expr line1="232" col1="37" line2="232" col2="57" start="36693" end="36713">
                <expr line1="232" col1="37" line2="232" col2="43" start="36693" end="36699">
                  <SYMBOL_FUNCTION_CALL line1="232" col1="37" line2="232" col2="43" start="36693" end="36699">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="232" col1="44" line2="232" col2="44" start="36700" end="36700">(</OP-LEFT-PAREN>
                <expr line1="232" col1="45" line2="232" col2="56" start="36701" end="36712">
                  <expr line1="232" col1="45" line2="232" col2="48" start="36701" end="36704">
                    <SYMBOL_FUNCTION_CALL line1="232" col1="45" line2="232" col2="48" start="36701" end="36704">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="232" col1="49" line2="232" col2="49" start="36705" end="36705">(</OP-LEFT-PAREN>
                  <expr line1="232" col1="50" line2="232" col2="55" start="36706" end="36711">
                    <SYMBOL line1="232" col1="50" line2="232" col2="55" start="36706" end="36711">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="232" col1="56" line2="232" col2="56" start="36712" end="36712">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="232" col1="57" line2="232" col2="57" start="36713" end="36713">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="232" col1="59" line2="232" col2="59" start="36715" end="36715">)</OP-RIGHT-PAREN>
          <expr line1="232" col1="61" line2="240" col2="5" start="36717" end="37925">
            <OP-LEFT-BRACE line1="232" col1="61" line2="232" col2="61" start="36717" end="36717">{</OP-LEFT-BRACE>
            <expr line1="233" col1="9" line2="234" col2="45" start="36823" end="37017">
              <expr line1="233" col1="9" line2="233" col2="17" start="36823" end="36831">
                <SYMBOL line1="233" col1="9" line2="233" col2="17" start="36823" end="36831">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="233" col1="19" line2="233" col2="20" start="36833" end="36834">&lt;-</LEFT_ASSIGN>
              <expr line1="233" col1="22" line2="234" col2="45" start="36836" end="37017">
                <expr line1="233" col1="22" line2="233" col2="31" start="36836" end="36845">
                  <SYMBOL_FUNCTION_CALL line1="233" col1="22" line2="233" col2="31" start="36836" end="36845">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="233" col1="32" line2="233" col2="32" start="36846" end="36846">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="233" col1="33" line2="233" col2="39" start="36847" end="36853">feature</SYMBOL_SUB>
                <EQ_SUB line1="233" col1="41" line2="233" col2="41" start="36855" end="36855">=</EQ_SUB>
                <expr line1="233" col1="43" line2="233" col2="73" start="36857" end="36887">
                  <expr line1="233" col1="43" line2="233" col2="57" start="36857" end="36871">
                    <expr line1="233" col1="43" line2="233" col2="49" start="36857" end="36863">
                      <SYMBOL_FUNCTION_CALL line1="233" col1="43" line2="233" col2="49" start="36857" end="36863">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="233" col1="50" line2="233" col2="50" start="36864" end="36864">(</OP-LEFT-PAREN>
                    <expr line1="233" col1="51" line2="233" col2="56" start="36865" end="36870">
                      <SYMBOL line1="233" col1="51" line2="233" col2="56" start="36865" end="36870">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="233" col1="57" line2="233" col2="57" start="36871" end="36871">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="233" col1="58" line2="233" col2="59" start="36872" end="36873">[[</LBB>
                  <expr line1="233" col1="60" line2="233" col2="71" start="36874" end="36885">
                    <SYMBOL line1="233" col1="60" line2="233" col2="71" start="36874" end="36885">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="233" col1="72" line2="233" col2="72" start="36886" end="36886">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="233" col1="73" line2="233" col2="73" start="36887" end="36887">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="233" col1="74" line2="233" col2="74" start="36888" end="36888">,</OP-COMMA>
                <expr line1="234" col1="33" line2="234" col2="44" start="37005" end="37016">
                  <expr line1="234" col1="33" line2="234" col2="36" start="37005" end="37008">
                    <SYMBOL_FUNCTION_CALL line1="234" col1="33" line2="234" col2="36" start="37005" end="37008">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="234" col1="37" line2="234" col2="37" start="37009" end="37009">(</OP-LEFT-PAREN>
                  <expr line1="234" col1="38" line2="234" col2="43" start="37010" end="37015">
                    <SYMBOL line1="234" col1="38" line2="234" col2="43" start="37010" end="37015">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="234" col1="44" line2="234" col2="44" start="37016" end="37016">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="234" col1="45" line2="234" col2="45" start="37017" end="37017">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="235" col1="9" line2="235" col2="51" start="37139" end="37181">
              <expr line1="235" col1="9" line2="235" col2="22" start="37139" end="37152">
                <SYMBOL line1="235" col1="9" line2="235" col2="22" start="37139" end="37152">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="235" col1="24" line2="235" col2="25" start="37154" end="37155">&lt;-</LEFT_ASSIGN>
              <expr line1="235" col1="27" line2="235" col2="51" start="37157" end="37181">
                <expr line1="235" col1="27" line2="235" col2="40" start="37157" end="37170">
                  <SYMBOL_PACKAGE line1="235" col1="27" line2="235" col2="34" start="37157" end="37164">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="235" col1="35" line2="235" col2="36" start="37165" end="37166">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="235" col1="37" line2="235" col2="40" start="37167" end="37170">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="235" col1="41" line2="235" col2="41" start="37171" end="37171">(</OP-LEFT-PAREN>
                <expr line1="235" col1="42" line2="235" col2="50" start="37172" end="37180">
                  <SYMBOL line1="235" col1="42" line2="235" col2="50" start="37172" end="37180">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="235" col1="51" line2="235" col2="51" start="37181" end="37181">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="236" col1="9" line2="236" col2="76" start="37297" end="37364">
              <expr line1="236" col1="9" line2="236" col2="16" start="37297" end="37304">
                <SYMBOL line1="236" col1="9" line2="236" col2="16" start="37297" end="37304">fpkm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="236" col1="18" line2="236" col2="19" start="37306" end="37307">&lt;-</LEFT_ASSIGN>
              <expr line1="236" col1="21" line2="236" col2="76" start="37309" end="37364">
                <expr line1="236" col1="21" line2="236" col2="35" start="37309" end="37323">
                  <SYMBOL_PACKAGE line1="236" col1="21" line2="236" col2="28" start="37309" end="37316">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="236" col1="29" line2="236" col2="30" start="37317" end="37318">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="236" col1="31" line2="236" col2="35" start="37319" end="37323">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="236" col1="36" line2="236" col2="36" start="37324" end="37324">(</OP-LEFT-PAREN>
                <expr line1="236" col1="37" line2="236" col2="50" start="37325" end="37338">
                  <SYMBOL line1="236" col1="37" line2="236" col2="50" start="37325" end="37338">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="236" col1="51" line2="236" col2="51" start="37339" end="37339">,</OP-COMMA>
                <expr line1="236" col1="53" line2="236" col2="70" start="37341" end="37358">
                  <expr line1="236" col1="53" line2="236" col2="59" start="37341" end="37347">
                    <SYMBOL line1="236" col1="53" line2="236" col2="59" start="37341" end="37347">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="236" col1="61" line2="236" col2="61" start="37349" end="37349">~</OP-TILDE>
                  <expr line1="236" col1="63" line2="236" col2="70" start="37351" end="37358">
                    <SYMBOL line1="236" col1="63" line2="236" col2="70" start="37351" end="37358">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="236" col1="71" line2="236" col2="71" start="37359" end="37359">,</OP-COMMA>
                <expr line1="236" col1="73" line2="236" col2="75" start="37361" end="37363">
                  <SYMBOL line1="236" col1="73" line2="236" col2="75" start="37361" end="37363">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="236" col1="76" line2="236" col2="76" start="37364" end="37364">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="237" col1="9" line2="237" col2="46" start="37455" end="37492">
              <expr line1="237" col1="9" line2="237" col2="26" start="37455" end="37472">
                <expr line1="237" col1="9" line2="237" col2="16" start="37455" end="37462">
                  <SYMBOL_FUNCTION_CALL line1="237" col1="9" line2="237" col2="16" start="37455" end="37462">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="237" col1="17" line2="237" col2="17" start="37463" end="37463">(</OP-LEFT-PAREN>
                <expr line1="237" col1="18" line2="237" col2="25" start="37464" end="37471">
                  <SYMBOL line1="237" col1="18" line2="237" col2="25" start="37464" end="37471">fpkm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="237" col1="26" line2="237" col2="26" start="37472" end="37472">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="237" col1="28" line2="237" col2="29" start="37474" end="37475">&lt;-</LEFT_ASSIGN>
              <expr line1="237" col1="31" line2="237" col2="46" start="37477" end="37492">
                <expr line1="237" col1="31" line2="237" col2="38" start="37477" end="37484">
                  <SYMBOL_FUNCTION_CALL line1="237" col1="31" line2="237" col2="38" start="37477" end="37484">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="237" col1="39" line2="237" col2="39" start="37485" end="37485">(</OP-LEFT-PAREN>
                <expr line1="237" col1="40" line2="237" col2="45" start="37486" end="37491">
                  <SYMBOL line1="237" col1="40" line2="237" col2="45" start="37486" end="37491">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="237" col1="46" line2="237" col2="46" start="37492" end="37492">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="238" col1="9" line2="238" col2="33" start="37613" end="37637">
              <expr line1="238" col1="9" line2="238" col2="21" start="37613" end="37625">
                <expr line1="238" col1="9" line2="238" col2="12" start="37613" end="37616">
                  <SYMBOL_FUNCTION_CALL line1="238" col1="9" line2="238" col2="12" start="37613" end="37616">fpkm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="238" col1="13" line2="238" col2="13" start="37617" end="37617">(</OP-LEFT-PAREN>
                <expr line1="238" col1="14" line2="238" col2="20" start="37618" end="37624">
                  <SYMBOL line1="238" col1="14" line2="238" col2="20" start="37618" end="37624">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="238" col1="21" line2="238" col2="21" start="37625" end="37625">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="238" col1="23" line2="238" col2="24" start="37627" end="37628">&lt;-</LEFT_ASSIGN>
              <expr line1="238" col1="26" line2="238" col2="33" start="37630" end="37637">
                <SYMBOL line1="238" col1="26" line2="238" col2="33" start="37630" end="37637">fpkm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="239" col1="9" line2="239" col2="20" start="37771" end="37782">
              <expr line1="239" col1="9" line2="239" col2="10" start="37771" end="37772">
                <SYMBOL_FUNCTION_CALL line1="239" col1="9" line2="239" col2="10" start="37771" end="37772">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="239" col1="11" line2="239" col2="11" start="37773" end="37773">(</OP-LEFT-PAREN>
              <expr line1="239" col1="12" line2="239" col2="19" start="37774" end="37781">
                <SYMBOL line1="239" col1="12" line2="239" col2="19" start="37774" end="37781">fpkm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="239" col1="20" line2="239" col2="20" start="37782" end="37782">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="240" col1="5" line2="240" col2="5" start="37925" end="37925">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="241" col1="5" line2="241" col2="73" start="38083" end="38151">
          <expr line1="241" col1="5" line2="241" col2="14" start="38083" end="38092">
            <SYMBOL line1="241" col1="5" line2="241" col2="14" start="38083" end="38092">cpm_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="241" col1="16" line2="241" col2="17" start="38094" end="38095">&lt;-</LEFT_ASSIGN>
          <expr line1="241" col1="19" line2="241" col2="73" start="38097" end="38151">
            <expr line1="241" col1="19" line2="241" col2="26" start="38097" end="38104">
              <SYMBOL_FUNCTION_CALL line1="241" col1="19" line2="241" col2="26" start="38097" end="38104">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="241" col1="27" line2="241" col2="27" start="38105" end="38105">(</OP-LEFT-PAREN>
            <expr line1="241" col1="28" line2="241" col2="38" start="38106" end="38116">
              <expr line1="241" col1="28" line2="241" col2="30" start="38106" end="38108">
                <SYMBOL_FUNCTION_CALL line1="241" col1="28" line2="241" col2="30" start="38106" end="38108">cpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="241" col1="31" line2="241" col2="31" start="38109" end="38109">(</OP-LEFT-PAREN>
              <expr line1="241" col1="32" line2="241" col2="37" start="38110" end="38115">
                <SYMBOL line1="241" col1="32" line2="241" col2="37" start="38110" end="38115">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="241" col1="38" line2="241" col2="38" start="38116" end="38116">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="241" col1="39" line2="241" col2="39" start="38117" end="38117">,</OP-COMMA>
            <SYMBOL_SUB line1="241" col1="41" line2="241" col2="45" start="38119" end="38123">error</SYMBOL_SUB>
            <EQ_SUB line1="241" col1="47" line2="241" col2="47" start="38125" end="38125">=</EQ_SUB>
            <expr line1="241" col1="49" line2="241" col2="72" start="38127" end="38150">
              <FUNCTION line1="241" col1="49" line2="241" col2="56" start="38127" end="38134">function</FUNCTION>
              <OP-LEFT-PAREN line1="241" col1="57" line2="241" col2="57" start="38135" end="38135">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="241" col1="58" line2="241" col2="58" start="38136" end="38136">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="241" col1="59" line2="241" col2="59" start="38137" end="38137">)</OP-RIGHT-PAREN>
              <expr line1="241" col1="61" line2="241" col2="72" start="38139" end="38150">
                <expr line1="241" col1="61" line2="241" col2="66" start="38139" end="38144">
                  <SYMBOL_FUNCTION_CALL line1="241" col1="61" line2="241" col2="66" start="38139" end="38144">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="241" col1="67" line2="241" col2="67" start="38145" end="38145">(</OP-LEFT-PAREN>
                <expr line1="241" col1="68" line2="241" col2="71" start="38146" end="38149">
                  <NULL_CONST line1="241" col1="68" line2="241" col2="71" start="38146" end="38149">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="241" col1="72" line2="241" col2="72" start="38150" end="38150">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="241" col1="73" line2="241" col2="73" start="38151" end="38151">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="242" col1="5" line2="250" col2="5" start="38241" end="39505">
          <IF line1="242" col1="5" line2="242" col2="6" start="38241" end="38242">if</IF>
          <OP-LEFT-PAREN line1="242" col1="8" line2="242" col2="8" start="38244" end="38244">(</OP-LEFT-PAREN>
          <expr line1="242" col1="10" line2="242" col2="29" start="38246" end="38265">
            <OP-EXCLAMATION line1="242" col1="10" line2="242" col2="10" start="38246" end="38246">!</OP-EXCLAMATION>
            <expr line1="242" col1="11" line2="242" col2="29" start="38247" end="38265">
              <expr line1="242" col1="11" line2="242" col2="17" start="38247" end="38253">
                <SYMBOL_FUNCTION_CALL line1="242" col1="11" line2="242" col2="17" start="38247" end="38253">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="242" col1="18" line2="242" col2="18" start="38254" end="38254">(</OP-LEFT-PAREN>
              <expr line1="242" col1="19" line2="242" col2="28" start="38255" end="38264">
                <SYMBOL line1="242" col1="19" line2="242" col2="28" start="38255" end="38264">cpm_object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="242" col1="29" line2="242" col2="29" start="38265" end="38265">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="242" col1="31" line2="242" col2="31" start="38267" end="38267">)</OP-RIGHT-PAREN>
          <expr line1="242" col1="33" line2="250" col2="5" start="38269" end="39505">
            <OP-LEFT-BRACE line1="242" col1="33" line2="242" col2="33" start="38269" end="38269">{</OP-LEFT-BRACE>
            <expr line1="243" col1="9" line2="244" col2="43" start="38403" end="38595">
              <expr line1="243" col1="9" line2="243" col2="17" start="38403" end="38411">
                <SYMBOL line1="243" col1="9" line2="243" col2="17" start="38403" end="38411">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="243" col1="19" line2="243" col2="20" start="38413" end="38414">&lt;-</LEFT_ASSIGN>
              <expr line1="243" col1="22" line2="244" col2="43" start="38416" end="38595">
                <expr line1="243" col1="22" line2="243" col2="31" start="38416" end="38425">
                  <SYMBOL_FUNCTION_CALL line1="243" col1="22" line2="243" col2="31" start="38416" end="38425">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="243" col1="32" line2="243" col2="32" start="38426" end="38426">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="243" col1="33" line2="243" col2="39" start="38427" end="38433">feature</SYMBOL_SUB>
                <EQ_SUB line1="243" col1="41" line2="243" col2="41" start="38435" end="38435">=</EQ_SUB>
                <expr line1="243" col1="43" line2="243" col2="73" start="38437" end="38467">
                  <expr line1="243" col1="43" line2="243" col2="57" start="38437" end="38451">
                    <expr line1="243" col1="43" line2="243" col2="49" start="38437" end="38443">
                      <SYMBOL_FUNCTION_CALL line1="243" col1="43" line2="243" col2="49" start="38437" end="38443">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="243" col1="50" line2="243" col2="50" start="38444" end="38444">(</OP-LEFT-PAREN>
                    <expr line1="243" col1="51" line2="243" col2="56" start="38445" end="38450">
                      <SYMBOL line1="243" col1="51" line2="243" col2="56" start="38445" end="38450">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="243" col1="57" line2="243" col2="57" start="38451" end="38451">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="243" col1="58" line2="243" col2="59" start="38452" end="38453">[[</LBB>
                  <expr line1="243" col1="60" line2="243" col2="71" start="38454" end="38465">
                    <SYMBOL line1="243" col1="60" line2="243" col2="71" start="38454" end="38465">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="243" col1="72" line2="243" col2="72" start="38466" end="38466">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="243" col1="73" line2="243" col2="73" start="38467" end="38467">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="243" col1="74" line2="243" col2="74" start="38468" end="38468">,</OP-COMMA>
                <expr line1="244" col1="33" line2="244" col2="42" start="38585" end="38594">
                  <SYMBOL line1="244" col1="33" line2="244" col2="42" start="38585" end="38594">cpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="244" col1="43" line2="244" col2="43" start="38595" end="38595">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="245" col1="9" line2="245" col2="51" start="38719" end="38761">
              <expr line1="245" col1="9" line2="245" col2="22" start="38719" end="38732">
                <SYMBOL line1="245" col1="9" line2="245" col2="22" start="38719" end="38732">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="245" col1="24" line2="245" col2="25" start="38734" end="38735">&lt;-</LEFT_ASSIGN>
              <expr line1="245" col1="27" line2="245" col2="51" start="38737" end="38761">
                <expr line1="245" col1="27" line2="245" col2="40" start="38737" end="38750">
                  <SYMBOL_PACKAGE line1="245" col1="27" line2="245" col2="34" start="38737" end="38744">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="245" col1="35" line2="245" col2="36" start="38745" end="38746">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="245" col1="37" line2="245" col2="40" start="38747" end="38750">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="245" col1="41" line2="245" col2="41" start="38751" end="38751">(</OP-LEFT-PAREN>
                <expr line1="245" col1="42" line2="245" col2="50" start="38752" end="38760">
                  <SYMBOL line1="245" col1="42" line2="245" col2="50" start="38752" end="38760">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="245" col1="51" line2="245" col2="51" start="38761" end="38761">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="246" col1="9" line2="246" col2="75" start="38877" end="38943">
              <expr line1="246" col1="9" line2="246" col2="15" start="38877" end="38883">
                <SYMBOL line1="246" col1="9" line2="246" col2="15" start="38877" end="38883">cpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="246" col1="17" line2="246" col2="18" start="38885" end="38886">&lt;-</LEFT_ASSIGN>
              <expr line1="246" col1="20" line2="246" col2="75" start="38888" end="38943">
                <expr line1="246" col1="20" line2="246" col2="34" start="38888" end="38902">
                  <SYMBOL_PACKAGE line1="246" col1="20" line2="246" col2="27" start="38888" end="38895">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="246" col1="28" line2="246" col2="29" start="38896" end="38897">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="246" col1="30" line2="246" col2="34" start="38898" end="38902">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="246" col1="35" line2="246" col2="35" start="38903" end="38903">(</OP-LEFT-PAREN>
                <expr line1="246" col1="36" line2="246" col2="49" start="38904" end="38917">
                  <SYMBOL line1="246" col1="36" line2="246" col2="49" start="38904" end="38917">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="246" col1="50" line2="246" col2="50" start="38918" end="38918">,</OP-COMMA>
                <expr line1="246" col1="52" line2="246" col2="69" start="38920" end="38937">
                  <expr line1="246" col1="52" line2="246" col2="58" start="38920" end="38926">
                    <SYMBOL line1="246" col1="52" line2="246" col2="58" start="38920" end="38926">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="246" col1="60" line2="246" col2="60" start="38928" end="38928">~</OP-TILDE>
                  <expr line1="246" col1="62" line2="246" col2="69" start="38930" end="38937">
                    <SYMBOL line1="246" col1="62" line2="246" col2="69" start="38930" end="38937">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="246" col1="70" line2="246" col2="70" start="38938" end="38938">,</OP-COMMA>
                <expr line1="246" col1="72" line2="246" col2="74" start="38940" end="38942">
                  <SYMBOL line1="246" col1="72" line2="246" col2="74" start="38940" end="38942">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="246" col1="75" line2="246" col2="75" start="38943" end="38943">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="247" col1="9" line2="247" col2="45" start="39035" end="39071">
              <expr line1="247" col1="9" line2="247" col2="25" start="39035" end="39051">
                <expr line1="247" col1="9" line2="247" col2="16" start="39035" end="39042">
                  <SYMBOL_FUNCTION_CALL line1="247" col1="9" line2="247" col2="16" start="39035" end="39042">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="247" col1="17" line2="247" col2="17" start="39043" end="39043">(</OP-LEFT-PAREN>
                <expr line1="247" col1="18" line2="247" col2="24" start="39044" end="39050">
                  <SYMBOL line1="247" col1="18" line2="247" col2="24" start="39044" end="39050">cpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="247" col1="25" line2="247" col2="25" start="39051" end="39051">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="247" col1="27" line2="247" col2="28" start="39053" end="39054">&lt;-</LEFT_ASSIGN>
              <expr line1="247" col1="30" line2="247" col2="45" start="39056" end="39071">
                <expr line1="247" col1="30" line2="247" col2="37" start="39056" end="39063">
                  <SYMBOL_FUNCTION_CALL line1="247" col1="30" line2="247" col2="37" start="39056" end="39063">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="247" col1="38" line2="247" col2="38" start="39064" end="39064">(</OP-LEFT-PAREN>
                <expr line1="247" col1="39" line2="247" col2="44" start="39065" end="39070">
                  <SYMBOL line1="247" col1="39" line2="247" col2="44" start="39065" end="39070">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="247" col1="45" line2="247" col2="45" start="39071" end="39071">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="248" col1="9" line2="248" col2="31" start="39193" end="39215">
              <expr line1="248" col1="9" line2="248" col2="20" start="39193" end="39204">
                <expr line1="248" col1="9" line2="248" col2="11" start="39193" end="39195">
                  <SYMBOL_FUNCTION_CALL line1="248" col1="9" line2="248" col2="11" start="39193" end="39195">cpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="248" col1="12" line2="248" col2="12" start="39196" end="39196">(</OP-LEFT-PAREN>
                <expr line1="248" col1="13" line2="248" col2="19" start="39197" end="39203">
                  <SYMBOL line1="248" col1="13" line2="248" col2="19" start="39197" end="39203">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="248" col1="20" line2="248" col2="20" start="39204" end="39204">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="248" col1="22" line2="248" col2="23" start="39206" end="39207">&lt;-</LEFT_ASSIGN>
              <expr line1="248" col1="25" line2="248" col2="31" start="39209" end="39215">
                <SYMBOL line1="248" col1="25" line2="248" col2="31" start="39209" end="39215">cpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="249" col1="9" line2="249" col2="19" start="39351" end="39361">
              <expr line1="249" col1="9" line2="249" col2="10" start="39351" end="39352">
                <SYMBOL_FUNCTION_CALL line1="249" col1="9" line2="249" col2="10" start="39351" end="39352">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="249" col1="11" line2="249" col2="11" start="39353" end="39353">(</OP-LEFT-PAREN>
              <expr line1="249" col1="12" line2="249" col2="18" start="39354" end="39360">
                <SYMBOL line1="249" col1="12" line2="249" col2="18" start="39354" end="39360">cpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="249" col1="19" line2="249" col2="19" start="39361" end="39361">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="250" col1="5" line2="250" col2="5" start="39505" end="39505">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="251" col1="5" line2="251" col2="39" start="39663" end="39697">## Use feature symbols for rownames</COMMENT>
        <expr line1="252" col1="5" line2="252" col2="11" start="39821" end="39827">
          <SYMBOL line1="252" col1="5" line2="252" col2="11" start="39821" end="39827">sce_out</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="253" col1="1" line2="253" col2="1" start="39975" end="39975">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="255" col1="1" line2="255" col2="80" start="40291" end="40370">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="257" col1="1" line2="257" col2="60" start="40607" end="40666">## Generating unique row names from an ID and a feature name</COMMENT>
  <COMMENT line1="259" col1="1" line2="259" col2="28" start="40923" end="40950">#' Make feature names unique</COMMENT>
  <COMMENT line1="260" col1="1" line2="260" col2="3" start="41081" end="41083">#' </COMMENT>
  <COMMENT line1="261" col1="1" line2="261" col2="81" start="41239" end="41319">#' Combine a user-interpretable feature name (e.g., gene symbol) with a standard </COMMENT>
  <COMMENT line1="262" col1="1" line2="262" col2="83" start="41397" end="41479">#' identifier that is guaranteed to be unique (e.g., Ensembl) for use as row names.</COMMENT>
  <COMMENT line1="263" col1="1" line2="263" col2="3" start="41555" end="41557">#' </COMMENT>
  <COMMENT line1="264" col1="1" line2="264" col2="54" start="41713" end="41766">#' @param ID A character vector of unique identifiers.</COMMENT>
  <COMMENT line1="265" col1="1" line2="265" col2="52" start="41871" end="41922">#' @param names A character vector of feature names.</COMMENT>
  <COMMENT line1="266" col1="1" line2="266" col2="2" start="42029" end="42030">#'</COMMENT>
  <COMMENT line1="267" col1="1" line2="267" col2="75" start="42187" end="42261">#' @details This function will attempt to use \code{names} if it is unique.</COMMENT>
  <COMMENT line1="268" col1="1" line2="268" col2="81" start="42345" end="42425">#' If not, it will append the \code{_ID} to any non-unique value of \code{names}.</COMMENT>
  <COMMENT line1="269" col1="1" line2="269" col2="64" start="42503" end="42566">#' Missing \code{names} will be replaced entirely by \code{ID}. </COMMENT>
  <COMMENT line1="270" col1="1" line2="270" col2="3" start="42661" end="42663">#' </COMMENT>
  <COMMENT line1="271" col1="1" line2="271" col2="81" start="42819" end="42899">#' The output is guaranteed to be unique, assuming that \code{ID} is also unique.</COMMENT>
  <COMMENT line1="272" col1="1" line2="272" col2="79" start="42977" end="43055">#' This can be directly used as the row names of a SingleCellExperiment object.</COMMENT>
  <COMMENT line1="273" col1="1" line2="273" col2="2" start="43135" end="43136">#'</COMMENT>
  <COMMENT line1="274" col1="1" line2="274" col2="60" start="43293" end="43352">#' @return A character vector of unique-ified feature names.</COMMENT>
  <COMMENT line1="275" col1="1" line2="275" col2="2" start="43451" end="43452">#'</COMMENT>
  <COMMENT line1="276" col1="1" line2="276" col2="20" start="43609" end="43628">#' @author Aaron Lun</COMMENT>
  <COMMENT line1="277" col1="1" line2="277" col2="2" start="43767" end="43768">#'</COMMENT>
  <COMMENT line1="278" col1="1" line2="278" col2="10" start="43925" end="43934">#' @export</COMMENT>
  <COMMENT line1="279" col1="1" line2="279" col2="12" start="44083" end="44094">#' @examples</COMMENT>
  <COMMENT line1="280" col1="1" line2="280" col2="24" start="44241" end="44264">#' uniquifyFeatureNames(</COMMENT>
  <COMMENT line1="281" col1="1" line2="281" col2="35" start="44399" end="44433">#'   ID=paste0("ENSG0000000", 1:5),</COMMENT>
  <COMMENT line1="282" col1="1" line2="282" col2="36" start="44557" end="44592">#'   names=c("A", NA, "B", "C", "A")</COMMENT>
  <COMMENT line1="283" col1="1" line2="283" col2="4" start="44715" end="44718">#' )</COMMENT>
  <expr line1="284" col1="1" line2="293" col2="1" start="44873" end="46295">
    <expr line1="284" col1="1" line2="284" col2="20" start="44873" end="44892">
      <SYMBOL line1="284" col1="1" line2="284" col2="20" start="44873" end="44892">uniquifyFeatureNames</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="284" col1="22" line2="284" col2="23" start="44894" end="44895">&lt;-</LEFT_ASSIGN>
    <expr line1="284" col1="25" line2="293" col2="1" start="44897" end="46295">
      <FUNCTION line1="284" col1="25" line2="284" col2="32" start="44897" end="44904">function</FUNCTION>
      <OP-LEFT-PAREN line1="284" col1="33" line2="284" col2="33" start="44905" end="44905">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="284" col1="34" line2="284" col2="35" start="44906" end="44907">ID</SYMBOL_FORMALS>
      <OP-COMMA line1="284" col1="36" line2="284" col2="36" start="44908" end="44908">,</OP-COMMA>
      <SYMBOL_FORMALS line1="284" col1="38" line2="284" col2="42" start="44910" end="44914">names</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="284" col1="43" line2="284" col2="43" start="44915" end="44915">)</OP-RIGHT-PAREN>
      <expr line1="284" col1="45" line2="293" col2="1" start="44917" end="46295">
        <OP-LEFT-BRACE line1="284" col1="45" line2="284" col2="45" start="44917" end="44917">{</OP-LEFT-BRACE>
        <expr line1="285" col1="5" line2="287" col2="5" start="45035" end="45351">
          <IF line1="285" col1="5" line2="285" col2="6" start="45035" end="45036">if</IF>
          <OP-LEFT-PAREN line1="285" col1="8" line2="285" col2="8" start="45038" end="45038">(</OP-LEFT-PAREN>
          <expr line1="285" col1="9" line2="285" col2="33" start="45039" end="45063">
            <expr line1="285" col1="9" line2="285" col2="18" start="45039" end="45048">
              <expr line1="285" col1="9" line2="285" col2="14" start="45039" end="45044">
                <SYMBOL_FUNCTION_CALL line1="285" col1="9" line2="285" col2="14" start="45039" end="45044">length</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="285" col1="15" line2="285" col2="15" start="45045" end="45045">(</OP-LEFT-PAREN>
              <expr line1="285" col1="16" line2="285" col2="17" start="45046" end="45047">
                <SYMBOL line1="285" col1="16" line2="285" col2="17" start="45046" end="45047">ID</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="285" col1="18" line2="285" col2="18" start="45048" end="45048">)</OP-RIGHT-PAREN>
            </expr>
            <NE line1="285" col1="19" line2="285" col2="20" start="45049" end="45050">!=</NE>
            <expr line1="285" col1="21" line2="285" col2="33" start="45051" end="45063">
              <expr line1="285" col1="21" line2="285" col2="26" start="45051" end="45056">
                <SYMBOL_FUNCTION_CALL line1="285" col1="21" line2="285" col2="26" start="45051" end="45056">length</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="285" col1="27" line2="285" col2="27" start="45057" end="45057">(</OP-LEFT-PAREN>
              <expr line1="285" col1="28" line2="285" col2="32" start="45058" end="45062">
                <SYMBOL line1="285" col1="28" line2="285" col2="32" start="45058" end="45062">names</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="285" col1="33" line2="285" col2="33" start="45063" end="45063">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="285" col1="34" line2="285" col2="34" start="45064" end="45064">)</OP-RIGHT-PAREN>
          <expr line1="285" col1="36" line2="287" col2="5" start="45066" end="45351">
            <OP-LEFT-BRACE line1="285" col1="36" line2="285" col2="36" start="45066" end="45066">{</OP-LEFT-BRACE>
            <expr line1="286" col1="9" line2="286" col2="57" start="45197" end="45245">
              <expr line1="286" col1="9" line2="286" col2="12" start="45197" end="45200">
                <SYMBOL_FUNCTION_CALL line1="286" col1="9" line2="286" col2="12" start="45197" end="45200">stop</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="286" col1="13" line2="286" col2="13" start="45201" end="45201">(</OP-LEFT-PAREN>
              <expr line1="286" col1="14" line2="286" col2="56" start="45202" end="45244">
                <STR_CONST line1="286" col1="14" line2="286" col2="56" start="45202" end="45244">"lengths of 'ID' and 'names' must be equal"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="286" col1="57" line2="286" col2="57" start="45245" end="45245">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="287" col1="5" line2="287" col2="5" start="45351" end="45351">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="288" col1="5" line2="288" col2="32" start="45509" end="45536">
          <expr line1="288" col1="5" line2="288" col2="16" start="45509" end="45520">
            <SYMBOL line1="288" col1="5" line2="288" col2="16" start="45509" end="45520">missing.name</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="288" col1="18" line2="288" col2="19" start="45522" end="45523">&lt;-</LEFT_ASSIGN>
          <expr line1="288" col1="21" line2="288" col2="32" start="45525" end="45536">
            <expr line1="288" col1="21" line2="288" col2="25" start="45525" end="45529">
              <SYMBOL_FUNCTION_CALL line1="288" col1="21" line2="288" col2="25" start="45525" end="45529">is.na</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="288" col1="26" line2="288" col2="26" start="45530" end="45530">(</OP-LEFT-PAREN>
            <expr line1="288" col1="27" line2="288" col2="31" start="45531" end="45535">
              <SYMBOL line1="288" col1="27" line2="288" col2="31" start="45531" end="45535">names</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="288" col1="32" line2="288" col2="32" start="45536" end="45536">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="289" col1="5" line2="289" col2="43" start="45667" end="45705">
          <expr line1="289" col1="5" line2="289" col2="23" start="45667" end="45685">
            <expr line1="289" col1="5" line2="289" col2="9" start="45667" end="45671">
              <SYMBOL line1="289" col1="5" line2="289" col2="9" start="45667" end="45671">names</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="289" col1="10" line2="289" col2="10" start="45672" end="45672">[</OP-LEFT-BRACKET>
            <expr line1="289" col1="11" line2="289" col2="22" start="45673" end="45684">
              <SYMBOL line1="289" col1="11" line2="289" col2="22" start="45673" end="45684">missing.name</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="289" col1="23" line2="289" col2="23" start="45685" end="45685">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="289" col1="25" line2="289" col2="26" start="45687" end="45688">&lt;-</LEFT_ASSIGN>
          <expr line1="289" col1="28" line2="289" col2="43" start="45690" end="45705">
            <expr line1="289" col1="28" line2="289" col2="29" start="45690" end="45691">
              <SYMBOL line1="289" col1="28" line2="289" col2="29" start="45690" end="45691">ID</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="289" col1="30" line2="289" col2="30" start="45692" end="45692">[</OP-LEFT-BRACKET>
            <expr line1="289" col1="31" line2="289" col2="42" start="45693" end="45704">
              <SYMBOL line1="289" col1="31" line2="289" col2="42" start="45693" end="45704">missing.name</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="289" col1="43" line2="289" col2="43" start="45705" end="45705">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="290" col1="5" line2="290" col2="51" start="45825" end="45871">
          <expr line1="290" col1="5" line2="290" col2="12" start="45825" end="45832">
            <SYMBOL line1="290" col1="5" line2="290" col2="12" start="45825" end="45832">dup.name</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="290" col1="14" line2="290" col2="15" start="45834" end="45835">&lt;-</LEFT_ASSIGN>
          <expr line1="290" col1="17" line2="290" col2="51" start="45837" end="45871">
            <expr line1="290" col1="17" line2="290" col2="21" start="45837" end="45841">
              <SYMBOL line1="290" col1="17" line2="290" col2="21" start="45837" end="45841">names</SYMBOL>
            </expr>
            <SPECIAL line1="290" col1="23" line2="290" col2="26" start="45843" end="45846">%in%</SPECIAL>
            <expr line1="290" col1="28" line2="290" col2="51" start="45848" end="45871">
              <expr line1="290" col1="28" line2="290" col2="32" start="45848" end="45852">
                <SYMBOL line1="290" col1="28" line2="290" col2="32" start="45848" end="45852">names</SYMBOL>
              </expr>
              <OP-LEFT-BRACKET line1="290" col1="33" line2="290" col2="33" start="45853" end="45853">[</OP-LEFT-BRACKET>
              <expr line1="290" col1="34" line2="290" col2="50" start="45854" end="45870">
                <expr line1="290" col1="34" line2="290" col2="43" start="45854" end="45863">
                  <SYMBOL_FUNCTION_CALL line1="290" col1="34" line2="290" col2="43" start="45854" end="45863">duplicated</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="290" col1="44" line2="290" col2="44" start="45864" end="45864">(</OP-LEFT-PAREN>
                <expr line1="290" col1="45" line2="290" col2="49" start="45865" end="45869">
                  <SYMBOL line1="290" col1="45" line2="290" col2="49" start="45865" end="45869">names</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="290" col1="50" line2="290" col2="50" start="45870" end="45870">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-BRACKET line1="290" col1="51" line2="290" col2="51" start="45871" end="45871">]</OP-RIGHT-BRACKET>
            </expr>
          </expr>
        </expr>
        <expr line1="291" col1="5" line2="291" col2="65" start="45983" end="46043">
          <expr line1="291" col1="5" line2="291" col2="19" start="45983" end="45997">
            <expr line1="291" col1="5" line2="291" col2="9" start="45983" end="45987">
              <SYMBOL line1="291" col1="5" line2="291" col2="9" start="45983" end="45987">names</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="291" col1="10" line2="291" col2="10" start="45988" end="45988">[</OP-LEFT-BRACKET>
            <expr line1="291" col1="11" line2="291" col2="18" start="45989" end="45996">
              <SYMBOL line1="291" col1="11" line2="291" col2="18" start="45989" end="45996">dup.name</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="291" col1="19" line2="291" col2="19" start="45997" end="45997">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="291" col1="21" line2="291" col2="22" start="45999" end="46000">&lt;-</LEFT_ASSIGN>
          <expr line1="291" col1="24" line2="291" col2="65" start="46002" end="46043">
            <expr line1="291" col1="24" line2="291" col2="29" start="46002" end="46007">
              <SYMBOL_FUNCTION_CALL line1="291" col1="24" line2="291" col2="29" start="46002" end="46007">paste0</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="291" col1="30" line2="291" col2="30" start="46008" end="46008">(</OP-LEFT-PAREN>
            <expr line1="291" col1="31" line2="291" col2="45" start="46009" end="46023">
              <expr line1="291" col1="31" line2="291" col2="35" start="46009" end="46013">
                <SYMBOL line1="291" col1="31" line2="291" col2="35" start="46009" end="46013">names</SYMBOL>
              </expr>
              <OP-LEFT-BRACKET line1="291" col1="36" line2="291" col2="36" start="46014" end="46014">[</OP-LEFT-BRACKET>
              <expr line1="291" col1="37" line2="291" col2="44" start="46015" end="46022">
                <SYMBOL line1="291" col1="37" line2="291" col2="44" start="46015" end="46022">dup.name</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="291" col1="45" line2="291" col2="45" start="46023" end="46023">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-COMMA line1="291" col1="46" line2="291" col2="46" start="46024" end="46024">,</OP-COMMA>
            <expr line1="291" col1="48" line2="291" col2="50" start="46026" end="46028">
              <STR_CONST line1="291" col1="48" line2="291" col2="50" start="46026" end="46028">"_"</STR_CONST>
            </expr>
            <OP-COMMA line1="291" col1="51" line2="291" col2="51" start="46029" end="46029">,</OP-COMMA>
            <expr line1="291" col1="53" line2="291" col2="64" start="46031" end="46042">
              <expr line1="291" col1="53" line2="291" col2="54" start="46031" end="46032">
                <SYMBOL line1="291" col1="53" line2="291" col2="54" start="46031" end="46032">ID</SYMBOL>
              </expr>
              <OP-LEFT-BRACKET line1="291" col1="55" line2="291" col2="55" start="46033" end="46033">[</OP-LEFT-BRACKET>
              <expr line1="291" col1="56" line2="291" col2="63" start="46034" end="46041">
                <SYMBOL line1="291" col1="56" line2="291" col2="63" start="46034" end="46041">dup.name</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="291" col1="64" line2="291" col2="64" start="46042" end="46042">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="291" col1="65" line2="291" col2="65" start="46043" end="46043">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="292" col1="5" line2="292" col2="17" start="46141" end="46153">
          <expr line1="292" col1="5" line2="292" col2="10" start="46141" end="46146">
            <SYMBOL_FUNCTION_CALL line1="292" col1="5" line2="292" col2="10" start="46141" end="46146">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="292" col1="11" line2="292" col2="11" start="46147" end="46147">(</OP-LEFT-PAREN>
          <expr line1="292" col1="12" line2="292" col2="16" start="46148" end="46152">
            <SYMBOL line1="292" col1="12" line2="292" col2="16" start="46148" end="46152">names</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="292" col1="17" line2="292" col2="17" start="46153" end="46153">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="293" col1="1" line2="293" col2="1" start="46295" end="46295">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

