<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="34" start="159" end="192">## summarise and annotate features</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="80" start="475" end="554">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="62" start="791" end="852">## Function to get feature annotation information from biomaRt</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="50" start="1107" end="1156">#' Get feature annotation information from Biomart</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="3" start="1265" end="1267">#' </COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="71" start="1423" end="1493">#' Use the biomaRt package to add feature annotation information to an </COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="39" start="1581" end="1619">#' \code{\link{SingleCellExperiment}}. </COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="3" start="1739" end="1741">#' </COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="54" start="1897" end="1950">#' @param object an \code{SingleCellExperiment} object</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="78" start="2055" end="2132">#' @param filters character vector defining the "filters" terms to pass to the</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="27" start="2213" end="2239">#' biomaRt::getBM function.</COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="80" start="2371" end="2450">#' @param attributes character vector defining the biomaRt attributes to pass to</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="66" start="2529" end="2594">#' the \code{attributes} argument of \code{\link[biomaRt]{getBM}}.</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="79" start="2687" end="2765">#' @param feature_symbol character string defining the biomaRt attribute to be </COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="79" start="2845" end="2923">#' used to define the symbol to be used for each feature (which appears as the </COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="71" start="3003" end="3073">#' \code{feature_symbol} in rowData(object), subsequently). Default is </COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="78" start="3161" end="3238">#' \code{"mgi_symbol"}, gene symbols for mouse. This should be changed if the </COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="32" start="3319" end="3350">#' organism is not Mus musculus!</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="80" start="3477" end="3556">#' @param feature_id character string defining the biomaRt attribute to be used </COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="70" start="3635" end="3704">#' to define the ID to be used for each feature (which appears as the </COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="67" start="3793" end="3859">#' \code{feature_id} in rowData(object), subsequently). Default is </COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="80" start="3951" end="4030">#' \code{"ensembl_gene_id"}, Ensembl gene IDs for mouse. This should be changed </COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="39" start="4109" end="4147">#' if the organism is not Mus musculus!</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="79" start="4267" end="4345">#' @param biomart character string defining the biomaRt to be used. Default is </COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="33" start="4425" end="4457">#' \code{"ENSEMBL_MART_ENSEMBL"}.</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="79" start="4583" end="4661">#' @param dataset character string defining the biomaRt dataset to use. Default</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="79" start="4741" end="4819">#' is \code{"mmusculus_gene_ensembl"}, which should be changed if the organism </COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="20" start="4899" end="4918">#' is not the mouse!</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="79" start="5057" end="5135">#' @param host optional character string argument which can be used to select a</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="78" start="5215" end="5292">#' particular \code{"host"} from biomaRt to use. Useful for accessing archived</COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="92" start="5373" end="5464">#' versions of biomaRt data. Default is \code{"www.ensembl.org"}, in which case the current </COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="58" start="5531" end="5588">#' version of the biomaRt (now hosted by Ensembl) is used.</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="3" start="5689" end="5691">#' </COMMENT>
  <COMMENT line1="37" col1="1" line2="37" col2="79" start="5847" end="5925">#' @details See the documentation for the biomaRt package, specifically for the</COMMENT>
  <COMMENT line1="38" col1="1" line2="38" col2="90" start="6005" end="6094">#' functions \code{useMart} and \code{\link[biomaRt]{getBM}}, for information on what are </COMMENT>
  <COMMENT line1="39" col1="1" line2="39" col2="75" start="6163" end="6237">#' permitted values for the filters, attributes, biomart, dataset and host </COMMENT>
  <COMMENT line1="40" col1="1" line2="40" col2="13" start="6321" end="6333">#' arguments.</COMMENT>
  <COMMENT line1="41" col1="1" line2="41" col2="3" start="6479" end="6481">#' </COMMENT>
  <COMMENT line1="42" col1="1" line2="42" col2="40" start="6637" end="6676">#' @return a SingleCellExperiment object</COMMENT>
  <COMMENT line1="43" col1="1" line2="43" col2="3" start="6795" end="6797">#' </COMMENT>
  <COMMENT line1="44" col1="1" line2="44" col2="30" start="6953" end="6982">#' @importFrom biomaRt useMart</COMMENT>
  <COMMENT line1="45" col1="1" line2="45" col2="10" start="7111" end="7120">#' @export</COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="3" start="7269" end="7271">#' </COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="12" start="7427" end="7438">#' @examples</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="12" start="7585" end="7596">#' \dontrun{</COMMENT>
  <COMMENT line1="49" col1="1" line2="49" col2="38" start="7743" end="7780">#' object &lt;- getBMFeatureAnnos(object)</COMMENT>
  <COMMENT line1="50" col1="1" line2="50" col2="4" start="7901" end="7904">#' }</COMMENT>
  <COMMENT line1="51" col1="1" line2="51" col2="3" start="8059" end="8061">#' </COMMENT>
  <expr line1="52" col1="1" line2="107" col2="1" start="8217" end="16907">
    <expr line1="52" col1="1" line2="52" col2="17" start="8217" end="8233">
      <SYMBOL line1="52" col1="1" line2="52" col2="17" start="8217" end="8233">getBMFeatureAnnos</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="52" col1="19" line2="52" col2="20" start="8235" end="8236">&lt;-</LEFT_ASSIGN>
    <expr line1="52" col1="22" line2="107" col2="1" start="8238" end="16907">
      <FUNCTION line1="52" col1="22" line2="52" col2="29" start="8238" end="8245">function</FUNCTION>
      <OP-LEFT-PAREN line1="52" col1="30" line2="52" col2="30" start="8246" end="8246">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="52" col1="31" line2="52" col2="36" start="8247" end="8252">object</SYMBOL_FORMALS>
      <OP-COMMA line1="52" col1="37" line2="52" col2="37" start="8253" end="8253">,</OP-COMMA>
      <SYMBOL_FORMALS line1="52" col1="39" line2="52" col2="45" start="8255" end="8261">filters</SYMBOL_FORMALS>
      <EQ_FORMALS line1="52" col1="46" line2="52" col2="46" start="8262" end="8262">=</EQ_FORMALS>
      <expr line1="52" col1="47" line2="52" col2="69" start="8263" end="8285">
        <STR_CONST line1="52" col1="47" line2="52" col2="69" start="8263" end="8285">"ensembl_transcript_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="52" col1="70" line2="52" col2="70" start="8286" end="8286">,</OP-COMMA>
      <SYMBOL_FORMALS line1="53" col1="31" line2="53" col2="40" start="8405" end="8414">attributes</SYMBOL_FORMALS>
      <EQ_FORMALS line1="53" col1="41" line2="53" col2="41" start="8415" end="8415">=</EQ_FORMALS>
      <expr line1="53" col1="42" line2="57" col2="62" start="8416" end="9068">
        <expr line1="53" col1="42" line2="53" col2="42" start="8416" end="8416">
          <SYMBOL_FUNCTION_CALL line1="53" col1="42" line2="53" col2="42" start="8416" end="8416">c</SYMBOL_FUNCTION_CALL>
        </expr>
        <OP-LEFT-PAREN line1="53" col1="43" line2="53" col2="43" start="8417" end="8417">(</OP-LEFT-PAREN>
        <expr line1="53" col1="44" line2="53" col2="66" start="8418" end="8440">
          <STR_CONST line1="53" col1="44" line2="53" col2="66" start="8418" end="8440">"ensembl_transcript_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="53" col1="67" line2="53" col2="67" start="8441" end="8441">,</OP-COMMA>
        <expr line1="54" col1="44" line2="54" col2="60" start="8576" end="8592">
          <STR_CONST line1="54" col1="44" line2="54" col2="60" start="8576" end="8592">"ensembl_gene_id"</STR_CONST>
        </expr>
        <OP-COMMA line1="54" col1="61" line2="54" col2="61" start="8593" end="8593">,</OP-COMMA>
        <expr line1="54" col1="63" line2="54" col2="76" start="8595" end="8608">
          <SYMBOL line1="54" col1="63" line2="54" col2="76" start="8595" end="8608">feature_symbol</SYMBOL>
        </expr>
        <OP-COMMA line1="54" col1="77" line2="54" col2="77" start="8609" end="8609">,</OP-COMMA>
        <expr line1="55" col1="44" line2="55" col2="60" start="8734" end="8750">
          <STR_CONST line1="55" col1="44" line2="55" col2="60" start="8734" end="8750">"chromosome_name"</STR_CONST>
        </expr>
        <OP-COMMA line1="55" col1="61" line2="55" col2="61" start="8751" end="8751">,</OP-COMMA>
        <expr line1="55" col1="63" line2="55" col2="82" start="8753" end="8772">
          <STR_CONST line1="55" col1="63" line2="55" col2="82" start="8753" end="8772">"transcript_biotype"</STR_CONST>
        </expr>
        <OP-COMMA line1="55" col1="83" line2="55" col2="83" start="8773" end="8773">,</OP-COMMA>
        <expr line1="56" col1="44" line2="56" col2="61" start="8892" end="8909">
          <STR_CONST line1="56" col1="44" line2="56" col2="61" start="8892" end="8909">"transcript_start"</STR_CONST>
        </expr>
        <OP-COMMA line1="56" col1="62" line2="56" col2="62" start="8910" end="8910">,</OP-COMMA>
        <expr line1="56" col1="64" line2="56" col2="79" start="8912" end="8927">
          <STR_CONST line1="56" col1="64" line2="56" col2="79" start="8912" end="8927">"transcript_end"</STR_CONST>
        </expr>
        <OP-COMMA line1="56" col1="80" line2="56" col2="80" start="8928" end="8928">,</OP-COMMA>
        <expr line1="57" col1="44" line2="57" col2="61" start="9050" end="9067">
          <STR_CONST line1="57" col1="44" line2="57" col2="61" start="9050" end="9067">"transcript_count"</STR_CONST>
        </expr>
        <OP-RIGHT-PAREN line1="57" col1="62" line2="57" col2="62" start="9068" end="9068">)</OP-RIGHT-PAREN>
      </expr>
      <OP-COMMA line1="57" col1="63" line2="57" col2="63" start="9069" end="9069">,</OP-COMMA>
      <SYMBOL_FORMALS line1="58" col1="31" line2="58" col2="44" start="9195" end="9208">feature_symbol</SYMBOL_FORMALS>
      <EQ_FORMALS line1="58" col1="45" line2="58" col2="45" start="9209" end="9209">=</EQ_FORMALS>
      <expr line1="58" col1="46" line2="58" col2="57" start="9210" end="9221">
        <STR_CONST line1="58" col1="46" line2="58" col2="57" start="9210" end="9221">"mgi_symbol"</STR_CONST>
      </expr>
      <OP-COMMA line1="58" col1="58" line2="58" col2="58" start="9222" end="9222">,</OP-COMMA>
      <SYMBOL_FORMALS line1="59" col1="31" line2="59" col2="40" start="9353" end="9362">feature_id</SYMBOL_FORMALS>
      <EQ_FORMALS line1="59" col1="41" line2="59" col2="41" start="9363" end="9363">=</EQ_FORMALS>
      <expr line1="59" col1="42" line2="59" col2="58" start="9364" end="9380">
        <STR_CONST line1="59" col1="42" line2="59" col2="58" start="9364" end="9380">"ensembl_gene_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="59" col1="59" line2="59" col2="59" start="9381" end="9381">,</OP-COMMA>
      <SYMBOL_FORMALS line1="60" col1="31" line2="60" col2="37" start="9511" end="9517">biomart</SYMBOL_FORMALS>
      <EQ_FORMALS line1="60" col1="38" line2="60" col2="38" start="9518" end="9518">=</EQ_FORMALS>
      <expr line1="60" col1="39" line2="60" col2="60" start="9519" end="9540">
        <STR_CONST line1="60" col1="39" line2="60" col2="60" start="9519" end="9540">"ENSEMBL_MART_ENSEMBL"</STR_CONST>
      </expr>
      <OP-COMMA line1="60" col1="61" line2="60" col2="61" start="9541" end="9541">,</OP-COMMA>
      <SYMBOL_FORMALS line1="61" col1="31" line2="61" col2="37" start="9669" end="9675">dataset</SYMBOL_FORMALS>
      <EQ_FORMALS line1="61" col1="38" line2="61" col2="38" start="9676" end="9676">=</EQ_FORMALS>
      <expr line1="61" col1="39" line2="61" col2="62" start="9677" end="9700">
        <STR_CONST line1="61" col1="39" line2="61" col2="62" start="9677" end="9700">"mmusculus_gene_ensembl"</STR_CONST>
      </expr>
      <OP-COMMA line1="61" col1="63" line2="61" col2="63" start="9701" end="9701">,</OP-COMMA>
      <SYMBOL_FORMALS line1="62" col1="31" line2="62" col2="34" start="9827" end="9830">host</SYMBOL_FORMALS>
      <EQ_FORMALS line1="62" col1="35" line2="62" col2="35" start="9831" end="9831">=</EQ_FORMALS>
      <expr line1="62" col1="36" line2="62" col2="52" start="9832" end="9848">
        <STR_CONST line1="62" col1="36" line2="62" col2="52" start="9832" end="9848">"www.ensembl.org"</STR_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="62" col1="53" line2="62" col2="53" start="9849" end="9849">)</OP-RIGHT-PAREN>
      <expr line1="62" col1="55" line2="107" col2="1" start="9851" end="16907">
        <OP-LEFT-BRACE line1="62" col1="55" line2="62" col2="55" start="9851" end="9851">{</OP-LEFT-BRACE>
        <COMMENT line1="63" col1="5" line2="63" col2="33" start="9959" end="9987">## Define Biomart Mart to use</COMMENT>
        <expr line1="64" col1="5" line2="68" col2="46" start="10117" end="10790">
          <IF line1="64" col1="5" line2="64" col2="6" start="10117" end="10118">if</IF>
          <OP-LEFT-PAREN line1="64" col1="8" line2="64" col2="8" start="10120" end="10120">(</OP-LEFT-PAREN>
          <expr line1="64" col1="10" line2="64" col2="22" start="10122" end="10134">
            <expr line1="64" col1="10" line2="64" col2="16" start="10122" end="10128">
              <SYMBOL_FUNCTION_CALL line1="64" col1="10" line2="64" col2="16" start="10122" end="10128">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="64" col1="17" line2="64" col2="17" start="10129" end="10129">(</OP-LEFT-PAREN>
            <expr line1="64" col1="18" line2="64" col2="21" start="10130" end="10133">
              <SYMBOL line1="64" col1="18" line2="64" col2="21" start="10130" end="10133">host</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="64" col1="22" line2="64" col2="22" start="10134" end="10134">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="64" col1="24" line2="64" col2="24" start="10136" end="10136">)</OP-RIGHT-PAREN>
          <expr line1="65" col1="9" line2="65" col2="71" start="10279" end="10341">
            <expr line1="65" col1="9" line2="65" col2="13" start="10279" end="10283">
              <SYMBOL line1="65" col1="9" line2="65" col2="13" start="10279" end="10283">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="65" col1="15" line2="65" col2="16" start="10285" end="10286">&lt;-</LEFT_ASSIGN>
            <expr line1="65" col1="18" line2="65" col2="71" start="10288" end="10341">
              <expr line1="65" col1="18" line2="65" col2="33" start="10288" end="10303">
                <SYMBOL_PACKAGE line1="65" col1="18" line2="65" col2="24" start="10288" end="10294">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="65" col1="25" line2="65" col2="26" start="10295" end="10296">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="65" col1="27" line2="65" col2="33" start="10297" end="10303">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="65" col1="34" line2="65" col2="34" start="10304" end="10304">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="65" col1="35" line2="65" col2="41" start="10305" end="10311">biomart</SYMBOL_SUB>
              <EQ_SUB line1="65" col1="43" line2="65" col2="43" start="10313" end="10313">=</EQ_SUB>
              <expr line1="65" col1="45" line2="65" col2="51" start="10315" end="10321">
                <SYMBOL line1="65" col1="45" line2="65" col2="51" start="10315" end="10321">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="65" col1="52" line2="65" col2="52" start="10322" end="10322">,</OP-COMMA>
              <SYMBOL_SUB line1="65" col1="54" line2="65" col2="60" start="10324" end="10330">dataset</SYMBOL_SUB>
              <EQ_SUB line1="65" col1="62" line2="65" col2="62" start="10332" end="10332">=</EQ_SUB>
              <expr line1="65" col1="64" line2="65" col2="70" start="10334" end="10340">
                <SYMBOL line1="65" col1="64" line2="65" col2="70" start="10334" end="10340">dataset</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="65" col1="71" line2="65" col2="71" start="10341" end="10341">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <ELSE line1="66" col1="5" line2="66" col2="8" start="10433" end="10436">else</ELSE>
          <expr line1="67" col1="9" line2="68" col2="46" start="10595" end="10790">
            <expr line1="67" col1="9" line2="67" col2="13" start="10595" end="10599">
              <SYMBOL line1="67" col1="9" line2="67" col2="13" start="10595" end="10599">bmart</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="67" col1="15" line2="67" col2="16" start="10601" end="10602">&lt;-</LEFT_ASSIGN>
            <expr line1="67" col1="18" line2="68" col2="46" start="10604" end="10790">
              <expr line1="67" col1="18" line2="67" col2="33" start="10604" end="10619">
                <SYMBOL_PACKAGE line1="67" col1="18" line2="67" col2="24" start="10604" end="10610">biomaRt</SYMBOL_PACKAGE>
                <NS_GET line1="67" col1="25" line2="67" col2="26" start="10611" end="10612">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="67" col1="27" line2="67" col2="33" start="10613" end="10619">useMart</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="67" col1="34" line2="67" col2="34" start="10620" end="10620">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="67" col1="35" line2="67" col2="41" start="10621" end="10627">biomart</SYMBOL_SUB>
              <EQ_SUB line1="67" col1="43" line2="67" col2="43" start="10629" end="10629">=</EQ_SUB>
              <expr line1="67" col1="45" line2="67" col2="51" start="10631" end="10637">
                <SYMBOL line1="67" col1="45" line2="67" col2="51" start="10631" end="10637">biomart</SYMBOL>
              </expr>
              <OP-COMMA line1="67" col1="52" line2="67" col2="52" start="10638" end="10638">,</OP-COMMA>
              <SYMBOL_SUB line1="67" col1="54" line2="67" col2="60" start="10640" end="10646">dataset</SYMBOL_SUB>
              <EQ_SUB line1="67" col1="62" line2="67" col2="62" start="10648" end="10648">=</EQ_SUB>
              <expr line1="67" col1="64" line2="67" col2="70" start="10650" end="10656">
                <SYMBOL line1="67" col1="64" line2="67" col2="70" start="10650" end="10656">dataset</SYMBOL>
              </expr>
              <OP-COMMA line1="67" col1="71" line2="67" col2="71" start="10657" end="10657">,</OP-COMMA>
              <SYMBOL_SUB line1="68" col1="35" line2="68" col2="38" start="10779" end="10782">host</SYMBOL_SUB>
              <EQ_SUB line1="68" col1="40" line2="68" col2="40" start="10784" end="10784">=</EQ_SUB>
              <expr line1="68" col1="42" line2="68" col2="45" start="10786" end="10789">
                <SYMBOL line1="68" col1="42" line2="68" col2="45" start="10786" end="10789">host</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="68" col1="46" line2="68" col2="46" start="10790" end="10790">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="69" col1="5" line2="69" col2="58" start="10907" end="10960">## Define feature IDs from SingleCellExperiment object</COMMENT>
        <expr line1="70" col1="5" line2="70" col2="35" start="11065" end="11095">
          <expr line1="70" col1="5" line2="70" col2="15" start="11065" end="11075">
            <SYMBOL line1="70" col1="5" line2="70" col2="15" start="11065" end="11075">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="70" col1="17" line2="70" col2="18" start="11077" end="11078">&lt;-</LEFT_ASSIGN>
          <expr line1="70" col1="20" line2="70" col2="35" start="11080" end="11095">
            <expr line1="70" col1="20" line2="70" col2="27" start="11080" end="11087">
              <SYMBOL_FUNCTION_CALL line1="70" col1="20" line2="70" col2="27" start="11080" end="11087">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="70" col1="28" line2="70" col2="28" start="11088" end="11088">(</OP-LEFT-PAREN>
            <expr line1="70" col1="29" line2="70" col2="34" start="11089" end="11094">
              <SYMBOL line1="70" col1="29" line2="70" col2="34" start="11089" end="11094">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="70" col1="35" line2="70" col2="35" start="11095" end="11095">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="71" col1="5" line2="71" col2="104" start="11223" end="11322">## Remove transcript ID artifacts from runKallisto (eg. ENSMUST00000201087.11 -&gt; ENSMUST00000201087)</COMMENT>
        <expr line1="72" col1="5" line2="72" col2="81" start="11381" end="11457">
          <expr line1="72" col1="5" line2="72" col2="15" start="11381" end="11391">
            <SYMBOL line1="72" col1="5" line2="72" col2="15" start="11381" end="11391">feature_ids</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="72" col1="17" line2="72" col2="18" start="11393" end="11394">&lt;-</LEFT_ASSIGN>
          <expr line1="72" col1="20" line2="72" col2="81" start="11396" end="11457">
            <expr line1="72" col1="20" line2="72" col2="23" start="11396" end="11399">
              <SYMBOL_FUNCTION_CALL line1="72" col1="20" line2="72" col2="23" start="11396" end="11399">gsub</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="72" col1="24" line2="72" col2="24" start="11400" end="11400">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="72" col1="25" line2="72" col2="31" start="11401" end="11407">pattern</SYMBOL_SUB>
            <EQ_SUB line1="72" col1="33" line2="72" col2="33" start="11409" end="11409">=</EQ_SUB>
            <expr line1="72" col1="35" line2="72" col2="45" start="11411" end="11421">
              <STR_CONST line1="72" col1="35" line2="72" col2="45" start="11411" end="11421">"\\.[0-9]+"</STR_CONST>
            </expr>
            <OP-COMMA line1="72" col1="46" line2="72" col2="46" start="11422" end="11422">,</OP-COMMA>
            <SYMBOL_SUB line1="72" col1="48" line2="72" col2="58" start="11424" end="11434">replacement</SYMBOL_SUB>
            <EQ_SUB line1="72" col1="60" line2="72" col2="60" start="11436" end="11436">=</EQ_SUB>
            <expr line1="72" col1="62" line2="72" col2="63" start="11438" end="11439">
              <STR_CONST line1="72" col1="62" line2="72" col2="63" start="11438" end="11439">""</STR_CONST>
            </expr>
            <OP-COMMA line1="72" col1="64" line2="72" col2="64" start="11440" end="11440">,</OP-COMMA>
            <SYMBOL_SUB line1="72" col1="66" line2="72" col2="66" start="11442" end="11442">x</SYMBOL_SUB>
            <EQ_SUB line1="72" col1="68" line2="72" col2="68" start="11444" end="11444">=</EQ_SUB>
            <expr line1="72" col1="70" line2="72" col2="80" start="11446" end="11456">
              <SYMBOL line1="72" col1="70" line2="72" col2="80" start="11446" end="11456">feature_ids</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="72" col1="81" line2="72" col2="81" start="11457" end="11457">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="73" col1="5" line2="73" col2="35" start="11539" end="11569">## Get annotations from biomaRt</COMMENT>
        <expr line1="74" col1="5" line2="76" col2="70" start="11697" end="12078">
          <expr line1="74" col1="5" line2="74" col2="16" start="11697" end="11708">
            <SYMBOL line1="74" col1="5" line2="74" col2="16" start="11697" end="11708">feature_info</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="74" col1="18" line2="74" col2="19" start="11710" end="11711">&lt;-</LEFT_ASSIGN>
          <expr line1="74" col1="21" line2="76" col2="70" start="11713" end="12078">
            <expr line1="74" col1="21" line2="74" col2="34" start="11713" end="11726">
              <SYMBOL_PACKAGE line1="74" col1="21" line2="74" col2="27" start="11713" end="11719">biomaRt</SYMBOL_PACKAGE>
              <NS_GET line1="74" col1="28" line2="74" col2="29" start="11720" end="11721">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="74" col1="30" line2="74" col2="34" start="11722" end="11726">getBM</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="74" col1="35" line2="74" col2="35" start="11727" end="11727">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="74" col1="36" line2="74" col2="45" start="11728" end="11737">attributes</SYMBOL_SUB>
            <EQ_SUB line1="74" col1="47" line2="74" col2="47" start="11739" end="11739">=</EQ_SUB>
            <expr line1="74" col1="49" line2="74" col2="58" start="11741" end="11750">
              <SYMBOL line1="74" col1="49" line2="74" col2="58" start="11741" end="11750">attributes</SYMBOL>
            </expr>
            <OP-COMMA line1="74" col1="59" line2="74" col2="59" start="11751" end="11751">,</OP-COMMA>
            <SYMBOL_SUB line1="75" col1="36" line2="75" col2="42" start="11886" end="11892">filters</SYMBOL_SUB>
            <EQ_SUB line1="75" col1="44" line2="75" col2="44" start="11894" end="11894">=</EQ_SUB>
            <expr line1="75" col1="46" line2="75" col2="52" start="11896" end="11902">
              <SYMBOL line1="75" col1="46" line2="75" col2="52" start="11896" end="11902">filters</SYMBOL>
            </expr>
            <OP-COMMA line1="75" col1="53" line2="75" col2="53" start="11903" end="11903">,</OP-COMMA>
            <SYMBOL_SUB line1="76" col1="36" line2="76" col2="41" start="12044" end="12049">values</SYMBOL_SUB>
            <EQ_SUB line1="76" col1="43" line2="76" col2="43" start="12051" end="12051">=</EQ_SUB>
            <expr line1="76" col1="45" line2="76" col2="55" start="12053" end="12063">
              <SYMBOL line1="76" col1="45" line2="76" col2="55" start="12053" end="12063">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="76" col1="56" line2="76" col2="56" start="12064" end="12064">,</OP-COMMA>
            <SYMBOL_SUB line1="76" col1="58" line2="76" col2="61" start="12066" end="12069">mart</SYMBOL_SUB>
            <EQ_SUB line1="76" col1="63" line2="76" col2="63" start="12071" end="12071">=</EQ_SUB>
            <expr line1="76" col1="65" line2="76" col2="69" start="12073" end="12077">
              <SYMBOL line1="76" col1="65" line2="76" col2="69" start="12073" end="12077">bmart</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="76" col1="70" line2="76" col2="70" start="12078" end="12078">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="77" col1="5" line2="77" col2="77" start="12171" end="12243">## Match the feature ids to the filters ids used to get info from biomaRt</COMMENT>
        <expr line1="78" col1="5" line2="78" col2="53" start="12329" end="12377">
          <expr line1="78" col1="5" line2="78" col2="6" start="12329" end="12330">
            <SYMBOL line1="78" col1="5" line2="78" col2="6" start="12329" end="12330">mm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="78" col1="8" line2="78" col2="9" start="12332" end="12333">&lt;-</LEFT_ASSIGN>
          <expr line1="78" col1="11" line2="78" col2="53" start="12335" end="12377">
            <expr line1="78" col1="11" line2="78" col2="15" start="12335" end="12339">
              <SYMBOL_FUNCTION_CALL line1="78" col1="11" line2="78" col2="15" start="12335" end="12339">match</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="78" col1="16" line2="78" col2="16" start="12340" end="12340">(</OP-LEFT-PAREN>
            <expr line1="78" col1="17" line2="78" col2="27" start="12341" end="12351">
              <SYMBOL line1="78" col1="17" line2="78" col2="27" start="12341" end="12351">feature_ids</SYMBOL>
            </expr>
            <OP-COMMA line1="78" col1="28" line2="78" col2="28" start="12352" end="12352">,</OP-COMMA>
            <expr line1="78" col1="30" line2="78" col2="52" start="12354" end="12376">
              <expr line1="78" col1="30" line2="78" col2="41" start="12354" end="12365">
                <SYMBOL line1="78" col1="30" line2="78" col2="41" start="12354" end="12365">feature_info</SYMBOL>
              </expr>
              <LBB line1="78" col1="42" line2="78" col2="43" start="12366" end="12367">[[</LBB>
              <expr line1="78" col1="44" line2="78" col2="50" start="12368" end="12374">
                <SYMBOL line1="78" col1="44" line2="78" col2="50" start="12368" end="12374">filters</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="78" col1="51" line2="78" col2="51" start="12375" end="12375">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="78" col1="52" line2="78" col2="52" start="12376" end="12376">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-RIGHT-PAREN line1="78" col1="53" line2="78" col2="53" start="12377" end="12377">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="79" col1="5" line2="79" col2="43" start="12487" end="12525">
          <expr line1="79" col1="5" line2="79" col2="21" start="12487" end="12503">
            <SYMBOL line1="79" col1="5" line2="79" col2="21" start="12487" end="12503">feature_info_full</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="79" col1="23" line2="79" col2="24" start="12505" end="12506">&lt;-</LEFT_ASSIGN>
          <expr line1="79" col1="26" line2="79" col2="43" start="12508" end="12525">
            <expr line1="79" col1="26" line2="79" col2="37" start="12508" end="12519">
              <SYMBOL line1="79" col1="26" line2="79" col2="37" start="12508" end="12519">feature_info</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="79" col1="38" line2="79" col2="38" start="12520" end="12520">[</OP-LEFT-BRACKET>
            <expr line1="79" col1="39" line2="79" col2="40" start="12521" end="12522">
              <SYMBOL line1="79" col1="39" line2="79" col2="40" start="12521" end="12522">mm</SYMBOL>
            </expr>
            <OP-COMMA line1="79" col1="41" line2="79" col2="41" start="12523" end="12523">,</OP-COMMA>
            <OP-RIGHT-BRACKET line1="79" col1="43" line2="79" col2="43" start="12525" end="12525">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="80" col1="5" line2="80" col2="46" start="12645" end="12686">
          <expr line1="80" col1="5" line2="80" col2="31" start="12645" end="12671">
            <expr line1="80" col1="5" line2="80" col2="12" start="12645" end="12652">
              <SYMBOL_FUNCTION_CALL line1="80" col1="5" line2="80" col2="12" start="12645" end="12652">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="80" col1="13" line2="80" col2="13" start="12653" end="12653">(</OP-LEFT-PAREN>
            <expr line1="80" col1="14" line2="80" col2="30" start="12654" end="12670">
              <SYMBOL line1="80" col1="14" line2="80" col2="30" start="12654" end="12670">feature_info_full</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="80" col1="31" line2="80" col2="31" start="12671" end="12671">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="80" col1="33" line2="80" col2="34" start="12673" end="12674">&lt;-</LEFT_ASSIGN>
          <expr line1="80" col1="36" line2="80" col2="46" start="12676" end="12686">
            <SYMBOL line1="80" col1="36" line2="80" col2="46" start="12676" end="12686">feature_ids</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="81" col1="5" line2="81" col2="37" start="12803" end="12835">## Define gene symbol and gene id</COMMENT>
        <expr line1="82" col1="5" line2="82" col2="75" start="12961" end="13031">
          <expr line1="82" col1="5" line2="82" col2="36" start="12961" end="12992">
            <expr line1="82" col1="5" line2="82" col2="21" start="12961" end="12977">
              <SYMBOL line1="82" col1="5" line2="82" col2="21" start="12961" end="12977">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="82" col1="22" line2="82" col2="22" start="12978" end="12978">$</OP-DOLLAR>
            <SYMBOL line1="82" col1="23" line2="82" col2="36" start="12979" end="12992">feature_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="82" col1="38" line2="82" col2="39" start="12994" end="12995">&lt;-</LEFT_ASSIGN>
          <expr line1="82" col1="41" line2="82" col2="75" start="12997" end="13031">
            <expr line1="82" col1="41" line2="82" col2="57" start="12997" end="13013">
              <SYMBOL line1="82" col1="41" line2="82" col2="57" start="12997" end="13013">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="82" col1="58" line2="82" col2="59" start="13014" end="13015">[[</LBB>
            <expr line1="82" col1="60" line2="82" col2="73" start="13016" end="13029">
              <SYMBOL line1="82" col1="60" line2="82" col2="73" start="13016" end="13029">feature_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="82" col1="74" line2="82" col2="74" start="13030" end="13030">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="82" col1="75" line2="82" col2="75" start="13031" end="13031">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="83" col1="5" line2="83" col2="67" start="13119" end="13181">
          <expr line1="83" col1="5" line2="83" col2="32" start="13119" end="13146">
            <expr line1="83" col1="5" line2="83" col2="21" start="13119" end="13135">
              <SYMBOL line1="83" col1="5" line2="83" col2="21" start="13119" end="13135">feature_info_full</SYMBOL>
            </expr>
            <OP-DOLLAR line1="83" col1="22" line2="83" col2="22" start="13136" end="13136">$</OP-DOLLAR>
            <SYMBOL line1="83" col1="23" line2="83" col2="32" start="13137" end="13146">feature_id</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="83" col1="34" line2="83" col2="35" start="13148" end="13149">&lt;-</LEFT_ASSIGN>
          <expr line1="83" col1="37" line2="83" col2="67" start="13151" end="13181">
            <expr line1="83" col1="37" line2="83" col2="53" start="13151" end="13167">
              <SYMBOL line1="83" col1="37" line2="83" col2="53" start="13151" end="13167">feature_info_full</SYMBOL>
            </expr>
            <LBB line1="83" col1="54" line2="83" col2="55" start="13168" end="13169">[[</LBB>
            <expr line1="83" col1="56" line2="83" col2="65" start="13170" end="13179">
              <SYMBOL line1="83" col1="56" line2="83" col2="65" start="13170" end="13179">feature_id</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="83" col1="66" line2="83" col2="66" start="13180" end="13180">]</OP-RIGHT-BRACKET>
            <OP-RIGHT-BRACKET line1="83" col1="67" line2="83" col2="67" start="13181" end="13181">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="84" col1="5" line2="84" col2="61" start="13277" end="13333">## Use rownames for gene symbol if gene symbol is missing</COMMENT>
        <expr line1="85" col1="5" line2="86" col2="61" start="13435" end="13649">
          <expr line1="85" col1="5" line2="85" col2="13" start="13435" end="13443">
            <SYMBOL line1="85" col1="5" line2="85" col2="13" start="13435" end="13443">na_symbol</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="85" col1="15" line2="85" col2="16" start="13445" end="13446">&lt;-</LEFT_ASSIGN>
          <expr line1="85" col1="18" line2="86" col2="61" start="13448" end="13649">
            <OP-LEFT-PAREN line1="85" col1="18" line2="85" col2="18" start="13448" end="13448">(</OP-LEFT-PAREN>
            <expr line1="85" col1="19" line2="86" col2="60" start="13449" end="13648">
              <expr line1="85" col1="19" line2="85" col2="57" start="13449" end="13487">
                <expr line1="85" col1="19" line2="85" col2="23" start="13449" end="13453">
                  <SYMBOL_FUNCTION_CALL line1="85" col1="19" line2="85" col2="23" start="13449" end="13453">is.na</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="85" col1="24" line2="85" col2="24" start="13454" end="13454">(</OP-LEFT-PAREN>
                <expr line1="85" col1="25" line2="85" col2="56" start="13455" end="13486">
                  <expr line1="85" col1="25" line2="85" col2="41" start="13455" end="13471">
                    <SYMBOL line1="85" col1="25" line2="85" col2="41" start="13455" end="13471">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="85" col1="42" line2="85" col2="42" start="13472" end="13472">$</OP-DOLLAR>
                  <SYMBOL line1="85" col1="43" line2="85" col2="56" start="13473" end="13486">feature_symbol</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="85" col1="57" line2="85" col2="57" start="13487" end="13487">)</OP-RIGHT-PAREN>
              </expr>
              <OR line1="85" col1="59" line2="85" col2="59" start="13489" end="13489">|</OR>
              <expr line1="86" col1="23" line2="86" col2="60" start="13611" end="13648">
                <expr line1="86" col1="23" line2="86" col2="54" start="13611" end="13642">
                  <expr line1="86" col1="23" line2="86" col2="39" start="13611" end="13627">
                    <SYMBOL line1="86" col1="23" line2="86" col2="39" start="13611" end="13627">feature_info_full</SYMBOL>
                  </expr>
                  <OP-DOLLAR line1="86" col1="40" line2="86" col2="40" start="13628" end="13628">$</OP-DOLLAR>
                  <SYMBOL line1="86" col1="41" line2="86" col2="54" start="13629" end="13642">feature_symbol</SYMBOL>
                </expr>
                <EQ line1="86" col1="56" line2="86" col2="57" start="13644" end="13645">==</EQ>
                <expr line1="86" col1="59" line2="86" col2="60" start="13647" end="13648">
                  <STR_CONST line1="86" col1="59" line2="86" col2="60" start="13647" end="13648">""</STR_CONST>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="86" col1="61" line2="86" col2="61" start="13649" end="13649">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="87" col1="5" line2="88" col2="46" start="13751" end="13950">
          <expr line1="87" col1="5" line2="87" col2="47" start="13751" end="13793">
            <expr line1="87" col1="5" line2="87" col2="36" start="13751" end="13782">
              <expr line1="87" col1="5" line2="87" col2="21" start="13751" end="13767">
                <SYMBOL line1="87" col1="5" line2="87" col2="21" start="13751" end="13767">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="87" col1="22" line2="87" col2="22" start="13768" end="13768">$</OP-DOLLAR>
              <SYMBOL line1="87" col1="23" line2="87" col2="36" start="13769" end="13782">feature_symbol</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="87" col1="37" line2="87" col2="37" start="13783" end="13783">[</OP-LEFT-BRACKET>
            <expr line1="87" col1="38" line2="87" col2="46" start="13784" end="13792">
              <SYMBOL line1="87" col1="38" line2="87" col2="46" start="13784" end="13792">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="87" col1="47" line2="87" col2="47" start="13793" end="13793">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="87" col1="49" line2="87" col2="50" start="13795" end="13796">&lt;-</LEFT_ASSIGN>
          <expr line1="88" col1="9" line2="88" col2="46" start="13913" end="13950">
            <expr line1="88" col1="9" line2="88" col2="35" start="13913" end="13939">
              <expr line1="88" col1="9" line2="88" col2="16" start="13913" end="13920">
                <SYMBOL_FUNCTION_CALL line1="88" col1="9" line2="88" col2="16" start="13913" end="13920">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="88" col1="17" line2="88" col2="17" start="13921" end="13921">(</OP-LEFT-PAREN>
              <expr line1="88" col1="18" line2="88" col2="34" start="13922" end="13938">
                <SYMBOL line1="88" col1="18" line2="88" col2="34" start="13922" end="13938">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="88" col1="35" line2="88" col2="35" start="13939" end="13939">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="88" col1="36" line2="88" col2="36" start="13940" end="13940">[</OP-LEFT-BRACKET>
            <expr line1="88" col1="37" line2="88" col2="45" start="13941" end="13949">
              <SYMBOL line1="88" col1="37" line2="88" col2="45" start="13941" end="13949">na_symbol</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="88" col1="46" line2="88" col2="46" start="13950" end="13950">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="89" col1="5" line2="89" col2="87" start="14067" end="14149">## Use rownames from SingleCellExperiment object (feature IDs) for feature_id if na</COMMENT>
        <expr line1="90" col1="5" line2="91" col2="72" start="14225" end="14450">
          <expr line1="90" col1="5" line2="90" col2="69" start="14225" end="14289">
            <expr line1="90" col1="5" line2="90" col2="32" start="14225" end="14252">
              <expr line1="90" col1="5" line2="90" col2="21" start="14225" end="14241">
                <SYMBOL line1="90" col1="5" line2="90" col2="21" start="14225" end="14241">feature_info_full</SYMBOL>
              </expr>
              <OP-DOLLAR line1="90" col1="22" line2="90" col2="22" start="14242" end="14242">$</OP-DOLLAR>
              <SYMBOL line1="90" col1="23" line2="90" col2="32" start="14243" end="14252">feature_id</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="90" col1="33" line2="90" col2="33" start="14253" end="14253">[</OP-LEFT-BRACKET>
            <expr line1="90" col1="34" line2="90" col2="68" start="14254" end="14288">
              <expr line1="90" col1="34" line2="90" col2="38" start="14254" end="14258">
                <SYMBOL_FUNCTION_CALL line1="90" col1="34" line2="90" col2="38" start="14254" end="14258">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="90" col1="39" line2="90" col2="39" start="14259" end="14259">(</OP-LEFT-PAREN>
              <expr line1="90" col1="40" line2="90" col2="67" start="14260" end="14287">
                <expr line1="90" col1="40" line2="90" col2="56" start="14260" end="14276">
                  <SYMBOL line1="90" col1="40" line2="90" col2="56" start="14260" end="14276">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="90" col1="57" line2="90" col2="57" start="14277" end="14277">$</OP-DOLLAR>
                <SYMBOL line1="90" col1="58" line2="90" col2="67" start="14278" end="14287">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="90" col1="68" line2="90" col2="68" start="14288" end="14288">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="90" col1="69" line2="90" col2="69" start="14289" end="14289">]</OP-RIGHT-BRACKET>
          </expr>
          <LEFT_ASSIGN line1="90" col1="71" line2="90" col2="72" start="14291" end="14292">&lt;-</LEFT_ASSIGN>
          <expr line1="91" col1="9" line2="91" col2="72" start="14387" end="14450">
            <expr line1="91" col1="9" line2="91" col2="35" start="14387" end="14413">
              <expr line1="91" col1="9" line2="91" col2="16" start="14387" end="14394">
                <SYMBOL_FUNCTION_CALL line1="91" col1="9" line2="91" col2="16" start="14387" end="14394">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="91" col1="17" line2="91" col2="17" start="14395" end="14395">(</OP-LEFT-PAREN>
              <expr line1="91" col1="18" line2="91" col2="34" start="14396" end="14412">
                <SYMBOL line1="91" col1="18" line2="91" col2="34" start="14396" end="14412">feature_info_full</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="91" col1="35" line2="91" col2="35" start="14413" end="14413">)</OP-RIGHT-PAREN>
            </expr>
            <OP-LEFT-BRACKET line1="91" col1="36" line2="91" col2="36" start="14414" end="14414">[</OP-LEFT-BRACKET>
            <expr line1="91" col1="37" line2="91" col2="71" start="14415" end="14449">
              <expr line1="91" col1="37" line2="91" col2="41" start="14415" end="14419">
                <SYMBOL_FUNCTION_CALL line1="91" col1="37" line2="91" col2="41" start="14415" end="14419">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="91" col1="42" line2="91" col2="42" start="14420" end="14420">(</OP-LEFT-PAREN>
              <expr line1="91" col1="43" line2="91" col2="70" start="14421" end="14448">
                <expr line1="91" col1="43" line2="91" col2="59" start="14421" end="14437">
                  <SYMBOL line1="91" col1="43" line2="91" col2="59" start="14421" end="14437">feature_info_full</SYMBOL>
                </expr>
                <OP-DOLLAR line1="91" col1="60" line2="91" col2="60" start="14438" end="14438">$</OP-DOLLAR>
                <SYMBOL line1="91" col1="61" line2="91" col2="70" start="14439" end="14448">feature_id</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="91" col1="71" line2="91" col2="71" start="14449" end="14449">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="91" col1="72" line2="91" col2="72" start="14450" end="14450">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <COMMENT line1="92" col1="5" line2="92" col2="66" start="14541" end="14602">## Need to drop any duplicated columns that we want to replace</COMMENT>
        <expr line1="93" col1="5" line2="93" col2="32" start="14699" end="14726">
          <expr line1="93" col1="5" line2="93" col2="13" start="14699" end="14707">
            <SYMBOL line1="93" col1="5" line2="93" col2="13" start="14699" end="14707">old_rdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="93" col1="15" line2="93" col2="16" start="14709" end="14710">&lt;-</LEFT_ASSIGN>
          <expr line1="93" col1="18" line2="93" col2="32" start="14712" end="14726">
            <expr line1="93" col1="18" line2="93" col2="24" start="14712" end="14718">
              <SYMBOL_FUNCTION_CALL line1="93" col1="18" line2="93" col2="24" start="14712" end="14718">rowData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="93" col1="25" line2="93" col2="25" start="14719" end="14719">(</OP-LEFT-PAREN>
            <expr line1="93" col1="26" line2="93" col2="31" start="14720" end="14725">
              <SYMBOL line1="93" col1="26" line2="93" col2="31" start="14720" end="14725">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="93" col1="32" line2="93" col2="32" start="14726" end="14726">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="94" col1="5" line2="95" col2="69" start="14857" end="15079">
          <expr line1="94" col1="5" line2="94" col2="13" start="14857" end="14865">
            <SYMBOL line1="94" col1="5" line2="94" col2="13" start="14857" end="14865">keep_cols</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="94" col1="15" line2="94" col2="16" start="14867" end="14868">&lt;-</LEFT_ASSIGN>
          <expr line1="94" col1="18" line2="95" col2="69" start="14870" end="15079">
            <OP-EXCLAMATION line1="94" col1="18" line2="94" col2="18" start="14870" end="14870">!</OP-EXCLAMATION>
            <expr line1="94" col1="19" line2="95" col2="69" start="14871" end="15079">
              <OP-LEFT-PAREN line1="94" col1="19" line2="94" col2="19" start="14871" end="14871">(</OP-LEFT-PAREN>
              <expr line1="94" col1="20" line2="95" col2="68" start="14872" end="15078">
                <expr line1="94" col1="20" line2="94" col2="38" start="14872" end="14890">
                  <expr line1="94" col1="20" line2="94" col2="27" start="14872" end="14879">
                    <SYMBOL_FUNCTION_CALL line1="94" col1="20" line2="94" col2="27" start="14872" end="14879">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="94" col1="28" line2="94" col2="28" start="14880" end="14880">(</OP-LEFT-PAREN>
                  <expr line1="94" col1="29" line2="94" col2="37" start="14881" end="14889">
                    <SYMBOL line1="94" col1="29" line2="94" col2="37" start="14881" end="14889">old_rdata</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="94" col1="38" line2="94" col2="38" start="14890" end="14890">)</OP-RIGHT-PAREN>
                </expr>
                <SPECIAL line1="94" col1="40" line2="94" col2="43" start="14892" end="14895">%in%</SPECIAL>
                <expr line1="95" col1="24" line2="95" col2="68" start="15034" end="15078">
                  <expr line1="95" col1="24" line2="95" col2="24" start="15034" end="15034">
                    <SYMBOL_FUNCTION_CALL line1="95" col1="24" line2="95" col2="24" start="15034" end="15034">c</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="95" col1="25" line2="95" col2="25" start="15035" end="15035">(</OP-LEFT-PAREN>
                  <expr line1="95" col1="26" line2="95" col2="41" start="15036" end="15051">
                    <STR_CONST line1="95" col1="26" line2="95" col2="41" start="15036" end="15051">"feature_symbol"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="95" col1="42" line2="95" col2="42" start="15052" end="15052">,</OP-COMMA>
                  <expr line1="95" col1="44" line2="95" col2="55" start="15054" end="15065">
                    <STR_CONST line1="95" col1="44" line2="95" col2="55" start="15054" end="15065">"feature_id"</STR_CONST>
                  </expr>
                  <OP-COMMA line1="95" col1="56" line2="95" col2="56" start="15066" end="15066">,</OP-COMMA>
                  <expr line1="95" col1="58" line2="95" col2="67" start="15068" end="15077">
                    <SYMBOL line1="95" col1="58" line2="95" col2="67" start="15068" end="15077">attributes</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="95" col1="68" line2="95" col2="68" start="15078" end="15078">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="95" col1="69" line2="95" col2="69" start="15079" end="15079">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="96" col1="5" line2="102" col2="38" start="15173" end="16154">
          <IF line1="96" col1="5" line2="96" col2="6" start="15173" end="15174">if</IF>
          <OP-LEFT-PAREN line1="96" col1="8" line2="96" col2="8" start="15176" end="15176">(</OP-LEFT-PAREN>
          <expr line1="96" col1="9" line2="96" col2="26" start="15177" end="15194">
            <expr line1="96" col1="9" line2="96" col2="22" start="15177" end="15190">
              <expr line1="96" col1="9" line2="96" col2="11" start="15177" end="15179">
                <SYMBOL_FUNCTION_CALL line1="96" col1="9" line2="96" col2="11" start="15177" end="15179">sum</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="96" col1="12" line2="96" col2="12" start="15180" end="15180">(</OP-LEFT-PAREN>
              <expr line1="96" col1="13" line2="96" col2="21" start="15181" end="15189">
                <SYMBOL line1="96" col1="13" line2="96" col2="21" start="15181" end="15189">keep_cols</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="96" col1="22" line2="96" col2="22" start="15190" end="15190">)</OP-RIGHT-PAREN>
            </expr>
            <GT line1="96" col1="24" line2="96" col2="24" start="15192" end="15192">&gt;</GT>
            <expr line1="96" col1="26" line2="96" col2="26" start="15194" end="15194">
              <NUM_CONST line1="96" col1="26" line2="96" col2="26" start="15194" end="15194">0</NUM_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="96" col1="27" line2="96" col2="27" start="15195" end="15195">)</OP-RIGHT-PAREN>
          <expr line1="96" col1="29" line2="101" col2="5" start="15197" end="15963">
            <OP-LEFT-BRACE line1="96" col1="29" line2="96" col2="29" start="15197" end="15197">{</OP-LEFT-BRACE>
            <expr line1="97" col1="9" line2="97" col2="49" start="15335" end="15375">
              <expr line1="97" col1="9" line2="97" col2="26" start="15335" end="15352">
                <SYMBOL line1="97" col1="9" line2="97" col2="26" start="15335" end="15352">colnames_old_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="97" col1="28" line2="97" col2="29" start="15354" end="15355">&lt;-</LEFT_ASSIGN>
              <expr line1="97" col1="31" line2="97" col2="49" start="15357" end="15375">
                <expr line1="97" col1="31" line2="97" col2="38" start="15357" end="15364">
                  <SYMBOL_FUNCTION_CALL line1="97" col1="31" line2="97" col2="38" start="15357" end="15364">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="97" col1="39" line2="97" col2="39" start="15365" end="15365">(</OP-LEFT-PAREN>
                <expr line1="97" col1="40" line2="97" col2="48" start="15366" end="15374">
                  <SYMBOL line1="97" col1="40" line2="97" col2="48" start="15366" end="15374">old_rdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="97" col1="49" line2="97" col2="49" start="15375" end="15375">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="98" col1="9" line2="98" col2="58" start="15493" end="15542">
              <expr line1="98" col1="9" line2="98" col2="17" start="15493" end="15501">
                <SYMBOL line1="98" col1="9" line2="98" col2="17" start="15493" end="15501">old_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="98" col1="19" line2="98" col2="20" start="15503" end="15504">&lt;-</LEFT_ASSIGN>
              <expr line1="98" col1="22" line2="98" col2="58" start="15506" end="15542">
                <expr line1="98" col1="22" line2="98" col2="34" start="15506" end="15518">
                  <SYMBOL_FUNCTION_CALL line1="98" col1="22" line2="98" col2="34" start="15506" end="15518">as.data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="98" col1="35" line2="98" col2="35" start="15519" end="15519">(</OP-LEFT-PAREN>
                <expr line1="98" col1="36" line2="98" col2="57" start="15520" end="15541">
                  <expr line1="98" col1="36" line2="98" col2="44" start="15520" end="15528">
                    <SYMBOL line1="98" col1="36" line2="98" col2="44" start="15520" end="15528">old_rdata</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="98" col1="45" line2="98" col2="45" start="15529" end="15529">[</OP-LEFT-BRACKET>
                  <OP-COMMA line1="98" col1="46" line2="98" col2="46" start="15530" end="15530">,</OP-COMMA>
                  <expr line1="98" col1="48" line2="98" col2="56" start="15532" end="15540">
                    <SYMBOL line1="98" col1="48" line2="98" col2="56" start="15532" end="15540">keep_cols</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="98" col1="57" line2="98" col2="57" start="15541" end="15541">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="98" col1="58" line2="98" col2="58" start="15542" end="15542">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="99" col1="9" line2="99" col2="60" start="15651" end="15702">
              <expr line1="99" col1="9" line2="99" col2="27" start="15651" end="15669">
                <expr line1="99" col1="9" line2="99" col2="16" start="15651" end="15658">
                  <SYMBOL_FUNCTION_CALL line1="99" col1="9" line2="99" col2="16" start="15651" end="15658">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="99" col1="17" line2="99" col2="17" start="15659" end="15659">(</OP-LEFT-PAREN>
                <expr line1="99" col1="18" line2="99" col2="26" start="15660" end="15668">
                  <SYMBOL line1="99" col1="18" line2="99" col2="26" start="15660" end="15668">old_rdata</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="99" col1="27" line2="99" col2="27" start="15669" end="15669">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="99" col1="29" line2="99" col2="30" start="15671" end="15672">&lt;-</LEFT_ASSIGN>
              <expr line1="99" col1="32" line2="99" col2="60" start="15674" end="15702">
                <expr line1="99" col1="32" line2="99" col2="49" start="15674" end="15691">
                  <SYMBOL line1="99" col1="32" line2="99" col2="49" start="15674" end="15691">colnames_old_rdata</SYMBOL>
                </expr>
                <OP-LEFT-BRACKET line1="99" col1="50" line2="99" col2="50" start="15692" end="15692">[</OP-LEFT-BRACKET>
                <expr line1="99" col1="51" line2="99" col2="59" start="15693" end="15701">
                  <SYMBOL line1="99" col1="51" line2="99" col2="59" start="15693" end="15701">keep_cols</SYMBOL>
                </expr>
                <OP-RIGHT-BRACKET line1="99" col1="60" line2="99" col2="60" start="15702" end="15702">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="100" col1="9" line2="100" col2="56" start="15809" end="15856">
              <expr line1="100" col1="9" line2="100" col2="17" start="15809" end="15817">
                <SYMBOL line1="100" col1="9" line2="100" col2="17" start="15809" end="15817">new_rdata</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="100" col1="19" line2="100" col2="20" start="15819" end="15820">&lt;-</LEFT_ASSIGN>
              <expr line1="100" col1="22" line2="100" col2="56" start="15822" end="15856">
                <expr line1="100" col1="22" line2="100" col2="26" start="15822" end="15826">
                  <SYMBOL_FUNCTION_CALL line1="100" col1="22" line2="100" col2="26" start="15822" end="15826">cbind</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="100" col1="27" line2="100" col2="27" start="15827" end="15827">(</OP-LEFT-PAREN>
                <expr line1="100" col1="28" line2="100" col2="36" start="15828" end="15836">
                  <SYMBOL line1="100" col1="28" line2="100" col2="36" start="15828" end="15836">old_rdata</SYMBOL>
                </expr>
                <OP-COMMA line1="100" col1="37" line2="100" col2="37" start="15837" end="15837">,</OP-COMMA>
                <expr line1="100" col1="39" line2="100" col2="55" start="15839" end="15855">
                  <SYMBOL line1="100" col1="39" line2="100" col2="55" start="15839" end="15855">feature_info_full</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="100" col1="56" line2="100" col2="56" start="15856" end="15856">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="101" col1="5" line2="101" col2="5" start="15963" end="15963">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="101" col1="7" line2="101" col2="10" start="15965" end="15968">else</ELSE>
          <expr line1="102" col1="9" line2="102" col2="38" start="16125" end="16154">
            <expr line1="102" col1="9" line2="102" col2="17" start="16125" end="16133">
              <SYMBOL line1="102" col1="9" line2="102" col2="17" start="16125" end="16133">new_rdata</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="102" col1="19" line2="102" col2="20" start="16135" end="16136">&lt;-</LEFT_ASSIGN>
            <expr line1="102" col1="22" line2="102" col2="38" start="16138" end="16154">
              <SYMBOL line1="102" col1="22" line2="102" col2="38" start="16138" end="16154">feature_info_full</SYMBOL>
            </expr>
          </expr>
        </expr>
        <COMMENT line1="103" col1="5" line2="103" col2="65" start="16279" end="16339">## Add new feature annotations to SingleCellExperiment object</COMMENT>
        <expr line1="104" col1="5" line2="104" col2="32" start="16437" end="16464">
          <expr line1="104" col1="5" line2="104" col2="19" start="16437" end="16451">
            <expr line1="104" col1="5" line2="104" col2="11" start="16437" end="16443">
              <SYMBOL_FUNCTION_CALL line1="104" col1="5" line2="104" col2="11" start="16437" end="16443">rowData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="104" col1="12" line2="104" col2="12" start="16444" end="16444">(</OP-LEFT-PAREN>
            <expr line1="104" col1="13" line2="104" col2="18" start="16445" end="16450">
              <SYMBOL line1="104" col1="13" line2="104" col2="18" start="16445" end="16450">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="104" col1="19" line2="104" col2="19" start="16451" end="16451">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="104" col1="21" line2="104" col2="22" start="16453" end="16454">&lt;-</LEFT_ASSIGN>
          <expr line1="104" col1="24" line2="104" col2="32" start="16456" end="16464">
            <SYMBOL line1="104" col1="24" line2="104" col2="32" start="16456" end="16464">new_rdata</SYMBOL>
          </expr>
        </expr>
        <COMMENT line1="105" col1="5" line2="105" col2="41" start="16595" end="16631">## Return SingleCellExperiment object</COMMENT>
        <expr line1="106" col1="5" line2="106" col2="10" start="16753" end="16758">
          <SYMBOL line1="106" col1="5" line2="106" col2="10" start="16753" end="16758">object</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="107" col1="1" line2="107" col2="1" start="16907" end="16907">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="109" col1="1" line2="109" col2="80" start="17223" end="17302">##----------------------------------------------------------------------------##</COMMENT>
  <COMMENT line1="111" col1="1" line2="111" col2="51" start="17539" end="17589">## Function to summarise expression across features</COMMENT>
  <COMMENT line1="113" col1="1" line2="113" col2="45" start="17855" end="17899">#' Summarise expression values across feature</COMMENT>
  <COMMENT line1="114" col1="1" line2="114" col2="3" start="18013" end="18015">#' </COMMENT>
  <COMMENT line1="115" col1="1" line2="115" col2="97" start="18171" end="18267">#' Create a new \code{\link{SingleCellExperiment}} with counts summarised at a different feature </COMMENT>
  <COMMENT line1="116" col1="1" line2="116" col2="77" start="18329" end="18405">#' level. A typical use would be to summarise transcript-level counts at gene</COMMENT>
  <COMMENT line1="117" col1="1" line2="117" col2="9" start="18487" end="18495">#' level.</COMMENT>
  <COMMENT line1="118" col1="1" line2="118" col2="3" start="18645" end="18647">#' </COMMENT>
  <COMMENT line1="119" col1="1" line2="119" col2="55" start="18803" end="18857">#' @param object an \code{SingleCellExperiment} object.</COMMENT>
  <COMMENT line1="120" col1="1" line2="120" col2="69" start="18961" end="19029">#' @param exprs_values character string indicating which slot of the </COMMENT>
  <COMMENT line1="121" col1="1" line2="121" col2="94" start="19119" end="19212">#' assayData from the \code{SingleCellExperiment} object should be used as expression values. </COMMENT>
  <COMMENT line1="122" col1="1" line2="122" col2="71" start="19277" end="19347">#' Valid options are \code{'counts'} the counts slot, \code{'tpm'} the </COMMENT>
  <COMMENT line1="123" col1="1" line2="123" col2="63" start="19435" end="19497">#' transcripts-per-million slot or \code{'fpkm'} the FPKM slot.</COMMENT>
  <COMMENT line1="124" col1="1" line2="124" col2="83" start="19593" end="19675">#' @param summarise_by character string giving the column of \code{rowData(object)}</COMMENT>
  <COMMENT line1="125" col1="1" line2="125" col2="80" start="19751" end="19830">#' that will be used as the features for which summarised expression levels are </COMMENT>
  <COMMENT line1="126" col1="1" line2="126" col2="50" start="19909" end="19958">#' to be produced. Default is \code{'feature_id'}.</COMMENT>
  <COMMENT line1="127" col1="1" line2="127" col2="73" start="20067" end="20139">#' @param scaled_tpm_counts logical, should feature-summarised counts be </COMMENT>
  <COMMENT line1="128" col1="1" line2="128" col2="78" start="20225" end="20302">#' computed from summed TPM values scaled by total library size? This approach</COMMENT>
  <COMMENT line1="129" col1="1" line2="129" col2="78" start="20383" end="20460">#' is recommended (see \url{https://f1000research.com/articles/4-1521/v2}), so</COMMENT>
  <COMMENT line1="130" col1="1" line2="130" col2="78" start="20541" end="20618">#' the default is \code{TRUE} and it is applied if TPM values are available in</COMMENT>
  <COMMENT line1="131" col1="1" line2="131" col2="14" start="20699" end="20712">#' the object.</COMMENT>
  <COMMENT line1="132" col1="1" line2="132" col2="75" start="20857" end="20931">#' @param lib_size optional vector of numeric values of same length as the </COMMENT>
  <COMMENT line1="133" col1="1" line2="133" col2="91" start="21015" end="21105">#' number of columns in the \code{SingleCellExperiment} object providing the total library </COMMENT>
  <COMMENT line1="134" col1="1" line2="134" col2="60" start="21173" end="21232">#' size (e.g. "count of mapped reads") for each cell/sample.</COMMENT>
  <COMMENT line1="135" col1="1" line2="135" col2="3" start="21331" end="21333">#' </COMMENT>
  <COMMENT line1="136" col1="1" line2="136" col2="77" start="21489" end="21565">#' @details Only transcripts-per-million (TPM) and fragments per kilobase of </COMMENT>
  <COMMENT line1="137" col1="1" line2="137" col2="79" start="21647" end="21725">#' exon per million reads mapped (FPKM) expression values should be aggregated </COMMENT>
  <COMMENT line1="138" col1="1" line2="138" col2="78" start="21805" end="21882">#' across features. Since counts are not scaled by the length of the feature, </COMMENT>
  <COMMENT line1="139" col1="1" line2="139" col2="73" start="21963" end="22035">#' expression in counts units are not comparable within a sample without </COMMENT>
  <COMMENT line1="140" col1="1" line2="140" col2="74" start="22121" end="22194">#' adjusting for feature length. Thus, we cannot sum counts over a set of </COMMENT>
  <COMMENT line1="141" col1="1" line2="141" col2="80" start="22279" end="22358">#' features to get the expression of that set (for example, we cannot sum counts</COMMENT>
  <COMMENT line1="142" col1="1" line2="142" col2="78" start="22437" end="22514">#' over transcripts to get accurate expression estimates for a gene). See the </COMMENT>
  <COMMENT line1="143" col1="1" line2="143" col2="82" start="22595" end="22676">#' following link for a discussion of RNA-seq expression units by Harold Pimentel:</COMMENT>
  <COMMENT line1="144" col1="1" line2="144" col2="157" start="22753" end="22909">#' \url{https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/}. For more details about the effects of summarising </COMMENT>
  <COMMENT line1="145" col1="1" line2="145" col2="74" start="22911" end="22984">#' transcript expression values at the gene level see Sonesen et al, 2016 </COMMENT>
  <COMMENT line1="146" col1="1" line2="146" col2="56" start="23069" end="23124">#' (\url{https://f1000research.com/articles/4-1521/v2}).</COMMENT>
  <COMMENT line1="147" col1="1" line2="147" col2="3" start="23227" end="23229">#' </COMMENT>
  <COMMENT line1="148" col1="1" line2="148" col2="41" start="23385" end="23425">#' @return an SingleCellExperiment object</COMMENT>
  <COMMENT line1="149" col1="1" line2="149" col2="3" start="23543" end="23545">#' </COMMENT>
  <COMMENT line1="150" col1="1" line2="150" col2="10" start="23701" end="23710">#' @export</COMMENT>
  <COMMENT line1="151" col1="1" line2="151" col2="3" start="23859" end="23861">#' </COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="12" start="24017" end="24028">#' @examples</COMMENT>
  <COMMENT line1="153" col1="1" line2="153" col2="28" start="24175" end="24202">#' data("sc_example_counts")</COMMENT>
  <COMMENT line1="154" col1="1" line2="154" col2="31" start="24333" end="24363">#' data("sc_example_cell_info")</COMMENT>
  <COMMENT line1="155" col1="1" line2="155" col2="39" start="24491" end="24529">#' example_sce &lt;- SingleCellExperiment(</COMMENT>
  <COMMENT line1="156" col1="1" line2="156" col2="77" start="24649" end="24725">#' assays = list(counts = sc_example_counts), colData = sc_example_cell_info)</COMMENT>
  <COMMENT line1="157" col1="1" line2="157" col2="53" start="24807" end="24859">#' rd &lt;- data.frame(gene_id = rownames(example_sce), </COMMENT>
  <COMMENT line1="158" col1="1" line2="158" col2="66" start="24965" end="25030">#' feature_id = paste("feature", rep(1:500, each = 4), sep = "_"))</COMMENT>
  <COMMENT line1="159" col1="1" line2="159" col2="40" start="25123" end="25162">#' rownames(rd) &lt;- rownames(example_sce)</COMMENT>
  <COMMENT line1="160" col1="1" line2="160" col2="29" start="25281" end="25309">#' rowData(example_sce) &lt;- rd</COMMENT>
  <COMMENT line1="161" col1="1" line2="161" col2="55" start="25439" end="25493">#' effective_length &lt;- rep(c(1000, 2000), times = 1000)</COMMENT>
  <COMMENT line1="162" col1="1" line2="162" col2="88" start="25597" end="25684">#' tpm(example_sce) &lt;- calculateTPM(example_sce, effective_length, calc_from = "counts")</COMMENT>
  <COMMENT line1="163" col1="1" line2="163" col2="3" start="25755" end="25757">#' </COMMENT>
  <COMMENT line1="164" col1="1" line2="164" col2="32" start="25913" end="25944">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="165" col1="1" line2="165" col2="66" start="26071" end="26136">#' summariseExprsAcrossFeatures(example_sce, exprs_values = "tpm")</COMMENT>
  <COMMENT line1="166" col1="1" line2="166" col2="32" start="26229" end="26260">#' example_sceset_summarised &lt;- </COMMENT>
  <COMMENT line1="167" col1="1" line2="167" col2="69" start="26387" end="26455">#' summariseExprsAcrossFeatures(example_sce, exprs_values = "counts")</COMMENT>
  <COMMENT line1="168" col1="1" line2="168" col2="3" start="26545" end="26547">#' </COMMENT>
  <expr line1="169" col1="1" line2="269" col2="1" start="26703" end="42503">
    <expr line1="169" col1="1" line2="169" col2="28" start="26703" end="26730">
      <SYMBOL line1="169" col1="1" line2="169" col2="28" start="26703" end="26730">summariseExprsAcrossFeatures</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="169" col1="30" line2="169" col2="31" start="26732" end="26733">&lt;-</LEFT_ASSIGN>
    <expr line1="169" col1="33" line2="269" col2="1" start="26735" end="42503">
      <FUNCTION line1="169" col1="33" line2="169" col2="40" start="26735" end="26742">function</FUNCTION>
      <OP-LEFT-PAREN line1="169" col1="41" line2="169" col2="41" start="26743" end="26743">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="169" col1="42" line2="169" col2="47" start="26744" end="26749">object</SYMBOL_FORMALS>
      <OP-COMMA line1="169" col1="48" line2="169" col2="48" start="26750" end="26750">,</OP-COMMA>
      <SYMBOL_FORMALS line1="169" col1="50" line2="169" col2="61" start="26752" end="26763">exprs_values</SYMBOL_FORMALS>
      <EQ_FORMALS line1="169" col1="63" line2="169" col2="63" start="26765" end="26765">=</EQ_FORMALS>
      <expr line1="169" col1="65" line2="169" col2="69" start="26767" end="26771">
        <STR_CONST line1="169" col1="65" line2="169" col2="69" start="26767" end="26771">"tpm"</STR_CONST>
      </expr>
      <OP-COMMA line1="169" col1="70" line2="169" col2="70" start="26772" end="26772">,</OP-COMMA>
      <SYMBOL_FORMALS line1="170" col1="42" line2="170" col2="53" start="26902" end="26913">summarise_by</SYMBOL_FORMALS>
      <EQ_FORMALS line1="170" col1="55" line2="170" col2="55" start="26915" end="26915">=</EQ_FORMALS>
      <expr line1="170" col1="57" line2="170" col2="68" start="26917" end="26928">
        <STR_CONST line1="170" col1="57" line2="170" col2="68" start="26917" end="26928">"feature_id"</STR_CONST>
      </expr>
      <OP-COMMA line1="170" col1="69" line2="170" col2="69" start="26929" end="26929">,</OP-COMMA>
      <SYMBOL_FORMALS line1="171" col1="42" line2="171" col2="58" start="27060" end="27076">scaled_tpm_counts</SYMBOL_FORMALS>
      <EQ_FORMALS line1="171" col1="60" line2="171" col2="60" start="27078" end="27078">=</EQ_FORMALS>
      <expr line1="171" col1="62" line2="171" col2="65" start="27080" end="27083">
        <NUM_CONST line1="171" col1="62" line2="171" col2="65" start="27080" end="27083">TRUE</NUM_CONST>
      </expr>
      <OP-COMMA line1="171" col1="66" line2="171" col2="66" start="27084" end="27084">,</OP-COMMA>
      <SYMBOL_FORMALS line1="172" col1="42" line2="172" col2="49" start="27218" end="27225">lib_size</SYMBOL_FORMALS>
      <EQ_FORMALS line1="172" col1="51" line2="172" col2="51" start="27227" end="27227">=</EQ_FORMALS>
      <expr line1="172" col1="53" line2="172" col2="56" start="27229" end="27232">
        <NULL_CONST line1="172" col1="53" line2="172" col2="56" start="27229" end="27232">NULL</NULL_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="172" col1="57" line2="172" col2="57" start="27233" end="27233">)</OP-RIGHT-PAREN>
      <expr line1="172" col1="59" line2="269" col2="1" start="27235" end="42503">
        <OP-LEFT-BRACE line1="172" col1="59" line2="172" col2="59" start="27235" end="27235">{</OP-LEFT-BRACE>
        <expr line1="173" col1="5" line2="174" col2="53" start="27339" end="27545">
          <IF line1="173" col1="5" line2="173" col2="6" start="27339" end="27340">if</IF>
          <OP-LEFT-PAREN line1="173" col1="8" line2="173" col2="8" start="27342" end="27342">(</OP-LEFT-PAREN>
          <expr line1="173" col1="10" line2="173" col2="53" start="27344" end="27387">
            <OP-EXCLAMATION line1="173" col1="10" line2="173" col2="10" start="27344" end="27344">!</OP-EXCLAMATION>
            <expr line1="173" col1="11" line2="173" col2="53" start="27345" end="27387">
              <expr line1="173" col1="11" line2="173" col2="21" start="27345" end="27355">
                <SYMBOL_PACKAGE line1="173" col1="11" line2="173" col2="17" start="27345" end="27351">methods</SYMBOL_PACKAGE>
                <NS_GET line1="173" col1="18" line2="173" col2="19" start="27352" end="27353">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="173" col1="20" line2="173" col2="21" start="27354" end="27355">is</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="173" col1="22" line2="173" col2="22" start="27356" end="27356">(</OP-LEFT-PAREN>
              <expr line1="173" col1="23" line2="173" col2="28" start="27357" end="27362">
                <SYMBOL line1="173" col1="23" line2="173" col2="28" start="27357" end="27362">object</SYMBOL>
              </expr>
              <OP-COMMA line1="173" col1="29" line2="173" col2="29" start="27363" end="27363">,</OP-COMMA>
              <expr line1="173" col1="31" line2="173" col2="52" start="27365" end="27386">
                <STR_CONST line1="173" col1="31" line2="173" col2="52" start="27365" end="27386">"SingleCellExperiment"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="173" col1="53" line2="173" col2="53" start="27387" end="27387">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="173" col1="55" line2="173" col2="55" start="27389" end="27389">)</OP-RIGHT-PAREN>
          <expr line1="174" col1="9" line2="174" col2="53" start="27501" end="27545">
            <expr line1="174" col1="9" line2="174" col2="12" start="27501" end="27504">
              <SYMBOL_FUNCTION_CALL line1="174" col1="9" line2="174" col2="12" start="27501" end="27504">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="174" col1="13" line2="174" col2="13" start="27505" end="27505">(</OP-LEFT-PAREN>
            <expr line1="174" col1="14" line2="174" col2="52" start="27506" end="27544">
              <STR_CONST line1="174" col1="14" line2="174" col2="52" start="27506" end="27544">"Object must be a SingleCellExperiment"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="174" col1="53" line2="174" col2="53" start="27545" end="27545">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="175" col1="5" line2="175" col2="72" start="27655" end="27722">## Define an expression matrix depending on which values we're using</COMMENT>
        <expr line1="176" col1="5" line2="176" col2="71" start="27813" end="27879">
          <expr line1="176" col1="5" line2="176" col2="16" start="27813" end="27824">
            <SYMBOL line1="176" col1="5" line2="176" col2="16" start="27813" end="27824">exprs_values</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="176" col1="18" line2="176" col2="19" start="27826" end="27827">&lt;-</LEFT_ASSIGN>
          <expr line1="176" col1="21" line2="176" col2="71" start="27829" end="27879">
            <expr line1="176" col1="21" line2="176" col2="29" start="27829" end="27837">
              <SYMBOL_FUNCTION_CALL line1="176" col1="21" line2="176" col2="29" start="27829" end="27837">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="176" col1="30" line2="176" col2="30" start="27838" end="27838">(</OP-LEFT-PAREN>
            <expr line1="176" col1="31" line2="176" col2="42" start="27839" end="27850">
              <SYMBOL line1="176" col1="31" line2="176" col2="42" start="27839" end="27850">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="176" col1="43" line2="176" col2="43" start="27851" end="27851">,</OP-COMMA>
            <expr line1="176" col1="45" line2="176" col2="70" start="27853" end="27878">
              <expr line1="176" col1="45" line2="176" col2="45" start="27853" end="27853">
                <SYMBOL_FUNCTION_CALL line1="176" col1="45" line2="176" col2="45" start="27853" end="27853">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="176" col1="46" line2="176" col2="46" start="27854" end="27854">(</OP-LEFT-PAREN>
              <expr line1="176" col1="47" line2="176" col2="51" start="27855" end="27859">
                <STR_CONST line1="176" col1="47" line2="176" col2="51" start="27855" end="27859">"tpm"</STR_CONST>
              </expr>
              <OP-COMMA line1="176" col1="52" line2="176" col2="52" start="27860" end="27860">,</OP-COMMA>
              <expr line1="176" col1="54" line2="176" col2="59" start="27862" end="27867">
                <STR_CONST line1="176" col1="54" line2="176" col2="59" start="27862" end="27867">"fpkm"</STR_CONST>
              </expr>
              <OP-COMMA line1="176" col1="60" line2="176" col2="60" start="27868" end="27868">,</OP-COMMA>
              <expr line1="176" col1="62" line2="176" col2="69" start="27870" end="27877">
                <STR_CONST line1="176" col1="62" line2="176" col2="69" start="27870" end="27877">"counts"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="176" col1="70" line2="176" col2="70" start="27878" end="27878">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="176" col1="71" line2="176" col2="71" start="27879" end="27879">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="177" col1="5" line2="180" col2="48" start="27971" end="28488">
          <expr line1="177" col1="5" line2="177" col2="13" start="27971" end="27979">
            <SYMBOL line1="177" col1="5" line2="177" col2="13" start="27971" end="27979">exprs_mat</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="177" col1="15" line2="177" col2="16" start="27981" end="27982">&lt;-</LEFT_ASSIGN>
          <expr line1="177" col1="18" line2="180" col2="48" start="27984" end="28488">
            <expr line1="177" col1="18" line2="177" col2="23" start="27984" end="27989">
              <SYMBOL_FUNCTION_CALL line1="177" col1="18" line2="177" col2="23" start="27984" end="27989">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="177" col1="24" line2="177" col2="24" start="27990" end="27990">(</OP-LEFT-PAREN>
            <expr line1="177" col1="25" line2="177" col2="36" start="27991" end="28002">
              <SYMBOL line1="177" col1="25" line2="177" col2="36" start="27991" end="28002">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="177" col1="37" line2="177" col2="37" start="28003" end="28003">,</OP-COMMA>
            <SYMBOL_SUB line1="178" col1="25" line2="178" col2="27" start="28149" end="28151">tpm</SYMBOL_SUB>
            <EQ_SUB line1="178" col1="29" line2="178" col2="29" start="28153" end="28153">=</EQ_SUB>
            <expr line1="178" col1="31" line2="178" col2="41" start="28155" end="28165">
              <expr line1="178" col1="31" line2="178" col2="33" start="28155" end="28157">
                <SYMBOL_FUNCTION_CALL line1="178" col1="31" line2="178" col2="33" start="28155" end="28157">tpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="178" col1="34" line2="178" col2="34" start="28158" end="28158">(</OP-LEFT-PAREN>
              <expr line1="178" col1="35" line2="178" col2="40" start="28159" end="28164">
                <SYMBOL line1="178" col1="35" line2="178" col2="40" start="28159" end="28164">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="178" col1="41" line2="178" col2="41" start="28165" end="28165">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="178" col1="42" line2="178" col2="42" start="28166" end="28166">,</OP-COMMA>
            <SYMBOL_SUB line1="179" col1="25" line2="179" col2="28" start="28307" end="28310">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="179" col1="30" line2="179" col2="30" start="28312" end="28312">=</EQ_SUB>
            <expr line1="179" col1="32" line2="179" col2="43" start="28314" end="28325">
              <expr line1="179" col1="32" line2="179" col2="35" start="28314" end="28317">
                <SYMBOL_FUNCTION_CALL line1="179" col1="32" line2="179" col2="35" start="28314" end="28317">fpkm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="179" col1="36" line2="179" col2="36" start="28318" end="28318">(</OP-LEFT-PAREN>
              <expr line1="179" col1="37" line2="179" col2="42" start="28319" end="28324">
                <SYMBOL line1="179" col1="37" line2="179" col2="42" start="28319" end="28324">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="179" col1="43" line2="179" col2="43" start="28325" end="28325">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="179" col1="44" line2="179" col2="44" start="28326" end="28326">,</OP-COMMA>
            <SYMBOL_SUB line1="180" col1="25" line2="180" col2="30" start="28465" end="28470">counts</SYMBOL_SUB>
            <EQ_SUB line1="180" col1="32" line2="180" col2="32" start="28472" end="28472">=</EQ_SUB>
            <expr line1="180" col1="34" line2="180" col2="47" start="28474" end="28487">
              <expr line1="180" col1="34" line2="180" col2="39" start="28474" end="28479">
                <SYMBOL_FUNCTION_CALL line1="180" col1="34" line2="180" col2="39" start="28474" end="28479">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="180" col1="40" line2="180" col2="40" start="28480" end="28480">(</OP-LEFT-PAREN>
              <expr line1="180" col1="41" line2="180" col2="46" start="28481" end="28486">
                <SYMBOL line1="180" col1="41" line2="180" col2="46" start="28481" end="28486">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="180" col1="47" line2="180" col2="47" start="28487" end="28487">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="180" col1="48" line2="180" col2="48" start="28488" end="28488">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="181" col1="5" line2="182" col2="77" start="28603" end="28833">
          <IF line1="181" col1="5" line2="181" col2="6" start="28603" end="28604">if</IF>
          <OP-LEFT-PAREN line1="181" col1="8" line2="181" col2="8" start="28606" end="28606">(</OP-LEFT-PAREN>
          <expr line1="181" col1="10" line2="181" col2="55" start="28608" end="28653">
            <OP-EXCLAMATION line1="181" col1="10" line2="181" col2="10" start="28608" end="28608">!</OP-EXCLAMATION>
            <expr line1="181" col1="11" line2="181" col2="55" start="28609" end="28653">
              <OP-LEFT-PAREN line1="181" col1="11" line2="181" col2="11" start="28609" end="28609">(</OP-LEFT-PAREN>
              <expr line1="181" col1="12" line2="181" col2="54" start="28610" end="28652">
                <expr line1="181" col1="12" line2="181" col2="23" start="28610" end="28621">
                  <SYMBOL line1="181" col1="12" line2="181" col2="23" start="28610" end="28621">summarise_by</SYMBOL>
                </expr>
                <SPECIAL line1="181" col1="25" line2="181" col2="28" start="28623" end="28626">%in%</SPECIAL>
                <expr line1="181" col1="30" line2="181" col2="54" start="28628" end="28652">
                  <expr line1="181" col1="30" line2="181" col2="37" start="28628" end="28635">
                    <SYMBOL_FUNCTION_CALL line1="181" col1="30" line2="181" col2="37" start="28628" end="28635">colnames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="181" col1="38" line2="181" col2="38" start="28636" end="28636">(</OP-LEFT-PAREN>
                  <expr line1="181" col1="39" line2="181" col2="53" start="28637" end="28651">
                    <expr line1="181" col1="39" line2="181" col2="45" start="28637" end="28643">
                      <SYMBOL_FUNCTION_CALL line1="181" col1="39" line2="181" col2="45" start="28637" end="28643">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="181" col1="46" line2="181" col2="46" start="28644" end="28644">(</OP-LEFT-PAREN>
                    <expr line1="181" col1="47" line2="181" col2="52" start="28645" end="28650">
                      <SYMBOL line1="181" col1="47" line2="181" col2="52" start="28645" end="28650">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="181" col1="53" line2="181" col2="53" start="28651" end="28651">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="181" col1="54" line2="181" col2="54" start="28652" end="28652">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="181" col1="55" line2="181" col2="55" start="28653" end="28653">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="181" col1="57" line2="181" col2="57" start="28655" end="28655">)</OP-RIGHT-PAREN>
          <expr line1="182" col1="9" line2="182" col2="77" start="28765" end="28833">
            <expr line1="182" col1="9" line2="182" col2="12" start="28765" end="28768">
              <SYMBOL_FUNCTION_CALL line1="182" col1="9" line2="182" col2="12" start="28765" end="28768">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="182" col1="13" line2="182" col2="13" start="28769" end="28769">(</OP-LEFT-PAREN>
            <expr line1="182" col1="14" line2="182" col2="76" start="28770" end="28832">
              <STR_CONST line1="182" col1="14" line2="182" col2="76" start="28770" end="28832">"The summarise_by argument is not a column of rowData(object)."</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="182" col1="77" line2="182" col2="77" start="28833" end="28833">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="184" col1="5" line2="184" col2="67" start="29077" end="29139">## Use reshape2 to make a long version of the expression matrix</COMMENT>
        <expr line1="185" col1="5" line2="185" col2="81" start="29235" end="29311">
          <expr line1="185" col1="5" line2="185" col2="13" start="29235" end="29243">
            <SYMBOL line1="185" col1="5" line2="185" col2="13" start="29235" end="29243">tmp_exprs</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="185" col1="15" line2="185" col2="16" start="29245" end="29246">&lt;-</LEFT_ASSIGN>
          <expr line1="185" col1="18" line2="185" col2="81" start="29248" end="29311">
            <expr line1="185" col1="18" line2="185" col2="27" start="29248" end="29257">
              <SYMBOL_FUNCTION_CALL line1="185" col1="18" line2="185" col2="27" start="29248" end="29257">data.frame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="185" col1="28" line2="185" col2="28" start="29258" end="29258">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="185" col1="29" line2="185" col2="35" start="29259" end="29265">feature</SYMBOL_SUB>
            <EQ_SUB line1="185" col1="37" line2="185" col2="37" start="29267" end="29267">=</EQ_SUB>
            <expr line1="185" col1="39" line2="185" col2="69" start="29269" end="29299">
              <expr line1="185" col1="39" line2="185" col2="53" start="29269" end="29283">
                <expr line1="185" col1="39" line2="185" col2="45" start="29269" end="29275">
                  <SYMBOL_FUNCTION_CALL line1="185" col1="39" line2="185" col2="45" start="29269" end="29275">rowData</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="185" col1="46" line2="185" col2="46" start="29276" end="29276">(</OP-LEFT-PAREN>
                <expr line1="185" col1="47" line2="185" col2="52" start="29277" end="29282">
                  <SYMBOL line1="185" col1="47" line2="185" col2="52" start="29277" end="29282">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="185" col1="53" line2="185" col2="53" start="29283" end="29283">)</OP-RIGHT-PAREN>
              </expr>
              <LBB line1="185" col1="54" line2="185" col2="55" start="29284" end="29285">[[</LBB>
              <expr line1="185" col1="56" line2="185" col2="67" start="29286" end="29297">
                <SYMBOL line1="185" col1="56" line2="185" col2="67" start="29286" end="29297">summarise_by</SYMBOL>
              </expr>
              <OP-RIGHT-BRACKET line1="185" col1="68" line2="185" col2="68" start="29298" end="29298">]</OP-RIGHT-BRACKET>
              <OP-RIGHT-BRACKET line1="185" col1="69" line2="185" col2="69" start="29299" end="29299">]</OP-RIGHT-BRACKET>
            </expr>
            <OP-COMMA line1="185" col1="70" line2="185" col2="70" start="29300" end="29300">,</OP-COMMA>
            <expr line1="185" col1="72" line2="185" col2="80" start="29302" end="29310">
              <SYMBOL line1="185" col1="72" line2="185" col2="80" start="29302" end="29310">exprs_mat</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="185" col1="81" line2="185" col2="81" start="29311" end="29311">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="186" col1="5" line2="186" col2="65" start="29393" end="29453">
          <expr line1="186" col1="5" line2="186" col2="18" start="29393" end="29406">
            <SYMBOL line1="186" col1="5" line2="186" col2="18" start="29393" end="29406">tmp_exprs_long</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="186" col1="20" line2="186" col2="21" start="29408" end="29409">&lt;-</LEFT_ASSIGN>
          <expr line1="186" col1="23" line2="186" col2="65" start="29411" end="29453">
            <expr line1="186" col1="23" line2="186" col2="38" start="29411" end="29426">
              <SYMBOL_FUNCTION_CALL line1="186" col1="23" line2="186" col2="38" start="29411" end="29426">suppressMessages</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="186" col1="39" line2="186" col2="39" start="29427" end="29427">(</OP-LEFT-PAREN>
            <expr line1="186" col1="40" line2="186" col2="64" start="29428" end="29452">
              <expr line1="186" col1="40" line2="186" col2="53" start="29428" end="29441">
                <SYMBOL_PACKAGE line1="186" col1="40" line2="186" col2="47" start="29428" end="29435">reshape2</SYMBOL_PACKAGE>
                <NS_GET line1="186" col1="48" line2="186" col2="49" start="29436" end="29437">::</NS_GET>
                <SYMBOL_FUNCTION_CALL line1="186" col1="50" line2="186" col2="53" start="29438" end="29441">melt</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="186" col1="54" line2="186" col2="54" start="29442" end="29442">(</OP-LEFT-PAREN>
              <expr line1="186" col1="55" line2="186" col2="63" start="29443" end="29451">
                <SYMBOL line1="186" col1="55" line2="186" col2="63" start="29443" end="29451">tmp_exprs</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="186" col1="64" line2="186" col2="64" start="29452" end="29452">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="186" col1="65" line2="186" col2="65" start="29453" end="29453">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="187" col1="5" line2="187" col2="73" start="29551" end="29619">
          <expr line1="187" col1="5" line2="187" col2="13" start="29551" end="29559">
            <SYMBOL line1="187" col1="5" line2="187" col2="13" start="29551" end="29559">exprs_new</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="187" col1="15" line2="187" col2="16" start="29561" end="29562">&lt;-</LEFT_ASSIGN>
          <expr line1="187" col1="18" line2="187" col2="73" start="29564" end="29619">
            <expr line1="187" col1="18" line2="187" col2="32" start="29564" end="29578">
              <SYMBOL_PACKAGE line1="187" col1="18" line2="187" col2="25" start="29564" end="29571">reshape2</SYMBOL_PACKAGE>
              <NS_GET line1="187" col1="26" line2="187" col2="27" start="29572" end="29573">::</NS_GET>
              <SYMBOL_FUNCTION_CALL line1="187" col1="28" line2="187" col2="32" start="29574" end="29578">acast</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="187" col1="33" line2="187" col2="33" start="29579" end="29579">(</OP-LEFT-PAREN>
            <expr line1="187" col1="34" line2="187" col2="47" start="29580" end="29593">
              <SYMBOL line1="187" col1="34" line2="187" col2="47" start="29580" end="29593">tmp_exprs_long</SYMBOL>
            </expr>
            <OP-COMMA line1="187" col1="48" line2="187" col2="48" start="29594" end="29594">,</OP-COMMA>
            <expr line1="187" col1="50" line2="187" col2="67" start="29596" end="29613">
              <expr line1="187" col1="50" line2="187" col2="56" start="29596" end="29602">
                <SYMBOL line1="187" col1="50" line2="187" col2="56" start="29596" end="29602">feature</SYMBOL>
              </expr>
              <OP-TILDE line1="187" col1="58" line2="187" col2="58" start="29604" end="29604">~</OP-TILDE>
              <expr line1="187" col1="60" line2="187" col2="67" start="29606" end="29613">
                <SYMBOL line1="187" col1="60" line2="187" col2="67" start="29606" end="29613">variable</SYMBOL>
              </expr>
            </expr>
            <OP-COMMA line1="187" col1="68" line2="187" col2="68" start="29614" end="29614">,</OP-COMMA>
            <expr line1="187" col1="70" line2="187" col2="72" start="29616" end="29618">
              <SYMBOL line1="187" col1="70" line2="187" col2="72" start="29616" end="29618">sum</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="187" col1="73" line2="187" col2="73" start="29619" end="29619">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="188" col1="5" line2="188" col2="65" start="29709" end="29769">
          <expr line1="188" col1="5" line2="188" col2="7" start="29709" end="29711">
            <SYMBOL_FUNCTION_CALL line1="188" col1="5" line2="188" col2="7" start="29709" end="29711">cat</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="188" col1="8" line2="188" col2="8" start="29712" end="29712">(</OP-LEFT-PAREN>
          <expr line1="188" col1="9" line2="188" col2="34" start="29713" end="29738">
            <STR_CONST line1="188" col1="9" line2="188" col2="34" start="29713" end="29738">"Collapsing expression to"</STR_CONST>
          </expr>
          <OP-COMMA line1="188" col1="35" line2="188" col2="35" start="29739" end="29739">,</OP-COMMA>
          <expr line1="188" col1="37" line2="188" col2="51" start="29741" end="29755">
            <expr line1="188" col1="37" line2="188" col2="40" start="29741" end="29744">
              <SYMBOL_FUNCTION_CALL line1="188" col1="37" line2="188" col2="40" start="29741" end="29744">nrow</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="188" col1="41" line2="188" col2="41" start="29745" end="29745">(</OP-LEFT-PAREN>
            <expr line1="188" col1="42" line2="188" col2="50" start="29746" end="29754">
              <SYMBOL line1="188" col1="42" line2="188" col2="50" start="29746" end="29754">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="188" col1="51" line2="188" col2="51" start="29755" end="29755">)</OP-RIGHT-PAREN>
          </expr>
          <OP-COMMA line1="188" col1="52" line2="188" col2="52" start="29756" end="29756">,</OP-COMMA>
          <expr line1="188" col1="54" line2="188" col2="64" start="29758" end="29768">
            <STR_CONST line1="188" col1="54" line2="188" col2="64" start="29758" end="29768">"features."</STR_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="188" col1="65" line2="188" col2="65" start="29769" end="29769">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="190" col1="5" line2="190" col2="49" start="30025" end="30069">## ensure sample names haven't been corrupted</COMMENT>
        <expr line1="191" col1="5" line2="191" col2="43" start="30183" end="30221">
          <expr line1="191" col1="5" line2="191" col2="23" start="30183" end="30201">
            <expr line1="191" col1="5" line2="191" col2="12" start="30183" end="30190">
              <SYMBOL_FUNCTION_CALL line1="191" col1="5" line2="191" col2="12" start="30183" end="30190">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="191" col1="13" line2="191" col2="13" start="30191" end="30191">(</OP-LEFT-PAREN>
            <expr line1="191" col1="14" line2="191" col2="22" start="30192" end="30200">
              <SYMBOL line1="191" col1="14" line2="191" col2="22" start="30192" end="30200">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="191" col1="23" line2="191" col2="23" start="30201" end="30201">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="191" col1="25" line2="191" col2="26" start="30203" end="30204">&lt;-</LEFT_ASSIGN>
          <expr line1="191" col1="28" line2="191" col2="43" start="30206" end="30221">
            <expr line1="191" col1="28" line2="191" col2="35" start="30206" end="30213">
              <SYMBOL_FUNCTION_CALL line1="191" col1="28" line2="191" col2="35" start="30206" end="30213">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="191" col1="36" line2="191" col2="36" start="30214" end="30214">(</OP-LEFT-PAREN>
            <expr line1="191" col1="37" line2="191" col2="42" start="30215" end="30220">
              <SYMBOL line1="191" col1="37" line2="191" col2="42" start="30215" end="30220">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="191" col1="43" line2="191" col2="43" start="30221" end="30221">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="193" col1="5" line2="193" col2="30" start="30499" end="30524">## Create a new SCE object</COMMENT>
        <expr line1="194" col1="5" line2="194" col2="25" start="30657" end="30677">
          <expr line1="194" col1="5" line2="194" col2="6" start="30657" end="30658">
            <SYMBOL line1="194" col1="5" line2="194" col2="6" start="30657" end="30658">pd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="194" col1="8" line2="194" col2="9" start="30660" end="30661">&lt;-</LEFT_ASSIGN>
          <expr line1="194" col1="11" line2="194" col2="25" start="30663" end="30677">
            <expr line1="194" col1="11" line2="194" col2="17" start="30663" end="30669">
              <SYMBOL_FUNCTION_CALL line1="194" col1="11" line2="194" col2="17" start="30663" end="30669">colData</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="194" col1="18" line2="194" col2="18" start="30670" end="30670">(</OP-LEFT-PAREN>
            <expr line1="194" col1="19" line2="194" col2="24" start="30671" end="30676">
              <SYMBOL line1="194" col1="19" line2="194" col2="24" start="30671" end="30676">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="194" col1="25" line2="194" col2="25" start="30677" end="30677">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="195" col1="5" line2="195" col2="62" start="30815" end="30872">
          <expr line1="195" col1="5" line2="195" col2="6" start="30815" end="30816">
            <SYMBOL line1="195" col1="5" line2="195" col2="6" start="30815" end="30816">fd</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="195" col1="8" line2="195" col2="9" start="30818" end="30819">&lt;-</LEFT_ASSIGN>
          <expr line1="195" col1="11" line2="195" col2="62" start="30821" end="30872">
            <expr line1="195" col1="11" line2="195" col2="20" start="30821" end="30830">
              <SYMBOL_FUNCTION_CALL line1="195" col1="11" line2="195" col2="20" start="30821" end="30830">data.frame</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="195" col1="21" line2="195" col2="21" start="30831" end="30831">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="195" col1="22" line2="195" col2="39" start="30832" end="30849">exprs_collapsed_to</SYMBOL_SUB>
            <EQ_SUB line1="195" col1="41" line2="195" col2="41" start="30851" end="30851">=</EQ_SUB>
            <expr line1="195" col1="43" line2="195" col2="61" start="30853" end="30871">
              <expr line1="195" col1="43" line2="195" col2="50" start="30853" end="30860">
                <SYMBOL_FUNCTION_CALL line1="195" col1="43" line2="195" col2="50" start="30853" end="30860">rownames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="195" col1="51" line2="195" col2="51" start="30861" end="30861">(</OP-LEFT-PAREN>
              <expr line1="195" col1="52" line2="195" col2="60" start="30862" end="30870">
                <SYMBOL line1="195" col1="52" line2="195" col2="60" start="30862" end="30870">exprs_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="195" col1="61" line2="195" col2="61" start="30871" end="30871">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="195" col1="62" line2="195" col2="62" start="30872" end="30872">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="196" col1="5" line2="196" col2="39" start="30973" end="31007">
          <expr line1="196" col1="5" line2="196" col2="16" start="30973" end="30984">
            <expr line1="196" col1="5" line2="196" col2="12" start="30973" end="30980">
              <SYMBOL_FUNCTION_CALL line1="196" col1="5" line2="196" col2="12" start="30973" end="30980">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="196" col1="13" line2="196" col2="13" start="30981" end="30981">(</OP-LEFT-PAREN>
            <expr line1="196" col1="14" line2="196" col2="15" start="30982" end="30983">
              <SYMBOL line1="196" col1="14" line2="196" col2="15" start="30982" end="30983">fd</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="196" col1="16" line2="196" col2="16" start="30984" end="30984">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="196" col1="18" line2="196" col2="19" start="30986" end="30987">&lt;-</LEFT_ASSIGN>
          <expr line1="196" col1="21" line2="196" col2="39" start="30989" end="31007">
            <expr line1="196" col1="21" line2="196" col2="28" start="30989" end="30996">
              <SYMBOL_FUNCTION_CALL line1="196" col1="21" line2="196" col2="28" start="30989" end="30996">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="196" col1="29" line2="196" col2="29" start="30997" end="30997">(</OP-LEFT-PAREN>
            <expr line1="196" col1="30" line2="196" col2="38" start="30998" end="31006">
              <SYMBOL line1="196" col1="30" line2="196" col2="38" start="30998" end="31006">exprs_new</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="196" col1="39" line2="196" col2="39" start="31007" end="31007">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="198" col1="5" line2="204" col2="80" start="31289" end="32312">
          <expr line1="198" col1="5" line2="198" col2="11" start="31289" end="31295">
            <SYMBOL line1="198" col1="5" line2="198" col2="11" start="31289" end="31295">sce_out</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="198" col1="13" line2="198" col2="14" start="31297" end="31298">&lt;-</LEFT_ASSIGN>
          <expr line1="198" col1="16" line2="204" col2="80" start="31300" end="32312">
            <expr line1="198" col1="16" line2="198" col2="21" start="31300" end="31305">
              <SYMBOL_FUNCTION_CALL line1="198" col1="16" line2="198" col2="21" start="31300" end="31305">switch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="198" col1="22" line2="198" col2="22" start="31306" end="31306">(</OP-LEFT-PAREN>
            <expr line1="198" col1="23" line2="198" col2="34" start="31307" end="31318">
              <SYMBOL line1="198" col1="23" line2="198" col2="34" start="31307" end="31318">exprs_values</SYMBOL>
            </expr>
            <OP-COMMA line1="198" col1="35" line2="198" col2="35" start="31319" end="31319">,</OP-COMMA>
            <SYMBOL_SUB line1="199" col1="23" line2="199" col2="25" start="31465" end="31467">tpm</SYMBOL_SUB>
            <EQ_SUB line1="199" col1="27" line2="199" col2="27" start="31469" end="31469">=</EQ_SUB>
            <expr line1="199" col1="29" line2="200" col2="76" start="31471" end="31676">
              <expr line1="199" col1="29" line2="199" col2="48" start="31471" end="31490">
                <SYMBOL_FUNCTION_CALL line1="199" col1="29" line2="199" col2="48" start="31471" end="31490">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="199" col1="49" line2="199" col2="49" start="31491" end="31491">(</OP-LEFT-PAREN>
              <expr line1="200" col1="27" line2="200" col2="47" start="31627" end="31647">
                <expr line1="200" col1="27" line2="200" col2="30" start="31627" end="31630">
                  <SYMBOL_FUNCTION_CALL line1="200" col1="27" line2="200" col2="30" start="31627" end="31630">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="200" col1="31" line2="200" col2="31" start="31631" end="31631">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="200" col1="32" line2="200" col2="34" start="31632" end="31634">tpm</SYMBOL_SUB>
                <EQ_SUB line1="200" col1="36" line2="200" col2="36" start="31636" end="31636">=</EQ_SUB>
                <expr line1="200" col1="38" line2="200" col2="46" start="31638" end="31646">
                  <SYMBOL line1="200" col1="38" line2="200" col2="46" start="31638" end="31646">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="200" col1="47" line2="200" col2="47" start="31647" end="31647">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="200" col1="48" line2="200" col2="48" start="31648" end="31648">,</OP-COMMA>
              <SYMBOL_SUB line1="200" col1="50" line2="200" col2="56" start="31650" end="31656">colData</SYMBOL_SUB>
              <EQ_SUB line1="200" col1="58" line2="200" col2="58" start="31658" end="31658">=</EQ_SUB>
              <expr line1="200" col1="60" line2="200" col2="61" start="31660" end="31661">
                <SYMBOL line1="200" col1="60" line2="200" col2="61" start="31660" end="31661">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="200" col1="62" line2="200" col2="62" start="31662" end="31662">,</OP-COMMA>
              <SYMBOL_SUB line1="200" col1="64" line2="200" col2="70" start="31664" end="31670">rowData</SYMBOL_SUB>
              <EQ_SUB line1="200" col1="72" line2="200" col2="72" start="31672" end="31672">=</EQ_SUB>
              <expr line1="200" col1="74" line2="200" col2="75" start="31674" end="31675">
                <SYMBOL line1="200" col1="74" line2="200" col2="75" start="31674" end="31675">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="200" col1="76" line2="200" col2="76" start="31676" end="31676">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="200" col1="77" line2="200" col2="77" start="31677" end="31677">,</OP-COMMA>
            <SYMBOL_SUB line1="201" col1="23" line2="201" col2="26" start="31781" end="31784">fpkm</SYMBOL_SUB>
            <EQ_SUB line1="201" col1="28" line2="201" col2="28" start="31786" end="31786">=</EQ_SUB>
            <expr line1="201" col1="30" line2="202" col2="77" start="31788" end="31993">
              <expr line1="201" col1="30" line2="201" col2="49" start="31788" end="31807">
                <SYMBOL_FUNCTION_CALL line1="201" col1="30" line2="201" col2="49" start="31788" end="31807">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="201" col1="50" line2="201" col2="50" start="31808" end="31808">(</OP-LEFT-PAREN>
              <expr line1="202" col1="27" line2="202" col2="48" start="31943" end="31964">
                <expr line1="202" col1="27" line2="202" col2="30" start="31943" end="31946">
                  <SYMBOL_FUNCTION_CALL line1="202" col1="27" line2="202" col2="30" start="31943" end="31946">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="202" col1="31" line2="202" col2="31" start="31947" end="31947">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="202" col1="32" line2="202" col2="35" start="31948" end="31951">fpkm</SYMBOL_SUB>
                <EQ_SUB line1="202" col1="37" line2="202" col2="37" start="31953" end="31953">=</EQ_SUB>
                <expr line1="202" col1="39" line2="202" col2="47" start="31955" end="31963">
                  <SYMBOL line1="202" col1="39" line2="202" col2="47" start="31955" end="31963">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="202" col1="48" line2="202" col2="48" start="31964" end="31964">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="202" col1="49" line2="202" col2="49" start="31965" end="31965">,</OP-COMMA>
              <SYMBOL_SUB line1="202" col1="51" line2="202" col2="57" start="31967" end="31973">colData</SYMBOL_SUB>
              <EQ_SUB line1="202" col1="59" line2="202" col2="59" start="31975" end="31975">=</EQ_SUB>
              <expr line1="202" col1="61" line2="202" col2="62" start="31977" end="31978">
                <SYMBOL line1="202" col1="61" line2="202" col2="62" start="31977" end="31978">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="202" col1="63" line2="202" col2="63" start="31979" end="31979">,</OP-COMMA>
              <SYMBOL_SUB line1="202" col1="65" line2="202" col2="71" start="31981" end="31987">rowData</SYMBOL_SUB>
              <EQ_SUB line1="202" col1="73" line2="202" col2="73" start="31989" end="31989">=</EQ_SUB>
              <expr line1="202" col1="75" line2="202" col2="76" start="31991" end="31992">
                <SYMBOL line1="202" col1="75" line2="202" col2="76" start="31991" end="31992">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="202" col1="77" line2="202" col2="77" start="31993" end="31993">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="202" col1="78" line2="202" col2="78" start="31994" end="31994">,</OP-COMMA>
            <SYMBOL_SUB line1="203" col1="23" line2="203" col2="28" start="32097" end="32102">counts</SYMBOL_SUB>
            <EQ_SUB line1="203" col1="30" line2="203" col2="30" start="32104" end="32104">=</EQ_SUB>
            <expr line1="203" col1="32" line2="204" col2="79" start="32106" end="32311">
              <expr line1="203" col1="32" line2="203" col2="51" start="32106" end="32125">
                <SYMBOL_FUNCTION_CALL line1="203" col1="32" line2="203" col2="51" start="32106" end="32125">SingleCellExperiment</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="203" col1="52" line2="203" col2="52" start="32126" end="32126">(</OP-LEFT-PAREN>
              <expr line1="204" col1="27" line2="204" col2="50" start="32259" end="32282">
                <expr line1="204" col1="27" line2="204" col2="30" start="32259" end="32262">
                  <SYMBOL_FUNCTION_CALL line1="204" col1="27" line2="204" col2="30" start="32259" end="32262">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="204" col1="31" line2="204" col2="31" start="32263" end="32263">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="204" col1="32" line2="204" col2="37" start="32264" end="32269">counts</SYMBOL_SUB>
                <EQ_SUB line1="204" col1="39" line2="204" col2="39" start="32271" end="32271">=</EQ_SUB>
                <expr line1="204" col1="41" line2="204" col2="49" start="32273" end="32281">
                  <SYMBOL line1="204" col1="41" line2="204" col2="49" start="32273" end="32281">exprs_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="204" col1="50" line2="204" col2="50" start="32282" end="32282">)</OP-RIGHT-PAREN>
              </expr>
              <OP-COMMA line1="204" col1="51" line2="204" col2="51" start="32283" end="32283">,</OP-COMMA>
              <SYMBOL_SUB line1="204" col1="53" line2="204" col2="59" start="32285" end="32291">colData</SYMBOL_SUB>
              <EQ_SUB line1="204" col1="61" line2="204" col2="61" start="32293" end="32293">=</EQ_SUB>
              <expr line1="204" col1="63" line2="204" col2="64" start="32295" end="32296">
                <SYMBOL line1="204" col1="63" line2="204" col2="64" start="32295" end="32296">pd</SYMBOL>
              </expr>
              <OP-COMMA line1="204" col1="65" line2="204" col2="65" start="32297" end="32297">,</OP-COMMA>
              <SYMBOL_SUB line1="204" col1="67" line2="204" col2="73" start="32299" end="32305">rowData</SYMBOL_SUB>
              <EQ_SUB line1="204" col1="75" line2="204" col2="75" start="32307" end="32307">=</EQ_SUB>
              <expr line1="204" col1="77" line2="204" col2="78" start="32309" end="32310">
                <SYMBOL line1="204" col1="77" line2="204" col2="78" start="32309" end="32310">fd</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="204" col1="79" line2="204" col2="79" start="32311" end="32311">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="204" col1="80" line2="204" col2="80" start="32312" end="32312">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="205" col1="5" line2="205" col2="52" start="32395" end="32442">## Summarise other data in the object if present</COMMENT>
        <COMMENT line1="206" col1="5" line2="206" col2="13" start="32553" end="32561">## counts</COMMENT>
        <expr line1="207" col1="5" line2="207" col2="73" start="32711" end="32779">
          <expr line1="207" col1="5" line2="207" col2="14" start="32711" end="32720">
            <SYMBOL line1="207" col1="5" line2="207" col2="14" start="32711" end="32720">tpm_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="207" col1="16" line2="207" col2="17" start="32722" end="32723">&lt;-</LEFT_ASSIGN>
          <expr line1="207" col1="19" line2="207" col2="73" start="32725" end="32779">
            <expr line1="207" col1="19" line2="207" col2="26" start="32725" end="32732">
              <SYMBOL_FUNCTION_CALL line1="207" col1="19" line2="207" col2="26" start="32725" end="32732">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="207" col1="27" line2="207" col2="27" start="32733" end="32733">(</OP-LEFT-PAREN>
            <expr line1="207" col1="28" line2="207" col2="38" start="32734" end="32744">
              <expr line1="207" col1="28" line2="207" col2="30" start="32734" end="32736">
                <SYMBOL_FUNCTION_CALL line1="207" col1="28" line2="207" col2="30" start="32734" end="32736">tpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="207" col1="31" line2="207" col2="31" start="32737" end="32737">(</OP-LEFT-PAREN>
              <expr line1="207" col1="32" line2="207" col2="37" start="32738" end="32743">
                <SYMBOL line1="207" col1="32" line2="207" col2="37" start="32738" end="32743">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="207" col1="38" line2="207" col2="38" start="32744" end="32744">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="207" col1="39" line2="207" col2="39" start="32745" end="32745">,</OP-COMMA>
            <SYMBOL_SUB line1="207" col1="41" line2="207" col2="45" start="32747" end="32751">error</SYMBOL_SUB>
            <EQ_SUB line1="207" col1="47" line2="207" col2="47" start="32753" end="32753">=</EQ_SUB>
            <expr line1="207" col1="49" line2="207" col2="72" start="32755" end="32778">
              <FUNCTION line1="207" col1="49" line2="207" col2="56" start="32755" end="32762">function</FUNCTION>
              <OP-LEFT-PAREN line1="207" col1="57" line2="207" col2="57" start="32763" end="32763">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="207" col1="58" line2="207" col2="58" start="32764" end="32764">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="207" col1="59" line2="207" col2="59" start="32765" end="32765">)</OP-RIGHT-PAREN>
              <expr line1="207" col1="61" line2="207" col2="72" start="32767" end="32778">
                <expr line1="207" col1="61" line2="207" col2="66" start="32767" end="32772">
                  <SYMBOL_FUNCTION_CALL line1="207" col1="61" line2="207" col2="66" start="32767" end="32772">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="207" col1="67" line2="207" col2="67" start="32773" end="32773">(</OP-LEFT-PAREN>
                <expr line1="207" col1="68" line2="207" col2="71" start="32774" end="32777">
                  <NULL_CONST line1="207" col1="68" line2="207" col2="71" start="32774" end="32777">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="207" col1="72" line2="207" col2="72" start="32778" end="32778">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="207" col1="73" line2="207" col2="73" start="32779" end="32779">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="208" col1="5" line2="208" col2="79" start="32869" end="32943">
          <expr line1="208" col1="5" line2="208" col2="17" start="32869" end="32881">
            <SYMBOL line1="208" col1="5" line2="208" col2="17" start="32869" end="32881">counts_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="208" col1="19" line2="208" col2="20" start="32883" end="32884">&lt;-</LEFT_ASSIGN>
          <expr line1="208" col1="22" line2="208" col2="79" start="32886" end="32943">
            <expr line1="208" col1="22" line2="208" col2="29" start="32886" end="32893">
              <SYMBOL_FUNCTION_CALL line1="208" col1="22" line2="208" col2="29" start="32886" end="32893">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="208" col1="30" line2="208" col2="30" start="32894" end="32894">(</OP-LEFT-PAREN>
            <expr line1="208" col1="31" line2="208" col2="44" start="32895" end="32908">
              <expr line1="208" col1="31" line2="208" col2="36" start="32895" end="32900">
                <SYMBOL_FUNCTION_CALL line1="208" col1="31" line2="208" col2="36" start="32895" end="32900">counts</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="208" col1="37" line2="208" col2="37" start="32901" end="32901">(</OP-LEFT-PAREN>
              <expr line1="208" col1="38" line2="208" col2="43" start="32902" end="32907">
                <SYMBOL line1="208" col1="38" line2="208" col2="43" start="32902" end="32907">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="208" col1="44" line2="208" col2="44" start="32908" end="32908">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="208" col1="45" line2="208" col2="45" start="32909" end="32909">,</OP-COMMA>
            <SYMBOL_SUB line1="208" col1="47" line2="208" col2="51" start="32911" end="32915">error</SYMBOL_SUB>
            <EQ_SUB line1="208" col1="53" line2="208" col2="53" start="32917" end="32917">=</EQ_SUB>
            <expr line1="208" col1="55" line2="208" col2="78" start="32919" end="32942">
              <FUNCTION line1="208" col1="55" line2="208" col2="62" start="32919" end="32926">function</FUNCTION>
              <OP-LEFT-PAREN line1="208" col1="63" line2="208" col2="63" start="32927" end="32927">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="208" col1="64" line2="208" col2="64" start="32928" end="32928">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="208" col1="65" line2="208" col2="65" start="32929" end="32929">)</OP-RIGHT-PAREN>
              <expr line1="208" col1="67" line2="208" col2="78" start="32931" end="32942">
                <expr line1="208" col1="67" line2="208" col2="72" start="32931" end="32936">
                  <SYMBOL_FUNCTION_CALL line1="208" col1="67" line2="208" col2="72" start="32931" end="32936">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="208" col1="73" line2="208" col2="73" start="32937" end="32937">(</OP-LEFT-PAREN>
                <expr line1="208" col1="74" line2="208" col2="77" start="32938" end="32941">
                  <NULL_CONST line1="208" col1="74" line2="208" col2="77" start="32938" end="32941">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="208" col1="78" line2="208" col2="78" start="32942" end="32942">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="208" col1="79" line2="208" col2="79" start="32943" end="32943">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="209" col1="5" line2="238" col2="5" start="33027" end="37609">
          <IF line1="209" col1="5" line2="209" col2="6" start="33027" end="33028">if</IF>
          <OP-LEFT-PAREN line1="209" col1="8" line2="209" col2="8" start="33030" end="33030">(</OP-LEFT-PAREN>
          <expr line1="209" col1="10" line2="209" col2="50" start="33032" end="33072">
            <expr line1="209" col1="10" line2="209" col2="29" start="33032" end="33051">
              <OP-EXCLAMATION line1="209" col1="10" line2="209" col2="10" start="33032" end="33032">!</OP-EXCLAMATION>
              <expr line1="209" col1="11" line2="209" col2="29" start="33033" end="33051">
                <expr line1="209" col1="11" line2="209" col2="17" start="33033" end="33039">
                  <SYMBOL_FUNCTION_CALL line1="209" col1="11" line2="209" col2="17" start="33033" end="33039">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="209" col1="18" line2="209" col2="18" start="33040" end="33040">(</OP-LEFT-PAREN>
                <expr line1="209" col1="19" line2="209" col2="28" start="33041" end="33050">
                  <SYMBOL line1="209" col1="19" line2="209" col2="28" start="33041" end="33050">tpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="209" col1="29" line2="209" col2="29" start="33051" end="33051">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <AND2 line1="209" col1="31" line2="209" col2="32" start="33053" end="33054">&amp;&amp;</AND2>
            <expr line1="209" col1="34" line2="209" col2="50" start="33056" end="33072">
              <SYMBOL line1="209" col1="34" line2="209" col2="50" start="33056" end="33072">scaled_tpm_counts</SYMBOL>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="209" col1="52" line2="209" col2="52" start="33074" end="33074">)</OP-RIGHT-PAREN>
          <expr line1="209" col1="54" line2="228" col2="5" start="33076" end="36029">
            <OP-LEFT-BRACE line1="209" col1="54" line2="209" col2="54" start="33076" end="33076">{</OP-LEFT-BRACE>
            <expr line1="210" col1="9" line2="218" col2="9" start="33189" end="34453">
              <IF line1="210" col1="9" line2="210" col2="10" start="33189" end="33190">if</IF>
              <OP-LEFT-PAREN line1="210" col1="12" line2="210" col2="12" start="33192" end="33192">(</OP-LEFT-PAREN>
              <expr line1="210" col1="14" line2="210" col2="30" start="33194" end="33210">
                <expr line1="210" col1="14" line2="210" col2="20" start="33194" end="33200">
                  <SYMBOL_FUNCTION_CALL line1="210" col1="14" line2="210" col2="20" start="33194" end="33200">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="210" col1="21" line2="210" col2="21" start="33201" end="33201">(</OP-LEFT-PAREN>
                <expr line1="210" col1="22" line2="210" col2="29" start="33202" end="33209">
                  <SYMBOL line1="210" col1="22" line2="210" col2="29" start="33202" end="33209">lib_size</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="210" col1="30" line2="210" col2="30" start="33210" end="33210">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="210" col1="32" line2="210" col2="32" start="33212" end="33212">)</OP-RIGHT-PAREN>
              <expr line1="210" col1="34" line2="215" col2="9" start="33214" end="33979">
                <OP-LEFT-BRACE line1="210" col1="34" line2="210" col2="34" start="33214" end="33214">{</OP-LEFT-BRACE>
                <expr line1="211" col1="13" line2="214" col2="60" start="33351" end="33872">
                  <IF line1="211" col1="13" line2="211" col2="14" start="33351" end="33352">if</IF>
                  <OP-LEFT-PAREN line1="211" col1="16" line2="211" col2="16" start="33354" end="33354">(</OP-LEFT-PAREN>
                  <expr line1="211" col1="18" line2="211" col2="39" start="33356" end="33377">
                    <expr line1="211" col1="18" line2="211" col2="24" start="33356" end="33362">
                      <SYMBOL_FUNCTION_CALL line1="211" col1="18" line2="211" col2="24" start="33356" end="33362">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="211" col1="25" line2="211" col2="25" start="33363" end="33363">(</OP-LEFT-PAREN>
                    <expr line1="211" col1="26" line2="211" col2="38" start="33364" end="33376">
                      <SYMBOL line1="211" col1="26" line2="211" col2="38" start="33364" end="33376">counts_object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="211" col1="39" line2="211" col2="39" start="33377" end="33377">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="211" col1="41" line2="211" col2="41" start="33379" end="33379">)</OP-RIGHT-PAREN>
                  <expr line1="212" col1="17" line2="212" col2="100" start="33513" end="33596">
                    <expr line1="212" col1="17" line2="212" col2="20" start="33513" end="33516">
                      <SYMBOL_FUNCTION_CALL line1="212" col1="17" line2="212" col2="20" start="33513" end="33516">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="212" col1="21" line2="212" col2="21" start="33517" end="33517">(</OP-LEFT-PAREN>
                    <expr line1="212" col1="22" line2="212" col2="99" start="33518" end="33595">
                      <STR_CONST line1="212" col1="22" line2="212" col2="99" start="33518" end="33595">"If object does not contain count values, lib_size argument must be provided."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="212" col1="100" line2="212" col2="100" start="33596" end="33596">)</OP-RIGHT-PAREN>
                  </expr>
                  <ELSE line1="213" col1="13" line2="213" col2="16" start="33667" end="33670">else</ELSE>
                  <expr line1="214" col1="17" line2="214" col2="60" start="33829" end="33872">
                    <expr line1="214" col1="17" line2="214" col2="24" start="33829" end="33836">
                      <SYMBOL line1="214" col1="17" line2="214" col2="24" start="33829" end="33836">lib_size</SYMBOL>
                    </expr>
                    <LEFT_ASSIGN line1="214" col1="26" line2="214" col2="27" start="33838" end="33839">&lt;-</LEFT_ASSIGN>
                    <expr line1="214" col1="29" line2="214" col2="60" start="33841" end="33872">
                      <expr line1="214" col1="29" line2="214" col2="44" start="33841" end="33856">
                        <SYMBOL_FUNCTION_CALL line1="214" col1="29" line2="214" col2="44" start="33841" end="33856">.general_colSums</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="214" col1="45" line2="214" col2="45" start="33857" end="33857">(</OP-LEFT-PAREN>
                      <expr line1="214" col1="46" line2="214" col2="59" start="33858" end="33871">
                        <expr line1="214" col1="46" line2="214" col2="51" start="33858" end="33863">
                          <SYMBOL_FUNCTION_CALL line1="214" col1="46" line2="214" col2="51" start="33858" end="33863">counts</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="214" col1="52" line2="214" col2="52" start="33864" end="33864">(</OP-LEFT-PAREN>
                        <expr line1="214" col1="53" line2="214" col2="58" start="33865" end="33870">
                          <SYMBOL line1="214" col1="53" line2="214" col2="58" start="33865" end="33870">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="214" col1="59" line2="214" col2="59" start="33871" end="33871">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="214" col1="60" line2="214" col2="60" start="33872" end="33872">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="215" col1="9" line2="215" col2="9" start="33979" end="33979">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="215" col1="11" line2="215" col2="14" start="33981" end="33984">else</ELSE>
              <expr line1="215" col1="16" line2="218" col2="9" start="33986" end="34453">
                <OP-LEFT-BRACE line1="215" col1="16" line2="215" col2="16" start="33986" end="33986">{</OP-LEFT-BRACE>
                <expr line1="216" col1="13" line2="217" col2="96" start="34141" end="34382">
                  <IF line1="216" col1="13" line2="216" col2="14" start="34141" end="34142">if</IF>
                  <OP-LEFT-PAREN line1="216" col1="16" line2="216" col2="16" start="34144" end="34144">(</OP-LEFT-PAREN>
                  <expr line1="216" col1="18" line2="216" col2="49" start="34146" end="34177">
                    <expr line1="216" col1="18" line2="216" col2="33" start="34146" end="34161">
                      <expr line1="216" col1="18" line2="216" col2="23" start="34146" end="34151">
                        <SYMBOL_FUNCTION_CALL line1="216" col1="18" line2="216" col2="23" start="34146" end="34151">length</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="216" col1="24" line2="216" col2="24" start="34152" end="34152">(</OP-LEFT-PAREN>
                      <expr line1="216" col1="25" line2="216" col2="32" start="34153" end="34160">
                        <SYMBOL line1="216" col1="25" line2="216" col2="32" start="34153" end="34160">lib_size</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="216" col1="33" line2="216" col2="33" start="34161" end="34161">)</OP-RIGHT-PAREN>
                    </expr>
                    <NE line1="216" col1="35" line2="216" col2="36" start="34163" end="34164">!=</NE>
                    <expr line1="216" col1="38" line2="216" col2="49" start="34166" end="34177">
                      <expr line1="216" col1="38" line2="216" col2="41" start="34166" end="34169">
                        <SYMBOL_FUNCTION_CALL line1="216" col1="38" line2="216" col2="41" start="34166" end="34169">ncol</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="216" col1="42" line2="216" col2="42" start="34170" end="34170">(</OP-LEFT-PAREN>
                      <expr line1="216" col1="43" line2="216" col2="48" start="34171" end="34176">
                        <SYMBOL line1="216" col1="43" line2="216" col2="48" start="34171" end="34176">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="216" col1="49" line2="216" col2="49" start="34177" end="34177">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="216" col1="50" line2="216" col2="50" start="34178" end="34178">)</OP-RIGHT-PAREN>
                  <expr line1="217" col1="17" line2="217" col2="96" start="34303" end="34382">
                    <expr line1="217" col1="17" line2="217" col2="20" start="34303" end="34306">
                      <SYMBOL_FUNCTION_CALL line1="217" col1="17" line2="217" col2="20" start="34303" end="34306">stop</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="217" col1="21" line2="217" col2="21" start="34307" end="34307">(</OP-LEFT-PAREN>
                    <expr line1="217" col1="22" line2="217" col2="95" start="34308" end="34381">
                      <STR_CONST line1="217" col1="22" line2="217" col2="95" start="34308" end="34381">"lib_size argument must have length equal to number of columns of object."</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="217" col1="96" line2="217" col2="96" start="34382" end="34382">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="218" col1="9" line2="218" col2="9" start="34453" end="34453">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="219" col1="9" line2="220" col2="44" start="34611" end="34804">
              <expr line1="219" col1="9" line2="219" col2="17" start="34611" end="34619">
                <SYMBOL line1="219" col1="9" line2="219" col2="17" start="34611" end="34619">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="219" col1="19" line2="219" col2="20" start="34621" end="34622">&lt;-</LEFT_ASSIGN>
              <expr line1="219" col1="22" line2="220" col2="44" start="34624" end="34804">
                <expr line1="219" col1="22" line2="219" col2="31" start="34624" end="34633">
                  <SYMBOL_FUNCTION_CALL line1="219" col1="22" line2="219" col2="31" start="34624" end="34633">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="219" col1="32" line2="219" col2="32" start="34634" end="34634">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="219" col1="33" line2="219" col2="39" start="34635" end="34641">feature</SYMBOL_SUB>
                <EQ_SUB line1="219" col1="41" line2="219" col2="41" start="34643" end="34643">=</EQ_SUB>
                <expr line1="219" col1="43" line2="219" col2="73" start="34645" end="34675">
                  <expr line1="219" col1="43" line2="219" col2="57" start="34645" end="34659">
                    <expr line1="219" col1="43" line2="219" col2="49" start="34645" end="34651">
                      <SYMBOL_FUNCTION_CALL line1="219" col1="43" line2="219" col2="49" start="34645" end="34651">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="219" col1="50" line2="219" col2="50" start="34652" end="34652">(</OP-LEFT-PAREN>
                    <expr line1="219" col1="51" line2="219" col2="56" start="34653" end="34658">
                      <SYMBOL line1="219" col1="51" line2="219" col2="56" start="34653" end="34658">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="219" col1="57" line2="219" col2="57" start="34659" end="34659">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="219" col1="58" line2="219" col2="59" start="34660" end="34661">[[</LBB>
                  <expr line1="219" col1="60" line2="219" col2="71" start="34662" end="34673">
                    <SYMBOL line1="219" col1="60" line2="219" col2="71" start="34662" end="34673">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="219" col1="72" line2="219" col2="72" start="34674" end="34674">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="219" col1="73" line2="219" col2="73" start="34675" end="34675">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="219" col1="74" line2="219" col2="74" start="34676" end="34676">,</OP-COMMA>
                <expr line1="220" col1="33" line2="220" col2="43" start="34793" end="34803">
                  <expr line1="220" col1="33" line2="220" col2="35" start="34793" end="34795">
                    <SYMBOL_FUNCTION_CALL line1="220" col1="33" line2="220" col2="35" start="34793" end="34795">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="220" col1="36" line2="220" col2="36" start="34796" end="34796">(</OP-LEFT-PAREN>
                  <expr line1="220" col1="37" line2="220" col2="42" start="34797" end="34802">
                    <SYMBOL line1="220" col1="37" line2="220" col2="42" start="34797" end="34802">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="220" col1="43" line2="220" col2="43" start="34803" end="34803">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="220" col1="44" line2="220" col2="44" start="34804" end="34804">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="221" col1="9" line2="221" col2="51" start="34927" end="34969">
              <expr line1="221" col1="9" line2="221" col2="22" start="34927" end="34940">
                <SYMBOL line1="221" col1="9" line2="221" col2="22" start="34927" end="34940">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="221" col1="24" line2="221" col2="25" start="34942" end="34943">&lt;-</LEFT_ASSIGN>
              <expr line1="221" col1="27" line2="221" col2="51" start="34945" end="34969">
                <expr line1="221" col1="27" line2="221" col2="40" start="34945" end="34958">
                  <SYMBOL_PACKAGE line1="221" col1="27" line2="221" col2="34" start="34945" end="34952">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="221" col1="35" line2="221" col2="36" start="34953" end="34954">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="221" col1="37" line2="221" col2="40" start="34955" end="34958">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="221" col1="41" line2="221" col2="41" start="34959" end="34959">(</OP-LEFT-PAREN>
                <expr line1="221" col1="42" line2="221" col2="50" start="34960" end="34968">
                  <SYMBOL line1="221" col1="42" line2="221" col2="50" start="34960" end="34968">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="221" col1="51" line2="221" col2="51" start="34969" end="34969">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="222" col1="9" line2="222" col2="78" start="35085" end="35154">
              <expr line1="222" col1="9" line2="222" col2="18" start="35085" end="35094">
                <SYMBOL line1="222" col1="9" line2="222" col2="18" start="35085" end="35094">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="222" col1="20" line2="222" col2="21" start="35096" end="35097">&lt;-</LEFT_ASSIGN>
              <expr line1="222" col1="23" line2="222" col2="78" start="35099" end="35154">
                <expr line1="222" col1="23" line2="222" col2="37" start="35099" end="35113">
                  <SYMBOL_PACKAGE line1="222" col1="23" line2="222" col2="30" start="35099" end="35106">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="222" col1="31" line2="222" col2="32" start="35107" end="35108">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="222" col1="33" line2="222" col2="37" start="35109" end="35113">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="222" col1="38" line2="222" col2="38" start="35114" end="35114">(</OP-LEFT-PAREN>
                <expr line1="222" col1="39" line2="222" col2="52" start="35115" end="35128">
                  <SYMBOL line1="222" col1="39" line2="222" col2="52" start="35115" end="35128">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="222" col1="53" line2="222" col2="53" start="35129" end="35129">,</OP-COMMA>
                <expr line1="222" col1="55" line2="222" col2="72" start="35131" end="35148">
                  <expr line1="222" col1="55" line2="222" col2="61" start="35131" end="35137">
                    <SYMBOL line1="222" col1="55" line2="222" col2="61" start="35131" end="35137">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="222" col1="63" line2="222" col2="63" start="35139" end="35139">~</OP-TILDE>
                  <expr line1="222" col1="65" line2="222" col2="72" start="35141" end="35148">
                    <SYMBOL line1="222" col1="65" line2="222" col2="72" start="35141" end="35148">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="222" col1="73" line2="222" col2="73" start="35149" end="35149">,</OP-COMMA>
                <expr line1="222" col1="75" line2="222" col2="77" start="35151" end="35153">
                  <SYMBOL line1="222" col1="75" line2="222" col2="77" start="35151" end="35153">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="222" col1="78" line2="222" col2="78" start="35154" end="35154">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <COMMENT line1="223" col1="9" line2="223" col2="63" start="35243" end="35297">## scale TPM by total library size to get scaled counts</COMMENT>
            <expr line1="224" col1="9" line2="224" col2="57" start="35401" end="35449">
              <expr line1="224" col1="9" line2="224" col2="18" start="35401" end="35410">
                <SYMBOL line1="224" col1="9" line2="224" col2="18" start="35401" end="35410">counts_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="224" col1="20" line2="224" col2="21" start="35412" end="35413">&lt;-</LEFT_ASSIGN>
              <expr line1="224" col1="23" line2="224" col2="57" start="35415" end="35449">
                <expr line1="224" col1="23" line2="224" col2="23" start="35415" end="35415">
                  <SYMBOL_FUNCTION_CALL line1="224" col1="23" line2="224" col2="23" start="35415" end="35415">t</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="224" col1="24" line2="224" col2="24" start="35416" end="35416">(</OP-LEFT-PAREN>
                <expr line1="224" col1="25" line2="224" col2="56" start="35417" end="35448">
                  <expr line1="224" col1="25" line2="224" col2="48" start="35417" end="35440">
                    <expr line1="224" col1="25" line2="224" col2="37" start="35417" end="35429">
                      <expr line1="224" col1="25" line2="224" col2="25" start="35417" end="35417">
                        <SYMBOL_FUNCTION_CALL line1="224" col1="25" line2="224" col2="25" start="35417" end="35417">t</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="224" col1="26" line2="224" col2="26" start="35418" end="35418">(</OP-LEFT-PAREN>
                      <expr line1="224" col1="27" line2="224" col2="36" start="35419" end="35428">
                        <SYMBOL line1="224" col1="27" line2="224" col2="36" start="35419" end="35428">counts_new</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="224" col1="37" line2="224" col2="37" start="35429" end="35429">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-STAR line1="224" col1="39" line2="224" col2="39" start="35431" end="35431">*</OP-STAR>
                    <expr line1="224" col1="41" line2="224" col2="48" start="35433" end="35440">
                      <SYMBOL line1="224" col1="41" line2="224" col2="48" start="35433" end="35440">lib_size</SYMBOL>
                    </expr>
                  </expr>
                  <OP-STAR line1="224" col1="50" line2="224" col2="50" start="35442" end="35442">*</OP-STAR>
                  <expr line1="224" col1="52" line2="224" col2="56" start="35444" end="35448">
                    <NUM_CONST line1="224" col1="52" line2="224" col2="56" start="35444" end="35448">1e-06</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="224" col1="57" line2="224" col2="57" start="35449" end="35449">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="225" col1="9" line2="225" col2="48" start="35559" end="35598">
              <expr line1="225" col1="9" line2="225" col2="28" start="35559" end="35578">
                <expr line1="225" col1="9" line2="225" col2="16" start="35559" end="35566">
                  <SYMBOL_FUNCTION_CALL line1="225" col1="9" line2="225" col2="16" start="35559" end="35566">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="225" col1="17" line2="225" col2="17" start="35567" end="35567">(</OP-LEFT-PAREN>
                <expr line1="225" col1="18" line2="225" col2="27" start="35568" end="35577">
                  <SYMBOL line1="225" col1="18" line2="225" col2="27" start="35568" end="35577">counts_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="225" col1="28" line2="225" col2="28" start="35578" end="35578">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="225" col1="30" line2="225" col2="31" start="35580" end="35581">&lt;-</LEFT_ASSIGN>
              <expr line1="225" col1="33" line2="225" col2="48" start="35583" end="35598">
                <expr line1="225" col1="33" line2="225" col2="40" start="35583" end="35590">
                  <SYMBOL_FUNCTION_CALL line1="225" col1="33" line2="225" col2="40" start="35583" end="35590">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="225" col1="41" line2="225" col2="41" start="35591" end="35591">(</OP-LEFT-PAREN>
                <expr line1="225" col1="42" line2="225" col2="47" start="35592" end="35597">
                  <SYMBOL line1="225" col1="42" line2="225" col2="47" start="35592" end="35597">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="225" col1="48" line2="225" col2="48" start="35598" end="35598">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="226" col1="9" line2="226" col2="37" start="35717" end="35745">
              <expr line1="226" col1="9" line2="226" col2="23" start="35717" end="35731">
                <expr line1="226" col1="9" line2="226" col2="14" start="35717" end="35722">
                  <SYMBOL_FUNCTION_CALL line1="226" col1="9" line2="226" col2="14" start="35717" end="35722">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="226" col1="15" line2="226" col2="15" start="35723" end="35723">(</OP-LEFT-PAREN>
                <expr line1="226" col1="16" line2="226" col2="22" start="35724" end="35730">
                  <SYMBOL line1="226" col1="16" line2="226" col2="22" start="35724" end="35730">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="226" col1="23" line2="226" col2="23" start="35731" end="35731">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="226" col1="25" line2="226" col2="26" start="35733" end="35734">&lt;-</LEFT_ASSIGN>
              <expr line1="226" col1="28" line2="226" col2="37" start="35736" end="35745">
                <SYMBOL line1="226" col1="28" line2="226" col2="37" start="35736" end="35745">counts_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="227" col1="9" line2="227" col2="22" start="35875" end="35888">
              <expr line1="227" col1="9" line2="227" col2="10" start="35875" end="35876">
                <SYMBOL_FUNCTION_CALL line1="227" col1="9" line2="227" col2="10" start="35875" end="35876">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="227" col1="11" line2="227" col2="11" start="35877" end="35877">(</OP-LEFT-PAREN>
              <expr line1="227" col1="12" line2="227" col2="21" start="35878" end="35887">
                <SYMBOL line1="227" col1="12" line2="227" col2="21" start="35878" end="35887">counts_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="227" col1="22" line2="227" col2="22" start="35888" end="35888">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="228" col1="5" line2="228" col2="5" start="36029" end="36029">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="228" col1="7" line2="228" col2="10" start="36031" end="36034">else</ELSE>
          <expr line1="228" col1="12" line2="238" col2="5" start="36036" end="37609">
            <OP-LEFT-BRACE line1="228" col1="12" line2="228" col2="12" start="36036" end="36036">{</OP-LEFT-BRACE>
            <expr line1="229" col1="9" line2="237" col2="9" start="36191" end="37455">
              <IF line1="229" col1="9" line2="229" col2="10" start="36191" end="36192">if</IF>
              <OP-LEFT-PAREN line1="229" col1="12" line2="229" col2="12" start="36194" end="36194">(</OP-LEFT-PAREN>
              <expr line1="229" col1="14" line2="229" col2="64" start="36196" end="36246">
                <expr line1="229" col1="14" line2="229" col2="37" start="36196" end="36219">
                  <expr line1="229" col1="14" line2="229" col2="25" start="36196" end="36207">
                    <SYMBOL line1="229" col1="14" line2="229" col2="25" start="36196" end="36207">exprs_values</SYMBOL>
                  </expr>
                  <NE line1="229" col1="27" line2="229" col2="28" start="36209" end="36210">!=</NE>
                  <expr line1="229" col1="30" line2="229" col2="37" start="36212" end="36219">
                    <STR_CONST line1="229" col1="30" line2="229" col2="37" start="36212" end="36219">"counts"</STR_CONST>
                  </expr>
                </expr>
                <AND2 line1="229" col1="39" line2="229" col2="40" start="36221" end="36222">&amp;&amp;</AND2>
                <expr line1="229" col1="42" line2="229" col2="64" start="36224" end="36246">
                  <OP-EXCLAMATION line1="229" col1="42" line2="229" col2="42" start="36224" end="36224">!</OP-EXCLAMATION>
                  <expr line1="229" col1="43" line2="229" col2="64" start="36225" end="36246">
                    <expr line1="229" col1="43" line2="229" col2="49" start="36225" end="36231">
                      <SYMBOL_FUNCTION_CALL line1="229" col1="43" line2="229" col2="49" start="36225" end="36231">is.null</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="229" col1="50" line2="229" col2="50" start="36232" end="36232">(</OP-LEFT-PAREN>
                    <expr line1="229" col1="51" line2="229" col2="63" start="36233" end="36245">
                      <SYMBOL line1="229" col1="51" line2="229" col2="63" start="36233" end="36245">counts_object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="229" col1="64" line2="229" col2="64" start="36246" end="36246">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="229" col1="66" line2="229" col2="66" start="36248" end="36248">)</OP-RIGHT-PAREN>
              <expr line1="229" col1="68" line2="237" col2="9" start="36250" end="37455">
                <OP-LEFT-BRACE line1="229" col1="68" line2="229" col2="68" start="36250" end="36250">{</OP-LEFT-BRACE>
                <expr line1="230" col1="13" line2="231" col2="51" start="36353" end="36549">
                  <expr line1="230" col1="13" line2="230" col2="21" start="36353" end="36361">
                    <SYMBOL line1="230" col1="13" line2="230" col2="21" start="36353" end="36361">tmp_exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="230" col1="23" line2="230" col2="24" start="36363" end="36364">&lt;-</LEFT_ASSIGN>
                  <expr line1="230" col1="26" line2="231" col2="51" start="36366" end="36549">
                    <expr line1="230" col1="26" line2="230" col2="35" start="36366" end="36375">
                      <SYMBOL_FUNCTION_CALL line1="230" col1="26" line2="230" col2="35" start="36366" end="36375">data.frame</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="230" col1="36" line2="230" col2="36" start="36376" end="36376">(</OP-LEFT-PAREN>
                    <SYMBOL_SUB line1="230" col1="37" line2="230" col2="43" start="36377" end="36383">feature</SYMBOL_SUB>
                    <EQ_SUB line1="230" col1="45" line2="230" col2="45" start="36385" end="36385">=</EQ_SUB>
                    <expr line1="230" col1="47" line2="230" col2="77" start="36387" end="36417">
                      <expr line1="230" col1="47" line2="230" col2="61" start="36387" end="36401">
                        <expr line1="230" col1="47" line2="230" col2="53" start="36387" end="36393">
                          <SYMBOL_FUNCTION_CALL line1="230" col1="47" line2="230" col2="53" start="36387" end="36393">rowData</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="230" col1="54" line2="230" col2="54" start="36394" end="36394">(</OP-LEFT-PAREN>
                        <expr line1="230" col1="55" line2="230" col2="60" start="36395" end="36400">
                          <SYMBOL line1="230" col1="55" line2="230" col2="60" start="36395" end="36400">object</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="230" col1="61" line2="230" col2="61" start="36401" end="36401">)</OP-RIGHT-PAREN>
                      </expr>
                      <LBB line1="230" col1="62" line2="230" col2="63" start="36402" end="36403">[[</LBB>
                      <expr line1="230" col1="64" line2="230" col2="75" start="36404" end="36415">
                        <SYMBOL line1="230" col1="64" line2="230" col2="75" start="36404" end="36415">summarise_by</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="230" col1="76" line2="230" col2="76" start="36416" end="36416">]</OP-RIGHT-BRACKET>
                      <OP-RIGHT-BRACKET line1="230" col1="77" line2="230" col2="77" start="36417" end="36417">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="230" col1="78" line2="230" col2="78" start="36418" end="36418">,</OP-COMMA>
                    <expr line1="231" col1="37" line2="231" col2="50" start="36535" end="36548">
                      <expr line1="231" col1="37" line2="231" col2="42" start="36535" end="36540">
                        <SYMBOL_FUNCTION_CALL line1="231" col1="37" line2="231" col2="42" start="36535" end="36540">counts</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="231" col1="43" line2="231" col2="43" start="36541" end="36541">(</OP-LEFT-PAREN>
                      <expr line1="231" col1="44" line2="231" col2="49" start="36542" end="36547">
                        <SYMBOL line1="231" col1="44" line2="231" col2="49" start="36542" end="36547">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="231" col1="50" line2="231" col2="50" start="36548" end="36548">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="231" col1="51" line2="231" col2="51" start="36549" end="36549">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="232" col1="13" line2="232" col2="55" start="36669" end="36711">
                  <expr line1="232" col1="13" line2="232" col2="26" start="36669" end="36682">
                    <SYMBOL line1="232" col1="13" line2="232" col2="26" start="36669" end="36682">tmp_exprs_long</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="232" col1="28" line2="232" col2="29" start="36684" end="36685">&lt;-</LEFT_ASSIGN>
                  <expr line1="232" col1="31" line2="232" col2="55" start="36687" end="36711">
                    <expr line1="232" col1="31" line2="232" col2="44" start="36687" end="36700">
                      <SYMBOL_PACKAGE line1="232" col1="31" line2="232" col2="38" start="36687" end="36694">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="232" col1="39" line2="232" col2="40" start="36695" end="36696">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="232" col1="41" line2="232" col2="44" start="36697" end="36700">melt</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="232" col1="45" line2="232" col2="45" start="36701" end="36701">(</OP-LEFT-PAREN>
                    <expr line1="232" col1="46" line2="232" col2="54" start="36702" end="36710">
                      <SYMBOL line1="232" col1="46" line2="232" col2="54" start="36702" end="36710">tmp_exprs</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="232" col1="55" line2="232" col2="55" start="36711" end="36711">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="233" col1="13" line2="233" col2="82" start="36827" end="36896">
                  <expr line1="233" col1="13" line2="233" col2="22" start="36827" end="36836">
                    <SYMBOL line1="233" col1="13" line2="233" col2="22" start="36827" end="36836">counts_new</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="233" col1="24" line2="233" col2="25" start="36838" end="36839">&lt;-</LEFT_ASSIGN>
                  <expr line1="233" col1="27" line2="233" col2="82" start="36841" end="36896">
                    <expr line1="233" col1="27" line2="233" col2="41" start="36841" end="36855">
                      <SYMBOL_PACKAGE line1="233" col1="27" line2="233" col2="34" start="36841" end="36848">reshape2</SYMBOL_PACKAGE>
                      <NS_GET line1="233" col1="35" line2="233" col2="36" start="36849" end="36850">::</NS_GET>
                      <SYMBOL_FUNCTION_CALL line1="233" col1="37" line2="233" col2="41" start="36851" end="36855">acast</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="233" col1="42" line2="233" col2="42" start="36856" end="36856">(</OP-LEFT-PAREN>
                    <expr line1="233" col1="43" line2="233" col2="56" start="36857" end="36870">
                      <SYMBOL line1="233" col1="43" line2="233" col2="56" start="36857" end="36870">tmp_exprs_long</SYMBOL>
                    </expr>
                    <OP-COMMA line1="233" col1="57" line2="233" col2="57" start="36871" end="36871">,</OP-COMMA>
                    <expr line1="233" col1="59" line2="233" col2="76" start="36873" end="36890">
                      <expr line1="233" col1="59" line2="233" col2="65" start="36873" end="36879">
                        <SYMBOL line1="233" col1="59" line2="233" col2="65" start="36873" end="36879">feature</SYMBOL>
                      </expr>
                      <OP-TILDE line1="233" col1="67" line2="233" col2="67" start="36881" end="36881">~</OP-TILDE>
                      <expr line1="233" col1="69" line2="233" col2="76" start="36883" end="36890">
                        <SYMBOL line1="233" col1="69" line2="233" col2="76" start="36883" end="36890">variable</SYMBOL>
                      </expr>
                    </expr>
                    <OP-COMMA line1="233" col1="77" line2="233" col2="77" start="36891" end="36891">,</OP-COMMA>
                    <expr line1="233" col1="79" line2="233" col2="81" start="36893" end="36895">
                      <SYMBOL line1="233" col1="79" line2="233" col2="81" start="36893" end="36895">sum</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="233" col1="82" line2="233" col2="82" start="36896" end="36896">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="234" col1="13" line2="234" col2="52" start="36985" end="37024">
                  <expr line1="234" col1="13" line2="234" col2="32" start="36985" end="37004">
                    <expr line1="234" col1="13" line2="234" col2="20" start="36985" end="36992">
                      <SYMBOL_FUNCTION_CALL line1="234" col1="13" line2="234" col2="20" start="36985" end="36992">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="234" col1="21" line2="234" col2="21" start="36993" end="36993">(</OP-LEFT-PAREN>
                    <expr line1="234" col1="22" line2="234" col2="31" start="36994" end="37003">
                      <SYMBOL line1="234" col1="22" line2="234" col2="31" start="36994" end="37003">counts_new</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="234" col1="32" line2="234" col2="32" start="37004" end="37004">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="234" col1="34" line2="234" col2="35" start="37006" end="37007">&lt;-</LEFT_ASSIGN>
                  <expr line1="234" col1="37" line2="234" col2="52" start="37009" end="37024">
                    <expr line1="234" col1="37" line2="234" col2="44" start="37009" end="37016">
                      <SYMBOL_FUNCTION_CALL line1="234" col1="37" line2="234" col2="44" start="37009" end="37016">colnames</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="234" col1="45" line2="234" col2="45" start="37017" end="37017">(</OP-LEFT-PAREN>
                    <expr line1="234" col1="46" line2="234" col2="51" start="37018" end="37023">
                      <SYMBOL line1="234" col1="46" line2="234" col2="51" start="37018" end="37023">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="234" col1="52" line2="234" col2="52" start="37024" end="37024">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="235" col1="13" line2="235" col2="41" start="37143" end="37171">
                  <expr line1="235" col1="13" line2="235" col2="27" start="37143" end="37157">
                    <expr line1="235" col1="13" line2="235" col2="18" start="37143" end="37148">
                      <SYMBOL_FUNCTION_CALL line1="235" col1="13" line2="235" col2="18" start="37143" end="37148">counts</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="235" col1="19" line2="235" col2="19" start="37149" end="37149">(</OP-LEFT-PAREN>
                    <expr line1="235" col1="20" line2="235" col2="26" start="37150" end="37156">
                      <SYMBOL line1="235" col1="20" line2="235" col2="26" start="37150" end="37156">sce_out</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="235" col1="27" line2="235" col2="27" start="37157" end="37157">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="235" col1="29" line2="235" col2="30" start="37159" end="37160">&lt;-</LEFT_ASSIGN>
                  <expr line1="235" col1="32" line2="235" col2="41" start="37162" end="37171">
                    <SYMBOL line1="235" col1="32" line2="235" col2="41" start="37162" end="37171">counts_new</SYMBOL>
                  </expr>
                </expr>
                <expr line1="236" col1="13" line2="236" col2="26" start="37301" end="37314">
                  <expr line1="236" col1="13" line2="236" col2="14" start="37301" end="37302">
                    <SYMBOL_FUNCTION_CALL line1="236" col1="13" line2="236" col2="14" start="37301" end="37302">rm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="236" col1="15" line2="236" col2="15" start="37303" end="37303">(</OP-LEFT-PAREN>
                  <expr line1="236" col1="16" line2="236" col2="25" start="37304" end="37313">
                    <SYMBOL line1="236" col1="16" line2="236" col2="25" start="37304" end="37313">counts_new</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="236" col1="26" line2="236" col2="26" start="37314" end="37314">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="237" col1="9" line2="237" col2="9" start="37455" end="37455">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="238" col1="5" line2="238" col2="5" start="37609" end="37609">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="239" col1="5" line2="247" col2="5" start="37767" end="39031">
          <IF line1="239" col1="5" line2="239" col2="6" start="37767" end="37768">if</IF>
          <OP-LEFT-PAREN line1="239" col1="8" line2="239" col2="8" start="37770" end="37770">(</OP-LEFT-PAREN>
          <expr line1="239" col1="10" line2="239" col2="54" start="37772" end="37816">
            <expr line1="239" col1="10" line2="239" col2="30" start="37772" end="37792">
              <expr line1="239" col1="10" line2="239" col2="21" start="37772" end="37783">
                <SYMBOL line1="239" col1="10" line2="239" col2="21" start="37772" end="37783">exprs_values</SYMBOL>
              </expr>
              <NE line1="239" col1="23" line2="239" col2="24" start="37785" end="37786">!=</NE>
              <expr line1="239" col1="26" line2="239" col2="30" start="37788" end="37792">
                <STR_CONST line1="239" col1="26" line2="239" col2="30" start="37788" end="37792">"tpm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="239" col1="32" line2="239" col2="33" start="37794" end="37795">&amp;&amp;</AND2>
            <expr line1="239" col1="35" line2="239" col2="54" start="37797" end="37816">
              <OP-EXCLAMATION line1="239" col1="35" line2="239" col2="35" start="37797" end="37797">!</OP-EXCLAMATION>
              <expr line1="239" col1="36" line2="239" col2="54" start="37798" end="37816">
                <expr line1="239" col1="36" line2="239" col2="42" start="37798" end="37804">
                  <SYMBOL_FUNCTION_CALL line1="239" col1="36" line2="239" col2="42" start="37798" end="37804">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="239" col1="43" line2="239" col2="43" start="37805" end="37805">(</OP-LEFT-PAREN>
                <expr line1="239" col1="44" line2="239" col2="53" start="37806" end="37815">
                  <SYMBOL line1="239" col1="44" line2="239" col2="53" start="37806" end="37815">tpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="239" col1="54" line2="239" col2="54" start="37816" end="37816">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="239" col1="56" line2="239" col2="56" start="37818" end="37818">)</OP-RIGHT-PAREN>
          <expr line1="239" col1="58" line2="247" col2="5" start="37820" end="39031">
            <OP-LEFT-BRACE line1="239" col1="58" line2="239" col2="58" start="37820" end="37820">{</OP-LEFT-BRACE>
            <expr line1="240" col1="9" line2="241" col2="44" start="37929" end="38122">
              <expr line1="240" col1="9" line2="240" col2="17" start="37929" end="37937">
                <SYMBOL line1="240" col1="9" line2="240" col2="17" start="37929" end="37937">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="240" col1="19" line2="240" col2="20" start="37939" end="37940">&lt;-</LEFT_ASSIGN>
              <expr line1="240" col1="22" line2="241" col2="44" start="37942" end="38122">
                <expr line1="240" col1="22" line2="240" col2="31" start="37942" end="37951">
                  <SYMBOL_FUNCTION_CALL line1="240" col1="22" line2="240" col2="31" start="37942" end="37951">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="240" col1="32" line2="240" col2="32" start="37952" end="37952">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="240" col1="33" line2="240" col2="39" start="37953" end="37959">feature</SYMBOL_SUB>
                <EQ_SUB line1="240" col1="41" line2="240" col2="41" start="37961" end="37961">=</EQ_SUB>
                <expr line1="240" col1="43" line2="240" col2="73" start="37963" end="37993">
                  <expr line1="240" col1="43" line2="240" col2="57" start="37963" end="37977">
                    <expr line1="240" col1="43" line2="240" col2="49" start="37963" end="37969">
                      <SYMBOL_FUNCTION_CALL line1="240" col1="43" line2="240" col2="49" start="37963" end="37969">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="240" col1="50" line2="240" col2="50" start="37970" end="37970">(</OP-LEFT-PAREN>
                    <expr line1="240" col1="51" line2="240" col2="56" start="37971" end="37976">
                      <SYMBOL line1="240" col1="51" line2="240" col2="56" start="37971" end="37976">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="240" col1="57" line2="240" col2="57" start="37977" end="37977">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="240" col1="58" line2="240" col2="59" start="37978" end="37979">[[</LBB>
                  <expr line1="240" col1="60" line2="240" col2="71" start="37980" end="37991">
                    <SYMBOL line1="240" col1="60" line2="240" col2="71" start="37980" end="37991">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="240" col1="72" line2="240" col2="72" start="37992" end="37992">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="240" col1="73" line2="240" col2="73" start="37993" end="37993">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="240" col1="74" line2="240" col2="74" start="37994" end="37994">,</OP-COMMA>
                <expr line1="241" col1="33" line2="241" col2="43" start="38111" end="38121">
                  <expr line1="241" col1="33" line2="241" col2="35" start="38111" end="38113">
                    <SYMBOL_FUNCTION_CALL line1="241" col1="33" line2="241" col2="35" start="38111" end="38113">tpm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="241" col1="36" line2="241" col2="36" start="38114" end="38114">(</OP-LEFT-PAREN>
                  <expr line1="241" col1="37" line2="241" col2="42" start="38115" end="38120">
                    <SYMBOL line1="241" col1="37" line2="241" col2="42" start="38115" end="38120">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="241" col1="43" line2="241" col2="43" start="38121" end="38121">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="241" col1="44" line2="241" col2="44" start="38122" end="38122">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="242" col1="9" line2="242" col2="51" start="38245" end="38287">
              <expr line1="242" col1="9" line2="242" col2="22" start="38245" end="38258">
                <SYMBOL line1="242" col1="9" line2="242" col2="22" start="38245" end="38258">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="242" col1="24" line2="242" col2="25" start="38260" end="38261">&lt;-</LEFT_ASSIGN>
              <expr line1="242" col1="27" line2="242" col2="51" start="38263" end="38287">
                <expr line1="242" col1="27" line2="242" col2="40" start="38263" end="38276">
                  <SYMBOL_PACKAGE line1="242" col1="27" line2="242" col2="34" start="38263" end="38270">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="242" col1="35" line2="242" col2="36" start="38271" end="38272">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="242" col1="37" line2="242" col2="40" start="38273" end="38276">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="242" col1="41" line2="242" col2="41" start="38277" end="38277">(</OP-LEFT-PAREN>
                <expr line1="242" col1="42" line2="242" col2="50" start="38278" end="38286">
                  <SYMBOL line1="242" col1="42" line2="242" col2="50" start="38278" end="38286">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="242" col1="51" line2="242" col2="51" start="38287" end="38287">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="243" col1="9" line2="243" col2="75" start="38403" end="38469">
              <expr line1="243" col1="9" line2="243" col2="15" start="38403" end="38409">
                <SYMBOL line1="243" col1="9" line2="243" col2="15" start="38403" end="38409">tpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="243" col1="17" line2="243" col2="18" start="38411" end="38412">&lt;-</LEFT_ASSIGN>
              <expr line1="243" col1="20" line2="243" col2="75" start="38414" end="38469">
                <expr line1="243" col1="20" line2="243" col2="34" start="38414" end="38428">
                  <SYMBOL_PACKAGE line1="243" col1="20" line2="243" col2="27" start="38414" end="38421">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="243" col1="28" line2="243" col2="29" start="38422" end="38423">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="243" col1="30" line2="243" col2="34" start="38424" end="38428">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="243" col1="35" line2="243" col2="35" start="38429" end="38429">(</OP-LEFT-PAREN>
                <expr line1="243" col1="36" line2="243" col2="49" start="38430" end="38443">
                  <SYMBOL line1="243" col1="36" line2="243" col2="49" start="38430" end="38443">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="243" col1="50" line2="243" col2="50" start="38444" end="38444">,</OP-COMMA>
                <expr line1="243" col1="52" line2="243" col2="69" start="38446" end="38463">
                  <expr line1="243" col1="52" line2="243" col2="58" start="38446" end="38452">
                    <SYMBOL line1="243" col1="52" line2="243" col2="58" start="38446" end="38452">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="243" col1="60" line2="243" col2="60" start="38454" end="38454">~</OP-TILDE>
                  <expr line1="243" col1="62" line2="243" col2="69" start="38456" end="38463">
                    <SYMBOL line1="243" col1="62" line2="243" col2="69" start="38456" end="38463">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="243" col1="70" line2="243" col2="70" start="38464" end="38464">,</OP-COMMA>
                <expr line1="243" col1="72" line2="243" col2="74" start="38466" end="38468">
                  <SYMBOL line1="243" col1="72" line2="243" col2="74" start="38466" end="38468">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="243" col1="75" line2="243" col2="75" start="38469" end="38469">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="244" col1="9" line2="244" col2="45" start="38561" end="38597">
              <expr line1="244" col1="9" line2="244" col2="25" start="38561" end="38577">
                <expr line1="244" col1="9" line2="244" col2="16" start="38561" end="38568">
                  <SYMBOL_FUNCTION_CALL line1="244" col1="9" line2="244" col2="16" start="38561" end="38568">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="244" col1="17" line2="244" col2="17" start="38569" end="38569">(</OP-LEFT-PAREN>
                <expr line1="244" col1="18" line2="244" col2="24" start="38570" end="38576">
                  <SYMBOL line1="244" col1="18" line2="244" col2="24" start="38570" end="38576">tpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="244" col1="25" line2="244" col2="25" start="38577" end="38577">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="244" col1="27" line2="244" col2="28" start="38579" end="38580">&lt;-</LEFT_ASSIGN>
              <expr line1="244" col1="30" line2="244" col2="45" start="38582" end="38597">
                <expr line1="244" col1="30" line2="244" col2="37" start="38582" end="38589">
                  <SYMBOL_FUNCTION_CALL line1="244" col1="30" line2="244" col2="37" start="38582" end="38589">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="244" col1="38" line2="244" col2="38" start="38590" end="38590">(</OP-LEFT-PAREN>
                <expr line1="244" col1="39" line2="244" col2="44" start="38591" end="38596">
                  <SYMBOL line1="244" col1="39" line2="244" col2="44" start="38591" end="38596">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="244" col1="45" line2="244" col2="45" start="38597" end="38597">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="245" col1="9" line2="245" col2="31" start="38719" end="38741">
              <expr line1="245" col1="9" line2="245" col2="20" start="38719" end="38730">
                <expr line1="245" col1="9" line2="245" col2="11" start="38719" end="38721">
                  <SYMBOL_FUNCTION_CALL line1="245" col1="9" line2="245" col2="11" start="38719" end="38721">tpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="245" col1="12" line2="245" col2="12" start="38722" end="38722">(</OP-LEFT-PAREN>
                <expr line1="245" col1="13" line2="245" col2="19" start="38723" end="38729">
                  <SYMBOL line1="245" col1="13" line2="245" col2="19" start="38723" end="38729">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="245" col1="20" line2="245" col2="20" start="38730" end="38730">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="245" col1="22" line2="245" col2="23" start="38732" end="38733">&lt;-</LEFT_ASSIGN>
              <expr line1="245" col1="25" line2="245" col2="31" start="38735" end="38741">
                <SYMBOL line1="245" col1="25" line2="245" col2="31" start="38735" end="38741">tpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="246" col1="9" line2="246" col2="19" start="38877" end="38887">
              <expr line1="246" col1="9" line2="246" col2="10" start="38877" end="38878">
                <SYMBOL_FUNCTION_CALL line1="246" col1="9" line2="246" col2="10" start="38877" end="38878">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="246" col1="11" line2="246" col2="11" start="38879" end="38879">(</OP-LEFT-PAREN>
              <expr line1="246" col1="12" line2="246" col2="18" start="38880" end="38886">
                <SYMBOL line1="246" col1="12" line2="246" col2="18" start="38880" end="38886">tpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="246" col1="19" line2="246" col2="19" start="38887" end="38887">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="247" col1="5" line2="247" col2="5" start="39031" end="39031">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="248" col1="5" line2="256" col2="5" start="39189" end="40453">
          <IF line1="248" col1="5" line2="248" col2="6" start="39189" end="39190">if</IF>
          <OP-LEFT-PAREN line1="248" col1="8" line2="248" col2="8" start="39192" end="39192">(</OP-LEFT-PAREN>
          <expr line1="248" col1="10" line2="248" col2="57" start="39194" end="39241">
            <expr line1="248" col1="10" line2="248" col2="31" start="39194" end="39215">
              <expr line1="248" col1="10" line2="248" col2="21" start="39194" end="39205">
                <SYMBOL line1="248" col1="10" line2="248" col2="21" start="39194" end="39205">exprs_values</SYMBOL>
              </expr>
              <NE line1="248" col1="23" line2="248" col2="24" start="39207" end="39208">!=</NE>
              <expr line1="248" col1="26" line2="248" col2="31" start="39210" end="39215">
                <STR_CONST line1="248" col1="26" line2="248" col2="31" start="39210" end="39215">"fpkm"</STR_CONST>
              </expr>
            </expr>
            <AND2 line1="248" col1="33" line2="248" col2="34" start="39217" end="39218">&amp;&amp;</AND2>
            <expr line1="248" col1="36" line2="248" col2="57" start="39220" end="39241">
              <OP-EXCLAMATION line1="248" col1="36" line2="248" col2="36" start="39220" end="39220">!</OP-EXCLAMATION>
              <expr line1="248" col1="37" line2="248" col2="57" start="39221" end="39241">
                <expr line1="248" col1="37" line2="248" col2="43" start="39221" end="39227">
                  <SYMBOL_FUNCTION_CALL line1="248" col1="37" line2="248" col2="43" start="39221" end="39227">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="248" col1="44" line2="248" col2="44" start="39228" end="39228">(</OP-LEFT-PAREN>
                <expr line1="248" col1="45" line2="248" col2="56" start="39229" end="39240">
                  <expr line1="248" col1="45" line2="248" col2="48" start="39229" end="39232">
                    <SYMBOL_FUNCTION_CALL line1="248" col1="45" line2="248" col2="48" start="39229" end="39232">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="248" col1="49" line2="248" col2="49" start="39233" end="39233">(</OP-LEFT-PAREN>
                  <expr line1="248" col1="50" line2="248" col2="55" start="39234" end="39239">
                    <SYMBOL line1="248" col1="50" line2="248" col2="55" start="39234" end="39239">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="248" col1="56" line2="248" col2="56" start="39240" end="39240">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="248" col1="57" line2="248" col2="57" start="39241" end="39241">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="248" col1="59" line2="248" col2="59" start="39243" end="39243">)</OP-RIGHT-PAREN>
          <expr line1="248" col1="61" line2="256" col2="5" start="39245" end="40453">
            <OP-LEFT-BRACE line1="248" col1="61" line2="248" col2="61" start="39245" end="39245">{</OP-LEFT-BRACE>
            <expr line1="249" col1="9" line2="250" col2="45" start="39351" end="39545">
              <expr line1="249" col1="9" line2="249" col2="17" start="39351" end="39359">
                <SYMBOL line1="249" col1="9" line2="249" col2="17" start="39351" end="39359">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="249" col1="19" line2="249" col2="20" start="39361" end="39362">&lt;-</LEFT_ASSIGN>
              <expr line1="249" col1="22" line2="250" col2="45" start="39364" end="39545">
                <expr line1="249" col1="22" line2="249" col2="31" start="39364" end="39373">
                  <SYMBOL_FUNCTION_CALL line1="249" col1="22" line2="249" col2="31" start="39364" end="39373">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="249" col1="32" line2="249" col2="32" start="39374" end="39374">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="249" col1="33" line2="249" col2="39" start="39375" end="39381">feature</SYMBOL_SUB>
                <EQ_SUB line1="249" col1="41" line2="249" col2="41" start="39383" end="39383">=</EQ_SUB>
                <expr line1="249" col1="43" line2="249" col2="73" start="39385" end="39415">
                  <expr line1="249" col1="43" line2="249" col2="57" start="39385" end="39399">
                    <expr line1="249" col1="43" line2="249" col2="49" start="39385" end="39391">
                      <SYMBOL_FUNCTION_CALL line1="249" col1="43" line2="249" col2="49" start="39385" end="39391">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="249" col1="50" line2="249" col2="50" start="39392" end="39392">(</OP-LEFT-PAREN>
                    <expr line1="249" col1="51" line2="249" col2="56" start="39393" end="39398">
                      <SYMBOL line1="249" col1="51" line2="249" col2="56" start="39393" end="39398">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="249" col1="57" line2="249" col2="57" start="39399" end="39399">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="249" col1="58" line2="249" col2="59" start="39400" end="39401">[[</LBB>
                  <expr line1="249" col1="60" line2="249" col2="71" start="39402" end="39413">
                    <SYMBOL line1="249" col1="60" line2="249" col2="71" start="39402" end="39413">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="249" col1="72" line2="249" col2="72" start="39414" end="39414">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="249" col1="73" line2="249" col2="73" start="39415" end="39415">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="249" col1="74" line2="249" col2="74" start="39416" end="39416">,</OP-COMMA>
                <expr line1="250" col1="33" line2="250" col2="44" start="39533" end="39544">
                  <expr line1="250" col1="33" line2="250" col2="36" start="39533" end="39536">
                    <SYMBOL_FUNCTION_CALL line1="250" col1="33" line2="250" col2="36" start="39533" end="39536">fpkm</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="250" col1="37" line2="250" col2="37" start="39537" end="39537">(</OP-LEFT-PAREN>
                  <expr line1="250" col1="38" line2="250" col2="43" start="39538" end="39543">
                    <SYMBOL line1="250" col1="38" line2="250" col2="43" start="39538" end="39543">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="250" col1="44" line2="250" col2="44" start="39544" end="39544">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="250" col1="45" line2="250" col2="45" start="39545" end="39545">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="251" col1="9" line2="251" col2="51" start="39667" end="39709">
              <expr line1="251" col1="9" line2="251" col2="22" start="39667" end="39680">
                <SYMBOL line1="251" col1="9" line2="251" col2="22" start="39667" end="39680">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="251" col1="24" line2="251" col2="25" start="39682" end="39683">&lt;-</LEFT_ASSIGN>
              <expr line1="251" col1="27" line2="251" col2="51" start="39685" end="39709">
                <expr line1="251" col1="27" line2="251" col2="40" start="39685" end="39698">
                  <SYMBOL_PACKAGE line1="251" col1="27" line2="251" col2="34" start="39685" end="39692">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="251" col1="35" line2="251" col2="36" start="39693" end="39694">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="251" col1="37" line2="251" col2="40" start="39695" end="39698">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="251" col1="41" line2="251" col2="41" start="39699" end="39699">(</OP-LEFT-PAREN>
                <expr line1="251" col1="42" line2="251" col2="50" start="39700" end="39708">
                  <SYMBOL line1="251" col1="42" line2="251" col2="50" start="39700" end="39708">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="251" col1="51" line2="251" col2="51" start="39709" end="39709">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="252" col1="9" line2="252" col2="76" start="39825" end="39892">
              <expr line1="252" col1="9" line2="252" col2="16" start="39825" end="39832">
                <SYMBOL line1="252" col1="9" line2="252" col2="16" start="39825" end="39832">fpkm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="252" col1="18" line2="252" col2="19" start="39834" end="39835">&lt;-</LEFT_ASSIGN>
              <expr line1="252" col1="21" line2="252" col2="76" start="39837" end="39892">
                <expr line1="252" col1="21" line2="252" col2="35" start="39837" end="39851">
                  <SYMBOL_PACKAGE line1="252" col1="21" line2="252" col2="28" start="39837" end="39844">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="252" col1="29" line2="252" col2="30" start="39845" end="39846">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="252" col1="31" line2="252" col2="35" start="39847" end="39851">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="252" col1="36" line2="252" col2="36" start="39852" end="39852">(</OP-LEFT-PAREN>
                <expr line1="252" col1="37" line2="252" col2="50" start="39853" end="39866">
                  <SYMBOL line1="252" col1="37" line2="252" col2="50" start="39853" end="39866">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="252" col1="51" line2="252" col2="51" start="39867" end="39867">,</OP-COMMA>
                <expr line1="252" col1="53" line2="252" col2="70" start="39869" end="39886">
                  <expr line1="252" col1="53" line2="252" col2="59" start="39869" end="39875">
                    <SYMBOL line1="252" col1="53" line2="252" col2="59" start="39869" end="39875">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="252" col1="61" line2="252" col2="61" start="39877" end="39877">~</OP-TILDE>
                  <expr line1="252" col1="63" line2="252" col2="70" start="39879" end="39886">
                    <SYMBOL line1="252" col1="63" line2="252" col2="70" start="39879" end="39886">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="252" col1="71" line2="252" col2="71" start="39887" end="39887">,</OP-COMMA>
                <expr line1="252" col1="73" line2="252" col2="75" start="39889" end="39891">
                  <SYMBOL line1="252" col1="73" line2="252" col2="75" start="39889" end="39891">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="252" col1="76" line2="252" col2="76" start="39892" end="39892">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="253" col1="9" line2="253" col2="46" start="39983" end="40020">
              <expr line1="253" col1="9" line2="253" col2="26" start="39983" end="40000">
                <expr line1="253" col1="9" line2="253" col2="16" start="39983" end="39990">
                  <SYMBOL_FUNCTION_CALL line1="253" col1="9" line2="253" col2="16" start="39983" end="39990">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="253" col1="17" line2="253" col2="17" start="39991" end="39991">(</OP-LEFT-PAREN>
                <expr line1="253" col1="18" line2="253" col2="25" start="39992" end="39999">
                  <SYMBOL line1="253" col1="18" line2="253" col2="25" start="39992" end="39999">fpkm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="253" col1="26" line2="253" col2="26" start="40000" end="40000">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="253" col1="28" line2="253" col2="29" start="40002" end="40003">&lt;-</LEFT_ASSIGN>
              <expr line1="253" col1="31" line2="253" col2="46" start="40005" end="40020">
                <expr line1="253" col1="31" line2="253" col2="38" start="40005" end="40012">
                  <SYMBOL_FUNCTION_CALL line1="253" col1="31" line2="253" col2="38" start="40005" end="40012">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="253" col1="39" line2="253" col2="39" start="40013" end="40013">(</OP-LEFT-PAREN>
                <expr line1="253" col1="40" line2="253" col2="45" start="40014" end="40019">
                  <SYMBOL line1="253" col1="40" line2="253" col2="45" start="40014" end="40019">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="253" col1="46" line2="253" col2="46" start="40020" end="40020">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="254" col1="9" line2="254" col2="33" start="40141" end="40165">
              <expr line1="254" col1="9" line2="254" col2="21" start="40141" end="40153">
                <expr line1="254" col1="9" line2="254" col2="12" start="40141" end="40144">
                  <SYMBOL_FUNCTION_CALL line1="254" col1="9" line2="254" col2="12" start="40141" end="40144">fpkm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="254" col1="13" line2="254" col2="13" start="40145" end="40145">(</OP-LEFT-PAREN>
                <expr line1="254" col1="14" line2="254" col2="20" start="40146" end="40152">
                  <SYMBOL line1="254" col1="14" line2="254" col2="20" start="40146" end="40152">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="254" col1="21" line2="254" col2="21" start="40153" end="40153">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="254" col1="23" line2="254" col2="24" start="40155" end="40156">&lt;-</LEFT_ASSIGN>
              <expr line1="254" col1="26" line2="254" col2="33" start="40158" end="40165">
                <SYMBOL line1="254" col1="26" line2="254" col2="33" start="40158" end="40165">fpkm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="255" col1="9" line2="255" col2="20" start="40299" end="40310">
              <expr line1="255" col1="9" line2="255" col2="10" start="40299" end="40300">
                <SYMBOL_FUNCTION_CALL line1="255" col1="9" line2="255" col2="10" start="40299" end="40300">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="255" col1="11" line2="255" col2="11" start="40301" end="40301">(</OP-LEFT-PAREN>
              <expr line1="255" col1="12" line2="255" col2="19" start="40302" end="40309">
                <SYMBOL line1="255" col1="12" line2="255" col2="19" start="40302" end="40309">fpkm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="255" col1="20" line2="255" col2="20" start="40310" end="40310">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="256" col1="5" line2="256" col2="5" start="40453" end="40453">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="257" col1="5" line2="257" col2="73" start="40611" end="40679">
          <expr line1="257" col1="5" line2="257" col2="14" start="40611" end="40620">
            <SYMBOL line1="257" col1="5" line2="257" col2="14" start="40611" end="40620">cpm_object</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="257" col1="16" line2="257" col2="17" start="40622" end="40623">&lt;-</LEFT_ASSIGN>
          <expr line1="257" col1="19" line2="257" col2="73" start="40625" end="40679">
            <expr line1="257" col1="19" line2="257" col2="26" start="40625" end="40632">
              <SYMBOL_FUNCTION_CALL line1="257" col1="19" line2="257" col2="26" start="40625" end="40632">tryCatch</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="257" col1="27" line2="257" col2="27" start="40633" end="40633">(</OP-LEFT-PAREN>
            <expr line1="257" col1="28" line2="257" col2="38" start="40634" end="40644">
              <expr line1="257" col1="28" line2="257" col2="30" start="40634" end="40636">
                <SYMBOL_FUNCTION_CALL line1="257" col1="28" line2="257" col2="30" start="40634" end="40636">cpm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="257" col1="31" line2="257" col2="31" start="40637" end="40637">(</OP-LEFT-PAREN>
              <expr line1="257" col1="32" line2="257" col2="37" start="40638" end="40643">
                <SYMBOL line1="257" col1="32" line2="257" col2="37" start="40638" end="40643">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="257" col1="38" line2="257" col2="38" start="40644" end="40644">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="257" col1="39" line2="257" col2="39" start="40645" end="40645">,</OP-COMMA>
            <SYMBOL_SUB line1="257" col1="41" line2="257" col2="45" start="40647" end="40651">error</SYMBOL_SUB>
            <EQ_SUB line1="257" col1="47" line2="257" col2="47" start="40653" end="40653">=</EQ_SUB>
            <expr line1="257" col1="49" line2="257" col2="72" start="40655" end="40678">
              <FUNCTION line1="257" col1="49" line2="257" col2="56" start="40655" end="40662">function</FUNCTION>
              <OP-LEFT-PAREN line1="257" col1="57" line2="257" col2="57" start="40663" end="40663">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="257" col1="58" line2="257" col2="58" start="40664" end="40664">e</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="257" col1="59" line2="257" col2="59" start="40665" end="40665">)</OP-RIGHT-PAREN>
              <expr line1="257" col1="61" line2="257" col2="72" start="40667" end="40678">
                <expr line1="257" col1="61" line2="257" col2="66" start="40667" end="40672">
                  <SYMBOL_FUNCTION_CALL line1="257" col1="61" line2="257" col2="66" start="40667" end="40672">return</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="257" col1="67" line2="257" col2="67" start="40673" end="40673">(</OP-LEFT-PAREN>
                <expr line1="257" col1="68" line2="257" col2="71" start="40674" end="40677">
                  <NULL_CONST line1="257" col1="68" line2="257" col2="71" start="40674" end="40677">NULL</NULL_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="257" col1="72" line2="257" col2="72" start="40678" end="40678">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="257" col1="73" line2="257" col2="73" start="40679" end="40679">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="258" col1="5" line2="266" col2="5" start="40769" end="42033">
          <IF line1="258" col1="5" line2="258" col2="6" start="40769" end="40770">if</IF>
          <OP-LEFT-PAREN line1="258" col1="8" line2="258" col2="8" start="40772" end="40772">(</OP-LEFT-PAREN>
          <expr line1="258" col1="10" line2="258" col2="29" start="40774" end="40793">
            <OP-EXCLAMATION line1="258" col1="10" line2="258" col2="10" start="40774" end="40774">!</OP-EXCLAMATION>
            <expr line1="258" col1="11" line2="258" col2="29" start="40775" end="40793">
              <expr line1="258" col1="11" line2="258" col2="17" start="40775" end="40781">
                <SYMBOL_FUNCTION_CALL line1="258" col1="11" line2="258" col2="17" start="40775" end="40781">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="258" col1="18" line2="258" col2="18" start="40782" end="40782">(</OP-LEFT-PAREN>
              <expr line1="258" col1="19" line2="258" col2="28" start="40783" end="40792">
                <SYMBOL line1="258" col1="19" line2="258" col2="28" start="40783" end="40792">cpm_object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="258" col1="29" line2="258" col2="29" start="40793" end="40793">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="258" col1="31" line2="258" col2="31" start="40795" end="40795">)</OP-RIGHT-PAREN>
          <expr line1="258" col1="33" line2="266" col2="5" start="40797" end="42033">
            <OP-LEFT-BRACE line1="258" col1="33" line2="258" col2="33" start="40797" end="40797">{</OP-LEFT-BRACE>
            <expr line1="259" col1="9" line2="260" col2="43" start="40931" end="41123">
              <expr line1="259" col1="9" line2="259" col2="17" start="40931" end="40939">
                <SYMBOL line1="259" col1="9" line2="259" col2="17" start="40931" end="40939">tmp_exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="259" col1="19" line2="259" col2="20" start="40941" end="40942">&lt;-</LEFT_ASSIGN>
              <expr line1="259" col1="22" line2="260" col2="43" start="40944" end="41123">
                <expr line1="259" col1="22" line2="259" col2="31" start="40944" end="40953">
                  <SYMBOL_FUNCTION_CALL line1="259" col1="22" line2="259" col2="31" start="40944" end="40953">data.frame</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="259" col1="32" line2="259" col2="32" start="40954" end="40954">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="259" col1="33" line2="259" col2="39" start="40955" end="40961">feature</SYMBOL_SUB>
                <EQ_SUB line1="259" col1="41" line2="259" col2="41" start="40963" end="40963">=</EQ_SUB>
                <expr line1="259" col1="43" line2="259" col2="73" start="40965" end="40995">
                  <expr line1="259" col1="43" line2="259" col2="57" start="40965" end="40979">
                    <expr line1="259" col1="43" line2="259" col2="49" start="40965" end="40971">
                      <SYMBOL_FUNCTION_CALL line1="259" col1="43" line2="259" col2="49" start="40965" end="40971">rowData</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="259" col1="50" line2="259" col2="50" start="40972" end="40972">(</OP-LEFT-PAREN>
                    <expr line1="259" col1="51" line2="259" col2="56" start="40973" end="40978">
                      <SYMBOL line1="259" col1="51" line2="259" col2="56" start="40973" end="40978">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="259" col1="57" line2="259" col2="57" start="40979" end="40979">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="259" col1="58" line2="259" col2="59" start="40980" end="40981">[[</LBB>
                  <expr line1="259" col1="60" line2="259" col2="71" start="40982" end="40993">
                    <SYMBOL line1="259" col1="60" line2="259" col2="71" start="40982" end="40993">summarise_by</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="259" col1="72" line2="259" col2="72" start="40994" end="40994">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="259" col1="73" line2="259" col2="73" start="40995" end="40995">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-COMMA line1="259" col1="74" line2="259" col2="74" start="40996" end="40996">,</OP-COMMA>
                <expr line1="260" col1="33" line2="260" col2="42" start="41113" end="41122">
                  <SYMBOL line1="260" col1="33" line2="260" col2="42" start="41113" end="41122">cpm_object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="260" col1="43" line2="260" col2="43" start="41123" end="41123">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="261" col1="9" line2="261" col2="51" start="41247" end="41289">
              <expr line1="261" col1="9" line2="261" col2="22" start="41247" end="41260">
                <SYMBOL line1="261" col1="9" line2="261" col2="22" start="41247" end="41260">tmp_exprs_long</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="261" col1="24" line2="261" col2="25" start="41262" end="41263">&lt;-</LEFT_ASSIGN>
              <expr line1="261" col1="27" line2="261" col2="51" start="41265" end="41289">
                <expr line1="261" col1="27" line2="261" col2="40" start="41265" end="41278">
                  <SYMBOL_PACKAGE line1="261" col1="27" line2="261" col2="34" start="41265" end="41272">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="261" col1="35" line2="261" col2="36" start="41273" end="41274">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="261" col1="37" line2="261" col2="40" start="41275" end="41278">melt</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="261" col1="41" line2="261" col2="41" start="41279" end="41279">(</OP-LEFT-PAREN>
                <expr line1="261" col1="42" line2="261" col2="50" start="41280" end="41288">
                  <SYMBOL line1="261" col1="42" line2="261" col2="50" start="41280" end="41288">tmp_exprs</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="261" col1="51" line2="261" col2="51" start="41289" end="41289">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="262" col1="9" line2="262" col2="75" start="41405" end="41471">
              <expr line1="262" col1="9" line2="262" col2="15" start="41405" end="41411">
                <SYMBOL line1="262" col1="9" line2="262" col2="15" start="41405" end="41411">cpm_new</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="262" col1="17" line2="262" col2="18" start="41413" end="41414">&lt;-</LEFT_ASSIGN>
              <expr line1="262" col1="20" line2="262" col2="75" start="41416" end="41471">
                <expr line1="262" col1="20" line2="262" col2="34" start="41416" end="41430">
                  <SYMBOL_PACKAGE line1="262" col1="20" line2="262" col2="27" start="41416" end="41423">reshape2</SYMBOL_PACKAGE>
                  <NS_GET line1="262" col1="28" line2="262" col2="29" start="41424" end="41425">::</NS_GET>
                  <SYMBOL_FUNCTION_CALL line1="262" col1="30" line2="262" col2="34" start="41426" end="41430">acast</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="262" col1="35" line2="262" col2="35" start="41431" end="41431">(</OP-LEFT-PAREN>
                <expr line1="262" col1="36" line2="262" col2="49" start="41432" end="41445">
                  <SYMBOL line1="262" col1="36" line2="262" col2="49" start="41432" end="41445">tmp_exprs_long</SYMBOL>
                </expr>
                <OP-COMMA line1="262" col1="50" line2="262" col2="50" start="41446" end="41446">,</OP-COMMA>
                <expr line1="262" col1="52" line2="262" col2="69" start="41448" end="41465">
                  <expr line1="262" col1="52" line2="262" col2="58" start="41448" end="41454">
                    <SYMBOL line1="262" col1="52" line2="262" col2="58" start="41448" end="41454">feature</SYMBOL>
                  </expr>
                  <OP-TILDE line1="262" col1="60" line2="262" col2="60" start="41456" end="41456">~</OP-TILDE>
                  <expr line1="262" col1="62" line2="262" col2="69" start="41458" end="41465">
                    <SYMBOL line1="262" col1="62" line2="262" col2="69" start="41458" end="41465">variable</SYMBOL>
                  </expr>
                </expr>
                <OP-COMMA line1="262" col1="70" line2="262" col2="70" start="41466" end="41466">,</OP-COMMA>
                <expr line1="262" col1="72" line2="262" col2="74" start="41468" end="41470">
                  <SYMBOL line1="262" col1="72" line2="262" col2="74" start="41468" end="41470">sum</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="262" col1="75" line2="262" col2="75" start="41471" end="41471">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="263" col1="9" line2="263" col2="45" start="41563" end="41599">
              <expr line1="263" col1="9" line2="263" col2="25" start="41563" end="41579">
                <expr line1="263" col1="9" line2="263" col2="16" start="41563" end="41570">
                  <SYMBOL_FUNCTION_CALL line1="263" col1="9" line2="263" col2="16" start="41563" end="41570">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="263" col1="17" line2="263" col2="17" start="41571" end="41571">(</OP-LEFT-PAREN>
                <expr line1="263" col1="18" line2="263" col2="24" start="41572" end="41578">
                  <SYMBOL line1="263" col1="18" line2="263" col2="24" start="41572" end="41578">cpm_new</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="263" col1="25" line2="263" col2="25" start="41579" end="41579">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="263" col1="27" line2="263" col2="28" start="41581" end="41582">&lt;-</LEFT_ASSIGN>
              <expr line1="263" col1="30" line2="263" col2="45" start="41584" end="41599">
                <expr line1="263" col1="30" line2="263" col2="37" start="41584" end="41591">
                  <SYMBOL_FUNCTION_CALL line1="263" col1="30" line2="263" col2="37" start="41584" end="41591">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="263" col1="38" line2="263" col2="38" start="41592" end="41592">(</OP-LEFT-PAREN>
                <expr line1="263" col1="39" line2="263" col2="44" start="41593" end="41598">
                  <SYMBOL line1="263" col1="39" line2="263" col2="44" start="41593" end="41598">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="263" col1="45" line2="263" col2="45" start="41599" end="41599">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="264" col1="9" line2="264" col2="31" start="41721" end="41743">
              <expr line1="264" col1="9" line2="264" col2="20" start="41721" end="41732">
                <expr line1="264" col1="9" line2="264" col2="11" start="41721" end="41723">
                  <SYMBOL_FUNCTION_CALL line1="264" col1="9" line2="264" col2="11" start="41721" end="41723">cpm</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="264" col1="12" line2="264" col2="12" start="41724" end="41724">(</OP-LEFT-PAREN>
                <expr line1="264" col1="13" line2="264" col2="19" start="41725" end="41731">
                  <SYMBOL line1="264" col1="13" line2="264" col2="19" start="41725" end="41731">sce_out</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="264" col1="20" line2="264" col2="20" start="41732" end="41732">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="264" col1="22" line2="264" col2="23" start="41734" end="41735">&lt;-</LEFT_ASSIGN>
              <expr line1="264" col1="25" line2="264" col2="31" start="41737" end="41743">
                <SYMBOL line1="264" col1="25" line2="264" col2="31" start="41737" end="41743">cpm_new</SYMBOL>
              </expr>
            </expr>
            <expr line1="265" col1="9" line2="265" col2="19" start="41879" end="41889">
              <expr line1="265" col1="9" line2="265" col2="10" start="41879" end="41880">
                <SYMBOL_FUNCTION_CALL line1="265" col1="9" line2="265" col2="10" start="41879" end="41880">rm</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="265" col1="11" line2="265" col2="11" start="41881" end="41881">(</OP-LEFT-PAREN>
              <expr line1="265" col1="12" line2="265" col2="18" start="41882" end="41888">
                <SYMBOL line1="265" col1="12" line2="265" col2="18" start="41882" end="41888">cpm_new</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="265" col1="19" line2="265" col2="19" start="41889" end="41889">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="266" col1="5" line2="266" col2="5" start="42033" end="42033">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="267" col1="5" line2="267" col2="39" start="42191" end="42225">## Use feature symbols for rownames</COMMENT>
        <expr line1="268" col1="5" line2="268" col2="11" start="42349" end="42355">
          <SYMBOL line1="268" col1="5" line2="268" col2="11" start="42349" end="42355">sce_out</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="269" col1="1" line2="269" col2="1" start="42503" end="42503">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

