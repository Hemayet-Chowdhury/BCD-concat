<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<exprlist>
  <COMMENT line1="1" col1="1" line2="1" col2="58" start="96" end="153">#' Unmix samples using loss in a variance stabilized space</COMMENT>
  <COMMENT line1="2" col1="1" line2="2" col2="2" start="191" end="192">#'</COMMENT>
  <COMMENT line1="3" col1="1" line2="3" col2="67" start="286" end="352">#' Unmixes samples in \code{x} according to \code{pure} components,</COMMENT>
  <COMMENT line1="4" col1="1" line2="4" col2="62" start="381" end="442">#' using numerical optimization. The components in \code{pure}</COMMENT>
  <COMMENT line1="5" col1="1" line2="5" col2="81" start="476" end="556">#' are added on the scale of gene expression (either normalized counts, or TPMs).</COMMENT>
  <COMMENT line1="6" col1="1" line2="6" col2="60" start="571" end="630">#' The loss function when comparing fitted expression to the</COMMENT>
  <COMMENT line1="7" col1="1" line2="7" col2="61" start="666" end="726">#' samples in \code{x} occurs in a variance stabilized space.</COMMENT>
  <COMMENT line1="8" col1="1" line2="8" col2="57" start="761" end="817">#' This task is sometimes referred to as "deconvolution",</COMMENT>
  <COMMENT line1="9" col1="1" line2="9" col2="63" start="856" end="918">#' and can be used, for example, to identify contributions from</COMMENT>
  <COMMENT line1="10" col1="1" line2="10" col2="19" start="951" end="969">#' various tissues.</COMMENT>
  <COMMENT line1="11" col1="1" line2="11" col2="61" start="1046" end="1106">#' Note: some groups have found that the mixing contributions</COMMENT>
  <COMMENT line1="12" col1="1" line2="12" col2="69" start="1141" end="1209">#' may be more accurate if very lowly expressed genes across \code{x}</COMMENT>
  <COMMENT line1="13" col1="1" line2="13" col2="70" start="1236" end="1305">#' and \code{pure} are first removed. We have not explored this fully.</COMMENT>
  <COMMENT line1="14" col1="1" line2="14" col2="66" start="1331" end="1396">#' Note: if the \code{pbapply} package is installed a progress bar</COMMENT>
  <COMMENT line1="15" col1="1" line2="15" col2="53" start="1426" end="1478">#' will be displayed while mixing components are fit.</COMMENT>
  <COMMENT line1="16" col1="1" line2="16" col2="2" start="1521" end="1522">#'</COMMENT>
  <COMMENT line1="17" col1="1" line2="17" col2="66" start="1616" end="1681">#' @param x normalized counts or TPMs of the samples to be unmixed</COMMENT>
  <COMMENT line1="18" col1="1" line2="18" col2="62" start="1711" end="1772">#' @param pure normalized counts or TPMs of the "pure" samples</COMMENT>
  <COMMENT line1="19" col1="1" line2="19" col2="65" start="1806" end="1870">#' @param alpha for normalized counts, the dispersion of the data</COMMENT>
  <COMMENT line1="20" col1="1" line2="20" col2="72" start="1901" end="1972">#' when a negative binomial model is fit. this can be found by examining</COMMENT>
  <COMMENT line1="21" col1="1" line2="21" col2="69" start="1996" end="2064">#' the asymptotic value of \code{dispersionFunction(dds)}, when using</COMMENT>
  <COMMENT line1="22" col1="1" line2="22" col2="59" start="2091" end="2149">#' \code{fitType="parametric"} or the mean value when using</COMMENT>
  <COMMENT line1="23" col1="1" line2="23" col2="25" start="2186" end="2210">#' \code{fitType="mean"}.</COMMENT>
  <COMMENT line1="24" col1="1" line2="24" col2="79" start="2281" end="2359">#' @param shift for TPMs, the shift which approximately stabilizes the variance</COMMENT>
  <COMMENT line1="25" col1="1" line2="25" col2="68" start="2376" end="2443">#' of log shifted TPMs. Can be assessed with \code{vsn::meanSdPlot}.</COMMENT>
  <COMMENT line1="26" col1="1" line2="26" col2="67" start="2471" end="2537">#' @param power either 1 (for L1) or 2 (for squared) loss function.</COMMENT>
  <COMMENT line1="27" col1="1" line2="27" col2="16" start="2566" end="2581">#' Default is 1.</COMMENT>
  <COMMENT line1="28" col1="1" line2="28" col2="78" start="2661" end="2738">#' @param format \code{"matrix"} or \code{"list"}, default is \code{"matrix"}.</COMMENT>
  <COMMENT line1="29" col1="1" line2="29" col2="82" start="2756" end="2837">#' whether to output just the matrix of mixture components, or a list (see Value).</COMMENT>
  <COMMENT line1="30" col1="1" line2="30" col2="3" start="2851" end="2853">#' </COMMENT>
  <COMMENT line1="31" col1="1" line2="31" col2="74" start="2946" end="3019">#' @param quiet suppress progress bar. default is FALSE, show progress bar</COMMENT>
  <COMMENT line1="32" col1="1" line2="32" col2="27" start="3041" end="3067">#' if pbapply is installed.</COMMENT>
  <COMMENT line1="33" col1="1" line2="33" col2="2" start="3136" end="3137">#'</COMMENT>
  <COMMENT line1="34" col1="1" line2="34" col2="79" start="3231" end="3309">#' @return a matrix, the mixture components for each sample in \code{x} (rows).</COMMENT>
  <COMMENT line1="35" col1="1" line2="35" col2="69" start="3326" end="3394">#' The "pure" samples make up the columns, and so each row sums to 1.</COMMENT>
  <COMMENT line1="36" col1="1" line2="36" col2="90" start="3421" end="3510">#' If colnames existed on the input matrices they will be propagated to the output matrix.</COMMENT>
  <COMMENT line1="37" col1="1" line2="37" col2="64" start="3516" end="3579">#' If \code{format="list"}, then a list, containing as elements:</COMMENT>
  <COMMENT line1="38" col1="1" line2="38" col2="40" start="3611" end="3650">#' (1) the matrix of mixture components,</COMMENT>
  <COMMENT line1="39" col1="1" line2="39" col2="78" start="3706" end="3783">#' (2) the correlations in the variance stabilized space of the fitted samples</COMMENT>
  <COMMENT line1="40" col1="1" line2="40" col2="34" start="3801" end="3834">#' to the samples in \code{x}, and</COMMENT>
  <COMMENT line1="41" col1="1" line2="41" col2="74" start="3896" end="3969">#' (3) the fitted samples as a matrix with the same dimension as \code{x}.</COMMENT>
  <COMMENT line1="42" col1="1" line2="42" col2="2" start="3991" end="3992">#'</COMMENT>
  <COMMENT line1="43" col1="1" line2="43" col2="12" start="4086" end="4097">#' @examples</COMMENT>
  <COMMENT line1="44" col1="1" line2="44" col2="2" start="4181" end="4182">#'</COMMENT>
  <COMMENT line1="45" col1="1" line2="45" col2="25" start="4276" end="4300">#' # some artificial data</COMMENT>
  <COMMENT line1="46" col1="1" line2="46" col2="31" start="4371" end="4401">#' cts &lt;- matrix(c(80,50,1,100,</COMMENT>
  <COMMENT line1="47" col1="1" line2="47" col2="30" start="4466" end="4495">#'                 1,1,60,100,</COMMENT>
  <COMMENT line1="48" col1="1" line2="48" col2="52" start="4561" end="4612">#'                 0,50,60,100), ncol=4, byrow=TRUE)</COMMENT>
  <COMMENT line1="49" col1="1" line2="49" col2="24" start="4656" end="4679">#' # make a DESeqDataSet</COMMENT>
  <COMMENT line1="50" col1="1" line2="50" col2="37" start="4751" end="4787">#' dds &lt;- DESeqDataSetFromMatrix(cts,</COMMENT>
  <COMMENT line1="51" col1="1" line2="51" col2="50" start="4846" end="4895">#'   data.frame(row.names=seq_len(ncol(cts))), ~1)</COMMENT>
  <COMMENT line1="52" col1="1" line2="52" col2="40" start="4941" end="4980">#' colnames(dds) &lt;- paste0("sample",1:4)</COMMENT>
  <COMMENT line1="53" col1="1" line2="53" col2="2" start="5036" end="5037">#'</COMMENT>
  <COMMENT line1="54" col1="1" line2="54" col2="37" start="5131" end="5167">#' # note! here you would instead use</COMMENT>
  <COMMENT line1="55" col1="1" line2="55" col2="53" start="5226" end="5278">#' # estimateSizeFactors() to do actual normalization</COMMENT>
  <COMMENT line1="56" col1="1" line2="56" col2="40" start="5321" end="5360">#' sizeFactors(dds) &lt;- rep(1, ncol(dds))</COMMENT>
  <COMMENT line1="57" col1="1" line2="57" col2="2" start="5416" end="5417">#'</COMMENT>
  <COMMENT line1="58" col1="1" line2="58" col2="43" start="5511" end="5553">#' norm.cts &lt;- counts(dds, normalized=TRUE)</COMMENT>
  <COMMENT line1="59" col1="1" line2="59" col2="2" start="5606" end="5607">#'</COMMENT>
  <COMMENT line1="60" col1="1" line2="60" col2="49" start="5701" end="5749">#' # 'pure' should also have normalized counts...</COMMENT>
  <COMMENT line1="61" col1="1" line2="61" col2="27" start="5796" end="5822">#' pure &lt;- matrix(c(10,0,0,</COMMENT>
  <COMMENT line1="62" col1="1" line2="62" col2="27" start="5891" end="5917">#'                  0,0,10,</COMMENT>
  <COMMENT line1="63" col1="1" line2="63" col2="48" start="5986" end="6033">#'                  0,10,0), ncol=3, byrow=TRUE)</COMMENT>
  <COMMENT line1="64" col1="1" line2="64" col2="33" start="6081" end="6113">#' colnames(pure) &lt;- letters[1:3]</COMMENT>
  <COMMENT line1="65" col1="1" line2="65" col2="3" start="6176" end="6178">#' </COMMENT>
  <COMMENT line1="66" col1="1" line2="66" col2="78" start="6271" end="6348">#' # for real data, you need to find alpha after fitting estimateDispersions()</COMMENT>
  <COMMENT line1="67" col1="1" line2="67" col2="43" start="6366" end="6408">#' mix &lt;- unmix(norm.cts, pure, alpha=0.01)</COMMENT>
  <COMMENT line1="68" col1="1" line2="68" col2="3" start="6461" end="6463">#' </COMMENT>
  <COMMENT line1="69" col1="1" line2="69" col2="10" start="6556" end="6565">#' @export</COMMENT>
  <expr line1="70" col1="1" line2="132" col2="1" start="6651" end="12541">
    <expr line1="70" col1="1" line2="70" col2="5" start="6651" end="6655">
      <SYMBOL line1="70" col1="1" line2="70" col2="5" start="6651" end="6655">unmix</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="70" col1="7" line2="70" col2="8" start="6657" end="6658">&lt;-</LEFT_ASSIGN>
    <expr line1="70" col1="10" line2="132" col2="1" start="6660" end="12541">
      <FUNCTION line1="70" col1="10" line2="70" col2="17" start="6660" end="6667">function</FUNCTION>
      <OP-LEFT-PAREN line1="70" col1="18" line2="70" col2="18" start="6668" end="6668">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="70" col1="19" line2="70" col2="19" start="6669" end="6669">x</SYMBOL_FORMALS>
      <OP-COMMA line1="70" col1="20" line2="70" col2="20" start="6670" end="6670">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="22" line2="70" col2="25" start="6672" end="6675">pure</SYMBOL_FORMALS>
      <OP-COMMA line1="70" col1="26" line2="70" col2="26" start="6676" end="6676">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="28" line2="70" col2="32" start="6678" end="6682">alpha</SYMBOL_FORMALS>
      <OP-COMMA line1="70" col1="33" line2="70" col2="33" start="6683" end="6683">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="35" line2="70" col2="39" start="6685" end="6689">shift</SYMBOL_FORMALS>
      <OP-COMMA line1="70" col1="40" line2="70" col2="40" start="6690" end="6690">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="42" line2="70" col2="46" start="6692" end="6696">power</SYMBOL_FORMALS>
      <EQ_FORMALS line1="70" col1="47" line2="70" col2="47" start="6697" end="6697">=</EQ_FORMALS>
      <expr line1="70" col1="48" line2="70" col2="48" start="6698" end="6698">
        <NUM_CONST line1="70" col1="48" line2="70" col2="48" start="6698" end="6698">1</NUM_CONST>
      </expr>
      <OP-COMMA line1="70" col1="49" line2="70" col2="49" start="6699" end="6699">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="51" line2="70" col2="56" start="6701" end="6706">format</SYMBOL_FORMALS>
      <EQ_FORMALS line1="70" col1="57" line2="70" col2="57" start="6707" end="6707">=</EQ_FORMALS>
      <expr line1="70" col1="58" line2="70" col2="65" start="6708" end="6715">
        <STR_CONST line1="70" col1="58" line2="70" col2="65" start="6708" end="6715">"matrix"</STR_CONST>
      </expr>
      <OP-COMMA line1="70" col1="66" line2="70" col2="66" start="6716" end="6716">,</OP-COMMA>
      <SYMBOL_FORMALS line1="70" col1="68" line2="70" col2="72" start="6718" end="6722">quiet</SYMBOL_FORMALS>
      <EQ_FORMALS line1="70" col1="73" line2="70" col2="73" start="6723" end="6723">=</EQ_FORMALS>
      <expr line1="70" col1="74" line2="70" col2="78" start="6724" end="6728">
        <NUM_CONST line1="70" col1="74" line2="70" col2="78" start="6724" end="6728">FALSE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="70" col1="79" line2="70" col2="79" start="6729" end="6729">)</OP-RIGHT-PAREN>
      <expr line1="70" col1="81" line2="132" col2="1" start="6731" end="12541">
        <OP-LEFT-BRACE line1="70" col1="81" line2="70" col2="81" start="6731" end="6731">{</OP-LEFT-BRACE>
        <expr line1="72" col1="3" line2="72" col2="49" start="6843" end="6889">
          <expr line1="72" col1="3" line2="72" col2="8" start="6843" end="6848">
            <SYMBOL line1="72" col1="3" line2="72" col2="8" start="6843" end="6848">format</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="72" col1="10" line2="72" col2="11" start="6850" end="6851">&lt;-</LEFT_ASSIGN>
          <expr line1="72" col1="13" line2="72" col2="49" start="6853" end="6889">
            <expr line1="72" col1="13" line2="72" col2="21" start="6853" end="6861">
              <SYMBOL_FUNCTION_CALL line1="72" col1="13" line2="72" col2="21" start="6853" end="6861">match.arg</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="72" col1="22" line2="72" col2="22" start="6862" end="6862">(</OP-LEFT-PAREN>
            <expr line1="72" col1="23" line2="72" col2="28" start="6863" end="6868">
              <SYMBOL line1="72" col1="23" line2="72" col2="28" start="6863" end="6868">format</SYMBOL>
            </expr>
            <OP-COMMA line1="72" col1="29" line2="72" col2="29" start="6869" end="6869">,</OP-COMMA>
            <expr line1="72" col1="31" line2="72" col2="48" start="6871" end="6888">
              <expr line1="72" col1="31" line2="72" col2="31" start="6871" end="6871">
                <SYMBOL_FUNCTION_CALL line1="72" col1="31" line2="72" col2="31" start="6871" end="6871">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="72" col1="32" line2="72" col2="32" start="6872" end="6872">(</OP-LEFT-PAREN>
              <expr line1="72" col1="33" line2="72" col2="40" start="6873" end="6880">
                <STR_CONST line1="72" col1="33" line2="72" col2="40" start="6873" end="6880">"matrix"</STR_CONST>
              </expr>
              <OP-COMMA line1="72" col1="41" line2="72" col2="41" start="6881" end="6881">,</OP-COMMA>
              <expr line1="72" col1="42" line2="72" col2="47" start="6882" end="6887">
                <STR_CONST line1="72" col1="42" line2="72" col2="47" start="6882" end="6887">"list"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="72" col1="48" line2="72" col2="48" start="6888" end="6888">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="72" col1="49" line2="72" col2="49" start="6889" end="6889">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="73" col1="3" line2="73" col2="48" start="6938" end="6983">
          <IF line1="73" col1="3" line2="73" col2="4" start="6938" end="6939">if</IF>
          <OP-LEFT-PAREN line1="73" col1="6" line2="73" col2="6" start="6941" end="6941">(</OP-LEFT-PAREN>
          <expr line1="73" col1="7" line2="73" col2="20" start="6942" end="6955">
            <expr line1="73" col1="7" line2="73" col2="13" start="6942" end="6948">
              <SYMBOL_FUNCTION_CALL line1="73" col1="7" line2="73" col2="13" start="6942" end="6948">missing</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="73" col1="14" line2="73" col2="14" start="6949" end="6949">(</OP-LEFT-PAREN>
            <expr line1="73" col1="15" line2="73" col2="19" start="6950" end="6954">
              <SYMBOL line1="73" col1="15" line2="73" col2="19" start="6950" end="6954">alpha</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="73" col1="20" line2="73" col2="20" start="6955" end="6955">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="73" col1="21" line2="73" col2="21" start="6956" end="6956">)</OP-RIGHT-PAREN>
          <expr line1="73" col1="23" line2="73" col2="48" start="6958" end="6983">
            <expr line1="73" col1="23" line2="73" col2="31" start="6958" end="6966">
              <SYMBOL_FUNCTION_CALL line1="73" col1="23" line2="73" col2="31" start="6958" end="6966">stopifnot</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="73" col1="32" line2="73" col2="32" start="6967" end="6967">(</OP-LEFT-PAREN>
            <expr line1="73" col1="33" line2="73" col2="47" start="6968" end="6982">
              <OP-EXCLAMATION line1="73" col1="33" line2="73" col2="33" start="6968" end="6968">!</OP-EXCLAMATION>
              <expr line1="73" col1="34" line2="73" col2="47" start="6969" end="6982">
                <expr line1="73" col1="34" line2="73" col2="40" start="6969" end="6975">
                  <SYMBOL_FUNCTION_CALL line1="73" col1="34" line2="73" col2="40" start="6969" end="6975">missing</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="73" col1="41" line2="73" col2="41" start="6976" end="6976">(</OP-LEFT-PAREN>
                <expr line1="73" col1="42" line2="73" col2="46" start="6977" end="6981">
                  <SYMBOL line1="73" col1="42" line2="73" col2="46" start="6977" end="6981">shift</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="73" col1="47" line2="73" col2="47" start="6982" end="6982">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="73" col1="48" line2="73" col2="48" start="6983" end="6983">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="74" col1="3" line2="74" col2="48" start="7033" end="7078">
          <IF line1="74" col1="3" line2="74" col2="4" start="7033" end="7034">if</IF>
          <OP-LEFT-PAREN line1="74" col1="6" line2="74" col2="6" start="7036" end="7036">(</OP-LEFT-PAREN>
          <expr line1="74" col1="7" line2="74" col2="20" start="7037" end="7050">
            <expr line1="74" col1="7" line2="74" col2="13" start="7037" end="7043">
              <SYMBOL_FUNCTION_CALL line1="74" col1="7" line2="74" col2="13" start="7037" end="7043">missing</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="74" col1="14" line2="74" col2="14" start="7044" end="7044">(</OP-LEFT-PAREN>
            <expr line1="74" col1="15" line2="74" col2="19" start="7045" end="7049">
              <SYMBOL line1="74" col1="15" line2="74" col2="19" start="7045" end="7049">shift</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="74" col1="20" line2="74" col2="20" start="7050" end="7050">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="74" col1="21" line2="74" col2="21" start="7051" end="7051">)</OP-RIGHT-PAREN>
          <expr line1="74" col1="23" line2="74" col2="48" start="7053" end="7078">
            <expr line1="74" col1="23" line2="74" col2="31" start="7053" end="7061">
              <SYMBOL_FUNCTION_CALL line1="74" col1="23" line2="74" col2="31" start="7053" end="7061">stopifnot</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="74" col1="32" line2="74" col2="32" start="7062" end="7062">(</OP-LEFT-PAREN>
            <expr line1="74" col1="33" line2="74" col2="47" start="7063" end="7077">
              <OP-EXCLAMATION line1="74" col1="33" line2="74" col2="33" start="7063" end="7063">!</OP-EXCLAMATION>
              <expr line1="74" col1="34" line2="74" col2="47" start="7064" end="7077">
                <expr line1="74" col1="34" line2="74" col2="40" start="7064" end="7070">
                  <SYMBOL_FUNCTION_CALL line1="74" col1="34" line2="74" col2="40" start="7064" end="7070">missing</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="74" col1="41" line2="74" col2="41" start="7071" end="7071">(</OP-LEFT-PAREN>
                <expr line1="74" col1="42" line2="74" col2="46" start="7072" end="7076">
                  <SYMBOL line1="74" col1="42" line2="74" col2="46" start="7072" end="7076">alpha</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="74" col1="47" line2="74" col2="47" start="7077" end="7077">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="74" col1="48" line2="74" col2="48" start="7078" end="7078">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="75" col1="3" line2="75" col2="44" start="7128" end="7169">
          <expr line1="75" col1="3" line2="75" col2="11" start="7128" end="7136">
            <SYMBOL_FUNCTION_CALL line1="75" col1="3" line2="75" col2="11" start="7128" end="7136">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="75" col1="12" line2="75" col2="12" start="7137" end="7137">(</OP-LEFT-PAREN>
          <expr line1="75" col1="13" line2="75" col2="43" start="7138" end="7168">
            <expr line1="75" col1="13" line2="75" col2="26" start="7138" end="7151">
              <expr line1="75" col1="13" line2="75" col2="19" start="7138" end="7144">
                <SYMBOL_FUNCTION_CALL line1="75" col1="13" line2="75" col2="19" start="7138" end="7144">missing</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="75" col1="20" line2="75" col2="20" start="7145" end="7145">(</OP-LEFT-PAREN>
              <expr line1="75" col1="21" line2="75" col2="25" start="7146" end="7150">
                <SYMBOL line1="75" col1="21" line2="75" col2="25" start="7146" end="7150">shift</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="75" col1="26" line2="75" col2="26" start="7151" end="7151">)</OP-RIGHT-PAREN>
            </expr>
            <OR line1="75" col1="28" line2="75" col2="28" start="7153" end="7153">|</OR>
            <expr line1="75" col1="30" line2="75" col2="43" start="7155" end="7168">
              <expr line1="75" col1="30" line2="75" col2="36" start="7155" end="7161">
                <SYMBOL_FUNCTION_CALL line1="75" col1="30" line2="75" col2="36" start="7155" end="7161">missing</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="75" col1="37" line2="75" col2="37" start="7162" end="7162">(</OP-LEFT-PAREN>
              <expr line1="75" col1="38" line2="75" col2="42" start="7163" end="7167">
                <SYMBOL line1="75" col1="38" line2="75" col2="42" start="7163" end="7167">alpha</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="75" col1="43" line2="75" col2="43" start="7168" end="7168">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="75" col1="44" line2="75" col2="44" start="7169" end="7169">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="76" col1="3" line2="76" col2="27" start="7223" end="7247">
          <expr line1="76" col1="3" line2="76" col2="11" start="7223" end="7231">
            <SYMBOL_FUNCTION_CALL line1="76" col1="3" line2="76" col2="11" start="7223" end="7231">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="76" col1="12" line2="76" col2="12" start="7232" end="7232">(</OP-LEFT-PAREN>
          <expr line1="76" col1="13" line2="76" col2="26" start="7233" end="7246">
            <expr line1="76" col1="13" line2="76" col2="17" start="7233" end="7237">
              <SYMBOL line1="76" col1="13" line2="76" col2="17" start="7233" end="7237">power</SYMBOL>
            </expr>
            <SPECIAL line1="76" col1="19" line2="76" col2="22" start="7239" end="7242">%in%</SPECIAL>
            <expr line1="76" col1="24" line2="76" col2="26" start="7244" end="7246">
              <expr line1="76" col1="24" line2="76" col2="24" start="7244" end="7244">
                <NUM_CONST line1="76" col1="24" line2="76" col2="24" start="7244" end="7244">1</NUM_CONST>
              </expr>
              <OP-COLON line1="76" col1="25" line2="76" col2="25" start="7245" end="7245">:</OP-COLON>
              <expr line1="76" col1="26" line2="76" col2="26" start="7246" end="7246">
                <NUM_CONST line1="76" col1="26" line2="76" col2="26" start="7246" end="7246">2</NUM_CONST>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="76" col1="27" line2="76" col2="27" start="7247" end="7247">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="77" col1="3" line2="77" col2="34" start="7318" end="7349">
          <expr line1="77" col1="3" line2="77" col2="11" start="7318" end="7326">
            <SYMBOL_FUNCTION_CALL line1="77" col1="3" line2="77" col2="11" start="7318" end="7326">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="77" col1="12" line2="77" col2="12" start="7327" end="7327">(</OP-LEFT-PAREN>
          <expr line1="77" col1="13" line2="77" col2="33" start="7328" end="7348">
            <expr line1="77" col1="13" line2="77" col2="19" start="7328" end="7334">
              <expr line1="77" col1="13" line2="77" col2="16" start="7328" end="7331">
                <SYMBOL_FUNCTION_CALL line1="77" col1="13" line2="77" col2="16" start="7328" end="7331">nrow</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="77" col1="17" line2="77" col2="17" start="7332" end="7332">(</OP-LEFT-PAREN>
              <expr line1="77" col1="18" line2="77" col2="18" start="7333" end="7333">
                <SYMBOL line1="77" col1="18" line2="77" col2="18" start="7333" end="7333">x</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="77" col1="19" line2="77" col2="19" start="7334" end="7334">)</OP-RIGHT-PAREN>
            </expr>
            <EQ line1="77" col1="21" line2="77" col2="22" start="7336" end="7337">==</EQ>
            <expr line1="77" col1="24" line2="77" col2="33" start="7339" end="7348">
              <expr line1="77" col1="24" line2="77" col2="27" start="7339" end="7342">
                <SYMBOL_FUNCTION_CALL line1="77" col1="24" line2="77" col2="27" start="7339" end="7342">nrow</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="77" col1="28" line2="77" col2="28" start="7343" end="7343">(</OP-LEFT-PAREN>
              <expr line1="77" col1="29" line2="77" col2="32" start="7344" end="7347">
                <SYMBOL line1="77" col1="29" line2="77" col2="32" start="7344" end="7347">pure</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="77" col1="33" line2="77" col2="33" start="7348" end="7348">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="77" col1="34" line2="77" col2="34" start="7349" end="7349">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="78" col1="3" line2="78" col2="27" start="7413" end="7437">
          <expr line1="78" col1="3" line2="78" col2="11" start="7413" end="7421">
            <SYMBOL_FUNCTION_CALL line1="78" col1="3" line2="78" col2="11" start="7413" end="7421">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="78" col1="12" line2="78" col2="12" start="7422" end="7422">(</OP-LEFT-PAREN>
          <expr line1="78" col1="13" line2="78" col2="26" start="7423" end="7436">
            <expr line1="78" col1="13" line2="78" col2="22" start="7423" end="7432">
              <expr line1="78" col1="13" line2="78" col2="16" start="7423" end="7426">
                <SYMBOL_FUNCTION_CALL line1="78" col1="13" line2="78" col2="16" start="7423" end="7426">ncol</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="78" col1="17" line2="78" col2="17" start="7427" end="7427">(</OP-LEFT-PAREN>
              <expr line1="78" col1="18" line2="78" col2="21" start="7428" end="7431">
                <SYMBOL line1="78" col1="18" line2="78" col2="21" start="7428" end="7431">pure</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="78" col1="22" line2="78" col2="22" start="7432" end="7432">)</OP-RIGHT-PAREN>
            </expr>
            <GT line1="78" col1="24" line2="78" col2="24" start="7434" end="7434">&gt;</GT>
            <expr line1="78" col1="26" line2="78" col2="26" start="7436" end="7436">
              <NUM_CONST line1="78" col1="26" line2="78" col2="26" start="7436" end="7436">1</NUM_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="78" col1="27" line2="78" col2="27" start="7437" end="7437">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="80" col1="3" line2="82" col2="3" start="7603" end="7793">
          <IF line1="80" col1="3" line2="80" col2="4" start="7603" end="7604">if</IF>
          <OP-LEFT-PAREN line1="80" col1="6" line2="80" col2="6" start="7606" end="7606">(</OP-LEFT-PAREN>
          <expr line1="80" col1="7" line2="80" col2="56" start="7607" end="7656">
            <expr line1="80" col1="7" line2="80" col2="47" start="7607" end="7647">
              <expr line1="80" col1="7" line2="80" col2="22" start="7607" end="7622">
                <SYMBOL_FUNCTION_CALL line1="80" col1="7" line2="80" col2="22" start="7607" end="7622">requireNamespace</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="80" col1="23" line2="80" col2="23" start="7623" end="7623">(</OP-LEFT-PAREN>
              <expr line1="80" col1="24" line2="80" col2="32" start="7624" end="7632">
                <STR_CONST line1="80" col1="24" line2="80" col2="32" start="7624" end="7632">"pbapply"</STR_CONST>
              </expr>
              <OP-COMMA line1="80" col1="33" line2="80" col2="33" start="7633" end="7633">,</OP-COMMA>
              <SYMBOL_SUB line1="80" col1="35" line2="80" col2="41" start="7635" end="7641">quietly</SYMBOL_SUB>
              <EQ_SUB line1="80" col1="42" line2="80" col2="42" start="7642" end="7642">=</EQ_SUB>
              <expr line1="80" col1="43" line2="80" col2="46" start="7643" end="7646">
                <NUM_CONST line1="80" col1="43" line2="80" col2="46" start="7643" end="7646">TRUE</NUM_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="80" col1="47" line2="80" col2="47" start="7647" end="7647">)</OP-RIGHT-PAREN>
            </expr>
            <AND line1="80" col1="49" line2="80" col2="49" start="7649" end="7649">&amp;</AND>
            <expr line1="80" col1="51" line2="80" col2="56" start="7651" end="7656">
              <OP-EXCLAMATION line1="80" col1="51" line2="80" col2="51" start="7651" end="7651">!</OP-EXCLAMATION>
              <expr line1="80" col1="52" line2="80" col2="56" start="7652" end="7656">
                <SYMBOL line1="80" col1="52" line2="80" col2="56" start="7652" end="7656">quiet</SYMBOL>
              </expr>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="80" col1="57" line2="80" col2="57" start="7657" end="7657">)</OP-RIGHT-PAREN>
          <expr line1="80" col1="59" line2="82" col2="3" start="7659" end="7793">
            <OP-LEFT-BRACE line1="80" col1="59" line2="80" col2="59" start="7659" end="7659">{</OP-LEFT-BRACE>
            <expr line1="81" col1="5" line2="81" col2="31" start="7700" end="7726">
              <expr line1="81" col1="5" line2="81" col2="10" start="7700" end="7705">
                <SYMBOL line1="81" col1="5" line2="81" col2="10" start="7700" end="7705">lapply</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="81" col1="12" line2="81" col2="13" start="7707" end="7708">&lt;-</LEFT_ASSIGN>
              <expr line1="81" col1="15" line2="81" col2="31" start="7710" end="7726">
                <SYMBOL_PACKAGE line1="81" col1="15" line2="81" col2="21" start="7710" end="7716">pbapply</SYMBOL_PACKAGE>
                <NS_GET line1="81" col1="22" line2="81" col2="23" start="7717" end="7718">::</NS_GET>
                <SYMBOL line1="81" col1="24" line2="81" col2="31" start="7719" end="7726">pblapply</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="82" col1="3" line2="82" col2="3" start="7793" end="7793">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="84" col1="3" line2="85" col2="79" start="7983" end="8154">
          <expr line1="84" col1="3" line2="84" col2="9" start="7983" end="7989">
            <SYMBOL line1="84" col1="3" line2="84" col2="9" start="7983" end="7989">cor.msg</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="84" col1="11" line2="84" col2="12" start="7991" end="7992">&lt;-</LEFT_ASSIGN>
          <expr line1="84" col1="14" line2="85" col2="79" start="7994" end="8154">
            <STR_CONST line1="84" col1="14" line2="85" col2="79" start="7994" end="8154">"some columns of 'pure' are highly correlated (&gt;.99 after VST),
  may result in instabilty of unmix(). visually inspect correlations of 'pure'"</STR_CONST>
          </expr>
        </expr>
        <expr line1="87" col1="3" line2="113" col2="3" start="8268" end="10738">
          <IF line1="87" col1="3" line2="87" col2="4" start="8268" end="8269">if</IF>
          <OP-LEFT-PAREN line1="87" col1="6" line2="87" col2="6" start="8271" end="8271">(</OP-LEFT-PAREN>
          <expr line1="87" col1="7" line2="87" col2="20" start="8272" end="8285">
            <expr line1="87" col1="7" line2="87" col2="13" start="8272" end="8278">
              <SYMBOL_FUNCTION_CALL line1="87" col1="7" line2="87" col2="13" start="8272" end="8278">missing</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="87" col1="14" line2="87" col2="14" start="8279" end="8279">(</OP-LEFT-PAREN>
            <expr line1="87" col1="15" line2="87" col2="19" start="8280" end="8284">
              <SYMBOL line1="87" col1="15" line2="87" col2="19" start="8280" end="8284">shift</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="87" col1="20" line2="87" col2="20" start="8285" end="8285">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="87" col1="21" line2="87" col2="21" start="8286" end="8286">)</OP-RIGHT-PAREN>
          <expr line1="87" col1="23" line2="100" col2="3" start="8288" end="9503">
            <OP-LEFT-BRACE line1="87" col1="23" line2="87" col2="23" start="8288" end="8288">{</OP-LEFT-BRACE>
            <expr line1="88" col1="5" line2="88" col2="24" start="8365" end="8384">
              <expr line1="88" col1="5" line2="88" col2="13" start="8365" end="8373">
                <SYMBOL_FUNCTION_CALL line1="88" col1="5" line2="88" col2="13" start="8365" end="8373">stopifnot</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="88" col1="14" line2="88" col2="14" start="8374" end="8374">(</OP-LEFT-PAREN>
              <expr line1="88" col1="15" line2="88" col2="23" start="8375" end="8383">
                <expr line1="88" col1="15" line2="88" col2="19" start="8375" end="8379">
                  <SYMBOL line1="88" col1="15" line2="88" col2="19" start="8375" end="8379">alpha</SYMBOL>
                </expr>
                <GT line1="88" col1="21" line2="88" col2="21" start="8381" end="8381">&gt;</GT>
                <expr line1="88" col1="23" line2="88" col2="23" start="8383" end="8383">
                  <NUM_CONST line1="88" col1="23" line2="88" col2="23" start="8383" end="8383">0</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="88" col1="24" line2="88" col2="24" start="8384" end="8384">)</OP-RIGHT-PAREN>
            </expr>
            <COMMENT line1="89" col1="5" line2="89" col2="74" start="8460" end="8529"># variance stabilizing transformation for NB w/ fixed dispersion alpha</COMMENT>
            <expr line1="90" col1="5" line2="90" col2="91" start="8555" end="8641">
              <expr line1="90" col1="5" line2="90" col2="7" start="8555" end="8557">
                <SYMBOL line1="90" col1="5" line2="90" col2="7" start="8555" end="8557">vst</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="90" col1="9" line2="90" col2="10" start="8559" end="8560">&lt;-</LEFT_ASSIGN>
              <expr line1="90" col1="12" line2="90" col2="91" start="8562" end="8641">
                <FUNCTION line1="90" col1="12" line2="90" col2="19" start="8562" end="8569">function</FUNCTION>
                <OP-LEFT-PAREN line1="90" col1="20" line2="90" col2="20" start="8570" end="8570">(</OP-LEFT-PAREN>
                <SYMBOL_FORMALS line1="90" col1="21" line2="90" col2="21" start="8571" end="8571">q</SYMBOL_FORMALS>
                <OP-COMMA line1="90" col1="22" line2="90" col2="22" start="8572" end="8572">,</OP-COMMA>
                <SYMBOL_FORMALS line1="90" col1="24" line2="90" col2="28" start="8574" end="8578">alpha</SYMBOL_FORMALS>
                <OP-RIGHT-PAREN line1="90" col1="29" line2="90" col2="29" start="8579" end="8579">)</OP-RIGHT-PAREN>
                <expr line1="90" col1="31" line2="90" col2="91" start="8581" end="8641">
                  <expr line1="90" col1="31" line2="90" col2="82" start="8581" end="8632">
                    <OP-LEFT-PAREN line1="90" col1="31" line2="90" col2="31" start="8581" end="8581">(</OP-LEFT-PAREN>
                    <expr line1="90" col1="33" line2="90" col2="80" start="8583" end="8630">
                      <expr line1="90" col1="33" line2="90" col2="71" start="8583" end="8621">
                        <expr line1="90" col1="33" line2="90" col2="58" start="8583" end="8608">
                          <expr line1="90" col1="33" line2="90" col2="33" start="8583" end="8583">
                            <NUM_CONST line1="90" col1="33" line2="90" col2="33" start="8583" end="8583">2</NUM_CONST>
                          </expr>
                          <OP-STAR line1="90" col1="35" line2="90" col2="35" start="8585" end="8585">*</OP-STAR>
                          <expr line1="90" col1="37" line2="90" col2="58" start="8587" end="8608">
                            <expr line1="90" col1="37" line2="90" col2="41" start="8587" end="8591">
                              <SYMBOL_FUNCTION_CALL line1="90" col1="37" line2="90" col2="41" start="8587" end="8591">asinh</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="90" col1="42" line2="90" col2="42" start="8592" end="8592">(</OP-LEFT-PAREN>
                            <expr line1="90" col1="43" line2="90" col2="57" start="8593" end="8607">
                              <expr line1="90" col1="43" line2="90" col2="46" start="8593" end="8596">
                                <SYMBOL_FUNCTION_CALL line1="90" col1="43" line2="90" col2="46" start="8593" end="8596">sqrt</SYMBOL_FUNCTION_CALL>
                              </expr>
                              <OP-LEFT-PAREN line1="90" col1="47" line2="90" col2="47" start="8597" end="8597">(</OP-LEFT-PAREN>
                              <expr line1="90" col1="48" line2="90" col2="56" start="8598" end="8606">
                                <expr line1="90" col1="48" line2="90" col2="52" start="8598" end="8602">
                                  <SYMBOL line1="90" col1="48" line2="90" col2="52" start="8598" end="8602">alpha</SYMBOL>
                                </expr>
                                <OP-STAR line1="90" col1="54" line2="90" col2="54" start="8604" end="8604">*</OP-STAR>
                                <expr line1="90" col1="56" line2="90" col2="56" start="8606" end="8606">
                                  <SYMBOL line1="90" col1="56" line2="90" col2="56" start="8606" end="8606">q</SYMBOL>
                                </expr>
                              </expr>
                              <OP-RIGHT-PAREN line1="90" col1="57" line2="90" col2="57" start="8607" end="8607">)</OP-RIGHT-PAREN>
                            </expr>
                            <OP-RIGHT-PAREN line1="90" col1="58" line2="90" col2="58" start="8608" end="8608">)</OP-RIGHT-PAREN>
                          </expr>
                        </expr>
                        <OP-MINUS line1="90" col1="60" line2="90" col2="60" start="8610" end="8610">-</OP-MINUS>
                        <expr line1="90" col1="62" line2="90" col2="71" start="8612" end="8621">
                          <expr line1="90" col1="62" line2="90" col2="64" start="8612" end="8614">
                            <SYMBOL_FUNCTION_CALL line1="90" col1="62" line2="90" col2="64" start="8612" end="8614">log</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="90" col1="65" line2="90" col2="65" start="8615" end="8615">(</OP-LEFT-PAREN>
                          <expr line1="90" col1="66" line2="90" col2="70" start="8616" end="8620">
                            <SYMBOL line1="90" col1="66" line2="90" col2="70" start="8616" end="8620">alpha</SYMBOL>
                          </expr>
                          <OP-RIGHT-PAREN line1="90" col1="71" line2="90" col2="71" start="8621" end="8621">)</OP-RIGHT-PAREN>
                        </expr>
                      </expr>
                      <OP-MINUS line1="90" col1="73" line2="90" col2="73" start="8623" end="8623">-</OP-MINUS>
                      <expr line1="90" col1="75" line2="90" col2="80" start="8625" end="8630">
                        <expr line1="90" col1="75" line2="90" col2="77" start="8625" end="8627">
                          <SYMBOL_FUNCTION_CALL line1="90" col1="75" line2="90" col2="77" start="8625" end="8627">log</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="90" col1="78" line2="90" col2="78" start="8628" end="8628">(</OP-LEFT-PAREN>
                        <expr line1="90" col1="79" line2="90" col2="79" start="8629" end="8629">
                          <NUM_CONST line1="90" col1="79" line2="90" col2="79" start="8629" end="8629">4</NUM_CONST>
                        </expr>
                        <OP-RIGHT-PAREN line1="90" col1="80" line2="90" col2="80" start="8630" end="8630">)</OP-RIGHT-PAREN>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="90" col1="82" line2="90" col2="82" start="8632" end="8632">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-SLASH line1="90" col1="84" line2="90" col2="84" start="8634" end="8634">/</OP-SLASH>
                  <expr line1="90" col1="86" line2="90" col2="91" start="8636" end="8641">
                    <expr line1="90" col1="86" line2="90" col2="88" start="8636" end="8638">
                      <SYMBOL_FUNCTION_CALL line1="90" col1="86" line2="90" col2="88" start="8636" end="8638">log</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="90" col1="89" line2="90" col2="89" start="8639" end="8639">(</OP-LEFT-PAREN>
                    <expr line1="90" col1="90" line2="90" col2="90" start="8640" end="8640">
                      <NUM_CONST line1="90" col1="90" line2="90" col2="90" start="8640" end="8640">2</NUM_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="90" col1="91" line2="90" col2="91" start="8641" end="8641">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
              </expr>
            </expr>
            <expr line1="91" col1="5" line2="91" col2="37" start="8650" end="8682">
              <expr line1="91" col1="5" line2="91" col2="12" start="8650" end="8657">
                <SYMBOL line1="91" col1="5" line2="91" col2="12" start="8650" end="8657">pure.cor</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="91" col1="14" line2="91" col2="15" start="8659" end="8660">&lt;-</LEFT_ASSIGN>
              <expr line1="91" col1="17" line2="91" col2="37" start="8662" end="8682">
                <expr line1="91" col1="17" line2="91" col2="19" start="8662" end="8664">
                  <SYMBOL_FUNCTION_CALL line1="91" col1="17" line2="91" col2="19" start="8662" end="8664">cor</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="91" col1="20" line2="91" col2="20" start="8665" end="8665">(</OP-LEFT-PAREN>
                <expr line1="91" col1="21" line2="91" col2="36" start="8666" end="8681">
                  <expr line1="91" col1="21" line2="91" col2="23" start="8666" end="8668">
                    <SYMBOL_FUNCTION_CALL line1="91" col1="21" line2="91" col2="23" start="8666" end="8668">vst</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="91" col1="24" line2="91" col2="24" start="8669" end="8669">(</OP-LEFT-PAREN>
                  <expr line1="91" col1="25" line2="91" col2="28" start="8670" end="8673">
                    <SYMBOL line1="91" col1="25" line2="91" col2="28" start="8670" end="8673">pure</SYMBOL>
                  </expr>
                  <OP-COMMA line1="91" col1="29" line2="91" col2="29" start="8674" end="8674">,</OP-COMMA>
                  <expr line1="91" col1="31" line2="91" col2="35" start="8676" end="8680">
                    <SYMBOL line1="91" col1="31" line2="91" col2="35" start="8676" end="8680">alpha</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="91" col1="36" line2="91" col2="36" start="8681" end="8681">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="91" col1="37" line2="91" col2="37" start="8682" end="8682">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-SEMICOLON line1="91" col1="38" line2="91" col2="38" start="8683" end="8683">;</OP-SEMICOLON>
            <expr line1="91" col1="40" line2="91" col2="58" start="8685" end="8703">
              <expr line1="91" col1="40" line2="91" col2="53" start="8685" end="8698">
                <expr line1="91" col1="40" line2="91" col2="43" start="8685" end="8688">
                  <SYMBOL_FUNCTION_CALL line1="91" col1="40" line2="91" col2="43" start="8685" end="8688">diag</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="91" col1="44" line2="91" col2="44" start="8689" end="8689">(</OP-LEFT-PAREN>
                <expr line1="91" col1="45" line2="91" col2="52" start="8690" end="8697">
                  <SYMBOL line1="91" col1="45" line2="91" col2="52" start="8690" end="8697">pure.cor</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="91" col1="53" line2="91" col2="53" start="8698" end="8698">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="91" col1="55" line2="91" col2="56" start="8700" end="8701">&lt;-</LEFT_ASSIGN>
              <expr line1="91" col1="58" line2="91" col2="58" start="8703" end="8703">
                <NUM_CONST line1="91" col1="58" line2="91" col2="58" start="8703" end="8703">0</NUM_CONST>
              </expr>
            </expr>
            <expr line1="92" col1="5" line2="92" col2="45" start="8745" end="8785">
              <IF line1="92" col1="5" line2="92" col2="6" start="8745" end="8746">if</IF>
              <OP-LEFT-PAREN line1="92" col1="8" line2="92" col2="8" start="8748" end="8748">(</OP-LEFT-PAREN>
              <expr line1="92" col1="9" line2="92" col2="27" start="8749" end="8767">
                <expr line1="92" col1="9" line2="92" col2="11" start="8749" end="8751">
                  <SYMBOL_FUNCTION_CALL line1="92" col1="9" line2="92" col2="11" start="8749" end="8751">any</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="92" col1="12" line2="92" col2="12" start="8752" end="8752">(</OP-LEFT-PAREN>
                <expr line1="92" col1="13" line2="92" col2="26" start="8753" end="8766">
                  <expr line1="92" col1="13" line2="92" col2="20" start="8753" end="8760">
                    <SYMBOL line1="92" col1="13" line2="92" col2="20" start="8753" end="8760">pure.cor</SYMBOL>
                  </expr>
                  <GT line1="92" col1="22" line2="92" col2="22" start="8762" end="8762">&gt;</GT>
                  <expr line1="92" col1="24" line2="92" col2="26" start="8764" end="8766">
                    <NUM_CONST line1="92" col1="24" line2="92" col2="26" start="8764" end="8766">.99</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="92" col1="27" line2="92" col2="27" start="8767" end="8767">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="92" col1="28" line2="92" col2="28" start="8768" end="8768">)</OP-RIGHT-PAREN>
              <expr line1="92" col1="30" line2="92" col2="45" start="8770" end="8785">
                <expr line1="92" col1="30" line2="92" col2="36" start="8770" end="8776">
                  <SYMBOL_FUNCTION_CALL line1="92" col1="30" line2="92" col2="36" start="8770" end="8776">warning</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="92" col1="37" line2="92" col2="37" start="8777" end="8777">(</OP-LEFT-PAREN>
                <expr line1="92" col1="38" line2="92" col2="44" start="8778" end="8784">
                  <SYMBOL line1="92" col1="38" line2="92" col2="44" start="8778" end="8784">cor.msg</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="92" col1="45" line2="92" col2="45" start="8785" end="8785">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="93" col1="5" line2="95" col2="5" start="8840" end="9030">
              <expr line1="93" col1="5" line2="93" col2="14" start="8840" end="8849">
                <SYMBOL line1="93" col1="5" line2="93" col2="14" start="8840" end="8849">sumLossVST</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="93" col1="16" line2="93" col2="17" start="8851" end="8852">&lt;-</LEFT_ASSIGN>
              <expr line1="93" col1="19" line2="95" col2="5" start="8854" end="9030">
                <FUNCTION line1="93" col1="19" line2="93" col2="26" start="8854" end="8861">function</FUNCTION>
                <OP-LEFT-PAREN line1="93" col1="27" line2="93" col2="27" start="8862" end="8862">(</OP-LEFT-PAREN>
                <SYMBOL_FORMALS line1="93" col1="28" line2="93" col2="28" start="8863" end="8863">p</SYMBOL_FORMALS>
                <OP-COMMA line1="93" col1="29" line2="93" col2="29" start="8864" end="8864">,</OP-COMMA>
                <SYMBOL_FORMALS line1="93" col1="31" line2="93" col2="31" start="8866" end="8866">i</SYMBOL_FORMALS>
                <OP-COMMA line1="93" col1="32" line2="93" col2="32" start="8867" end="8867">,</OP-COMMA>
                <SYMBOL_FORMALS line1="93" col1="34" line2="93" col2="36" start="8869" end="8871">vst</SYMBOL_FORMALS>
                <OP-COMMA line1="93" col1="37" line2="93" col2="37" start="8872" end="8872">,</OP-COMMA>
                <SYMBOL_FORMALS line1="93" col1="39" line2="93" col2="43" start="8874" end="8878">alpha</SYMBOL_FORMALS>
                <OP-COMMA line1="93" col1="44" line2="93" col2="44" start="8879" end="8879">,</OP-COMMA>
                <SYMBOL_FORMALS line1="93" col1="46" line2="93" col2="50" start="8881" end="8885">power</SYMBOL_FORMALS>
                <OP-RIGHT-PAREN line1="93" col1="51" line2="93" col2="51" start="8886" end="8886">)</OP-RIGHT-PAREN>
                <expr line1="93" col1="53" line2="95" col2="5" start="8888" end="9030">
                  <OP-LEFT-BRACE line1="93" col1="53" line2="93" col2="53" start="8888" end="8888">{</OP-LEFT-BRACE>
                  <expr line1="94" col1="7" line2="94" col2="64" start="8937" end="8994">
                    <expr line1="94" col1="7" line2="94" col2="9" start="8937" end="8939">
                      <SYMBOL_FUNCTION_CALL line1="94" col1="7" line2="94" col2="9" start="8937" end="8939">sum</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="94" col1="10" line2="94" col2="10" start="8940" end="8940">(</OP-LEFT-PAREN>
                    <expr line1="94" col1="11" line2="94" col2="63" start="8941" end="8993">
                      <expr line1="94" col1="11" line2="94" col2="57" start="8941" end="8987">
                        <expr line1="94" col1="11" line2="94" col2="13" start="8941" end="8943">
                          <SYMBOL_FUNCTION_CALL line1="94" col1="11" line2="94" col2="13" start="8941" end="8943">abs</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="94" col1="14" line2="94" col2="14" start="8944" end="8944">(</OP-LEFT-PAREN>
                        <expr line1="94" col1="15" line2="94" col2="56" start="8945" end="8986">
                          <expr line1="94" col1="15" line2="94" col2="31" start="8945" end="8961">
                            <expr line1="94" col1="15" line2="94" col2="17" start="8945" end="8947">
                              <SYMBOL_FUNCTION_CALL line1="94" col1="15" line2="94" col2="17" start="8945" end="8947">vst</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="94" col1="18" line2="94" col2="18" start="8948" end="8948">(</OP-LEFT-PAREN>
                            <expr line1="94" col1="19" line2="94" col2="23" start="8949" end="8953">
                              <expr line1="94" col1="19" line2="94" col2="19" start="8949" end="8949">
                                <SYMBOL line1="94" col1="19" line2="94" col2="19" start="8949" end="8949">x</SYMBOL>
                              </expr>
                              <OP-LEFT-BRACKET line1="94" col1="20" line2="94" col2="20" start="8950" end="8950">[</OP-LEFT-BRACKET>
                              <OP-COMMA line1="94" col1="21" line2="94" col2="21" start="8951" end="8951">,</OP-COMMA>
                              <expr line1="94" col1="22" line2="94" col2="22" start="8952" end="8952">
                                <SYMBOL line1="94" col1="22" line2="94" col2="22" start="8952" end="8952">i</SYMBOL>
                              </expr>
                              <OP-RIGHT-BRACKET line1="94" col1="23" line2="94" col2="23" start="8953" end="8953">]</OP-RIGHT-BRACKET>
                            </expr>
                            <OP-COMMA line1="94" col1="24" line2="94" col2="24" start="8954" end="8954">,</OP-COMMA>
                            <expr line1="94" col1="26" line2="94" col2="30" start="8956" end="8960">
                              <SYMBOL line1="94" col1="26" line2="94" col2="30" start="8956" end="8960">alpha</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="94" col1="31" line2="94" col2="31" start="8961" end="8961">)</OP-RIGHT-PAREN>
                          </expr>
                          <OP-MINUS line1="94" col1="33" line2="94" col2="33" start="8963" end="8963">-</OP-MINUS>
                          <expr line1="94" col1="35" line2="94" col2="56" start="8965" end="8986">
                            <expr line1="94" col1="35" line2="94" col2="37" start="8965" end="8967">
                              <SYMBOL_FUNCTION_CALL line1="94" col1="35" line2="94" col2="37" start="8965" end="8967">vst</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="94" col1="38" line2="94" col2="38" start="8968" end="8968">(</OP-LEFT-PAREN>
                            <expr line1="94" col1="39" line2="94" col2="48" start="8969" end="8978">
                              <expr line1="94" col1="39" line2="94" col2="42" start="8969" end="8972">
                                <SYMBOL line1="94" col1="39" line2="94" col2="42" start="8969" end="8972">pure</SYMBOL>
                              </expr>
                              <SPECIAL line1="94" col1="44" line2="94" col2="46" start="8974" end="8976">%*%</SPECIAL>
                              <expr line1="94" col1="48" line2="94" col2="48" start="8978" end="8978">
                                <SYMBOL line1="94" col1="48" line2="94" col2="48" start="8978" end="8978">p</SYMBOL>
                              </expr>
                            </expr>
                            <OP-COMMA line1="94" col1="49" line2="94" col2="49" start="8979" end="8979">,</OP-COMMA>
                            <expr line1="94" col1="51" line2="94" col2="55" start="8981" end="8985">
                              <SYMBOL line1="94" col1="51" line2="94" col2="55" start="8981" end="8985">alpha</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="94" col1="56" line2="94" col2="56" start="8986" end="8986">)</OP-RIGHT-PAREN>
                          </expr>
                        </expr>
                        <OP-RIGHT-PAREN line1="94" col1="57" line2="94" col2="57" start="8987" end="8987">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-CARET line1="94" col1="58" line2="94" col2="58" start="8988" end="8988">^</OP-CARET>
                      <expr line1="94" col1="59" line2="94" col2="63" start="8989" end="8993">
                        <SYMBOL line1="94" col1="59" line2="94" col2="63" start="8989" end="8993">power</SYMBOL>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="94" col1="64" line2="94" col2="64" start="8994" end="8994">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-BRACE line1="95" col1="5" line2="95" col2="5" start="9030" end="9030">}</OP-RIGHT-BRACE>
                </expr>
              </expr>
            </expr>
            <expr line1="96" col1="5" line2="99" col2="6" start="9125" end="9411">
              <expr line1="96" col1="5" line2="96" col2="7" start="9125" end="9127">
                <SYMBOL line1="96" col1="5" line2="96" col2="7" start="9125" end="9127">res</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="96" col1="9" line2="96" col2="10" start="9129" end="9130">&lt;-</LEFT_ASSIGN>
              <expr line1="96" col1="12" line2="99" col2="6" start="9132" end="9411">
                <expr line1="96" col1="12" line2="96" col2="17" start="9132" end="9137">
                  <SYMBOL_FUNCTION_CALL line1="96" col1="12" line2="96" col2="17" start="9132" end="9137">lapply</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="96" col1="18" line2="96" col2="18" start="9138" end="9138">(</OP-LEFT-PAREN>
                <expr line1="96" col1="19" line2="96" col2="34" start="9139" end="9154">
                  <expr line1="96" col1="19" line2="96" col2="25" start="9139" end="9145">
                    <SYMBOL_FUNCTION_CALL line1="96" col1="19" line2="96" col2="25" start="9139" end="9145">seq_len</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="96" col1="26" line2="96" col2="26" start="9146" end="9146">(</OP-LEFT-PAREN>
                  <expr line1="96" col1="27" line2="96" col2="33" start="9147" end="9153">
                    <expr line1="96" col1="27" line2="96" col2="30" start="9147" end="9150">
                      <SYMBOL_FUNCTION_CALL line1="96" col1="27" line2="96" col2="30" start="9147" end="9150">ncol</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="96" col1="31" line2="96" col2="31" start="9151" end="9151">(</OP-LEFT-PAREN>
                    <expr line1="96" col1="32" line2="96" col2="32" start="9152" end="9152">
                      <SYMBOL line1="96" col1="32" line2="96" col2="32" start="9152" end="9152">x</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="96" col1="33" line2="96" col2="33" start="9153" end="9153">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="96" col1="34" line2="96" col2="34" start="9154" end="9154">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="96" col1="35" line2="96" col2="35" start="9155" end="9155">,</OP-COMMA>
                <expr line1="96" col1="37" line2="99" col2="5" start="9157" end="9410">
                  <FUNCTION line1="96" col1="37" line2="96" col2="44" start="9157" end="9164">function</FUNCTION>
                  <OP-LEFT-PAREN line1="96" col1="45" line2="96" col2="45" start="9165" end="9165">(</OP-LEFT-PAREN>
                  <SYMBOL_FORMALS line1="96" col1="46" line2="96" col2="46" start="9166" end="9166">i</SYMBOL_FORMALS>
                  <OP-RIGHT-PAREN line1="96" col1="47" line2="96" col2="47" start="9167" end="9167">)</OP-RIGHT-PAREN>
                  <expr line1="96" col1="49" line2="99" col2="5" start="9169" end="9410">
                    <OP-LEFT-BRACE line1="96" col1="49" line2="96" col2="49" start="9169" end="9169">{</OP-LEFT-BRACE>
                    <expr line1="97" col1="7" line2="98" col2="54" start="9222" end="9364">
                      <expr line1="97" col1="7" line2="98" col2="50" start="9222" end="9360">
                        <expr line1="97" col1="7" line2="97" col2="11" start="9222" end="9226">
                          <SYMBOL_FUNCTION_CALL line1="97" col1="7" line2="97" col2="11" start="9222" end="9226">optim</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="97" col1="12" line2="97" col2="12" start="9227" end="9227">(</OP-LEFT-PAREN>
                        <SYMBOL_SUB line1="97" col1="13" line2="97" col2="15" start="9228" end="9230">par</SYMBOL_SUB>
                        <EQ_SUB line1="97" col1="16" line2="97" col2="16" start="9231" end="9231">=</EQ_SUB>
                        <expr line1="97" col1="17" line2="97" col2="34" start="9232" end="9249">
                          <expr line1="97" col1="17" line2="97" col2="19" start="9232" end="9234">
                            <SYMBOL_FUNCTION_CALL line1="97" col1="17" line2="97" col2="19" start="9232" end="9234">rep</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="97" col1="20" line2="97" col2="20" start="9235" end="9235">(</OP-LEFT-PAREN>
                          <expr line1="97" col1="21" line2="97" col2="21" start="9236" end="9236">
                            <NUM_CONST line1="97" col1="21" line2="97" col2="21" start="9236" end="9236">1</NUM_CONST>
                          </expr>
                          <OP-COMMA line1="97" col1="22" line2="97" col2="22" start="9237" end="9237">,</OP-COMMA>
                          <expr line1="97" col1="24" line2="97" col2="33" start="9239" end="9248">
                            <expr line1="97" col1="24" line2="97" col2="27" start="9239" end="9242">
                              <SYMBOL_FUNCTION_CALL line1="97" col1="24" line2="97" col2="27" start="9239" end="9242">ncol</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="97" col1="28" line2="97" col2="28" start="9243" end="9243">(</OP-LEFT-PAREN>
                            <expr line1="97" col1="29" line2="97" col2="32" start="9244" end="9247">
                              <SYMBOL line1="97" col1="29" line2="97" col2="32" start="9244" end="9247">pure</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="97" col1="33" line2="97" col2="33" start="9248" end="9248">)</OP-RIGHT-PAREN>
                          </expr>
                          <OP-RIGHT-PAREN line1="97" col1="34" line2="97" col2="34" start="9249" end="9249">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-COMMA line1="97" col1="35" line2="97" col2="35" start="9250" end="9250">,</OP-COMMA>
                        <SYMBOL_SUB line1="97" col1="37" line2="97" col2="38" start="9252" end="9253">fn</SYMBOL_SUB>
                        <EQ_SUB line1="97" col1="39" line2="97" col2="39" start="9254" end="9254">=</EQ_SUB>
                        <expr line1="97" col1="40" line2="97" col2="49" start="9255" end="9264">
                          <SYMBOL line1="97" col1="40" line2="97" col2="49" start="9255" end="9264">sumLossVST</SYMBOL>
                        </expr>
                        <OP-COMMA line1="97" col1="50" line2="97" col2="50" start="9265" end="9265">,</OP-COMMA>
                        <SYMBOL_SUB line1="97" col1="52" line2="97" col2="53" start="9267" end="9268">gr</SYMBOL_SUB>
                        <EQ_SUB line1="97" col1="54" line2="97" col2="54" start="9269" end="9269">=</EQ_SUB>
                        <expr line1="97" col1="55" line2="97" col2="58" start="9270" end="9273">
                          <NULL_CONST line1="97" col1="55" line2="97" col2="58" start="9270" end="9273">NULL</NULL_CONST>
                        </expr>
                        <OP-COMMA line1="97" col1="59" line2="97" col2="59" start="9274" end="9274">,</OP-COMMA>
                        <expr line1="97" col1="61" line2="97" col2="61" start="9276" end="9276">
                          <SYMBOL line1="97" col1="61" line2="97" col2="61" start="9276" end="9276">i</SYMBOL>
                        </expr>
                        <OP-COMMA line1="97" col1="62" line2="97" col2="62" start="9277" end="9277">,</OP-COMMA>
                        <expr line1="97" col1="64" line2="97" col2="66" start="9279" end="9281">
                          <SYMBOL line1="97" col1="64" line2="97" col2="66" start="9279" end="9281">vst</SYMBOL>
                        </expr>
                        <OP-COMMA line1="97" col1="67" line2="97" col2="67" start="9282" end="9282">,</OP-COMMA>
                        <expr line1="97" col1="69" line2="97" col2="73" start="9284" end="9288">
                          <SYMBOL line1="97" col1="69" line2="97" col2="73" start="9284" end="9288">alpha</SYMBOL>
                        </expr>
                        <OP-COMMA line1="97" col1="74" line2="97" col2="74" start="9289" end="9289">,</OP-COMMA>
                        <expr line1="97" col1="76" line2="97" col2="80" start="9291" end="9295">
                          <SYMBOL line1="97" col1="76" line2="97" col2="80" start="9291" end="9295">power</SYMBOL>
                        </expr>
                        <OP-COMMA line1="97" col1="81" line2="97" col2="81" start="9296" end="9296">,</OP-COMMA>
                        <SYMBOL_SUB line1="98" col1="13" line2="98" col2="18" start="9323" end="9328">method</SYMBOL_SUB>
                        <EQ_SUB line1="98" col1="19" line2="98" col2="19" start="9329" end="9329">=</EQ_SUB>
                        <expr line1="98" col1="20" line2="98" col2="29" start="9330" end="9339">
                          <STR_CONST line1="98" col1="20" line2="98" col2="29" start="9330" end="9339">"L-BFGS-B"</STR_CONST>
                        </expr>
                        <OP-COMMA line1="98" col1="30" line2="98" col2="30" start="9340" end="9340">,</OP-COMMA>
                        <SYMBOL_SUB line1="98" col1="32" line2="98" col2="36" start="9342" end="9346">lower</SYMBOL_SUB>
                        <EQ_SUB line1="98" col1="37" line2="98" col2="37" start="9347" end="9347">=</EQ_SUB>
                        <expr line1="98" col1="38" line2="98" col2="38" start="9348" end="9348">
                          <NUM_CONST line1="98" col1="38" line2="98" col2="38" start="9348" end="9348">0</NUM_CONST>
                        </expr>
                        <OP-COMMA line1="98" col1="39" line2="98" col2="39" start="9349" end="9349">,</OP-COMMA>
                        <SYMBOL_SUB line1="98" col1="41" line2="98" col2="45" start="9351" end="9355">upper</SYMBOL_SUB>
                        <EQ_SUB line1="98" col1="46" line2="98" col2="46" start="9356" end="9356">=</EQ_SUB>
                        <expr line1="98" col1="47" line2="98" col2="49" start="9357" end="9359">
                          <NUM_CONST line1="98" col1="47" line2="98" col2="49" start="9357" end="9359">100</NUM_CONST>
                        </expr>
                        <OP-RIGHT-PAREN line1="98" col1="50" line2="98" col2="50" start="9360" end="9360">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-DOLLAR line1="98" col1="51" line2="98" col2="51" start="9361" end="9361">$</OP-DOLLAR>
                      <SYMBOL line1="98" col1="52" line2="98" col2="54" start="9362" end="9364">par</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACE line1="99" col1="5" line2="99" col2="5" start="9410" end="9410">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="99" col1="6" line2="99" col2="6" start="9411" end="9411">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="100" col1="3" line2="100" col2="3" start="9503" end="9503">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="100" col1="5" line2="100" col2="8" start="9505" end="9508">else</ELSE>
          <expr line1="100" col1="10" line2="113" col2="3" start="9510" end="10738">
            <OP-LEFT-BRACE line1="100" col1="10" line2="100" col2="10" start="9510" end="9510">{</OP-LEFT-BRACE>
            <expr line1="101" col1="5" line2="101" col2="24" start="9600" end="9619">
              <expr line1="101" col1="5" line2="101" col2="13" start="9600" end="9608">
                <SYMBOL_FUNCTION_CALL line1="101" col1="5" line2="101" col2="13" start="9600" end="9608">stopifnot</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="101" col1="14" line2="101" col2="14" start="9609" end="9609">(</OP-LEFT-PAREN>
              <expr line1="101" col1="15" line2="101" col2="23" start="9610" end="9618">
                <expr line1="101" col1="15" line2="101" col2="19" start="9610" end="9614">
                  <SYMBOL line1="101" col1="15" line2="101" col2="19" start="9610" end="9614">shift</SYMBOL>
                </expr>
                <GT line1="101" col1="21" line2="101" col2="21" start="9616" end="9616">&gt;</GT>
                <expr line1="101" col1="23" line2="101" col2="23" start="9618" end="9618">
                  <NUM_CONST line1="101" col1="23" line2="101" col2="23" start="9618" end="9618">0</NUM_CONST>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="101" col1="24" line2="101" col2="24" start="9619" end="9619">)</OP-RIGHT-PAREN>
            </expr>
            <COMMENT line1="102" col1="5" line2="102" col2="24" start="9695" end="9714"># VST of shifted log</COMMENT>
            <expr line1="103" col1="5" line2="103" col2="46" start="9790" end="9831">
              <expr line1="103" col1="5" line2="103" col2="9" start="9790" end="9794">
                <SYMBOL line1="103" col1="5" line2="103" col2="9" start="9790" end="9794">vstSL</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="103" col1="11" line2="103" col2="12" start="9796" end="9797">&lt;-</LEFT_ASSIGN>
              <expr line1="103" col1="14" line2="103" col2="46" start="9799" end="9831">
                <FUNCTION line1="103" col1="14" line2="103" col2="21" start="9799" end="9806">function</FUNCTION>
                <OP-LEFT-PAREN line1="103" col1="22" line2="103" col2="22" start="9807" end="9807">(</OP-LEFT-PAREN>
                <SYMBOL_FORMALS line1="103" col1="23" line2="103" col2="23" start="9808" end="9808">q</SYMBOL_FORMALS>
                <OP-COMMA line1="103" col1="24" line2="103" col2="24" start="9809" end="9809">,</OP-COMMA>
                <SYMBOL_FORMALS line1="103" col1="26" line2="103" col2="30" start="9811" end="9815">shift</SYMBOL_FORMALS>
                <OP-RIGHT-PAREN line1="103" col1="31" line2="103" col2="31" start="9816" end="9816">)</OP-RIGHT-PAREN>
                <expr line1="103" col1="33" line2="103" col2="46" start="9818" end="9831">
                  <expr line1="103" col1="33" line2="103" col2="35" start="9818" end="9820">
                    <SYMBOL_FUNCTION_CALL line1="103" col1="33" line2="103" col2="35" start="9818" end="9820">log</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="103" col1="36" line2="103" col2="36" start="9821" end="9821">(</OP-LEFT-PAREN>
                  <expr line1="103" col1="37" line2="103" col2="45" start="9822" end="9830">
                    <expr line1="103" col1="37" line2="103" col2="37" start="9822" end="9822">
                      <SYMBOL line1="103" col1="37" line2="103" col2="37" start="9822" end="9822">q</SYMBOL>
                    </expr>
                    <OP-PLUS line1="103" col1="39" line2="103" col2="39" start="9824" end="9824">+</OP-PLUS>
                    <expr line1="103" col1="41" line2="103" col2="45" start="9826" end="9830">
                      <SYMBOL line1="103" col1="41" line2="103" col2="45" start="9826" end="9830">shift</SYMBOL>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="103" col1="46" line2="103" col2="46" start="9831" end="9831">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
            </expr>
            <expr line1="104" col1="5" line2="104" col2="39" start="9885" end="9919">
              <expr line1="104" col1="5" line2="104" col2="12" start="9885" end="9892">
                <SYMBOL line1="104" col1="5" line2="104" col2="12" start="9885" end="9892">pure.cor</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="104" col1="14" line2="104" col2="15" start="9894" end="9895">&lt;-</LEFT_ASSIGN>
              <expr line1="104" col1="17" line2="104" col2="39" start="9897" end="9919">
                <expr line1="104" col1="17" line2="104" col2="19" start="9897" end="9899">
                  <SYMBOL_FUNCTION_CALL line1="104" col1="17" line2="104" col2="19" start="9897" end="9899">cor</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="104" col1="20" line2="104" col2="20" start="9900" end="9900">(</OP-LEFT-PAREN>
                <expr line1="104" col1="21" line2="104" col2="38" start="9901" end="9918">
                  <expr line1="104" col1="21" line2="104" col2="25" start="9901" end="9905">
                    <SYMBOL_FUNCTION_CALL line1="104" col1="21" line2="104" col2="25" start="9901" end="9905">vstSL</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="104" col1="26" line2="104" col2="26" start="9906" end="9906">(</OP-LEFT-PAREN>
                  <expr line1="104" col1="27" line2="104" col2="30" start="9907" end="9910">
                    <SYMBOL line1="104" col1="27" line2="104" col2="30" start="9907" end="9910">pure</SYMBOL>
                  </expr>
                  <OP-COMMA line1="104" col1="31" line2="104" col2="31" start="9911" end="9911">,</OP-COMMA>
                  <expr line1="104" col1="33" line2="104" col2="37" start="9913" end="9917">
                    <SYMBOL line1="104" col1="33" line2="104" col2="37" start="9913" end="9917">shift</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="104" col1="38" line2="104" col2="38" start="9918" end="9918">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="104" col1="39" line2="104" col2="39" start="9919" end="9919">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-SEMICOLON line1="104" col1="40" line2="104" col2="40" start="9920" end="9920">;</OP-SEMICOLON>
            <expr line1="104" col1="42" line2="104" col2="60" start="9922" end="9940">
              <expr line1="104" col1="42" line2="104" col2="55" start="9922" end="9935">
                <expr line1="104" col1="42" line2="104" col2="45" start="9922" end="9925">
                  <SYMBOL_FUNCTION_CALL line1="104" col1="42" line2="104" col2="45" start="9922" end="9925">diag</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="104" col1="46" line2="104" col2="46" start="9926" end="9926">(</OP-LEFT-PAREN>
                <expr line1="104" col1="47" line2="104" col2="54" start="9927" end="9934">
                  <SYMBOL line1="104" col1="47" line2="104" col2="54" start="9927" end="9934">pure.cor</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="104" col1="55" line2="104" col2="55" start="9935" end="9935">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="104" col1="57" line2="104" col2="58" start="9937" end="9938">&lt;-</LEFT_ASSIGN>
              <expr line1="104" col1="60" line2="104" col2="60" start="9940" end="9940">
                <NUM_CONST line1="104" col1="60" line2="104" col2="60" start="9940" end="9940">0</NUM_CONST>
              </expr>
            </expr>
            <expr line1="105" col1="5" line2="105" col2="45" start="9980" end="10020">
              <IF line1="105" col1="5" line2="105" col2="6" start="9980" end="9981">if</IF>
              <OP-LEFT-PAREN line1="105" col1="8" line2="105" col2="8" start="9983" end="9983">(</OP-LEFT-PAREN>
              <expr line1="105" col1="9" line2="105" col2="27" start="9984" end="10002">
                <expr line1="105" col1="9" line2="105" col2="11" start="9984" end="9986">
                  <SYMBOL_FUNCTION_CALL line1="105" col1="9" line2="105" col2="11" start="9984" end="9986">any</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="105" col1="12" line2="105" col2="12" start="9987" end="9987">(</OP-LEFT-PAREN>
                <expr line1="105" col1="13" line2="105" col2="26" start="9988" end="10001">
                  <expr line1="105" col1="13" line2="105" col2="20" start="9988" end="9995">
                    <SYMBOL line1="105" col1="13" line2="105" col2="20" start="9988" end="9995">pure.cor</SYMBOL>
                  </expr>
                  <GT line1="105" col1="22" line2="105" col2="22" start="9997" end="9997">&gt;</GT>
                  <expr line1="105" col1="24" line2="105" col2="26" start="9999" end="10001">
                    <NUM_CONST line1="105" col1="24" line2="105" col2="26" start="9999" end="10001">.99</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="105" col1="27" line2="105" col2="27" start="10002" end="10002">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="105" col1="28" line2="105" col2="28" start="10003" end="10003">)</OP-RIGHT-PAREN>
              <expr line1="105" col1="30" line2="105" col2="45" start="10005" end="10020">
                <expr line1="105" col1="30" line2="105" col2="36" start="10005" end="10011">
                  <SYMBOL_FUNCTION_CALL line1="105" col1="30" line2="105" col2="36" start="10005" end="10011">warning</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="105" col1="37" line2="105" col2="37" start="10012" end="10012">(</OP-LEFT-PAREN>
                <expr line1="105" col1="38" line2="105" col2="44" start="10013" end="10019">
                  <SYMBOL line1="105" col1="38" line2="105" col2="44" start="10013" end="10019">cor.msg</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="105" col1="45" line2="105" col2="45" start="10020" end="10020">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="106" col1="5" line2="108" col2="5" start="10075" end="10265">
              <expr line1="106" col1="5" line2="106" col2="13" start="10075" end="10083">
                <SYMBOL line1="106" col1="5" line2="106" col2="13" start="10075" end="10083">sumLossSL</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="106" col1="15" line2="106" col2="16" start="10085" end="10086">&lt;-</LEFT_ASSIGN>
              <expr line1="106" col1="18" line2="108" col2="5" start="10088" end="10265">
                <FUNCTION line1="106" col1="18" line2="106" col2="25" start="10088" end="10095">function</FUNCTION>
                <OP-LEFT-PAREN line1="106" col1="26" line2="106" col2="26" start="10096" end="10096">(</OP-LEFT-PAREN>
                <SYMBOL_FORMALS line1="106" col1="27" line2="106" col2="27" start="10097" end="10097">p</SYMBOL_FORMALS>
                <OP-COMMA line1="106" col1="28" line2="106" col2="28" start="10098" end="10098">,</OP-COMMA>
                <SYMBOL_FORMALS line1="106" col1="30" line2="106" col2="30" start="10100" end="10100">i</SYMBOL_FORMALS>
                <OP-COMMA line1="106" col1="31" line2="106" col2="31" start="10101" end="10101">,</OP-COMMA>
                <SYMBOL_FORMALS line1="106" col1="33" line2="106" col2="35" start="10103" end="10105">vst</SYMBOL_FORMALS>
                <OP-COMMA line1="106" col1="36" line2="106" col2="36" start="10106" end="10106">,</OP-COMMA>
                <SYMBOL_FORMALS line1="106" col1="38" line2="106" col2="42" start="10108" end="10112">shift</SYMBOL_FORMALS>
                <OP-COMMA line1="106" col1="43" line2="106" col2="43" start="10113" end="10113">,</OP-COMMA>
                <SYMBOL_FORMALS line1="106" col1="45" line2="106" col2="49" start="10115" end="10119">power</SYMBOL_FORMALS>
                <OP-RIGHT-PAREN line1="106" col1="50" line2="106" col2="50" start="10120" end="10120">)</OP-RIGHT-PAREN>
                <expr line1="106" col1="52" line2="108" col2="5" start="10122" end="10265">
                  <OP-LEFT-BRACE line1="106" col1="52" line2="106" col2="52" start="10122" end="10122">{</OP-LEFT-BRACE>
                  <expr line1="107" col1="7" line2="107" col2="68" start="10172" end="10233">
                    <expr line1="107" col1="7" line2="107" col2="9" start="10172" end="10174">
                      <SYMBOL_FUNCTION_CALL line1="107" col1="7" line2="107" col2="9" start="10172" end="10174">sum</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="107" col1="10" line2="107" col2="10" start="10175" end="10175">(</OP-LEFT-PAREN>
                    <expr line1="107" col1="11" line2="107" col2="67" start="10176" end="10232">
                      <expr line1="107" col1="11" line2="107" col2="61" start="10176" end="10226">
                        <expr line1="107" col1="11" line2="107" col2="13" start="10176" end="10178">
                          <SYMBOL_FUNCTION_CALL line1="107" col1="11" line2="107" col2="13" start="10176" end="10178">abs</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="107" col1="14" line2="107" col2="14" start="10179" end="10179">(</OP-LEFT-PAREN>
                        <expr line1="107" col1="15" line2="107" col2="60" start="10180" end="10225">
                          <expr line1="107" col1="15" line2="107" col2="33" start="10180" end="10198">
                            <expr line1="107" col1="15" line2="107" col2="19" start="10180" end="10184">
                              <SYMBOL_FUNCTION_CALL line1="107" col1="15" line2="107" col2="19" start="10180" end="10184">vstSL</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="107" col1="20" line2="107" col2="20" start="10185" end="10185">(</OP-LEFT-PAREN>
                            <expr line1="107" col1="21" line2="107" col2="25" start="10186" end="10190">
                              <expr line1="107" col1="21" line2="107" col2="21" start="10186" end="10186">
                                <SYMBOL line1="107" col1="21" line2="107" col2="21" start="10186" end="10186">x</SYMBOL>
                              </expr>
                              <OP-LEFT-BRACKET line1="107" col1="22" line2="107" col2="22" start="10187" end="10187">[</OP-LEFT-BRACKET>
                              <OP-COMMA line1="107" col1="23" line2="107" col2="23" start="10188" end="10188">,</OP-COMMA>
                              <expr line1="107" col1="24" line2="107" col2="24" start="10189" end="10189">
                                <SYMBOL line1="107" col1="24" line2="107" col2="24" start="10189" end="10189">i</SYMBOL>
                              </expr>
                              <OP-RIGHT-BRACKET line1="107" col1="25" line2="107" col2="25" start="10190" end="10190">]</OP-RIGHT-BRACKET>
                            </expr>
                            <OP-COMMA line1="107" col1="26" line2="107" col2="26" start="10191" end="10191">,</OP-COMMA>
                            <expr line1="107" col1="28" line2="107" col2="32" start="10193" end="10197">
                              <SYMBOL line1="107" col1="28" line2="107" col2="32" start="10193" end="10197">shift</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="107" col1="33" line2="107" col2="33" start="10198" end="10198">)</OP-RIGHT-PAREN>
                          </expr>
                          <OP-MINUS line1="107" col1="35" line2="107" col2="35" start="10200" end="10200">-</OP-MINUS>
                          <expr line1="107" col1="37" line2="107" col2="60" start="10202" end="10225">
                            <expr line1="107" col1="37" line2="107" col2="41" start="10202" end="10206">
                              <SYMBOL_FUNCTION_CALL line1="107" col1="37" line2="107" col2="41" start="10202" end="10206">vstSL</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="107" col1="42" line2="107" col2="42" start="10207" end="10207">(</OP-LEFT-PAREN>
                            <expr line1="107" col1="43" line2="107" col2="52" start="10208" end="10217">
                              <expr line1="107" col1="43" line2="107" col2="46" start="10208" end="10211">
                                <SYMBOL line1="107" col1="43" line2="107" col2="46" start="10208" end="10211">pure</SYMBOL>
                              </expr>
                              <SPECIAL line1="107" col1="48" line2="107" col2="50" start="10213" end="10215">%*%</SPECIAL>
                              <expr line1="107" col1="52" line2="107" col2="52" start="10217" end="10217">
                                <SYMBOL line1="107" col1="52" line2="107" col2="52" start="10217" end="10217">p</SYMBOL>
                              </expr>
                            </expr>
                            <OP-COMMA line1="107" col1="53" line2="107" col2="53" start="10218" end="10218">,</OP-COMMA>
                            <expr line1="107" col1="55" line2="107" col2="59" start="10220" end="10224">
                              <SYMBOL line1="107" col1="55" line2="107" col2="59" start="10220" end="10224">shift</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="107" col1="60" line2="107" col2="60" start="10225" end="10225">)</OP-RIGHT-PAREN>
                          </expr>
                        </expr>
                        <OP-RIGHT-PAREN line1="107" col1="61" line2="107" col2="61" start="10226" end="10226">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-CARET line1="107" col1="62" line2="107" col2="62" start="10227" end="10227">^</OP-CARET>
                      <expr line1="107" col1="63" line2="107" col2="67" start="10228" end="10232">
                        <SYMBOL line1="107" col1="63" line2="107" col2="67" start="10228" end="10232">power</SYMBOL>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="107" col1="68" line2="107" col2="68" start="10233" end="10233">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-BRACE line1="108" col1="5" line2="108" col2="5" start="10265" end="10265">}</OP-RIGHT-BRACE>
                </expr>
              </expr>
            </expr>
            <expr line1="109" col1="5" line2="112" col2="6" start="10360" end="10646">
              <expr line1="109" col1="5" line2="109" col2="7" start="10360" end="10362">
                <SYMBOL line1="109" col1="5" line2="109" col2="7" start="10360" end="10362">res</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="109" col1="9" line2="109" col2="10" start="10364" end="10365">&lt;-</LEFT_ASSIGN>
              <expr line1="109" col1="12" line2="112" col2="6" start="10367" end="10646">
                <expr line1="109" col1="12" line2="109" col2="17" start="10367" end="10372">
                  <SYMBOL_FUNCTION_CALL line1="109" col1="12" line2="109" col2="17" start="10367" end="10372">lapply</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="109" col1="18" line2="109" col2="18" start="10373" end="10373">(</OP-LEFT-PAREN>
                <expr line1="109" col1="19" line2="109" col2="34" start="10374" end="10389">
                  <expr line1="109" col1="19" line2="109" col2="25" start="10374" end="10380">
                    <SYMBOL_FUNCTION_CALL line1="109" col1="19" line2="109" col2="25" start="10374" end="10380">seq_len</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="109" col1="26" line2="109" col2="26" start="10381" end="10381">(</OP-LEFT-PAREN>
                  <expr line1="109" col1="27" line2="109" col2="33" start="10382" end="10388">
                    <expr line1="109" col1="27" line2="109" col2="30" start="10382" end="10385">
                      <SYMBOL_FUNCTION_CALL line1="109" col1="27" line2="109" col2="30" start="10382" end="10385">ncol</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="109" col1="31" line2="109" col2="31" start="10386" end="10386">(</OP-LEFT-PAREN>
                    <expr line1="109" col1="32" line2="109" col2="32" start="10387" end="10387">
                      <SYMBOL line1="109" col1="32" line2="109" col2="32" start="10387" end="10387">x</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="109" col1="33" line2="109" col2="33" start="10388" end="10388">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="109" col1="34" line2="109" col2="34" start="10389" end="10389">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="109" col1="35" line2="109" col2="35" start="10390" end="10390">,</OP-COMMA>
                <expr line1="109" col1="37" line2="112" col2="5" start="10392" end="10645">
                  <FUNCTION line1="109" col1="37" line2="109" col2="44" start="10392" end="10399">function</FUNCTION>
                  <OP-LEFT-PAREN line1="109" col1="45" line2="109" col2="45" start="10400" end="10400">(</OP-LEFT-PAREN>
                  <SYMBOL_FORMALS line1="109" col1="46" line2="109" col2="46" start="10401" end="10401">i</SYMBOL_FORMALS>
                  <OP-RIGHT-PAREN line1="109" col1="47" line2="109" col2="47" start="10402" end="10402">)</OP-RIGHT-PAREN>
                  <expr line1="109" col1="49" line2="112" col2="5" start="10404" end="10645">
                    <OP-LEFT-BRACE line1="109" col1="49" line2="109" col2="49" start="10404" end="10404">{</OP-LEFT-BRACE>
                    <expr line1="110" col1="7" line2="111" col2="54" start="10457" end="10599">
                      <expr line1="110" col1="7" line2="111" col2="50" start="10457" end="10595">
                        <expr line1="110" col1="7" line2="110" col2="11" start="10457" end="10461">
                          <SYMBOL_FUNCTION_CALL line1="110" col1="7" line2="110" col2="11" start="10457" end="10461">optim</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="110" col1="12" line2="110" col2="12" start="10462" end="10462">(</OP-LEFT-PAREN>
                        <SYMBOL_SUB line1="110" col1="13" line2="110" col2="15" start="10463" end="10465">par</SYMBOL_SUB>
                        <EQ_SUB line1="110" col1="16" line2="110" col2="16" start="10466" end="10466">=</EQ_SUB>
                        <expr line1="110" col1="17" line2="110" col2="34" start="10467" end="10484">
                          <expr line1="110" col1="17" line2="110" col2="19" start="10467" end="10469">
                            <SYMBOL_FUNCTION_CALL line1="110" col1="17" line2="110" col2="19" start="10467" end="10469">rep</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="110" col1="20" line2="110" col2="20" start="10470" end="10470">(</OP-LEFT-PAREN>
                          <expr line1="110" col1="21" line2="110" col2="21" start="10471" end="10471">
                            <NUM_CONST line1="110" col1="21" line2="110" col2="21" start="10471" end="10471">1</NUM_CONST>
                          </expr>
                          <OP-COMMA line1="110" col1="22" line2="110" col2="22" start="10472" end="10472">,</OP-COMMA>
                          <expr line1="110" col1="24" line2="110" col2="33" start="10474" end="10483">
                            <expr line1="110" col1="24" line2="110" col2="27" start="10474" end="10477">
                              <SYMBOL_FUNCTION_CALL line1="110" col1="24" line2="110" col2="27" start="10474" end="10477">ncol</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="110" col1="28" line2="110" col2="28" start="10478" end="10478">(</OP-LEFT-PAREN>
                            <expr line1="110" col1="29" line2="110" col2="32" start="10479" end="10482">
                              <SYMBOL line1="110" col1="29" line2="110" col2="32" start="10479" end="10482">pure</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="110" col1="33" line2="110" col2="33" start="10483" end="10483">)</OP-RIGHT-PAREN>
                          </expr>
                          <OP-RIGHT-PAREN line1="110" col1="34" line2="110" col2="34" start="10484" end="10484">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-COMMA line1="110" col1="35" line2="110" col2="35" start="10485" end="10485">,</OP-COMMA>
                        <SYMBOL_SUB line1="110" col1="37" line2="110" col2="38" start="10487" end="10488">fn</SYMBOL_SUB>
                        <EQ_SUB line1="110" col1="39" line2="110" col2="39" start="10489" end="10489">=</EQ_SUB>
                        <expr line1="110" col1="40" line2="110" col2="48" start="10490" end="10498">
                          <SYMBOL line1="110" col1="40" line2="110" col2="48" start="10490" end="10498">sumLossSL</SYMBOL>
                        </expr>
                        <OP-COMMA line1="110" col1="49" line2="110" col2="49" start="10499" end="10499">,</OP-COMMA>
                        <SYMBOL_SUB line1="110" col1="51" line2="110" col2="52" start="10501" end="10502">gr</SYMBOL_SUB>
                        <EQ_SUB line1="110" col1="53" line2="110" col2="53" start="10503" end="10503">=</EQ_SUB>
                        <expr line1="110" col1="54" line2="110" col2="57" start="10504" end="10507">
                          <NULL_CONST line1="110" col1="54" line2="110" col2="57" start="10504" end="10507">NULL</NULL_CONST>
                        </expr>
                        <OP-COMMA line1="110" col1="58" line2="110" col2="58" start="10508" end="10508">,</OP-COMMA>
                        <expr line1="110" col1="60" line2="110" col2="60" start="10510" end="10510">
                          <SYMBOL line1="110" col1="60" line2="110" col2="60" start="10510" end="10510">i</SYMBOL>
                        </expr>
                        <OP-COMMA line1="110" col1="61" line2="110" col2="61" start="10511" end="10511">,</OP-COMMA>
                        <expr line1="110" col1="63" line2="110" col2="67" start="10513" end="10517">
                          <SYMBOL line1="110" col1="63" line2="110" col2="67" start="10513" end="10517">vstSL</SYMBOL>
                        </expr>
                        <OP-COMMA line1="110" col1="68" line2="110" col2="68" start="10518" end="10518">,</OP-COMMA>
                        <expr line1="110" col1="70" line2="110" col2="74" start="10520" end="10524">
                          <SYMBOL line1="110" col1="70" line2="110" col2="74" start="10520" end="10524">shift</SYMBOL>
                        </expr>
                        <OP-COMMA line1="110" col1="75" line2="110" col2="75" start="10525" end="10525">,</OP-COMMA>
                        <expr line1="110" col1="77" line2="110" col2="81" start="10527" end="10531">
                          <SYMBOL line1="110" col1="77" line2="110" col2="81" start="10527" end="10531">power</SYMBOL>
                        </expr>
                        <OP-COMMA line1="110" col1="82" line2="110" col2="82" start="10532" end="10532">,</OP-COMMA>
                        <SYMBOL_SUB line1="111" col1="13" line2="111" col2="18" start="10558" end="10563">method</SYMBOL_SUB>
                        <EQ_SUB line1="111" col1="19" line2="111" col2="19" start="10564" end="10564">=</EQ_SUB>
                        <expr line1="111" col1="20" line2="111" col2="29" start="10565" end="10574">
                          <STR_CONST line1="111" col1="20" line2="111" col2="29" start="10565" end="10574">"L-BFGS-B"</STR_CONST>
                        </expr>
                        <OP-COMMA line1="111" col1="30" line2="111" col2="30" start="10575" end="10575">,</OP-COMMA>
                        <SYMBOL_SUB line1="111" col1="32" line2="111" col2="36" start="10577" end="10581">lower</SYMBOL_SUB>
                        <EQ_SUB line1="111" col1="37" line2="111" col2="37" start="10582" end="10582">=</EQ_SUB>
                        <expr line1="111" col1="38" line2="111" col2="38" start="10583" end="10583">
                          <NUM_CONST line1="111" col1="38" line2="111" col2="38" start="10583" end="10583">0</NUM_CONST>
                        </expr>
                        <OP-COMMA line1="111" col1="39" line2="111" col2="39" start="10584" end="10584">,</OP-COMMA>
                        <SYMBOL_SUB line1="111" col1="41" line2="111" col2="45" start="10586" end="10590">upper</SYMBOL_SUB>
                        <EQ_SUB line1="111" col1="46" line2="111" col2="46" start="10591" end="10591">=</EQ_SUB>
                        <expr line1="111" col1="47" line2="111" col2="49" start="10592" end="10594">
                          <NUM_CONST line1="111" col1="47" line2="111" col2="49" start="10592" end="10594">100</NUM_CONST>
                        </expr>
                        <OP-RIGHT-PAREN line1="111" col1="50" line2="111" col2="50" start="10595" end="10595">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-DOLLAR line1="111" col1="51" line2="111" col2="51" start="10596" end="10596">$</OP-DOLLAR>
                      <SYMBOL line1="111" col1="52" line2="111" col2="54" start="10597" end="10599">par</SYMBOL>
                    </expr>
                    <OP-RIGHT-BRACE line1="112" col1="5" line2="112" col2="5" start="10645" end="10645">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="112" col1="6" line2="112" col2="6" start="10646" end="10646">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="113" col1="3" line2="113" col2="3" start="10738" end="10738">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="115" col1="3" line2="115" col2="28" start="10928" end="10953">
          <expr line1="115" col1="3" line2="115" col2="5" start="10928" end="10930">
            <SYMBOL line1="115" col1="3" line2="115" col2="5" start="10928" end="10930">mix</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="115" col1="7" line2="115" col2="8" start="10932" end="10933">&lt;-</LEFT_ASSIGN>
          <expr line1="115" col1="10" line2="115" col2="28" start="10935" end="10953">
            <expr line1="115" col1="10" line2="115" col2="16" start="10935" end="10941">
              <SYMBOL_FUNCTION_CALL line1="115" col1="10" line2="115" col2="16" start="10935" end="10941">do.call</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="115" col1="17" line2="115" col2="17" start="10942" end="10942">(</OP-LEFT-PAREN>
            <expr line1="115" col1="18" line2="115" col2="22" start="10943" end="10947">
              <SYMBOL line1="115" col1="18" line2="115" col2="22" start="10943" end="10947">rbind</SYMBOL>
            </expr>
            <OP-COMMA line1="115" col1="23" line2="115" col2="23" start="10948" end="10948">,</OP-COMMA>
            <expr line1="115" col1="25" line2="115" col2="27" start="10950" end="10952">
              <SYMBOL line1="115" col1="25" line2="115" col2="27" start="10950" end="10952">res</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="115" col1="28" line2="115" col2="28" start="10953" end="10953">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="116" col1="3" line2="116" col2="27" start="11023" end="11047">
          <expr line1="116" col1="3" line2="116" col2="5" start="11023" end="11025">
            <SYMBOL line1="116" col1="3" line2="116" col2="5" start="11023" end="11025">mix</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="116" col1="7" line2="116" col2="8" start="11027" end="11028">&lt;-</LEFT_ASSIGN>
          <expr line1="116" col1="10" line2="116" col2="27" start="11030" end="11047">
            <expr line1="116" col1="10" line2="116" col2="12" start="11030" end="11032">
              <SYMBOL line1="116" col1="10" line2="116" col2="12" start="11030" end="11032">mix</SYMBOL>
            </expr>
            <OP-SLASH line1="116" col1="14" line2="116" col2="14" start="11034" end="11034">/</OP-SLASH>
            <expr line1="116" col1="16" line2="116" col2="27" start="11036" end="11047">
              <expr line1="116" col1="16" line2="116" col2="22" start="11036" end="11042">
                <SYMBOL_FUNCTION_CALL line1="116" col1="16" line2="116" col2="22" start="11036" end="11042">rowSums</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="116" col1="23" line2="116" col2="23" start="11043" end="11043">(</OP-LEFT-PAREN>
              <expr line1="116" col1="24" line2="116" col2="26" start="11044" end="11046">
                <SYMBOL line1="116" col1="24" line2="116" col2="26" start="11044" end="11046">mix</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="116" col1="27" line2="116" col2="27" start="11047" end="11047">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="117" col1="3" line2="117" col2="33" start="11118" end="11148">
          <expr line1="117" col1="3" line2="117" col2="15" start="11118" end="11130">
            <expr line1="117" col1="3" line2="117" col2="10" start="11118" end="11125">
              <SYMBOL_FUNCTION_CALL line1="117" col1="3" line2="117" col2="10" start="11118" end="11125">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="117" col1="11" line2="117" col2="11" start="11126" end="11126">(</OP-LEFT-PAREN>
            <expr line1="117" col1="12" line2="117" col2="14" start="11127" end="11129">
              <SYMBOL line1="117" col1="12" line2="117" col2="14" start="11127" end="11129">mix</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="117" col1="15" line2="117" col2="15" start="11130" end="11130">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="117" col1="17" line2="117" col2="18" start="11132" end="11133">&lt;-</LEFT_ASSIGN>
          <expr line1="117" col1="20" line2="117" col2="33" start="11135" end="11148">
            <expr line1="117" col1="20" line2="117" col2="27" start="11135" end="11142">
              <SYMBOL_FUNCTION_CALL line1="117" col1="20" line2="117" col2="27" start="11135" end="11142">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="117" col1="28" line2="117" col2="28" start="11143" end="11143">(</OP-LEFT-PAREN>
            <expr line1="117" col1="29" line2="117" col2="32" start="11144" end="11147">
              <SYMBOL line1="117" col1="29" line2="117" col2="32" start="11144" end="11147">pure</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="117" col1="33" line2="117" col2="33" start="11148" end="11148">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="118" col1="3" line2="118" col2="30" start="11213" end="11240">
          <expr line1="118" col1="3" line2="118" col2="15" start="11213" end="11225">
            <expr line1="118" col1="3" line2="118" col2="10" start="11213" end="11220">
              <SYMBOL_FUNCTION_CALL line1="118" col1="3" line2="118" col2="10" start="11213" end="11220">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="118" col1="11" line2="118" col2="11" start="11221" end="11221">(</OP-LEFT-PAREN>
            <expr line1="118" col1="12" line2="118" col2="14" start="11222" end="11224">
              <SYMBOL line1="118" col1="12" line2="118" col2="14" start="11222" end="11224">mix</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="118" col1="15" line2="118" col2="15" start="11225" end="11225">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="118" col1="17" line2="118" col2="18" start="11227" end="11228">&lt;-</LEFT_ASSIGN>
          <expr line1="118" col1="20" line2="118" col2="30" start="11230" end="11240">
            <expr line1="118" col1="20" line2="118" col2="27" start="11230" end="11237">
              <SYMBOL_FUNCTION_CALL line1="118" col1="20" line2="118" col2="27" start="11230" end="11237">colnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="118" col1="28" line2="118" col2="28" start="11238" end="11238">(</OP-LEFT-PAREN>
            <expr line1="118" col1="29" line2="118" col2="29" start="11239" end="11239">
              <SYMBOL line1="118" col1="29" line2="118" col2="29" start="11239" end="11239">x</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="118" col1="30" line2="118" col2="30" start="11240" end="11240">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="120" col1="3" line2="130" col2="3" start="11403" end="12353">
          <IF line1="120" col1="3" line2="120" col2="4" start="11403" end="11404">if</IF>
          <OP-LEFT-PAREN line1="120" col1="6" line2="120" col2="6" start="11406" end="11406">(</OP-LEFT-PAREN>
          <expr line1="120" col1="7" line2="120" col2="24" start="11407" end="11424">
            <expr line1="120" col1="7" line2="120" col2="12" start="11407" end="11412">
              <SYMBOL line1="120" col1="7" line2="120" col2="12" start="11407" end="11412">format</SYMBOL>
            </expr>
            <EQ line1="120" col1="14" line2="120" col2="15" start="11414" end="11415">==</EQ>
            <expr line1="120" col1="17" line2="120" col2="24" start="11417" end="11424">
              <STR_CONST line1="120" col1="17" line2="120" col2="24" start="11417" end="11424">"matrix"</STR_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="120" col1="25" line2="120" col2="25" start="11425" end="11425">)</OP-RIGHT-PAREN>
          <expr line1="120" col1="27" line2="122" col2="3" start="11427" end="11593">
            <OP-LEFT-BRACE line1="120" col1="27" line2="120" col2="27" start="11427" end="11427">{</OP-LEFT-BRACE>
            <expr line1="121" col1="5" line2="121" col2="15" start="11500" end="11510">
              <expr line1="121" col1="5" line2="121" col2="10" start="11500" end="11505">
                <SYMBOL_FUNCTION_CALL line1="121" col1="5" line2="121" col2="10" start="11500" end="11505">return</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="121" col1="11" line2="121" col2="11" start="11506" end="11506">(</OP-LEFT-PAREN>
              <expr line1="121" col1="12" line2="121" col2="14" start="11507" end="11509">
                <SYMBOL line1="121" col1="12" line2="121" col2="14" start="11507" end="11509">mix</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="121" col1="15" line2="121" col2="15" start="11510" end="11510">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="122" col1="3" line2="122" col2="3" start="11593" end="11593">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="122" col1="5" line2="122" col2="8" start="11595" end="11598">else</ELSE>
          <expr line1="122" col1="10" line2="130" col2="3" start="11600" end="12353">
            <OP-LEFT-BRACE line1="122" col1="10" line2="122" col2="10" start="11600" end="11600">{</OP-LEFT-BRACE>
            <expr line1="123" col1="5" line2="123" col2="29" start="11690" end="11714">
              <expr line1="123" col1="5" line2="123" col2="10" start="11690" end="11695">
                <SYMBOL line1="123" col1="5" line2="123" col2="10" start="11690" end="11695">fitted</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="123" col1="12" line2="123" col2="13" start="11697" end="11698">&lt;-</LEFT_ASSIGN>
              <expr line1="123" col1="15" line2="123" col2="29" start="11700" end="11714">
                <expr line1="123" col1="15" line2="123" col2="18" start="11700" end="11703">
                  <SYMBOL line1="123" col1="15" line2="123" col2="18" start="11700" end="11703">pure</SYMBOL>
                </expr>
                <SPECIAL line1="123" col1="20" line2="123" col2="22" start="11705" end="11707">%*%</SPECIAL>
                <expr line1="123" col1="24" line2="123" col2="29" start="11709" end="11714">
                  <expr line1="123" col1="24" line2="123" col2="24" start="11709" end="11709">
                    <SYMBOL_FUNCTION_CALL line1="123" col1="24" line2="123" col2="24" start="11709" end="11709">t</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="123" col1="25" line2="123" col2="25" start="11710" end="11710">(</OP-LEFT-PAREN>
                  <expr line1="123" col1="26" line2="123" col2="28" start="11711" end="11713">
                    <SYMBOL line1="123" col1="26" line2="123" col2="28" start="11711" end="11713">mix</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="123" col1="29" line2="123" col2="29" start="11714" end="11714">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
            </expr>
            <expr line1="124" col1="5" line2="128" col2="5" start="11785" end="12165">
              <expr line1="124" col1="5" line2="124" col2="7" start="11785" end="11787">
                <SYMBOL line1="124" col1="5" line2="124" col2="7" start="11785" end="11787">cor</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="124" col1="9" line2="124" col2="10" start="11789" end="11790">&lt;-</LEFT_ASSIGN>
              <expr line1="124" col1="12" line2="128" col2="5" start="11792" end="12165">
                <IF line1="124" col1="12" line2="124" col2="13" start="11792" end="11793">if</IF>
                <OP-LEFT-PAREN line1="124" col1="15" line2="124" col2="15" start="11795" end="11795">(</OP-LEFT-PAREN>
                <expr line1="124" col1="16" line2="124" col2="29" start="11796" end="11809">
                  <expr line1="124" col1="16" line2="124" col2="22" start="11796" end="11802">
                    <SYMBOL_FUNCTION_CALL line1="124" col1="16" line2="124" col2="22" start="11796" end="11802">missing</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="124" col1="23" line2="124" col2="23" start="11803" end="11803">(</OP-LEFT-PAREN>
                  <expr line1="124" col1="24" line2="124" col2="28" start="11804" end="11808">
                    <SYMBOL line1="124" col1="24" line2="124" col2="28" start="11804" end="11808">shift</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="124" col1="29" line2="124" col2="29" start="11809" end="11809">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="124" col1="30" line2="124" col2="30" start="11810" end="11810">)</OP-RIGHT-PAREN>
                <expr line1="124" col1="32" line2="126" col2="5" start="11812" end="11975">
                  <OP-LEFT-BRACE line1="124" col1="32" line2="124" col2="32" start="11812" end="11812">{</OP-LEFT-BRACE>
                  <expr line1="125" col1="7" line2="125" col2="44" start="11882" end="11919">
                    <expr line1="125" col1="7" line2="125" col2="9" start="11882" end="11884">
                      <SYMBOL_FUNCTION_CALL line1="125" col1="7" line2="125" col2="9" start="11882" end="11884">cor</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="125" col1="10" line2="125" col2="10" start="11885" end="11885">(</OP-LEFT-PAREN>
                    <expr line1="125" col1="11" line2="125" col2="23" start="11886" end="11898">
                      <expr line1="125" col1="11" line2="125" col2="13" start="11886" end="11888">
                        <SYMBOL_FUNCTION_CALL line1="125" col1="11" line2="125" col2="13" start="11886" end="11888">vst</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="125" col1="14" line2="125" col2="14" start="11889" end="11889">(</OP-LEFT-PAREN>
                      <expr line1="125" col1="15" line2="125" col2="15" start="11890" end="11890">
                        <SYMBOL line1="125" col1="15" line2="125" col2="15" start="11890" end="11890">x</SYMBOL>
                      </expr>
                      <OP-COMMA line1="125" col1="16" line2="125" col2="16" start="11891" end="11891">,</OP-COMMA>
                      <expr line1="125" col1="18" line2="125" col2="22" start="11893" end="11897">
                        <SYMBOL line1="125" col1="18" line2="125" col2="22" start="11893" end="11897">alpha</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="125" col1="23" line2="125" col2="23" start="11898" end="11898">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-COMMA line1="125" col1="24" line2="125" col2="24" start="11899" end="11899">,</OP-COMMA>
                    <expr line1="125" col1="26" line2="125" col2="43" start="11901" end="11918">
                      <expr line1="125" col1="26" line2="125" col2="28" start="11901" end="11903">
                        <SYMBOL_FUNCTION_CALL line1="125" col1="26" line2="125" col2="28" start="11901" end="11903">vst</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="125" col1="29" line2="125" col2="29" start="11904" end="11904">(</OP-LEFT-PAREN>
                      <expr line1="125" col1="30" line2="125" col2="35" start="11905" end="11910">
                        <SYMBOL line1="125" col1="30" line2="125" col2="35" start="11905" end="11910">fitted</SYMBOL>
                      </expr>
                      <OP-COMMA line1="125" col1="36" line2="125" col2="36" start="11911" end="11911">,</OP-COMMA>
                      <expr line1="125" col1="38" line2="125" col2="42" start="11913" end="11917">
                        <SYMBOL line1="125" col1="38" line2="125" col2="42" start="11913" end="11917">alpha</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="125" col1="43" line2="125" col2="43" start="11918" end="11918">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="125" col1="44" line2="125" col2="44" start="11919" end="11919">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-BRACE line1="126" col1="5" line2="126" col2="5" start="11975" end="11975">}</OP-RIGHT-BRACE>
                </expr>
                <ELSE line1="126" col1="7" line2="126" col2="10" start="11977" end="11980">else</ELSE>
                <expr line1="126" col1="12" line2="128" col2="5" start="11982" end="12165">
                  <OP-LEFT-BRACE line1="126" col1="12" line2="126" col2="12" start="11982" end="11982">{</OP-LEFT-BRACE>
                  <expr line1="127" col1="7" line2="127" col2="48" start="12072" end="12113">
                    <expr line1="127" col1="7" line2="127" col2="9" start="12072" end="12074">
                      <SYMBOL_FUNCTION_CALL line1="127" col1="7" line2="127" col2="9" start="12072" end="12074">cor</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="127" col1="10" line2="127" col2="10" start="12075" end="12075">(</OP-LEFT-PAREN>
                    <expr line1="127" col1="11" line2="127" col2="25" start="12076" end="12090">
                      <expr line1="127" col1="11" line2="127" col2="15" start="12076" end="12080">
                        <SYMBOL_FUNCTION_CALL line1="127" col1="11" line2="127" col2="15" start="12076" end="12080">vstSL</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="127" col1="16" line2="127" col2="16" start="12081" end="12081">(</OP-LEFT-PAREN>
                      <expr line1="127" col1="17" line2="127" col2="17" start="12082" end="12082">
                        <SYMBOL line1="127" col1="17" line2="127" col2="17" start="12082" end="12082">x</SYMBOL>
                      </expr>
                      <OP-COMMA line1="127" col1="18" line2="127" col2="18" start="12083" end="12083">,</OP-COMMA>
                      <expr line1="127" col1="20" line2="127" col2="24" start="12085" end="12089">
                        <SYMBOL line1="127" col1="20" line2="127" col2="24" start="12085" end="12089">shift</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="127" col1="25" line2="127" col2="25" start="12090" end="12090">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-COMMA line1="127" col1="26" line2="127" col2="26" start="12091" end="12091">,</OP-COMMA>
                    <expr line1="127" col1="28" line2="127" col2="47" start="12093" end="12112">
                      <expr line1="127" col1="28" line2="127" col2="32" start="12093" end="12097">
                        <SYMBOL_FUNCTION_CALL line1="127" col1="28" line2="127" col2="32" start="12093" end="12097">vstSL</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="127" col1="33" line2="127" col2="33" start="12098" end="12098">(</OP-LEFT-PAREN>
                      <expr line1="127" col1="34" line2="127" col2="39" start="12099" end="12104">
                        <SYMBOL line1="127" col1="34" line2="127" col2="39" start="12099" end="12104">fitted</SYMBOL>
                      </expr>
                      <OP-COMMA line1="127" col1="40" line2="127" col2="40" start="12105" end="12105">,</OP-COMMA>
                      <expr line1="127" col1="42" line2="127" col2="46" start="12107" end="12111">
                        <SYMBOL line1="127" col1="42" line2="127" col2="46" start="12107" end="12111">shift</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="127" col1="47" line2="127" col2="47" start="12112" end="12112">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="127" col1="48" line2="127" col2="48" start="12113" end="12113">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-BRACE line1="128" col1="5" line2="128" col2="5" start="12165" end="12165">}</OP-RIGHT-BRACE>
                </expr>
              </expr>
            </expr>
            <expr line1="129" col1="5" line2="129" col2="55" start="12260" end="12310">
              <expr line1="129" col1="5" line2="129" col2="10" start="12260" end="12265">
                <SYMBOL_FUNCTION_CALL line1="129" col1="5" line2="129" col2="10" start="12260" end="12265">return</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="129" col1="11" line2="129" col2="11" start="12266" end="12266">(</OP-LEFT-PAREN>
              <expr line1="129" col1="12" line2="129" col2="54" start="12267" end="12309">
                <expr line1="129" col1="12" line2="129" col2="15" start="12267" end="12270">
                  <SYMBOL_FUNCTION_CALL line1="129" col1="12" line2="129" col2="15" start="12267" end="12270">list</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="129" col1="16" line2="129" col2="16" start="12271" end="12271">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="129" col1="17" line2="129" col2="19" start="12272" end="12274">mix</SYMBOL_SUB>
                <EQ_SUB line1="129" col1="20" line2="129" col2="20" start="12275" end="12275">=</EQ_SUB>
                <expr line1="129" col1="21" line2="129" col2="23" start="12276" end="12278">
                  <SYMBOL line1="129" col1="21" line2="129" col2="23" start="12276" end="12278">mix</SYMBOL>
                </expr>
                <OP-COMMA line1="129" col1="24" line2="129" col2="24" start="12279" end="12279">,</OP-COMMA>
                <SYMBOL_SUB line1="129" col1="26" line2="129" col2="28" start="12281" end="12283">cor</SYMBOL_SUB>
                <EQ_SUB line1="129" col1="29" line2="129" col2="29" start="12284" end="12284">=</EQ_SUB>
                <expr line1="129" col1="30" line2="129" col2="38" start="12285" end="12293">
                  <expr line1="129" col1="30" line2="129" col2="33" start="12285" end="12288">
                    <SYMBOL_FUNCTION_CALL line1="129" col1="30" line2="129" col2="33" start="12285" end="12288">diag</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="129" col1="34" line2="129" col2="34" start="12289" end="12289">(</OP-LEFT-PAREN>
                  <expr line1="129" col1="35" line2="129" col2="37" start="12290" end="12292">
                    <SYMBOL line1="129" col1="35" line2="129" col2="37" start="12290" end="12292">cor</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="129" col1="38" line2="129" col2="38" start="12293" end="12293">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="129" col1="39" line2="129" col2="39" start="12294" end="12294">,</OP-COMMA>
                <SYMBOL_SUB line1="129" col1="41" line2="129" col2="46" start="12296" end="12301">fitted</SYMBOL_SUB>
                <EQ_SUB line1="129" col1="47" line2="129" col2="47" start="12302" end="12302">=</EQ_SUB>
                <expr line1="129" col1="48" line2="129" col2="53" start="12303" end="12308">
                  <SYMBOL line1="129" col1="48" line2="129" col2="53" start="12303" end="12308">fitted</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="129" col1="54" line2="129" col2="54" start="12309" end="12309">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="129" col1="55" line2="129" col2="55" start="12310" end="12310">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACE line1="130" col1="3" line2="130" col2="3" start="12353" end="12353">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <OP-RIGHT-BRACE line1="132" col1="1" line2="132" col2="1" start="12541" end="12541">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="134" col1="1" line2="134" col2="80" start="12731" end="12810">#' Collapse technical replicates in a RangedSummarizedExperiment or DESeqDataSet</COMMENT>
  <COMMENT line1="135" col1="1" line2="135" col2="2" start="12826" end="12827">#'</COMMENT>
  <COMMENT line1="136" col1="1" line2="136" col2="66" start="12921" end="12986">#' Collapses the columns in \code{object} by summing within levels</COMMENT>
  <COMMENT line1="137" col1="1" line2="137" col2="68" start="13016" end="13083">#' of a grouping factor \code{groupby}. The purpose of this function</COMMENT>
  <COMMENT line1="138" col1="1" line2="138" col2="73" start="13111" end="13183">#' is to sum up read counts from technical replicates to create an object</COMMENT>
  <COMMENT line1="139" col1="1" line2="139" col2="55" start="13206" end="13260">#' with a single column of read counts for each sample.</COMMENT>
  <COMMENT line1="140" col1="1" line2="140" col2="80" start="13301" end="13380">#' Note: by "technical replicates", we mean multiple sequencing runs of the same</COMMENT>
  <COMMENT line1="141" col1="1" line2="141" col2="69" start="13396" end="13464">#' library, in constrast to "biological replicates" in which multiple</COMMENT>
  <COMMENT line1="142" col1="1" line2="142" col2="57" start="13491" end="13547">#' libraries are prepared from separate biological units.</COMMENT>
  <COMMENT line1="143" col1="1" line2="143" col2="75" start="13586" end="13660">#' Optionally renames the columns of returned object with the levels of the</COMMENT>
  <COMMENT line1="144" col1="1" line2="144" col2="19" start="13681" end="13699">#' grouping factor.</COMMENT>
  <COMMENT line1="145" col1="1" line2="145" col2="49" start="13776" end="13824">#' Note: this function is written very simply and</COMMENT>
  <COMMENT line1="146" col1="1" line2="146" col2="80" start="13871" end="13950">#' can be easily altered to produce other behavior by examining the source code.</COMMENT>
  <COMMENT line1="147" col1="1" line2="147" col2="2" start="13966" end="13967">#'</COMMENT>
  <COMMENT line1="148" col1="1" line2="148" col2="75" start="14061" end="14135">#' @param object A \code{RangedSummarizedExperiment} or \code{DESeqDataSet}</COMMENT>
  <COMMENT line1="149" col1="1" line2="149" col2="69" start="14156" end="14224">#' @param groupby a grouping factor, as long as the columns of object</COMMENT>
  <COMMENT line1="150" col1="1" line2="150" col2="79" start="14251" end="14329">#' @param run optional, the names of each unique column in object. if provided,</COMMENT>
  <COMMENT line1="151" col1="1" line2="151" col2="72" start="14346" end="14417">#' a new column \code{runsCollapsed} will be added to the \code{colData}</COMMENT>
  <COMMENT line1="152" col1="1" line2="152" col2="48" start="14441" end="14488">#' which pastes together the names of \code{run}</COMMENT>
  <COMMENT line1="153" col1="1" line2="153" col2="73" start="14536" end="14608">#' @param renameCols whether to rename the columns of the returned object</COMMENT>
  <COMMENT line1="154" col1="1" line2="154" col2="42" start="14631" end="14672">#' using the levels of the grouping factor</COMMENT>
  <COMMENT line1="155" col1="1" line2="155" col2="2" start="14726" end="14727">#'</COMMENT>
  <COMMENT line1="156" col1="1" line2="156" col2="78" start="14821" end="14898">#' @return the \code{object} with as many columns as levels in \code{groupby}.</COMMENT>
  <COMMENT line1="157" col1="1" line2="157" col2="68" start="14916" end="14983">#' This object has assay/count data which is summed from the various</COMMENT>
  <COMMENT line1="158" col1="1" line2="158" col2="77" start="15011" end="15087">#' columns which are grouped together, and the \code{colData} is subset using</COMMENT>
  <COMMENT line1="159" col1="1" line2="159" col2="53" start="15106" end="15158">#' the first column for each group in \code{groupby}.</COMMENT>
  <COMMENT line1="160" col1="1" line2="160" col2="2" start="15201" end="15202">#'</COMMENT>
  <COMMENT line1="161" col1="1" line2="161" col2="12" start="15296" end="15307">#' @examples</COMMENT>
  <COMMENT line1="162" col1="1" line2="162" col2="2" start="15391" end="15392">#'</COMMENT>
  <COMMENT line1="163" col1="1" line2="163" col2="39" start="15486" end="15524">#' dds &lt;- makeExampleDESeqDataSet(m=12)</COMMENT>
  <COMMENT line1="164" col1="1" line2="164" col2="3" start="15581" end="15583">#' </COMMENT>
  <COMMENT line1="165" col1="1" line2="165" col2="62" start="15676" end="15737">#' # make data with two technical replicates for three samples</COMMENT>
  <COMMENT line1="166" col1="1" line2="166" col2="80" start="15771" end="15850">#' dds$sample &lt;- factor(sample(paste0("sample",rep(1:9, c(2,1,1,2,1,1,2,1,1)))))</COMMENT>
  <COMMENT line1="167" col1="1" line2="167" col2="32" start="15866" end="15897">#' dds$run &lt;- paste0("run",1:12)</COMMENT>
  <COMMENT line1="168" col1="1" line2="168" col2="2" start="15961" end="15962">#'</COMMENT>
  <COMMENT line1="169" col1="1" line2="169" col2="58" start="16056" end="16113">#' ddsColl &lt;- collapseReplicates(dds, dds$sample, dds$run)</COMMENT>
  <COMMENT line1="170" col1="1" line2="170" col2="2" start="16151" end="16152">#'</COMMENT>
  <COMMENT line1="171" col1="1" line2="171" col2="63" start="16246" end="16308">#' # examine the colData and column names of the collapsed data</COMMENT>
  <COMMENT line1="172" col1="1" line2="172" col2="19" start="16341" end="16359">#' colData(ddsColl)</COMMENT>
  <COMMENT line1="173" col1="1" line2="173" col2="20" start="16436" end="16455">#' colnames(ddsColl)</COMMENT>
  <COMMENT line1="174" col1="1" line2="174" col2="2" start="16531" end="16532">#'</COMMENT>
  <COMMENT line1="175" col1="1" line2="175" col2="63" start="16626" end="16688">#' # check that the sum of the counts for "sample1" is the same</COMMENT>
  <COMMENT line1="176" col1="1" line2="176" col2="53" start="16721" end="16773">#' # as the counts in the "sample1" column in ddsColl</COMMENT>
  <COMMENT line1="177" col1="1" line2="177" col2="57" start="16816" end="16872">#' matchFirstLevel &lt;- dds$sample == levels(dds$sample)[1]</COMMENT>
  <COMMENT line1="178" col1="1" line2="178" col2="80" start="16911" end="16990">#' stopifnot(all(rowSums(counts(dds[,matchFirstLevel])) == counts(ddsColl[,1])))</COMMENT>
  <COMMENT line1="179" col1="1" line2="179" col2="3" start="17006" end="17008">#' </COMMENT>
  <COMMENT line1="180" col1="1" line2="180" col2="10" start="17101" end="17110">#' @export</COMMENT>
  <expr line1="181" col1="1" line2="201" col2="1" start="17196" end="19096">
    <expr line1="181" col1="1" line2="181" col2="18" start="17196" end="17213">
      <SYMBOL line1="181" col1="1" line2="181" col2="18" start="17196" end="17213">collapseReplicates</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="181" col1="20" line2="181" col2="21" start="17215" end="17216">&lt;-</LEFT_ASSIGN>
    <expr line1="181" col1="23" line2="201" col2="1" start="17218" end="19096">
      <FUNCTION line1="181" col1="23" line2="181" col2="30" start="17218" end="17225">function</FUNCTION>
      <OP-LEFT-PAREN line1="181" col1="31" line2="181" col2="31" start="17226" end="17226">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="181" col1="32" line2="181" col2="37" start="17227" end="17232">object</SYMBOL_FORMALS>
      <OP-COMMA line1="181" col1="38" line2="181" col2="38" start="17233" end="17233">,</OP-COMMA>
      <SYMBOL_FORMALS line1="181" col1="40" line2="181" col2="46" start="17235" end="17241">groupby</SYMBOL_FORMALS>
      <OP-COMMA line1="181" col1="47" line2="181" col2="47" start="17242" end="17242">,</OP-COMMA>
      <SYMBOL_FORMALS line1="181" col1="49" line2="181" col2="51" start="17244" end="17246">run</SYMBOL_FORMALS>
      <OP-COMMA line1="181" col1="52" line2="181" col2="52" start="17247" end="17247">,</OP-COMMA>
      <SYMBOL_FORMALS line1="181" col1="54" line2="181" col2="63" start="17249" end="17258">renameCols</SYMBOL_FORMALS>
      <EQ_FORMALS line1="181" col1="64" line2="181" col2="64" start="17259" end="17259">=</EQ_FORMALS>
      <expr line1="181" col1="65" line2="181" col2="68" start="17260" end="17263">
        <NUM_CONST line1="181" col1="65" line2="181" col2="68" start="17260" end="17263">TRUE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="181" col1="69" line2="181" col2="69" start="17264" end="17264">)</OP-RIGHT-PAREN>
      <expr line1="181" col1="71" line2="201" col2="1" start="17266" end="19096">
        <OP-LEFT-BRACE line1="181" col1="71" line2="181" col2="71" start="17266" end="17266">{</OP-LEFT-BRACE>
        <expr line1="182" col1="3" line2="182" col2="53" start="17293" end="17343">
          <IF line1="182" col1="3" line2="182" col2="4" start="17293" end="17294">if</IF>
          <OP-LEFT-PAREN line1="182" col1="6" line2="182" col2="6" start="17296" end="17296">(</OP-LEFT-PAREN>
          <expr line1="182" col1="7" line2="182" col2="25" start="17297" end="17315">
            <OP-EXCLAMATION line1="182" col1="7" line2="182" col2="7" start="17297" end="17297">!</OP-EXCLAMATION>
            <expr line1="182" col1="8" line2="182" col2="25" start="17298" end="17315">
              <expr line1="182" col1="8" line2="182" col2="16" start="17298" end="17306">
                <SYMBOL_FUNCTION_CALL line1="182" col1="8" line2="182" col2="16" start="17298" end="17306">is.factor</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="182" col1="17" line2="182" col2="17" start="17307" end="17307">(</OP-LEFT-PAREN>
              <expr line1="182" col1="18" line2="182" col2="24" start="17308" end="17314">
                <SYMBOL line1="182" col1="18" line2="182" col2="24" start="17308" end="17314">groupby</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="182" col1="25" line2="182" col2="25" start="17315" end="17315">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="182" col1="26" line2="182" col2="26" start="17316" end="17316">)</OP-RIGHT-PAREN>
          <expr line1="182" col1="28" line2="182" col2="53" start="17318" end="17343">
            <expr line1="182" col1="28" line2="182" col2="34" start="17318" end="17324">
              <SYMBOL line1="182" col1="28" line2="182" col2="34" start="17318" end="17324">groupby</SYMBOL>
            </expr>
            <LEFT_ASSIGN line1="182" col1="36" line2="182" col2="37" start="17326" end="17327">&lt;-</LEFT_ASSIGN>
            <expr line1="182" col1="39" line2="182" col2="53" start="17329" end="17343">
              <expr line1="182" col1="39" line2="182" col2="44" start="17329" end="17334">
                <SYMBOL_FUNCTION_CALL line1="182" col1="39" line2="182" col2="44" start="17329" end="17334">factor</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="182" col1="45" line2="182" col2="45" start="17335" end="17335">(</OP-LEFT-PAREN>
              <expr line1="182" col1="46" line2="182" col2="52" start="17336" end="17342">
                <SYMBOL line1="182" col1="46" line2="182" col2="52" start="17336" end="17342">groupby</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="182" col1="53" line2="182" col2="53" start="17343" end="17343">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="183" col1="3" line2="183" col2="32" start="17388" end="17417">
          <expr line1="183" col1="3" line2="183" col2="9" start="17388" end="17394">
            <SYMBOL line1="183" col1="3" line2="183" col2="9" start="17388" end="17394">groupby</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="183" col1="11" line2="183" col2="12" start="17396" end="17397">&lt;-</LEFT_ASSIGN>
          <expr line1="183" col1="14" line2="183" col2="32" start="17399" end="17417">
            <expr line1="183" col1="14" line2="183" col2="23" start="17399" end="17408">
              <SYMBOL_FUNCTION_CALL line1="183" col1="14" line2="183" col2="23" start="17399" end="17408">droplevels</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="183" col1="24" line2="183" col2="24" start="17409" end="17409">(</OP-LEFT-PAREN>
            <expr line1="183" col1="25" line2="183" col2="31" start="17410" end="17416">
              <SYMBOL line1="183" col1="25" line2="183" col2="31" start="17410" end="17416">groupby</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="183" col1="32" line2="183" col2="32" start="17417" end="17417">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="184" col1="3" line2="184" col2="44" start="17483" end="17524">
          <expr line1="184" col1="3" line2="184" col2="11" start="17483" end="17491">
            <SYMBOL_FUNCTION_CALL line1="184" col1="3" line2="184" col2="11" start="17483" end="17491">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="184" col1="12" line2="184" col2="12" start="17492" end="17492">(</OP-LEFT-PAREN>
          <expr line1="184" col1="13" line2="184" col2="43" start="17493" end="17523">
            <expr line1="184" col1="13" line2="184" col2="27" start="17493" end="17507">
              <expr line1="184" col1="13" line2="184" col2="18" start="17493" end="17498">
                <SYMBOL_FUNCTION_CALL line1="184" col1="13" line2="184" col2="18" start="17493" end="17498">length</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="184" col1="19" line2="184" col2="19" start="17499" end="17499">(</OP-LEFT-PAREN>
              <expr line1="184" col1="20" line2="184" col2="26" start="17500" end="17506">
                <SYMBOL line1="184" col1="20" line2="184" col2="26" start="17500" end="17506">groupby</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="184" col1="27" line2="184" col2="27" start="17507" end="17507">)</OP-RIGHT-PAREN>
            </expr>
            <EQ line1="184" col1="29" line2="184" col2="30" start="17509" end="17510">==</EQ>
            <expr line1="184" col1="32" line2="184" col2="43" start="17512" end="17523">
              <expr line1="184" col1="32" line2="184" col2="35" start="17512" end="17515">
                <SYMBOL_FUNCTION_CALL line1="184" col1="32" line2="184" col2="35" start="17512" end="17515">ncol</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="184" col1="36" line2="184" col2="36" start="17516" end="17516">(</OP-LEFT-PAREN>
              <expr line1="184" col1="37" line2="184" col2="42" start="17517" end="17522">
                <SYMBOL line1="184" col1="37" line2="184" col2="42" start="17517" end="17522">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="184" col1="43" line2="184" col2="43" start="17523" end="17523">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="184" col1="44" line2="184" col2="44" start="17524" end="17524">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="185" col1="3" line2="185" col2="42" start="17578" end="17617">
          <expr line1="185" col1="3" line2="185" col2="4" start="17578" end="17579">
            <SYMBOL line1="185" col1="3" line2="185" col2="4" start="17578" end="17579">sp</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="185" col1="6" line2="185" col2="7" start="17581" end="17582">&lt;-</LEFT_ASSIGN>
          <expr line1="185" col1="9" line2="185" col2="42" start="17584" end="17617">
            <expr line1="185" col1="9" line2="185" col2="13" start="17584" end="17588">
              <SYMBOL_FUNCTION_CALL line1="185" col1="9" line2="185" col2="13" start="17584" end="17588">split</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="185" col1="14" line2="185" col2="14" start="17589" end="17589">(</OP-LEFT-PAREN>
            <expr line1="185" col1="15" line2="185" col2="32" start="17590" end="17607">
              <expr line1="185" col1="15" line2="185" col2="17" start="17590" end="17592">
                <SYMBOL_FUNCTION_CALL line1="185" col1="15" line2="185" col2="17" start="17590" end="17592">seq</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="185" col1="18" line2="185" col2="18" start="17593" end="17593">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="185" col1="19" line2="185" col2="23" start="17594" end="17598">along</SYMBOL_SUB>
              <EQ_SUB line1="185" col1="24" line2="185" col2="24" start="17599" end="17599">=</EQ_SUB>
              <expr line1="185" col1="25" line2="185" col2="31" start="17600" end="17606">
                <SYMBOL line1="185" col1="25" line2="185" col2="31" start="17600" end="17606">groupby</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="185" col1="32" line2="185" col2="32" start="17607" end="17607">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="185" col1="33" line2="185" col2="33" start="17608" end="17608">,</OP-COMMA>
            <expr line1="185" col1="35" line2="185" col2="41" start="17610" end="17616">
              <SYMBOL line1="185" col1="35" line2="185" col2="41" start="17610" end="17616">groupby</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="185" col1="42" line2="185" col2="42" start="17617" end="17617">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="186" col1="3" line2="186" col2="76" start="17673" end="17746">
          <expr line1="186" col1="3" line2="186" col2="11" start="17673" end="17681">
            <SYMBOL line1="186" col1="3" line2="186" col2="11" start="17673" end="17681">countdata</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="186" col1="13" line2="186" col2="14" start="17683" end="17684">&lt;-</LEFT_ASSIGN>
          <expr line1="186" col1="16" line2="186" col2="76" start="17686" end="17746">
            <expr line1="186" col1="16" line2="186" col2="21" start="17686" end="17691">
              <SYMBOL_FUNCTION_CALL line1="186" col1="16" line2="186" col2="21" start="17686" end="17691">sapply</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="186" col1="22" line2="186" col2="22" start="17692" end="17692">(</OP-LEFT-PAREN>
            <expr line1="186" col1="23" line2="186" col2="24" start="17693" end="17694">
              <SYMBOL line1="186" col1="23" line2="186" col2="24" start="17693" end="17694">sp</SYMBOL>
            </expr>
            <OP-COMMA line1="186" col1="25" line2="186" col2="25" start="17695" end="17695">,</OP-COMMA>
            <expr line1="186" col1="27" line2="186" col2="75" start="17697" end="17745">
              <FUNCTION line1="186" col1="27" line2="186" col2="34" start="17697" end="17704">function</FUNCTION>
              <OP-LEFT-PAREN line1="186" col1="35" line2="186" col2="35" start="17705" end="17705">(</OP-LEFT-PAREN>
              <SYMBOL_FORMALS line1="186" col1="36" line2="186" col2="36" start="17706" end="17706">i</SYMBOL_FORMALS>
              <OP-RIGHT-PAREN line1="186" col1="37" line2="186" col2="37" start="17707" end="17707">)</OP-RIGHT-PAREN>
              <expr line1="186" col1="39" line2="186" col2="75" start="17709" end="17745">
                <expr line1="186" col1="39" line2="186" col2="45" start="17709" end="17715">
                  <SYMBOL_FUNCTION_CALL line1="186" col1="39" line2="186" col2="45" start="17709" end="17715">rowSums</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="186" col1="46" line2="186" col2="46" start="17716" end="17716">(</OP-LEFT-PAREN>
                <expr line1="186" col1="47" line2="186" col2="74" start="17717" end="17744">
                  <expr line1="186" col1="47" line2="186" col2="59" start="17717" end="17729">
                    <expr line1="186" col1="47" line2="186" col2="51" start="17717" end="17721">
                      <SYMBOL_FUNCTION_CALL line1="186" col1="47" line2="186" col2="51" start="17717" end="17721">assay</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="186" col1="52" line2="186" col2="52" start="17722" end="17722">(</OP-LEFT-PAREN>
                    <expr line1="186" col1="53" line2="186" col2="58" start="17723" end="17728">
                      <SYMBOL line1="186" col1="53" line2="186" col2="58" start="17723" end="17728">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="186" col1="59" line2="186" col2="59" start="17729" end="17729">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-LEFT-BRACKET line1="186" col1="60" line2="186" col2="60" start="17730" end="17730">[</OP-LEFT-BRACKET>
                  <OP-COMMA line1="186" col1="61" line2="186" col2="61" start="17731" end="17731">,</OP-COMMA>
                  <expr line1="186" col1="62" line2="186" col2="62" start="17732" end="17732">
                    <SYMBOL line1="186" col1="62" line2="186" col2="62" start="17732" end="17732">i</SYMBOL>
                  </expr>
                  <OP-COMMA line1="186" col1="63" line2="186" col2="63" start="17733" end="17733">,</OP-COMMA>
                  <SYMBOL_SUB line1="186" col1="64" line2="186" col2="67" start="17734" end="17737">drop</SYMBOL_SUB>
                  <EQ_SUB line1="186" col1="68" line2="186" col2="68" start="17738" end="17738">=</EQ_SUB>
                  <expr line1="186" col1="69" line2="186" col2="73" start="17739" end="17743">
                    <NUM_CONST line1="186" col1="69" line2="186" col2="73" start="17739" end="17743">FALSE</NUM_CONST>
                  </expr>
                  <OP-RIGHT-BRACKET line1="186" col1="74" line2="186" col2="74" start="17744" end="17744">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="186" col1="75" line2="186" col2="75" start="17745" end="17745">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="186" col1="76" line2="186" col2="76" start="17746" end="17746">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="187" col1="3" line2="187" col2="30" start="17768" end="17795">
          <expr line1="187" col1="3" line2="187" col2="17" start="17768" end="17782">
            <expr line1="187" col1="3" line2="187" col2="6" start="17768" end="17771">
              <SYMBOL_FUNCTION_CALL line1="187" col1="3" line2="187" col2="6" start="17768" end="17771">mode</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="187" col1="7" line2="187" col2="7" start="17772" end="17772">(</OP-LEFT-PAREN>
            <expr line1="187" col1="8" line2="187" col2="16" start="17773" end="17781">
              <SYMBOL line1="187" col1="8" line2="187" col2="16" start="17773" end="17781">countdata</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="187" col1="17" line2="187" col2="17" start="17782" end="17782">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="187" col1="19" line2="187" col2="20" start="17784" end="17785">&lt;-</LEFT_ASSIGN>
          <expr line1="187" col1="22" line2="187" col2="30" start="17787" end="17795">
            <STR_CONST line1="187" col1="22" line2="187" col2="30" start="17787" end="17795">"integer"</STR_CONST>
          </expr>
        </expr>
        <expr line1="188" col1="3" line2="188" col2="34" start="17863" end="17894">
          <expr line1="188" col1="3" line2="188" col2="12" start="17863" end="17872">
            <SYMBOL line1="188" col1="3" line2="188" col2="12" start="17863" end="17872">colsToKeep</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="188" col1="14" line2="188" col2="15" start="17874" end="17875">&lt;-</LEFT_ASSIGN>
          <expr line1="188" col1="17" line2="188" col2="34" start="17877" end="17894">
            <expr line1="188" col1="17" line2="188" col2="22" start="17877" end="17882">
              <SYMBOL_FUNCTION_CALL line1="188" col1="17" line2="188" col2="22" start="17877" end="17882">sapply</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="188" col1="23" line2="188" col2="23" start="17883" end="17883">(</OP-LEFT-PAREN>
            <expr line1="188" col1="24" line2="188" col2="25" start="17884" end="17885">
              <SYMBOL line1="188" col1="24" line2="188" col2="25" start="17884" end="17885">sp</SYMBOL>
            </expr>
            <OP-COMMA line1="188" col1="26" line2="188" col2="26" start="17886" end="17886">,</OP-COMMA>
            <expr line1="188" col1="28" line2="188" col2="30" start="17888" end="17890">
              <SYMBOL line1="188" col1="28" line2="188" col2="30" start="17888" end="17890">`[`</SYMBOL>
            </expr>
            <OP-COMMA line1="188" col1="31" line2="188" col2="31" start="17891" end="17891">,</OP-COMMA>
            <expr line1="188" col1="33" line2="188" col2="33" start="17893" end="17893">
              <NUM_CONST line1="188" col1="33" line2="188" col2="33" start="17893" end="17893">1</NUM_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="188" col1="34" line2="188" col2="34" start="17894" end="17894">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="189" col1="3" line2="189" col2="34" start="17958" end="17989">
          <expr line1="189" col1="3" line2="189" col2="11" start="17958" end="17966">
            <SYMBOL line1="189" col1="3" line2="189" col2="11" start="17958" end="17966">collapsed</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="189" col1="13" line2="189" col2="14" start="17968" end="17969">&lt;-</LEFT_ASSIGN>
          <expr line1="189" col1="16" line2="189" col2="34" start="17971" end="17989">
            <expr line1="189" col1="16" line2="189" col2="21" start="17971" end="17976">
              <SYMBOL line1="189" col1="16" line2="189" col2="21" start="17971" end="17976">object</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="189" col1="22" line2="189" col2="22" start="17977" end="17977">[</OP-LEFT-BRACKET>
            <OP-COMMA line1="189" col1="23" line2="189" col2="23" start="17978" end="17978">,</OP-COMMA>
            <expr line1="189" col1="24" line2="189" col2="33" start="17979" end="17988">
              <SYMBOL line1="189" col1="24" line2="189" col2="33" start="17979" end="17988">colsToKeep</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="189" col1="34" line2="189" col2="34" start="17989" end="17989">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="190" col1="3" line2="190" col2="44" start="18053" end="18094">
          <expr line1="190" col1="3" line2="190" col2="21" start="18053" end="18071">
            <expr line1="190" col1="3" line2="190" col2="10" start="18053" end="18060">
              <SYMBOL_FUNCTION_CALL line1="190" col1="3" line2="190" col2="10" start="18053" end="18060">dimnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="190" col1="11" line2="190" col2="11" start="18061" end="18061">(</OP-LEFT-PAREN>
            <expr line1="190" col1="12" line2="190" col2="20" start="18062" end="18070">
              <SYMBOL line1="190" col1="12" line2="190" col2="20" start="18062" end="18070">countdata</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="190" col1="21" line2="190" col2="21" start="18071" end="18071">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="190" col1="23" line2="190" col2="24" start="18073" end="18074">&lt;-</LEFT_ASSIGN>
          <expr line1="190" col1="26" line2="190" col2="44" start="18076" end="18094">
            <expr line1="190" col1="26" line2="190" col2="33" start="18076" end="18083">
              <SYMBOL_FUNCTION_CALL line1="190" col1="26" line2="190" col2="33" start="18076" end="18083">dimnames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="190" col1="34" line2="190" col2="34" start="18084" end="18084">(</OP-LEFT-PAREN>
            <expr line1="190" col1="35" line2="190" col2="43" start="18085" end="18093">
              <SYMBOL line1="190" col1="35" line2="190" col2="43" start="18085" end="18093">collapsed</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="190" col1="44" line2="190" col2="44" start="18094" end="18094">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="191" col1="3" line2="191" col2="31" start="18148" end="18176">
          <expr line1="191" col1="3" line2="191" col2="18" start="18148" end="18163">
            <expr line1="191" col1="3" line2="191" col2="7" start="18148" end="18152">
              <SYMBOL_FUNCTION_CALL line1="191" col1="3" line2="191" col2="7" start="18148" end="18152">assay</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="191" col1="8" line2="191" col2="8" start="18153" end="18153">(</OP-LEFT-PAREN>
            <expr line1="191" col1="9" line2="191" col2="17" start="18154" end="18162">
              <SYMBOL line1="191" col1="9" line2="191" col2="17" start="18154" end="18162">collapsed</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="191" col1="18" line2="191" col2="18" start="18163" end="18163">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="191" col1="20" line2="191" col2="21" start="18165" end="18166">&lt;-</LEFT_ASSIGN>
          <expr line1="191" col1="23" line2="191" col2="31" start="18168" end="18176">
            <SYMBOL line1="191" col1="23" line2="191" col2="31" start="18168" end="18176">countdata</SYMBOL>
          </expr>
        </expr>
        <expr line1="192" col1="3" line2="195" col2="3" start="18243" end="18528">
          <IF line1="192" col1="3" line2="192" col2="4" start="18243" end="18244">if</IF>
          <OP-LEFT-PAREN line1="192" col1="6" line2="192" col2="6" start="18246" end="18246">(</OP-LEFT-PAREN>
          <expr line1="192" col1="7" line2="192" col2="19" start="18247" end="18259">
            <OP-EXCLAMATION line1="192" col1="7" line2="192" col2="7" start="18247" end="18247">!</OP-EXCLAMATION>
            <expr line1="192" col1="8" line2="192" col2="19" start="18248" end="18259">
              <expr line1="192" col1="8" line2="192" col2="14" start="18248" end="18254">
                <SYMBOL_FUNCTION_CALL line1="192" col1="8" line2="192" col2="14" start="18248" end="18254">missing</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="192" col1="15" line2="192" col2="15" start="18255" end="18255">(</OP-LEFT-PAREN>
              <expr line1="192" col1="16" line2="192" col2="18" start="18256" end="18258">
                <SYMBOL line1="192" col1="16" line2="192" col2="18" start="18256" end="18258">run</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="192" col1="19" line2="192" col2="19" start="18259" end="18259">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="192" col1="20" line2="192" col2="20" start="18260" end="18260">)</OP-RIGHT-PAREN>
          <expr line1="192" col1="22" line2="195" col2="3" start="18262" end="18528">
            <OP-LEFT-BRACE line1="192" col1="22" line2="192" col2="22" start="18262" end="18262">{</OP-LEFT-BRACE>
            <expr line1="193" col1="5" line2="193" col2="45" start="18340" end="18380">
              <expr line1="193" col1="5" line2="193" col2="13" start="18340" end="18348">
                <SYMBOL_FUNCTION_CALL line1="193" col1="5" line2="193" col2="13" start="18340" end="18348">stopifnot</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="193" col1="14" line2="193" col2="14" start="18349" end="18349">(</OP-LEFT-PAREN>
              <expr line1="193" col1="15" line2="193" col2="44" start="18350" end="18379">
                <expr line1="193" col1="15" line2="193" col2="29" start="18350" end="18364">
                  <expr line1="193" col1="15" line2="193" col2="20" start="18350" end="18355">
                    <SYMBOL_FUNCTION_CALL line1="193" col1="15" line2="193" col2="20" start="18350" end="18355">length</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="193" col1="21" line2="193" col2="21" start="18356" end="18356">(</OP-LEFT-PAREN>
                  <expr line1="193" col1="22" line2="193" col2="28" start="18357" end="18363">
                    <SYMBOL line1="193" col1="22" line2="193" col2="28" start="18357" end="18363">groupby</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="193" col1="29" line2="193" col2="29" start="18364" end="18364">)</OP-RIGHT-PAREN>
                </expr>
                <EQ line1="193" col1="31" line2="193" col2="32" start="18366" end="18367">==</EQ>
                <expr line1="193" col1="34" line2="193" col2="44" start="18369" end="18379">
                  <expr line1="193" col1="34" line2="193" col2="39" start="18369" end="18374">
                    <SYMBOL_FUNCTION_CALL line1="193" col1="34" line2="193" col2="39" start="18369" end="18374">length</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="193" col1="40" line2="193" col2="40" start="18375" end="18375">(</OP-LEFT-PAREN>
                  <expr line1="193" col1="41" line2="193" col2="43" start="18376" end="18378">
                    <SYMBOL line1="193" col1="41" line2="193" col2="43" start="18376" end="18378">run</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="193" col1="44" line2="193" col2="44" start="18379" end="18379">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="193" col1="45" line2="193" col2="45" start="18380" end="18380">)</OP-RIGHT-PAREN>
            </expr>
            <expr line1="194" col1="5" line2="194" col2="90" start="18435" end="18520">
              <expr line1="194" col1="5" line2="194" col2="36" start="18435" end="18466">
                <expr line1="194" col1="5" line2="194" col2="22" start="18435" end="18452">
                  <expr line1="194" col1="5" line2="194" col2="11" start="18435" end="18441">
                    <SYMBOL_FUNCTION_CALL line1="194" col1="5" line2="194" col2="11" start="18435" end="18441">colData</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="194" col1="12" line2="194" col2="12" start="18442" end="18442">(</OP-LEFT-PAREN>
                  <expr line1="194" col1="13" line2="194" col2="21" start="18443" end="18451">
                    <SYMBOL line1="194" col1="13" line2="194" col2="21" start="18443" end="18451">collapsed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="194" col1="22" line2="194" col2="22" start="18452" end="18452">)</OP-RIGHT-PAREN>
                </expr>
                <OP-DOLLAR line1="194" col1="23" line2="194" col2="23" start="18453" end="18453">$</OP-DOLLAR>
                <SYMBOL line1="194" col1="24" line2="194" col2="36" start="18454" end="18466">runsCollapsed</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="194" col1="38" line2="194" col2="39" start="18468" end="18469">&lt;-</LEFT_ASSIGN>
              <expr line1="194" col1="41" line2="194" col2="90" start="18471" end="18520">
                <expr line1="194" col1="41" line2="194" col2="46" start="18471" end="18476">
                  <SYMBOL_FUNCTION_CALL line1="194" col1="41" line2="194" col2="46" start="18471" end="18476">sapply</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="194" col1="47" line2="194" col2="47" start="18477" end="18477">(</OP-LEFT-PAREN>
                <expr line1="194" col1="48" line2="194" col2="49" start="18478" end="18479">
                  <SYMBOL line1="194" col1="48" line2="194" col2="49" start="18478" end="18479">sp</SYMBOL>
                </expr>
                <OP-COMMA line1="194" col1="50" line2="194" col2="50" start="18480" end="18480">,</OP-COMMA>
                <expr line1="194" col1="52" line2="194" col2="89" start="18482" end="18519">
                  <FUNCTION line1="194" col1="52" line2="194" col2="59" start="18482" end="18489">function</FUNCTION>
                  <OP-LEFT-PAREN line1="194" col1="60" line2="194" col2="60" start="18490" end="18490">(</OP-LEFT-PAREN>
                  <SYMBOL_FORMALS line1="194" col1="61" line2="194" col2="61" start="18491" end="18491">i</SYMBOL_FORMALS>
                  <OP-RIGHT-PAREN line1="194" col1="62" line2="194" col2="62" start="18492" end="18492">)</OP-RIGHT-PAREN>
                  <expr line1="194" col1="64" line2="194" col2="89" start="18494" end="18519">
                    <expr line1="194" col1="64" line2="194" col2="68" start="18494" end="18498">
                      <SYMBOL_FUNCTION_CALL line1="194" col1="64" line2="194" col2="68" start="18494" end="18498">paste</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="194" col1="69" line2="194" col2="69" start="18499" end="18499">(</OP-LEFT-PAREN>
                    <expr line1="194" col1="70" line2="194" col2="75" start="18500" end="18505">
                      <expr line1="194" col1="70" line2="194" col2="72" start="18500" end="18502">
                        <SYMBOL line1="194" col1="70" line2="194" col2="72" start="18500" end="18502">run</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="194" col1="73" line2="194" col2="73" start="18503" end="18503">[</OP-LEFT-BRACKET>
                      <expr line1="194" col1="74" line2="194" col2="74" start="18504" end="18504">
                        <SYMBOL line1="194" col1="74" line2="194" col2="74" start="18504" end="18504">i</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="194" col1="75" line2="194" col2="75" start="18505" end="18505">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="194" col1="76" line2="194" col2="76" start="18506" end="18506">,</OP-COMMA>
                    <SYMBOL_SUB line1="194" col1="77" line2="194" col2="84" start="18507" end="18514">collapse</SYMBOL_SUB>
                    <EQ_SUB line1="194" col1="85" line2="194" col2="85" start="18515" end="18515">=</EQ_SUB>
                    <expr line1="194" col1="86" line2="194" col2="88" start="18516" end="18518">
                      <STR_CONST line1="194" col1="86" line2="194" col2="88" start="18516" end="18518">","</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="194" col1="89" line2="194" col2="89" start="18519" end="18519">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="194" col1="90" line2="194" col2="90" start="18520" end="18520">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="195" col1="3" line2="195" col2="3" start="18528" end="18528">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="196" col1="3" line2="198" col2="3" start="18623" end="18813">
          <IF line1="196" col1="3" line2="196" col2="4" start="18623" end="18624">if</IF>
          <OP-LEFT-PAREN line1="196" col1="6" line2="196" col2="6" start="18626" end="18626">(</OP-LEFT-PAREN>
          <expr line1="196" col1="7" line2="196" col2="16" start="18627" end="18636">
            <SYMBOL line1="196" col1="7" line2="196" col2="16" start="18627" end="18636">renameCols</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="196" col1="17" line2="196" col2="17" start="18637" end="18637">)</OP-RIGHT-PAREN>
          <expr line1="196" col1="19" line2="198" col2="3" start="18639" end="18813">
            <OP-LEFT-BRACE line1="196" col1="19" line2="196" col2="19" start="18639" end="18639">{</OP-LEFT-BRACE>
            <expr line1="197" col1="5" line2="197" col2="42" start="18720" end="18757">
              <expr line1="197" col1="5" line2="197" col2="23" start="18720" end="18738">
                <expr line1="197" col1="5" line2="197" col2="12" start="18720" end="18727">
                  <SYMBOL_FUNCTION_CALL line1="197" col1="5" line2="197" col2="12" start="18720" end="18727">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="197" col1="13" line2="197" col2="13" start="18728" end="18728">(</OP-LEFT-PAREN>
                <expr line1="197" col1="14" line2="197" col2="22" start="18729" end="18737">
                  <SYMBOL line1="197" col1="14" line2="197" col2="22" start="18729" end="18737">collapsed</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="197" col1="23" line2="197" col2="23" start="18738" end="18738">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="197" col1="25" line2="197" col2="26" start="18740" end="18741">&lt;-</LEFT_ASSIGN>
              <expr line1="197" col1="28" line2="197" col2="42" start="18743" end="18757">
                <expr line1="197" col1="28" line2="197" col2="33" start="18743" end="18748">
                  <SYMBOL_FUNCTION_CALL line1="197" col1="28" line2="197" col2="33" start="18743" end="18748">levels</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="197" col1="34" line2="197" col2="34" start="18749" end="18749">(</OP-LEFT-PAREN>
                <expr line1="197" col1="35" line2="197" col2="41" start="18750" end="18756">
                  <SYMBOL line1="197" col1="35" line2="197" col2="41" start="18750" end="18756">groupby</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="197" col1="42" line2="197" col2="42" start="18757" end="18757">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="198" col1="3" line2="198" col2="3" start="18813" end="18813">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="199" col1="3" line2="199" col2="80" start="18908" end="18985">
          <expr line1="199" col1="3" line2="199" col2="11" start="18908" end="18916">
            <SYMBOL_FUNCTION_CALL line1="199" col1="3" line2="199" col2="11" start="18908" end="18916">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="199" col1="12" line2="199" col2="12" start="18917" end="18917">(</OP-LEFT-PAREN>
          <expr line1="199" col1="13" line2="199" col2="79" start="18918" end="18984">
            <expr line1="199" col1="13" line2="199" col2="42" start="18918" end="18947">
              <expr line1="199" col1="13" line2="199" col2="15" start="18918" end="18920">
                <SYMBOL_FUNCTION_CALL line1="199" col1="13" line2="199" col2="15" start="18918" end="18920">sum</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="199" col1="16" line2="199" col2="16" start="18921" end="18921">(</OP-LEFT-PAREN>
              <expr line1="199" col1="17" line2="199" col2="41" start="18922" end="18946">
                <expr line1="199" col1="17" line2="199" col2="26" start="18922" end="18931">
                  <SYMBOL_FUNCTION_CALL line1="199" col1="17" line2="199" col2="26" start="18922" end="18931">as.numeric</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="199" col1="27" line2="199" col2="27" start="18932" end="18932">(</OP-LEFT-PAREN>
                <expr line1="199" col1="28" line2="199" col2="40" start="18933" end="18945">
                  <expr line1="199" col1="28" line2="199" col2="32" start="18933" end="18937">
                    <SYMBOL_FUNCTION_CALL line1="199" col1="28" line2="199" col2="32" start="18933" end="18937">assay</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="199" col1="33" line2="199" col2="33" start="18938" end="18938">(</OP-LEFT-PAREN>
                  <expr line1="199" col1="34" line2="199" col2="39" start="18939" end="18944">
                    <SYMBOL line1="199" col1="34" line2="199" col2="39" start="18939" end="18944">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="199" col1="40" line2="199" col2="40" start="18945" end="18945">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="199" col1="41" line2="199" col2="41" start="18946" end="18946">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="199" col1="42" line2="199" col2="42" start="18947" end="18947">)</OP-RIGHT-PAREN>
            </expr>
            <EQ line1="199" col1="44" line2="199" col2="45" start="18949" end="18950">==</EQ>
            <expr line1="199" col1="47" line2="199" col2="79" start="18952" end="18984">
              <expr line1="199" col1="47" line2="199" col2="49" start="18952" end="18954">
                <SYMBOL_FUNCTION_CALL line1="199" col1="47" line2="199" col2="49" start="18952" end="18954">sum</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="199" col1="50" line2="199" col2="50" start="18955" end="18955">(</OP-LEFT-PAREN>
              <expr line1="199" col1="51" line2="199" col2="78" start="18956" end="18983">
                <expr line1="199" col1="51" line2="199" col2="60" start="18956" end="18965">
                  <SYMBOL_FUNCTION_CALL line1="199" col1="51" line2="199" col2="60" start="18956" end="18965">as.numeric</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="199" col1="61" line2="199" col2="61" start="18966" end="18966">(</OP-LEFT-PAREN>
                <expr line1="199" col1="62" line2="199" col2="77" start="18967" end="18982">
                  <expr line1="199" col1="62" line2="199" col2="66" start="18967" end="18971">
                    <SYMBOL_FUNCTION_CALL line1="199" col1="62" line2="199" col2="66" start="18967" end="18971">assay</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="199" col1="67" line2="199" col2="67" start="18972" end="18972">(</OP-LEFT-PAREN>
                  <expr line1="199" col1="68" line2="199" col2="76" start="18973" end="18981">
                    <SYMBOL line1="199" col1="68" line2="199" col2="76" start="18973" end="18981">collapsed</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="199" col1="77" line2="199" col2="77" start="18982" end="18982">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="199" col1="78" line2="199" col2="78" start="18983" end="18983">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="199" col1="79" line2="199" col2="79" start="18984" end="18984">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="199" col1="80" line2="199" col2="80" start="18985" end="18985">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="200" col1="3" line2="200" col2="11" start="19003" end="19011">
          <SYMBOL line1="200" col1="3" line2="200" col2="11" start="19003" end="19011">collapsed</SYMBOL>
        </expr>
        <OP-RIGHT-BRACE line1="201" col1="1" line2="201" col2="1" start="19096" end="19096">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="203" col1="1" line2="203" col2="60" start="19286" end="19345">#' FPKM: fragments per kilobase per million mapped fragments</COMMENT>
  <COMMENT line1="204" col1="1" line2="204" col2="2" start="19381" end="19382">#'</COMMENT>
  <COMMENT line1="205" col1="1" line2="205" col2="60" start="19476" end="19535">#' The following function returns fragment counts normalized</COMMENT>
  <COMMENT line1="206" col1="1" line2="206" col2="62" start="19571" end="19632">#' per kilobase of feature length per million mapped fragments</COMMENT>
  <COMMENT line1="207" col1="1" line2="207" col2="59" start="19666" end="19724">#' (by default using a robust estimate of the library size,</COMMENT>
  <COMMENT line1="208" col1="1" line2="208" col2="44" start="19761" end="19804">#' as in \code{\link{estimateSizeFactors}}).</COMMENT>
  <COMMENT line1="209" col1="1" line2="209" col2="2" start="19856" end="19857">#'</COMMENT>
  <COMMENT line1="210" col1="1" line2="210" col2="73" start="19951" end="20023">#' The length of the features (e.g. genes) is calculated one of two ways:</COMMENT>
  <COMMENT line1="211" col1="1" line2="211" col2="70" start="20046" end="20115">#' (1) If there is a matrix named "avgTxLength" in \code{assays(dds)},</COMMENT>
  <COMMENT line1="212" col1="1" line2="212" col2="57" start="20141" end="20197">#' this will take precedence in the length normalization.</COMMENT>
  <COMMENT line1="213" col1="1" line2="213" col2="55" start="20236" end="20290">#' This occurs when using the tximport-DESeq2 pipeline.</COMMENT>
  <COMMENT line1="214" col1="1" line2="214" col2="47" start="20331" end="20377">#' (2) Otherwise, feature length is calculated </COMMENT>
  <COMMENT line1="215" col1="1" line2="215" col2="47" start="20426" end="20472">#' from the \code{rowRanges} of the dds object,</COMMENT>
  <COMMENT line1="216" col1="1" line2="216" col2="68" start="20521" end="20588">#' if a column \code{basepairs} is not present in \code{mcols(dds)}.</COMMENT>
  <COMMENT line1="217" col1="1" line2="217" col2="86" start="20616" end="20701">#' The calculated length is the number of basepairs in the union of all \code{GRanges}</COMMENT>
  <COMMENT line1="218" col1="1" line2="218" col2="51" start="20711" end="20761">#' assigned to a given row of \code{object}, e.g., </COMMENT>
  <COMMENT line1="219" col1="1" line2="219" col2="55" start="20806" end="20860">#' the union of all basepairs of exons of a given gene.</COMMENT>
  <COMMENT line1="220" col1="1" line2="220" col2="63" start="20901" end="20963">#' Note that the second approach over-estimates the gene length</COMMENT>
  <COMMENT line1="221" col1="1" line2="221" col2="74" start="20996" end="21069">#' (average transcript length, weighted by abundance is a more appropriate</COMMENT>
  <COMMENT line1="222" col1="1" line2="222" col2="94" start="21091" end="21184">#' normalization for gene counts), and so the FPKM will be an underestimate of the true value.</COMMENT>
  <COMMENT line1="223" col1="1" line2="223" col2="3" start="21186" end="21188">#' </COMMENT>
  <COMMENT line1="224" col1="1" line2="224" col2="86" start="21281" end="21366">#' Note that, when the read/fragment counting has inter-feature dependencies, a strict</COMMENT>
  <COMMENT line1="225" col1="1" line2="225" col2="71" start="21376" end="21446">#' normalization would not incorporate the basepairs of a feature which</COMMENT>
  <COMMENT line1="226" col1="1" line2="226" col2="75" start="21471" end="21545">#' overlap another feature. This inter-feature dependence is not taken into</COMMENT>
  <COMMENT line1="227" col1="1" line2="227" col2="60" start="21566" end="21625">#' consideration in the internal union basepair calculation.</COMMENT>
  <COMMENT line1="228" col1="1" line2="228" col2="2" start="21661" end="21662">#'</COMMENT>
  <COMMENT line1="229" col1="1" line2="229" col2="38" start="21756" end="21793">#' @param object a \code{DESeqDataSet}</COMMENT>
  <COMMENT line1="230" col1="1" line2="230" col2="57" start="21851" end="21907">#' @param robust whether to use size factors to normalize</COMMENT>
  <COMMENT line1="231" col1="1" line2="231" col2="56" start="21946" end="22001">#' rather than taking the column sums of the raw counts,</COMMENT>
  <COMMENT line1="232" col1="1" line2="232" col2="40" start="22041" end="22080">#' using the \code{\link{fpm}} function.</COMMENT>
  <COMMENT line1="233" col1="1" line2="233" col2="2" start="22136" end="22137">#'</COMMENT>
  <COMMENT line1="234" col1="1" line2="234" col2="59" start="22231" end="22289">#' @return a matrix which is normalized per kilobase of the</COMMENT>
  <COMMENT line1="235" col1="1" line2="235" col2="65" start="22326" end="22390">#' union of basepairs in the \code{GRangesList} or \code{GRanges}</COMMENT>
  <COMMENT line1="236" col1="1" line2="236" col2="61" start="22421" end="22481">#' of the mcols(object), and per million of mapped fragments,</COMMENT>
  <COMMENT line1="237" col1="1" line2="237" col2="69" start="22516" end="22584">#' either using the robust median ratio method (robust=TRUE, default)</COMMENT>
  <COMMENT line1="238" col1="1" line2="238" col2="38" start="22611" end="22648">#' or using raw counts (robust=FALSE).</COMMENT>
  <COMMENT line1="239" col1="1" line2="239" col2="57" start="22706" end="22762">#' Defining a column \code{mcols(object)$basepairs} takes</COMMENT>
  <COMMENT line1="240" col1="1" line2="240" col2="70" start="22801" end="22870">#' precedence over internal calculation of the kilobases for each row.</COMMENT>
  <COMMENT line1="241" col1="1" line2="241" col2="2" start="22896" end="22897">#'</COMMENT>
  <COMMENT line1="242" col1="1" line2="242" col2="12" start="22991" end="23002">#' @examples</COMMENT>
  <COMMENT line1="243" col1="1" line2="243" col2="2" start="23086" end="23087">#'</COMMENT>
  <COMMENT line1="244" col1="1" line2="244" col2="50" start="23181" end="23230">#' # create a matrix with 1 million counts for the</COMMENT>
  <COMMENT line1="245" col1="1" line2="245" col2="45" start="23276" end="23320">#' # 2nd and 3rd column, the 1st and 4th have</COMMENT>
  <COMMENT line1="246" col1="1" line2="246" col2="46" start="23371" end="23416">#' # half and double the counts, respectively.</COMMENT>
  <COMMENT line1="247" col1="1" line2="247" col2="56" start="23466" end="23521">#' m &lt;- matrix(1e6 * rep(c(.125, .25, .25, .5), each=4),</COMMENT>
  <COMMENT line1="248" col1="1" line2="248" col2="46" start="23561" end="23606">#'             ncol=4, dimnames=list(1:4,1:4))</COMMENT>
  <COMMENT line1="249" col1="1" line2="249" col2="23" start="23656" end="23678">#' mode(m) &lt;- "integer"</COMMENT>
  <COMMENT line1="250" col1="1" line2="250" col2="76" start="23751" end="23826">#' se &lt;- SummarizedExperiment(list(counts=m), colData=DataFrame(sample=1:4))</COMMENT>
  <COMMENT line1="251" col1="1" line2="251" col2="31" start="23846" end="23876">#' dds &lt;- DESeqDataSet(se, ~ 1)</COMMENT>
  <COMMENT line1="252" col1="1" line2="252" col2="3" start="23941" end="23943">#' </COMMENT>
  <COMMENT line1="253" col1="1" line2="253" col2="51" start="24036" end="24086">#' # create 4 GRanges with lengths: 1, 1, 2, 2.5 Kb</COMMENT>
  <COMMENT line1="254" col1="1" line2="254" col2="47" start="24131" end="24177">#' gr1 &lt;- GRanges("chr1",IRanges(1,1000)) # 1kb</COMMENT>
  <COMMENT line1="255" col1="1" line2="255" col2="63" start="24226" end="24288">#' gr2 &lt;- GRanges("chr1",IRanges(c(1,1001),c( 500,1500))) # 1kb</COMMENT>
  <COMMENT line1="256" col1="1" line2="256" col2="63" start="24321" end="24383">#' gr3 &lt;- GRanges("chr1",IRanges(c(1,1001),c(1000,2000))) # 2kb</COMMENT>
  <COMMENT line1="257" col1="1" line2="257" col2="64" start="24416" end="24479">#' gr4 &lt;- GRanges("chr1",IRanges(c(1,1001),c(200,1300))) # 500bp</COMMENT>
  <COMMENT line1="258" col1="1" line2="258" col2="49" start="24511" end="24559">#' rowRanges(dds) &lt;- GRangesList(gr1,gr2,gr3,gr4)</COMMENT>
  <COMMENT line1="259" col1="1" line2="259" col2="3" start="24606" end="24608">#' </COMMENT>
  <COMMENT line1="260" col1="1" line2="260" col2="19" start="24701" end="24719">#' # the raw counts</COMMENT>
  <COMMENT line1="261" col1="1" line2="261" col2="14" start="24796" end="24809">#' counts(dds)</COMMENT>
  <COMMENT line1="262" col1="1" line2="262" col2="2" start="24891" end="24892">#'</COMMENT>
  <COMMENT line1="263" col1="1" line2="263" col2="19" start="24986" end="25004">#' # the FPM values</COMMENT>
  <COMMENT line1="264" col1="1" line2="264" col2="11" start="25081" end="25091">#' fpm(dds)</COMMENT>
  <COMMENT line1="265" col1="1" line2="265" col2="3" start="25176" end="25178">#' </COMMENT>
  <COMMENT line1="266" col1="1" line2="266" col2="20" start="25271" end="25290">#' # the FPKM values</COMMENT>
  <COMMENT line1="267" col1="1" line2="267" col2="12" start="25366" end="25377">#' fpkm(dds)</COMMENT>
  <COMMENT line1="268" col1="1" line2="268" col2="3" start="25461" end="25463">#' </COMMENT>
  <COMMENT line1="269" col1="1" line2="269" col2="29" start="25556" end="25584">#' @seealso \code{\link{fpm}}</COMMENT>
  <COMMENT line1="270" col1="1" line2="270" col2="2" start="25651" end="25652">#'</COMMENT>
  <COMMENT line1="271" col1="1" line2="271" col2="19" start="25746" end="25764">#' @docType methods</COMMENT>
  <COMMENT line1="272" col1="1" line2="272" col2="13" start="25841" end="25853">#' @name fpkm</COMMENT>
  <COMMENT line1="273" col1="1" line2="273" col2="15" start="25936" end="25950">#' @rdname fpkm</COMMENT>
  <COMMENT line1="274" col1="1" line2="274" col2="3" start="26031" end="26033">#' </COMMENT>
  <COMMENT line1="275" col1="1" line2="275" col2="10" start="26126" end="26135">#' @export</COMMENT>
  <expr line1="276" col1="1" line2="308" col2="1" start="26221" end="29261">
    <expr line1="276" col1="1" line2="276" col2="4" start="26221" end="26224">
      <SYMBOL line1="276" col1="1" line2="276" col2="4" start="26221" end="26224">fpkm</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="276" col1="6" line2="276" col2="7" start="26226" end="26227">&lt;-</LEFT_ASSIGN>
    <expr line1="276" col1="9" line2="308" col2="1" start="26229" end="29261">
      <FUNCTION line1="276" col1="9" line2="276" col2="16" start="26229" end="26236">function</FUNCTION>
      <OP-LEFT-PAREN line1="276" col1="17" line2="276" col2="17" start="26237" end="26237">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="276" col1="18" line2="276" col2="23" start="26238" end="26243">object</SYMBOL_FORMALS>
      <OP-COMMA line1="276" col1="24" line2="276" col2="24" start="26244" end="26244">,</OP-COMMA>
      <SYMBOL_FORMALS line1="276" col1="26" line2="276" col2="31" start="26246" end="26251">robust</SYMBOL_FORMALS>
      <EQ_FORMALS line1="276" col1="32" line2="276" col2="32" start="26252" end="26252">=</EQ_FORMALS>
      <expr line1="276" col1="33" line2="276" col2="36" start="26253" end="26256">
        <NUM_CONST line1="276" col1="33" line2="276" col2="36" start="26253" end="26256">TRUE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="276" col1="37" line2="276" col2="37" start="26257" end="26257">)</OP-RIGHT-PAREN>
      <expr line1="276" col1="39" line2="308" col2="1" start="26259" end="29261">
        <OP-LEFT-BRACE line1="276" col1="39" line2="276" col2="39" start="26259" end="26259">{</OP-LEFT-BRACE>
        <expr line1="277" col1="3" line2="277" col2="35" start="26318" end="26350">
          <expr line1="277" col1="3" line2="277" col2="5" start="26318" end="26320">
            <SYMBOL line1="277" col1="3" line2="277" col2="5" start="26318" end="26320">fpm</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="277" col1="7" line2="277" col2="8" start="26322" end="26323">&lt;-</LEFT_ASSIGN>
          <expr line1="277" col1="10" line2="277" col2="35" start="26325" end="26350">
            <expr line1="277" col1="10" line2="277" col2="12" start="26325" end="26327">
              <SYMBOL_FUNCTION_CALL line1="277" col1="10" line2="277" col2="12" start="26325" end="26327">fpm</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="277" col1="13" line2="277" col2="13" start="26328" end="26328">(</OP-LEFT-PAREN>
            <expr line1="277" col1="14" line2="277" col2="19" start="26329" end="26334">
              <SYMBOL line1="277" col1="14" line2="277" col2="19" start="26329" end="26334">object</SYMBOL>
            </expr>
            <OP-COMMA line1="277" col1="20" line2="277" col2="20" start="26335" end="26335">,</OP-COMMA>
            <SYMBOL_SUB line1="277" col1="22" line2="277" col2="27" start="26337" end="26342">robust</SYMBOL_SUB>
            <EQ_SUB line1="277" col1="28" line2="277" col2="28" start="26343" end="26343">=</EQ_SUB>
            <expr line1="277" col1="29" line2="277" col2="34" start="26344" end="26349">
              <SYMBOL line1="277" col1="29" line2="277" col2="34" start="26344" end="26349">robust</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="277" col1="35" line2="277" col2="35" start="26350" end="26350">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="278" col1="3" line2="287" col2="3" start="26413" end="27268">
          <IF line1="278" col1="3" line2="278" col2="4" start="26413" end="26414">if</IF>
          <OP-LEFT-PAREN line1="278" col1="6" line2="278" col2="6" start="26416" end="26416">(</OP-LEFT-PAREN>
          <expr line1="278" col1="7" line2="278" col2="43" start="26417" end="26453">
            <expr line1="278" col1="7" line2="278" col2="19" start="26417" end="26429">
              <STR_CONST line1="278" col1="7" line2="278" col2="19" start="26417" end="26429">"avgTxLength"</STR_CONST>
            </expr>
            <SPECIAL line1="278" col1="21" line2="278" col2="24" start="26431" end="26434">%in%</SPECIAL>
            <expr line1="278" col1="26" line2="278" col2="43" start="26436" end="26453">
              <expr line1="278" col1="26" line2="278" col2="35" start="26436" end="26445">
                <SYMBOL_FUNCTION_CALL line1="278" col1="26" line2="278" col2="35" start="26436" end="26445">assayNames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="278" col1="36" line2="278" col2="36" start="26446" end="26446">(</OP-LEFT-PAREN>
              <expr line1="278" col1="37" line2="278" col2="42" start="26447" end="26452">
                <SYMBOL line1="278" col1="37" line2="278" col2="42" start="26447" end="26452">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="278" col1="43" line2="278" col2="43" start="26453" end="26453">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="278" col1="44" line2="278" col2="44" start="26454" end="26454">)</OP-RIGHT-PAREN>
          <expr line1="278" col1="46" line2="287" col2="3" start="26456" end="27268">
            <OP-LEFT-BRACE line1="278" col1="46" line2="278" col2="46" start="26456" end="26456">{</OP-LEFT-BRACE>
            <expr line1="279" col1="5" line2="279" col2="56" start="26510" end="26561">
              <expr line1="279" col1="5" line2="279" col2="9" start="26510" end="26514">
                <SYMBOL line1="279" col1="5" line2="279" col2="9" start="26510" end="26514">exprs</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="279" col1="11" line2="279" col2="12" start="26516" end="26517">&lt;-</LEFT_ASSIGN>
              <expr line1="279" col1="14" line2="279" col2="56" start="26519" end="26561">
                <expr line1="279" col1="14" line2="279" col2="22" start="26519" end="26527">
                  <expr line1="279" col1="14" line2="279" col2="16" start="26519" end="26521">
                    <NUM_CONST line1="279" col1="14" line2="279" col2="16" start="26519" end="26521">1e3</NUM_CONST>
                  </expr>
                  <OP-STAR line1="279" col1="18" line2="279" col2="18" start="26523" end="26523">*</OP-STAR>
                  <expr line1="279" col1="20" line2="279" col2="22" start="26525" end="26527">
                    <SYMBOL line1="279" col1="20" line2="279" col2="22" start="26525" end="26527">fpm</SYMBOL>
                  </expr>
                </expr>
                <OP-SLASH line1="279" col1="24" line2="279" col2="24" start="26529" end="26529">/</OP-SLASH>
                <expr line1="279" col1="26" line2="279" col2="56" start="26531" end="26561">
                  <expr line1="279" col1="26" line2="279" col2="39" start="26531" end="26544">
                    <expr line1="279" col1="26" line2="279" col2="31" start="26531" end="26536">
                      <SYMBOL_FUNCTION_CALL line1="279" col1="26" line2="279" col2="31" start="26531" end="26536">assays</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="279" col1="32" line2="279" col2="32" start="26537" end="26537">(</OP-LEFT-PAREN>
                    <expr line1="279" col1="33" line2="279" col2="38" start="26538" end="26543">
                      <SYMBOL line1="279" col1="33" line2="279" col2="38" start="26538" end="26543">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="279" col1="39" line2="279" col2="39" start="26544" end="26544">)</OP-RIGHT-PAREN>
                  </expr>
                  <LBB line1="279" col1="40" line2="279" col2="41" start="26545" end="26546">[[</LBB>
                  <expr line1="279" col1="42" line2="279" col2="54" start="26547" end="26559">
                    <STR_CONST line1="279" col1="42" line2="279" col2="54" start="26547" end="26559">"avgTxLength"</STR_CONST>
                  </expr>
                  <OP-RIGHT-BRACKET line1="279" col1="55" line2="279" col2="55" start="26560" end="26560">]</OP-RIGHT-BRACKET>
                  <OP-RIGHT-BRACKET line1="279" col1="56" line2="279" col2="56" start="26561" end="26561">]</OP-RIGHT-BRACKET>
                </expr>
              </expr>
            </expr>
            <expr line1="280" col1="5" line2="286" col2="5" start="26605" end="27175">
              <IF line1="280" col1="5" line2="280" col2="6" start="26605" end="26606">if</IF>
              <OP-LEFT-PAREN line1="280" col1="8" line2="280" col2="8" start="26608" end="26608">(</OP-LEFT-PAREN>
              <expr line1="280" col1="9" line2="280" col2="14" start="26609" end="26614">
                <SYMBOL line1="280" col1="9" line2="280" col2="14" start="26609" end="26614">robust</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="280" col1="15" line2="280" col2="15" start="26615" end="26615">)</OP-RIGHT-PAREN>
              <expr line1="280" col1="17" line2="284" col2="5" start="26617" end="26985">
                <OP-LEFT-BRACE line1="280" col1="17" line2="280" col2="17" start="26617" end="26617">{</OP-LEFT-BRACE>
                <expr line1="281" col1="7" line2="281" col2="47" start="26702" end="26742">
                  <expr line1="281" col1="7" line2="281" col2="8" start="26702" end="26703">
                    <SYMBOL line1="281" col1="7" line2="281" col2="8" start="26702" end="26703">sf</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="281" col1="10" line2="281" col2="11" start="26705" end="26706">&lt;-</LEFT_ASSIGN>
                  <expr line1="281" col1="13" line2="281" col2="47" start="26708" end="26742">
                    <expr line1="281" col1="13" line2="281" col2="40" start="26708" end="26735">
                      <SYMBOL_FUNCTION_CALL line1="281" col1="13" line2="281" col2="40" start="26708" end="26735">estimateSizeFactorsForMatrix</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="281" col1="41" line2="281" col2="41" start="26736" end="26736">(</OP-LEFT-PAREN>
                    <expr line1="281" col1="42" line2="281" col2="46" start="26737" end="26741">
                      <SYMBOL line1="281" col1="42" line2="281" col2="46" start="26737" end="26741">exprs</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="281" col1="47" line2="281" col2="47" start="26742" end="26742">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="282" col1="7" line2="282" col2="29" start="26797" end="26819">
                  <expr line1="282" col1="7" line2="282" col2="11" start="26797" end="26801">
                    <SYMBOL line1="282" col1="7" line2="282" col2="11" start="26797" end="26801">exprs</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="282" col1="13" line2="282" col2="14" start="26803" end="26804">&lt;-</LEFT_ASSIGN>
                  <expr line1="282" col1="16" line2="282" col2="29" start="26806" end="26819">
                    <expr line1="282" col1="16" line2="282" col2="16" start="26806" end="26806">
                      <SYMBOL_FUNCTION_CALL line1="282" col1="16" line2="282" col2="16" start="26806" end="26806">t</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="282" col1="17" line2="282" col2="17" start="26807" end="26807">(</OP-LEFT-PAREN>
                    <expr line1="282" col1="18" line2="282" col2="28" start="26808" end="26818">
                      <expr line1="282" col1="18" line2="282" col2="25" start="26808" end="26815">
                        <expr line1="282" col1="18" line2="282" col2="18" start="26808" end="26808">
                          <SYMBOL_FUNCTION_CALL line1="282" col1="18" line2="282" col2="18" start="26808" end="26808">t</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="282" col1="19" line2="282" col2="19" start="26809" end="26809">(</OP-LEFT-PAREN>
                        <expr line1="282" col1="20" line2="282" col2="24" start="26810" end="26814">
                          <SYMBOL line1="282" col1="20" line2="282" col2="24" start="26810" end="26814">exprs</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="282" col1="25" line2="282" col2="25" start="26815" end="26815">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-SLASH line1="282" col1="26" line2="282" col2="26" start="26816" end="26816">/</OP-SLASH>
                      <expr line1="282" col1="27" line2="282" col2="28" start="26817" end="26818">
                        <SYMBOL line1="282" col1="27" line2="282" col2="28" start="26817" end="26818">sf</SYMBOL>
                      </expr>
                    </expr>
                    <OP-RIGHT-PAREN line1="282" col1="29" line2="282" col2="29" start="26819" end="26819">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="283" col1="7" line2="283" col2="19" start="26892" end="26904">
                  <expr line1="283" col1="7" line2="283" col2="12" start="26892" end="26897">
                    <SYMBOL_FUNCTION_CALL line1="283" col1="7" line2="283" col2="12" start="26892" end="26897">return</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="283" col1="13" line2="283" col2="13" start="26898" end="26898">(</OP-LEFT-PAREN>
                  <expr line1="283" col1="14" line2="283" col2="18" start="26899" end="26903">
                    <SYMBOL line1="283" col1="14" line2="283" col2="18" start="26899" end="26903">exprs</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="283" col1="19" line2="283" col2="19" start="26904" end="26904">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="284" col1="5" line2="284" col2="5" start="26985" end="26985">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="284" col1="7" line2="284" col2="10" start="26987" end="26990">else</ELSE>
              <expr line1="284" col1="12" line2="286" col2="5" start="26992" end="27175">
                <OP-LEFT-BRACE line1="284" col1="12" line2="284" col2="12" start="26992" end="26992">{</OP-LEFT-BRACE>
                <expr line1="285" col1="7" line2="285" col2="19" start="27082" end="27094">
                  <expr line1="285" col1="7" line2="285" col2="12" start="27082" end="27087">
                    <SYMBOL_FUNCTION_CALL line1="285" col1="7" line2="285" col2="12" start="27082" end="27087">return</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="285" col1="13" line2="285" col2="13" start="27088" end="27088">(</OP-LEFT-PAREN>
                  <expr line1="285" col1="14" line2="285" col2="18" start="27089" end="27093">
                    <SYMBOL line1="285" col1="14" line2="285" col2="18" start="27089" end="27093">exprs</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="285" col1="19" line2="285" col2="19" start="27094" end="27094">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="286" col1="5" line2="286" col2="5" start="27175" end="27175">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="287" col1="3" line2="287" col2="3" start="27268" end="27268">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="288" col1="3" line2="306" col2="3" start="27363" end="29073">
          <IF line1="288" col1="3" line2="288" col2="4" start="27363" end="27364">if</IF>
          <OP-LEFT-PAREN line1="288" col1="6" line2="288" col2="6" start="27366" end="27366">(</OP-LEFT-PAREN>
          <expr line1="288" col1="7" line2="288" col2="38" start="27367" end="27398">
            <expr line1="288" col1="7" line2="288" col2="13" start="27367" end="27373">
              <SYMBOL_FUNCTION_CALL line1="288" col1="7" line2="288" col2="13" start="27367" end="27373">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="288" col1="14" line2="288" col2="14" start="27374" end="27374">(</OP-LEFT-PAREN>
            <expr line1="288" col1="15" line2="288" col2="37" start="27375" end="27397">
              <expr line1="288" col1="15" line2="288" col2="27" start="27375" end="27387">
                <expr line1="288" col1="15" line2="288" col2="19" start="27375" end="27379">
                  <SYMBOL_FUNCTION_CALL line1="288" col1="15" line2="288" col2="19" start="27375" end="27379">mcols</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="288" col1="20" line2="288" col2="20" start="27380" end="27380">(</OP-LEFT-PAREN>
                <expr line1="288" col1="21" line2="288" col2="26" start="27381" end="27386">
                  <SYMBOL line1="288" col1="21" line2="288" col2="26" start="27381" end="27386">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="288" col1="27" line2="288" col2="27" start="27387" end="27387">)</OP-RIGHT-PAREN>
              </expr>
              <OP-DOLLAR line1="288" col1="28" line2="288" col2="28" start="27388" end="27388">$</OP-DOLLAR>
              <SYMBOL line1="288" col1="29" line2="288" col2="37" start="27389" end="27397">basepairs</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="288" col1="38" line2="288" col2="38" start="27398" end="27398">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="288" col1="39" line2="288" col2="39" start="27399" end="27399">)</OP-RIGHT-PAREN>
          <expr line1="288" col1="41" line2="306" col2="3" start="27401" end="29073">
            <OP-LEFT-BRACE line1="288" col1="41" line2="288" col2="41" start="27401" end="27401">{</OP-LEFT-BRACE>
            <expr line1="289" col1="5" line2="293" col2="5" start="27460" end="27840">
              <IF line1="289" col1="5" line2="289" col2="6" start="27460" end="27461">if</IF>
              <OP-LEFT-PAREN line1="289" col1="8" line2="289" col2="8" start="27463" end="27463">(</OP-LEFT-PAREN>
              <expr line1="289" col1="9" line2="289" col2="44" start="27464" end="27499">
                <expr line1="289" col1="9" line2="289" col2="10" start="27464" end="27465">
                  <SYMBOL_FUNCTION_CALL line1="289" col1="9" line2="289" col2="10" start="27464" end="27465">is</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="289" col1="11" line2="289" col2="11" start="27466" end="27466">(</OP-LEFT-PAREN>
                <expr line1="289" col1="12" line2="289" col2="28" start="27467" end="27483">
                  <expr line1="289" col1="12" line2="289" col2="20" start="27467" end="27475">
                    <SYMBOL_FUNCTION_CALL line1="289" col1="12" line2="289" col2="20" start="27467" end="27475">rowRanges</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="289" col1="21" line2="289" col2="21" start="27476" end="27476">(</OP-LEFT-PAREN>
                  <expr line1="289" col1="22" line2="289" col2="27" start="27477" end="27482">
                    <SYMBOL line1="289" col1="22" line2="289" col2="27" start="27477" end="27482">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="289" col1="28" line2="289" col2="28" start="27483" end="27483">)</OP-RIGHT-PAREN>
                </expr>
                <OP-COMMA line1="289" col1="29" line2="289" col2="29" start="27484" end="27484">,</OP-COMMA>
                <expr line1="289" col1="31" line2="289" col2="43" start="27486" end="27498">
                  <STR_CONST line1="289" col1="31" line2="289" col2="43" start="27486" end="27498">"GRangesList"</STR_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="289" col1="44" line2="289" col2="44" start="27499" end="27499">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="289" col1="45" line2="289" col2="45" start="27500" end="27500">)</OP-RIGHT-PAREN>
              <expr line1="289" col1="47" line2="291" col2="5" start="27502" end="27650">
                <OP-LEFT-BRACE line1="289" col1="47" line2="289" col2="47" start="27502" end="27502">{</OP-LEFT-BRACE>
                <expr line1="290" col1="7" line2="290" col2="73" start="27557" end="27623">
                  <expr line1="290" col1="7" line2="290" col2="9" start="27557" end="27559">
                    <SYMBOL line1="290" col1="7" line2="290" col2="9" start="27557" end="27559">ubp</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="290" col1="11" line2="290" col2="12" start="27561" end="27562">&lt;-</LEFT_ASSIGN>
                  <expr line1="290" col1="14" line2="290" col2="73" start="27564" end="27623">
                    <expr line1="290" col1="14" line2="290" col2="22" start="27564" end="27572">
                      <SYMBOL_FUNCTION_CALL line1="290" col1="14" line2="290" col2="22" start="27564" end="27572">DataFrame</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="290" col1="23" line2="290" col2="23" start="27573" end="27573">(</OP-LEFT-PAREN>
                    <SYMBOL_SUB line1="290" col1="24" line2="290" col2="32" start="27574" end="27582">basepairs</SYMBOL_SUB>
                    <EQ_SUB line1="290" col1="34" line2="290" col2="34" start="27584" end="27584">=</EQ_SUB>
                    <expr line1="290" col1="36" line2="290" col2="72" start="27586" end="27622">
                      <expr line1="290" col1="36" line2="290" col2="38" start="27586" end="27588">
                        <SYMBOL_FUNCTION_CALL line1="290" col1="36" line2="290" col2="38" start="27586" end="27588">sum</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="290" col1="39" line2="290" col2="39" start="27589" end="27589">(</OP-LEFT-PAREN>
                      <expr line1="290" col1="40" line2="290" col2="71" start="27590" end="27621">
                        <expr line1="290" col1="40" line2="290" col2="44" start="27590" end="27594">
                          <SYMBOL_FUNCTION_CALL line1="290" col1="40" line2="290" col2="44" start="27590" end="27594">width</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="290" col1="45" line2="290" col2="45" start="27595" end="27595">(</OP-LEFT-PAREN>
                        <expr line1="290" col1="46" line2="290" col2="70" start="27596" end="27620">
                          <expr line1="290" col1="46" line2="290" col2="51" start="27596" end="27601">
                            <SYMBOL_FUNCTION_CALL line1="290" col1="46" line2="290" col2="51" start="27596" end="27601">reduce</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="290" col1="52" line2="290" col2="52" start="27602" end="27602">(</OP-LEFT-PAREN>
                          <expr line1="290" col1="53" line2="290" col2="69" start="27603" end="27619">
                            <expr line1="290" col1="53" line2="290" col2="61" start="27603" end="27611">
                              <SYMBOL_FUNCTION_CALL line1="290" col1="53" line2="290" col2="61" start="27603" end="27611">rowRanges</SYMBOL_FUNCTION_CALL>
                            </expr>
                            <OP-LEFT-PAREN line1="290" col1="62" line2="290" col2="62" start="27612" end="27612">(</OP-LEFT-PAREN>
                            <expr line1="290" col1="63" line2="290" col2="68" start="27613" end="27618">
                              <SYMBOL line1="290" col1="63" line2="290" col2="68" start="27613" end="27618">object</SYMBOL>
                            </expr>
                            <OP-RIGHT-PAREN line1="290" col1="69" line2="290" col2="69" start="27619" end="27619">)</OP-RIGHT-PAREN>
                          </expr>
                          <OP-RIGHT-PAREN line1="290" col1="70" line2="290" col2="70" start="27620" end="27620">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-RIGHT-PAREN line1="290" col1="71" line2="290" col2="71" start="27621" end="27621">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="290" col1="72" line2="290" col2="72" start="27622" end="27622">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="290" col1="73" line2="290" col2="73" start="27623" end="27623">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="291" col1="5" line2="291" col2="5" start="27650" end="27650">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="291" col1="7" line2="291" col2="10" start="27652" end="27655">else</ELSE>
              <expr line1="291" col1="12" line2="293" col2="5" start="27657" end="27840">
                <IF line1="291" col1="12" line2="291" col2="13" start="27657" end="27658">if</IF>
                <OP-LEFT-PAREN line1="291" col1="15" line2="291" col2="15" start="27660" end="27660">(</OP-LEFT-PAREN>
                <expr line1="291" col1="16" line2="291" col2="47" start="27661" end="27692">
                  <expr line1="291" col1="16" line2="291" col2="17" start="27661" end="27662">
                    <SYMBOL_FUNCTION_CALL line1="291" col1="16" line2="291" col2="17" start="27661" end="27662">is</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="291" col1="18" line2="291" col2="18" start="27663" end="27663">(</OP-LEFT-PAREN>
                  <expr line1="291" col1="19" line2="291" col2="35" start="27664" end="27680">
                    <expr line1="291" col1="19" line2="291" col2="27" start="27664" end="27672">
                      <SYMBOL_FUNCTION_CALL line1="291" col1="19" line2="291" col2="27" start="27664" end="27672">rowRanges</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="291" col1="28" line2="291" col2="28" start="27673" end="27673">(</OP-LEFT-PAREN>
                    <expr line1="291" col1="29" line2="291" col2="34" start="27674" end="27679">
                      <SYMBOL line1="291" col1="29" line2="291" col2="34" start="27674" end="27679">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="291" col1="35" line2="291" col2="35" start="27680" end="27680">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-COMMA line1="291" col1="36" line2="291" col2="36" start="27681" end="27681">,</OP-COMMA>
                  <expr line1="291" col1="38" line2="291" col2="46" start="27683" end="27691">
                    <STR_CONST line1="291" col1="38" line2="291" col2="46" start="27683" end="27691">"GRanges"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="291" col1="47" line2="291" col2="47" start="27692" end="27692">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="291" col1="48" line2="291" col2="48" start="27693" end="27693">)</OP-RIGHT-PAREN>
                <expr line1="291" col1="50" line2="293" col2="5" start="27695" end="27840">
                  <OP-LEFT-BRACE line1="291" col1="50" line2="291" col2="50" start="27695" end="27695">{</OP-LEFT-BRACE>
                  <expr line1="292" col1="7" line2="292" col2="60" start="27747" end="27800">
                    <expr line1="292" col1="7" line2="292" col2="9" start="27747" end="27749">
                      <SYMBOL line1="292" col1="7" line2="292" col2="9" start="27747" end="27749">ubp</SYMBOL>
                    </expr>
                    <LEFT_ASSIGN line1="292" col1="11" line2="292" col2="12" start="27751" end="27752">&lt;-</LEFT_ASSIGN>
                    <expr line1="292" col1="14" line2="292" col2="60" start="27754" end="27800">
                      <expr line1="292" col1="14" line2="292" col2="22" start="27754" end="27762">
                        <SYMBOL_FUNCTION_CALL line1="292" col1="14" line2="292" col2="22" start="27754" end="27762">DataFrame</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="292" col1="23" line2="292" col2="23" start="27763" end="27763">(</OP-LEFT-PAREN>
                      <SYMBOL_SUB line1="292" col1="24" line2="292" col2="32" start="27764" end="27772">basepairs</SYMBOL_SUB>
                      <EQ_SUB line1="292" col1="34" line2="292" col2="34" start="27774" end="27774">=</EQ_SUB>
                      <expr line1="292" col1="36" line2="292" col2="59" start="27776" end="27799">
                        <expr line1="292" col1="36" line2="292" col2="40" start="27776" end="27780">
                          <SYMBOL_FUNCTION_CALL line1="292" col1="36" line2="292" col2="40" start="27776" end="27780">width</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="292" col1="41" line2="292" col2="41" start="27781" end="27781">(</OP-LEFT-PAREN>
                        <expr line1="292" col1="42" line2="292" col2="58" start="27782" end="27798">
                          <expr line1="292" col1="42" line2="292" col2="50" start="27782" end="27790">
                            <SYMBOL_FUNCTION_CALL line1="292" col1="42" line2="292" col2="50" start="27782" end="27790">rowRanges</SYMBOL_FUNCTION_CALL>
                          </expr>
                          <OP-LEFT-PAREN line1="292" col1="51" line2="292" col2="51" start="27791" end="27791">(</OP-LEFT-PAREN>
                          <expr line1="292" col1="52" line2="292" col2="57" start="27792" end="27797">
                            <SYMBOL line1="292" col1="52" line2="292" col2="57" start="27792" end="27797">object</SYMBOL>
                          </expr>
                          <OP-RIGHT-PAREN line1="292" col1="58" line2="292" col2="58" start="27798" end="27798">)</OP-RIGHT-PAREN>
                        </expr>
                        <OP-RIGHT-PAREN line1="292" col1="59" line2="292" col2="59" start="27799" end="27799">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="292" col1="60" line2="292" col2="60" start="27800" end="27800">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                  <OP-RIGHT-BRACE line1="293" col1="5" line2="293" col2="5" start="27840" end="27840">}</OP-RIGHT-BRACE>
                </expr>
              </expr>
            </expr>
            <expr line1="294" col1="5" line2="298" col2="5" start="27935" end="28315">
              <IF line1="294" col1="5" line2="294" col2="6" start="27935" end="27936">if</IF>
              <OP-LEFT-PAREN line1="294" col1="8" line2="294" col2="8" start="27938" end="27938">(</OP-LEFT-PAREN>
              <expr line1="294" col1="9" line2="294" col2="31" start="27939" end="27961">
                <expr line1="294" col1="9" line2="294" col2="11" start="27939" end="27941">
                  <SYMBOL_FUNCTION_CALL line1="294" col1="9" line2="294" col2="11" start="27939" end="27941">all</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="294" col1="12" line2="294" col2="12" start="27942" end="27942">(</OP-LEFT-PAREN>
                <expr line1="294" col1="13" line2="294" col2="30" start="27943" end="27960">
                  <expr line1="294" col1="13" line2="294" col2="25" start="27943" end="27955">
                    <expr line1="294" col1="13" line2="294" col2="15" start="27943" end="27945">
                      <SYMBOL line1="294" col1="13" line2="294" col2="15" start="27943" end="27945">ubp</SYMBOL>
                    </expr>
                    <OP-DOLLAR line1="294" col1="16" line2="294" col2="16" start="27946" end="27946">$</OP-DOLLAR>
                    <SYMBOL line1="294" col1="17" line2="294" col2="25" start="27947" end="27955">basepairs</SYMBOL>
                  </expr>
                  <EQ line1="294" col1="27" line2="294" col2="28" start="27957" end="27958">==</EQ>
                  <expr line1="294" col1="30" line2="294" col2="30" start="27960" end="27960">
                    <NUM_CONST line1="294" col1="30" line2="294" col2="30" start="27960" end="27960">0</NUM_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="294" col1="31" line2="294" col2="31" start="27961" end="27961">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="294" col1="32" line2="294" col2="32" start="27962" end="27962">)</OP-RIGHT-PAREN>
              <expr line1="294" col1="34" line2="298" col2="5" start="27964" end="28315">
                <OP-LEFT-BRACE line1="294" col1="34" line2="294" col2="34" start="27964" end="27964">{</OP-LEFT-BRACE>
                <expr line1="295" col1="7" line2="297" col2="43" start="28032" end="28258">
                  <expr line1="295" col1="7" line2="295" col2="10" start="28032" end="28035">
                    <SYMBOL_FUNCTION_CALL line1="295" col1="7" line2="295" col2="10" start="28032" end="28035">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="295" col1="11" line2="295" col2="11" start="28036" end="28036">(</OP-LEFT-PAREN>
                  <expr line1="295" col1="12" line2="297" col2="42" start="28037" end="28257">
                    <STR_CONST line1="295" col1="12" line2="297" col2="42" start="28037" end="28257">"rowRanges(object) has all ranges of zero width.
the user should instead supply a column, mcols(object)$basepairs,
which will be used to produce FPKM values"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="297" col1="43" line2="297" col2="43" start="28258" end="28258">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="298" col1="5" line2="298" col2="5" start="28315" end="28315">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="299" col1="5" line2="305" col2="5" start="28410" end="28980">
              <IF line1="299" col1="5" line2="299" col2="6" start="28410" end="28411">if</IF>
              <OP-LEFT-PAREN line1="299" col1="8" line2="299" col2="8" start="28413" end="28413">(</OP-LEFT-PAREN>
              <expr line1="299" col1="9" line2="299" col2="37" start="28414" end="28442">
                <expr line1="299" col1="9" line2="299" col2="15" start="28414" end="28420">
                  <SYMBOL_FUNCTION_CALL line1="299" col1="9" line2="299" col2="15" start="28414" end="28420">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="299" col1="16" line2="299" col2="16" start="28421" end="28421">(</OP-LEFT-PAREN>
                <expr line1="299" col1="17" line2="299" col2="36" start="28422" end="28441">
                  <expr line1="299" col1="17" line2="299" col2="21" start="28422" end="28426">
                    <SYMBOL_FUNCTION_CALL line1="299" col1="17" line2="299" col2="21" start="28422" end="28426">mcols</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="299" col1="22" line2="299" col2="22" start="28427" end="28427">(</OP-LEFT-PAREN>
                  <expr line1="299" col1="23" line2="299" col2="35" start="28428" end="28440">
                    <expr line1="299" col1="23" line2="299" col2="27" start="28428" end="28432">
                      <SYMBOL_FUNCTION_CALL line1="299" col1="23" line2="299" col2="27" start="28428" end="28432">mcols</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="299" col1="28" line2="299" col2="28" start="28433" end="28433">(</OP-LEFT-PAREN>
                    <expr line1="299" col1="29" line2="299" col2="34" start="28434" end="28439">
                      <SYMBOL line1="299" col1="29" line2="299" col2="34" start="28434" end="28439">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="299" col1="35" line2="299" col2="35" start="28440" end="28440">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="299" col1="36" line2="299" col2="36" start="28441" end="28441">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="299" col1="37" line2="299" col2="37" start="28442" end="28442">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="299" col1="38" line2="299" col2="38" start="28443" end="28443">)</OP-RIGHT-PAREN>
              <expr line1="299" col1="40" line2="301" col2="5" start="28445" end="28600">
                <OP-LEFT-BRACE line1="299" col1="40" line2="299" col2="40" start="28445" end="28445">{</OP-LEFT-BRACE>
                <expr line1="300" col1="7" line2="300" col2="26" start="28507" end="28526">
                  <expr line1="300" col1="7" line2="300" col2="19" start="28507" end="28519">
                    <expr line1="300" col1="7" line2="300" col2="11" start="28507" end="28511">
                      <SYMBOL_FUNCTION_CALL line1="300" col1="7" line2="300" col2="11" start="28507" end="28511">mcols</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="300" col1="12" line2="300" col2="12" start="28512" end="28512">(</OP-LEFT-PAREN>
                    <expr line1="300" col1="13" line2="300" col2="18" start="28513" end="28518">
                      <SYMBOL line1="300" col1="13" line2="300" col2="18" start="28513" end="28518">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="300" col1="19" line2="300" col2="19" start="28519" end="28519">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="300" col1="21" line2="300" col2="22" start="28521" end="28522">&lt;-</LEFT_ASSIGN>
                  <expr line1="300" col1="24" line2="300" col2="26" start="28524" end="28526">
                    <SYMBOL line1="300" col1="24" line2="300" col2="26" start="28524" end="28526">ubp</SYMBOL>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="301" col1="5" line2="301" col2="5" start="28600" end="28600">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="301" col1="7" line2="301" col2="10" start="28602" end="28605">else</ELSE>
              <expr line1="301" col1="12" line2="305" col2="5" start="28607" end="28980">
                <OP-LEFT-BRACE line1="301" col1="12" line2="301" col2="12" start="28607" end="28607">{</OP-LEFT-BRACE>
                <expr line1="302" col1="7" line2="303" col2="90" start="28697" end="28875">
                  <expr line1="302" col1="7" line2="302" col2="16" start="28697" end="28706">
                    <expr line1="302" col1="7" line2="302" col2="11" start="28697" end="28701">
                      <SYMBOL_FUNCTION_CALL line1="302" col1="7" line2="302" col2="11" start="28697" end="28701">mcols</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="302" col1="12" line2="302" col2="12" start="28702" end="28702">(</OP-LEFT-PAREN>
                    <expr line1="302" col1="13" line2="302" col2="15" start="28703" end="28705">
                      <SYMBOL line1="302" col1="13" line2="302" col2="15" start="28703" end="28705">ubp</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="302" col1="16" line2="302" col2="16" start="28706" end="28706">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="302" col1="18" line2="302" col2="19" start="28708" end="28709">&lt;-</LEFT_ASSIGN>
                  <expr line1="302" col1="21" line2="303" col2="90" start="28711" end="28875">
                    <expr line1="302" col1="21" line2="302" col2="29" start="28711" end="28719">
                      <SYMBOL_FUNCTION_CALL line1="302" col1="21" line2="302" col2="29" start="28711" end="28719">DataFrame</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="302" col1="30" line2="302" col2="30" start="28720" end="28720">(</OP-LEFT-PAREN>
                    <SYMBOL_SUB line1="302" col1="31" line2="302" col2="34" start="28721" end="28724">type</SYMBOL_SUB>
                    <EQ_SUB line1="302" col1="35" line2="302" col2="35" start="28725" end="28725">=</EQ_SUB>
                    <expr line1="302" col1="36" line2="302" col2="49" start="28726" end="28739">
                      <STR_CONST line1="302" col1="36" line2="302" col2="49" start="28726" end="28739">"intermediate"</STR_CONST>
                    </expr>
                    <OP-COMMA line1="302" col1="50" line2="302" col2="50" start="28740" end="28740">,</OP-COMMA>
                    <SYMBOL_SUB line1="303" col1="31" line2="303" col2="41" start="28816" end="28826">description</SYMBOL_SUB>
                    <EQ_SUB line1="303" col1="42" line2="303" col2="42" start="28827" end="28827">=</EQ_SUB>
                    <expr line1="303" col1="43" line2="303" col2="89" start="28828" end="28874">
                      <STR_CONST line1="303" col1="43" line2="303" col2="89" start="28828" end="28874">"count of basepairs in the union of all ranges"</STR_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="303" col1="90" line2="303" col2="90" start="28875" end="28875">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <expr line1="304" col1="7" line2="304" col2="48" start="28887" end="28928">
                  <expr line1="304" col1="7" line2="304" col2="19" start="28887" end="28899">
                    <expr line1="304" col1="7" line2="304" col2="11" start="28887" end="28891">
                      <SYMBOL_FUNCTION_CALL line1="304" col1="7" line2="304" col2="11" start="28887" end="28891">mcols</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="304" col1="12" line2="304" col2="12" start="28892" end="28892">(</OP-LEFT-PAREN>
                    <expr line1="304" col1="13" line2="304" col2="18" start="28893" end="28898">
                      <SYMBOL line1="304" col1="13" line2="304" col2="18" start="28893" end="28898">object</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="304" col1="19" line2="304" col2="19" start="28899" end="28899">)</OP-RIGHT-PAREN>
                  </expr>
                  <LEFT_ASSIGN line1="304" col1="21" line2="304" col2="22" start="28901" end="28902">&lt;-</LEFT_ASSIGN>
                  <expr line1="304" col1="24" line2="304" col2="48" start="28904" end="28928">
                    <expr line1="304" col1="24" line2="304" col2="28" start="28904" end="28908">
                      <SYMBOL_FUNCTION_CALL line1="304" col1="24" line2="304" col2="28" start="28904" end="28908">cbind</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="304" col1="29" line2="304" col2="29" start="28909" end="28909">(</OP-LEFT-PAREN>
                    <expr line1="304" col1="30" line2="304" col2="42" start="28910" end="28922">
                      <expr line1="304" col1="30" line2="304" col2="34" start="28910" end="28914">
                        <SYMBOL_FUNCTION_CALL line1="304" col1="30" line2="304" col2="34" start="28910" end="28914">mcols</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="304" col1="35" line2="304" col2="35" start="28915" end="28915">(</OP-LEFT-PAREN>
                      <expr line1="304" col1="36" line2="304" col2="41" start="28916" end="28921">
                        <SYMBOL line1="304" col1="36" line2="304" col2="41" start="28916" end="28921">object</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="304" col1="42" line2="304" col2="42" start="28922" end="28922">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-COMMA line1="304" col1="43" line2="304" col2="43" start="28923" end="28923">,</OP-COMMA>
                    <expr line1="304" col1="45" line2="304" col2="47" start="28925" end="28927">
                      <SYMBOL line1="304" col1="45" line2="304" col2="47" start="28925" end="28927">ubp</SYMBOL>
                    </expr>
                    <OP-RIGHT-PAREN line1="304" col1="48" line2="304" col2="48" start="28928" end="28928">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="305" col1="5" line2="305" col2="5" start="28980" end="28980">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="306" col1="3" line2="306" col2="3" start="29073" end="29073">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="307" col1="3" line2="307" col2="51" start="29168" end="29216">
          <expr line1="307" col1="3" line2="307" col2="5" start="29168" end="29170">
            <NUM_CONST line1="307" col1="3" line2="307" col2="5" start="29168" end="29170">1e3</NUM_CONST>
          </expr>
          <OP-STAR line1="307" col1="7" line2="307" col2="7" start="29172" end="29172">*</OP-STAR>
          <expr line1="307" col1="9" line2="307" col2="51" start="29174" end="29216">
            <expr line1="307" col1="9" line2="307" col2="13" start="29174" end="29178">
              <SYMBOL_FUNCTION_CALL line1="307" col1="9" line2="307" col2="13" start="29174" end="29178">sweep</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="307" col1="14" line2="307" col2="14" start="29179" end="29179">(</OP-LEFT-PAREN>
            <expr line1="307" col1="15" line2="307" col2="17" start="29180" end="29182">
              <SYMBOL line1="307" col1="15" line2="307" col2="17" start="29180" end="29182">fpm</SYMBOL>
            </expr>
            <OP-COMMA line1="307" col1="18" line2="307" col2="18" start="29183" end="29183">,</OP-COMMA>
            <expr line1="307" col1="20" line2="307" col2="20" start="29185" end="29185">
              <NUM_CONST line1="307" col1="20" line2="307" col2="20" start="29185" end="29185">1</NUM_CONST>
            </expr>
            <OP-COMMA line1="307" col1="21" line2="307" col2="21" start="29186" end="29186">,</OP-COMMA>
            <expr line1="307" col1="23" line2="307" col2="45" start="29188" end="29210">
              <expr line1="307" col1="23" line2="307" col2="35" start="29188" end="29200">
                <expr line1="307" col1="23" line2="307" col2="27" start="29188" end="29192">
                  <SYMBOL_FUNCTION_CALL line1="307" col1="23" line2="307" col2="27" start="29188" end="29192">mcols</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="307" col1="28" line2="307" col2="28" start="29193" end="29193">(</OP-LEFT-PAREN>
                <expr line1="307" col1="29" line2="307" col2="34" start="29194" end="29199">
                  <SYMBOL line1="307" col1="29" line2="307" col2="34" start="29194" end="29199">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="307" col1="35" line2="307" col2="35" start="29200" end="29200">)</OP-RIGHT-PAREN>
              </expr>
              <OP-DOLLAR line1="307" col1="36" line2="307" col2="36" start="29201" end="29201">$</OP-DOLLAR>
              <SYMBOL line1="307" col1="37" line2="307" col2="45" start="29202" end="29210">basepairs</SYMBOL>
            </expr>
            <OP-COMMA line1="307" col1="46" line2="307" col2="46" start="29211" end="29211">,</OP-COMMA>
            <expr line1="307" col1="48" line2="307" col2="50" start="29213" end="29215">
              <STR_CONST line1="307" col1="48" line2="307" col2="50" start="29213" end="29215">"/"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="307" col1="51" line2="307" col2="51" start="29216" end="29216">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <OP-RIGHT-BRACE line1="308" col1="1" line2="308" col2="1" start="29261" end="29261">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="310" col1="1" line2="310" col2="46" start="29451" end="29496">#' FPM: fragments per million mapped fragments</COMMENT>
  <COMMENT line1="311" col1="1" line2="311" col2="2" start="29546" end="29547">#'</COMMENT>
  <COMMENT line1="312" col1="1" line2="312" col2="47" start="29641" end="29687">#' Calculates either a robust version (default)</COMMENT>
  <COMMENT line1="313" col1="1" line2="313" col2="67" start="29736" end="29802">#' or the traditional matrix of fragments/counts per million mapped</COMMENT>
  <COMMENT line1="314" col1="1" line2="314" col2="23" start="29831" end="29853">#' fragments (FPM/CPM).</COMMENT>
  <COMMENT line1="315" col1="1" line2="315" col2="49" start="29926" end="29974">#' Note: this function is written very simply and</COMMENT>
  <COMMENT line1="316" col1="1" line2="316" col2="80" start="30021" end="30100">#' can be easily altered to produce other behavior by examining the source code.</COMMENT>
  <COMMENT line1="317" col1="1" line2="317" col2="3" start="30116" end="30118">#' </COMMENT>
  <COMMENT line1="318" col1="1" line2="318" col2="38" start="30211" end="30248">#' @param object a \code{DESeqDataSet}</COMMENT>
  <COMMENT line1="319" col1="1" line2="319" col2="57" start="30306" end="30362">#' @param robust whether to use size factors to normalize</COMMENT>
  <COMMENT line1="320" col1="1" line2="320" col2="56" start="30401" end="30456">#' rather than taking the column sums of the raw counts.</COMMENT>
  <COMMENT line1="321" col1="1" line2="321" col2="54" start="30496" end="30549">#' If TRUE, the size factors and the geometric mean of</COMMENT>
  <COMMENT line1="322" col1="1" line2="322" col2="71" start="30591" end="30661">#' column sums are multiplied to create a robust library size estimate.</COMMENT>
  <COMMENT line1="323" col1="1" line2="323" col2="78" start="30686" end="30763">#' Robust normalization is not used if average transcript lengths are present.</COMMENT>
  <COMMENT line1="324" col1="1" line2="324" col2="3" start="30781" end="30783">#' </COMMENT>
  <COMMENT line1="325" col1="1" line2="325" col2="72" start="30876" end="30947">#' @return a matrix which is normalized per million of mapped fragments,</COMMENT>
  <COMMENT line1="326" col1="1" line2="326" col2="69" start="30971" end="31039">#' either using the robust median ratio method (robust=TRUE, default)</COMMENT>
  <COMMENT line1="327" col1="1" line2="327" col2="38" start="31066" end="31103">#' or using raw counts (robust=FALSE).</COMMENT>
  <COMMENT line1="328" col1="1" line2="328" col2="2" start="31161" end="31162">#'</COMMENT>
  <COMMENT line1="329" col1="1" line2="329" col2="12" start="31256" end="31267">#' @examples</COMMENT>
  <COMMENT line1="330" col1="1" line2="330" col2="2" start="31351" end="31352">#'</COMMENT>
  <COMMENT line1="331" col1="1" line2="331" col2="54" start="31446" end="31499">#' # generate a dataset with size factors: .5, 1, 1, 2</COMMENT>
  <COMMENT line1="332" col1="1" line2="332" col2="50" start="31541" end="31590">#' dds &lt;- makeExampleDESeqDataSet(m = 4, n = 1000,</COMMENT>
  <COMMENT line1="333" col1="1" line2="333" col2="58" start="31636" end="31693">#'                                interceptMean=log2(1e3),</COMMENT>
  <COMMENT line1="334" col1="1" line2="334" col2="48" start="31731" end="31778">#'                                interceptSD=0,</COMMENT>
  <COMMENT line1="335" col1="1" line2="335" col2="58" start="31826" end="31883">#'                                sizeFactors=c(.5,1,1,2),</COMMENT>
  <COMMENT line1="336" col1="1" line2="336" col2="62" start="31921" end="31982">#'                                dispMeanRel=function(x) .01)</COMMENT>
  <COMMENT line1="337" col1="1" line2="337" col2="2" start="32016" end="32017">#'</COMMENT>
  <COMMENT line1="338" col1="1" line2="338" col2="40" start="32111" end="32150">#' # add a few rows with very high count</COMMENT>
  <COMMENT line1="339" col1="1" line2="339" col2="29" start="32206" end="32234">#' counts(dds)[4:10,] &lt;- 2e5L</COMMENT>
  <COMMENT line1="340" col1="1" line2="340" col2="2" start="32301" end="32302">#'</COMMENT>
  <COMMENT line1="341" col1="1" line2="341" col2="69" start="32396" end="32464">#' # in this robust version, the counts are comparable across samples</COMMENT>
  <COMMENT line1="342" col1="1" line2="342" col2="27" start="32491" end="32517">#' round(head(fpm(dds), 3))</COMMENT>
  <COMMENT line1="343" col1="1" line2="343" col2="2" start="32586" end="32587">#'</COMMENT>
  <COMMENT line1="344" col1="1" line2="344" col2="61" start="32681" end="32741">#' # in this column sum version, the counts are still skewed:</COMMENT>
  <COMMENT line1="345" col1="1" line2="345" col2="37" start="32776" end="32812">#' # sample1 &lt; sample2 &amp; 3 &lt; sample 4</COMMENT>
  <COMMENT line1="346" col1="1" line2="346" col2="41" start="32871" end="32911">#' round(head(fpm(dds, robust=FALSE), 3))</COMMENT>
  <COMMENT line1="347" col1="1" line2="347" col2="2" start="32966" end="32967">#'</COMMENT>
  <COMMENT line1="348" col1="1" line2="348" col2="42" start="33061" end="33102">#' # the column sums of the robust version</COMMENT>
  <COMMENT line1="349" col1="1" line2="349" col2="34" start="33156" end="33189">#' # are not equal to 1e6, but the</COMMENT>
  <COMMENT line1="350" col1="1" line2="350" col2="42" start="33251" end="33292">#' # column sums of the non-robust version</COMMENT>
  <COMMENT line1="351" col1="1" line2="351" col2="35" start="33346" end="33380">#' # are equal to 1e6 by definition</COMMENT>
  <COMMENT line1="352" col1="1" line2="352" col2="3" start="33441" end="33443">#' </COMMENT>
  <COMMENT line1="353" col1="1" line2="353" col2="24" start="33536" end="33559">#' colSums(fpm(dds))/1e6</COMMENT>
  <COMMENT line1="354" col1="1" line2="354" col2="38" start="33631" end="33668">#' colSums(fpm(dds, robust=FALSE))/1e6</COMMENT>
  <COMMENT line1="355" col1="1" line2="355" col2="2" start="33726" end="33727">#'</COMMENT>
  <COMMENT line1="356" col1="1" line2="356" col2="30" start="33821" end="33850">#' @seealso \code{\link{fpkm}}</COMMENT>
  <COMMENT line1="357" col1="1" line2="357" col2="2" start="33916" end="33917">#'</COMMENT>
  <COMMENT line1="358" col1="1" line2="358" col2="19" start="34011" end="34029">#' @docType methods</COMMENT>
  <COMMENT line1="359" col1="1" line2="359" col2="12" start="34106" end="34117">#' @name fpm</COMMENT>
  <COMMENT line1="360" col1="1" line2="360" col2="14" start="34201" end="34214">#' @rdname fpm</COMMENT>
  <COMMENT line1="361" col1="1" line2="361" col2="3" start="34296" end="34298">#' </COMMENT>
  <COMMENT line1="362" col1="1" line2="362" col2="10" start="34391" end="34400">#' @export</COMMENT>
  <expr line1="363" col1="1" line2="376" col2="1" start="34486" end="35721">
    <expr line1="363" col1="1" line2="363" col2="3" start="34486" end="34488">
      <SYMBOL line1="363" col1="1" line2="363" col2="3" start="34486" end="34488">fpm</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="363" col1="5" line2="363" col2="6" start="34490" end="34491">&lt;-</LEFT_ASSIGN>
    <expr line1="363" col1="8" line2="376" col2="1" start="34493" end="35721">
      <FUNCTION line1="363" col1="8" line2="363" col2="15" start="34493" end="34500">function</FUNCTION>
      <OP-LEFT-PAREN line1="363" col1="16" line2="363" col2="16" start="34501" end="34501">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="363" col1="17" line2="363" col2="22" start="34502" end="34507">object</SYMBOL_FORMALS>
      <OP-COMMA line1="363" col1="23" line2="363" col2="23" start="34508" end="34508">,</OP-COMMA>
      <SYMBOL_FORMALS line1="363" col1="25" line2="363" col2="30" start="34510" end="34515">robust</SYMBOL_FORMALS>
      <EQ_FORMALS line1="363" col1="31" line2="363" col2="31" start="34516" end="34516">=</EQ_FORMALS>
      <expr line1="363" col1="32" line2="363" col2="35" start="34517" end="34520">
        <NUM_CONST line1="363" col1="32" line2="363" col2="35" start="34517" end="34520">TRUE</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="363" col1="36" line2="363" col2="36" start="34521" end="34521">)</OP-RIGHT-PAREN>
      <expr line1="363" col1="38" line2="376" col2="1" start="34523" end="35721">
        <OP-LEFT-BRACE line1="363" col1="38" line2="363" col2="38" start="34523" end="34523">{</OP-LEFT-BRACE>
        <COMMENT line1="364" col1="3" line2="364" col2="63" start="34583" end="34643"># we do something different if average tx lengths are present</COMMENT>
        <expr line1="365" col1="3" line2="365" col2="56" start="34678" end="34731">
          <expr line1="365" col1="3" line2="365" col2="12" start="34678" end="34687">
            <SYMBOL line1="365" col1="3" line2="365" col2="12" start="34678" end="34687">noAvgTxLen</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="365" col1="14" line2="365" col2="15" start="34689" end="34690">&lt;-</LEFT_ASSIGN>
          <expr line1="365" col1="17" line2="365" col2="56" start="34692" end="34731">
            <OP-EXCLAMATION line1="365" col1="17" line2="365" col2="17" start="34692" end="34692">!</OP-EXCLAMATION>
            <expr line1="365" col1="18" line2="365" col2="56" start="34693" end="34731">
              <OP-LEFT-PAREN line1="365" col1="18" line2="365" col2="18" start="34693" end="34693">(</OP-LEFT-PAREN>
              <expr line1="365" col1="19" line2="365" col2="55" start="34694" end="34730">
                <expr line1="365" col1="19" line2="365" col2="31" start="34694" end="34706">
                  <STR_CONST line1="365" col1="19" line2="365" col2="31" start="34694" end="34706">"avgTxLength"</STR_CONST>
                </expr>
                <SPECIAL line1="365" col1="33" line2="365" col2="36" start="34708" end="34711">%in%</SPECIAL>
                <expr line1="365" col1="38" line2="365" col2="55" start="34713" end="34730">
                  <expr line1="365" col1="38" line2="365" col2="47" start="34713" end="34722">
                    <SYMBOL_FUNCTION_CALL line1="365" col1="38" line2="365" col2="47" start="34713" end="34722">assayNames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="365" col1="48" line2="365" col2="48" start="34723" end="34723">(</OP-LEFT-PAREN>
                  <expr line1="365" col1="49" line2="365" col2="54" start="34724" end="34729">
                    <SYMBOL line1="365" col1="49" line2="365" col2="54" start="34724" end="34729">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="365" col1="55" line2="365" col2="55" start="34730" end="34730">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-PAREN line1="365" col1="56" line2="365" col2="56" start="34731" end="34731">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
        </expr>
        <expr line1="366" col1="3" line2="368" col2="3" start="34773" end="34963">
          <IF line1="366" col1="3" line2="366" col2="4" start="34773" end="34774">if</IF>
          <OP-LEFT-PAREN line1="366" col1="6" line2="366" col2="6" start="34776" end="34776">(</OP-LEFT-PAREN>
          <expr line1="366" col1="7" line2="366" col2="56" start="34777" end="34826">
            <expr line1="366" col1="7" line2="366" col2="43" start="34777" end="34813">
              <expr line1="366" col1="7" line2="366" col2="12" start="34777" end="34782">
                <SYMBOL line1="366" col1="7" line2="366" col2="12" start="34777" end="34782">robust</SYMBOL>
              </expr>
              <AND line1="366" col1="14" line2="366" col2="14" start="34784" end="34784">&amp;</AND>
              <expr line1="366" col1="16" line2="366" col2="43" start="34786" end="34813">
                <expr line1="366" col1="16" line2="366" col2="22" start="34786" end="34792">
                  <SYMBOL_FUNCTION_CALL line1="366" col1="16" line2="366" col2="22" start="34786" end="34792">is.null</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="366" col1="23" line2="366" col2="23" start="34793" end="34793">(</OP-LEFT-PAREN>
                <expr line1="366" col1="24" line2="366" col2="42" start="34794" end="34812">
                  <expr line1="366" col1="24" line2="366" col2="34" start="34794" end="34804">
                    <SYMBOL_FUNCTION_CALL line1="366" col1="24" line2="366" col2="34" start="34794" end="34804">sizeFactors</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="366" col1="35" line2="366" col2="35" start="34805" end="34805">(</OP-LEFT-PAREN>
                  <expr line1="366" col1="36" line2="366" col2="41" start="34806" end="34811">
                    <SYMBOL line1="366" col1="36" line2="366" col2="41" start="34806" end="34811">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="366" col1="42" line2="366" col2="42" start="34812" end="34812">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="366" col1="43" line2="366" col2="43" start="34813" end="34813">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <AND line1="366" col1="45" line2="366" col2="45" start="34815" end="34815">&amp;</AND>
            <expr line1="366" col1="47" line2="366" col2="56" start="34817" end="34826">
              <SYMBOL line1="366" col1="47" line2="366" col2="56" start="34817" end="34826">noAvgTxLen</SYMBOL>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="366" col1="57" line2="366" col2="57" start="34827" end="34827">)</OP-RIGHT-PAREN>
          <expr line1="366" col1="59" line2="368" col2="3" start="34829" end="34963">
            <OP-LEFT-BRACE line1="366" col1="59" line2="366" col2="59" start="34829" end="34829">{</OP-LEFT-BRACE>
            <expr line1="367" col1="5" line2="367" col2="41" start="34870" end="34906">
              <expr line1="367" col1="5" line2="367" col2="10" start="34870" end="34875">
                <SYMBOL line1="367" col1="5" line2="367" col2="10" start="34870" end="34875">object</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="367" col1="12" line2="367" col2="13" start="34877" end="34878">&lt;-</LEFT_ASSIGN>
              <expr line1="367" col1="15" line2="367" col2="41" start="34880" end="34906">
                <expr line1="367" col1="15" line2="367" col2="33" start="34880" end="34898">
                  <SYMBOL_FUNCTION_CALL line1="367" col1="15" line2="367" col2="33" start="34880" end="34898">estimateSizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="367" col1="34" line2="367" col2="34" start="34899" end="34899">(</OP-LEFT-PAREN>
                <expr line1="367" col1="35" line2="367" col2="40" start="34900" end="34905">
                  <SYMBOL line1="367" col1="35" line2="367" col2="40" start="34900" end="34905">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="367" col1="41" line2="367" col2="41" start="34906" end="34906">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="368" col1="3" line2="368" col2="3" start="34963" end="34963">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="369" col1="3" line2="369" col2="21" start="35058" end="35076">
          <expr line1="369" col1="3" line2="369" col2="3" start="35058" end="35058">
            <SYMBOL line1="369" col1="3" line2="369" col2="3" start="35058" end="35058">k</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="369" col1="5" line2="369" col2="6" start="35060" end="35061">&lt;-</LEFT_ASSIGN>
          <expr line1="369" col1="8" line2="369" col2="21" start="35063" end="35076">
            <expr line1="369" col1="8" line2="369" col2="13" start="35063" end="35068">
              <SYMBOL_FUNCTION_CALL line1="369" col1="8" line2="369" col2="13" start="35063" end="35068">counts</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="369" col1="14" line2="369" col2="14" start="35069" end="35069">(</OP-LEFT-PAREN>
            <expr line1="369" col1="15" line2="369" col2="20" start="35070" end="35075">
              <SYMBOL line1="369" col1="15" line2="369" col2="20" start="35070" end="35075">object</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="369" col1="21" line2="369" col2="21" start="35076" end="35076">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="370" col1="3" line2="374" col2="3" start="35153" end="35533">
          <expr line1="370" col1="3" line2="370" col2="15" start="35153" end="35165">
            <SYMBOL line1="370" col1="3" line2="370" col2="15" start="35153" end="35165">library.sizes</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="370" col1="17" line2="370" col2="18" start="35167" end="35168">&lt;-</LEFT_ASSIGN>
          <expr line1="370" col1="20" line2="374" col2="3" start="35170" end="35533">
            <IF line1="370" col1="20" line2="370" col2="21" start="35170" end="35171">if</IF>
            <OP-LEFT-PAREN line1="370" col1="23" line2="370" col2="23" start="35173" end="35173">(</OP-LEFT-PAREN>
            <expr line1="370" col1="24" line2="370" col2="42" start="35174" end="35192">
              <expr line1="370" col1="24" line2="370" col2="29" start="35174" end="35179">
                <SYMBOL line1="370" col1="24" line2="370" col2="29" start="35174" end="35179">robust</SYMBOL>
              </expr>
              <AND line1="370" col1="31" line2="370" col2="31" start="35181" end="35181">&amp;</AND>
              <expr line1="370" col1="33" line2="370" col2="42" start="35183" end="35192">
                <SYMBOL line1="370" col1="33" line2="370" col2="42" start="35183" end="35192">noAvgTxLen</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="370" col1="43" line2="370" col2="43" start="35193" end="35193">)</OP-RIGHT-PAREN>
            <expr line1="370" col1="45" line2="372" col2="3" start="35195" end="35343">
              <OP-LEFT-BRACE line1="370" col1="45" line2="370" col2="45" start="35195" end="35195">{</OP-LEFT-BRACE>
              <expr line1="371" col1="5" line2="371" col2="52" start="35250" end="35297">
                <expr line1="371" col1="5" line2="371" col2="23" start="35250" end="35268">
                  <expr line1="371" col1="5" line2="371" col2="15" start="35250" end="35260">
                    <SYMBOL_FUNCTION_CALL line1="371" col1="5" line2="371" col2="15" start="35250" end="35260">sizeFactors</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="371" col1="16" line2="371" col2="16" start="35261" end="35261">(</OP-LEFT-PAREN>
                  <expr line1="371" col1="17" line2="371" col2="22" start="35262" end="35267">
                    <SYMBOL line1="371" col1="17" line2="371" col2="22" start="35262" end="35267">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="371" col1="23" line2="371" col2="23" start="35268" end="35268">)</OP-RIGHT-PAREN>
                </expr>
                <OP-STAR line1="371" col1="25" line2="371" col2="25" start="35270" end="35270">*</OP-STAR>
                <expr line1="371" col1="27" line2="371" col2="52" start="35272" end="35297">
                  <expr line1="371" col1="27" line2="371" col2="29" start="35272" end="35274">
                    <SYMBOL_FUNCTION_CALL line1="371" col1="27" line2="371" col2="29" start="35272" end="35274">exp</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="371" col1="30" line2="371" col2="30" start="35275" end="35275">(</OP-LEFT-PAREN>
                  <expr line1="371" col1="31" line2="371" col2="51" start="35276" end="35296">
                    <expr line1="371" col1="31" line2="371" col2="34" start="35276" end="35279">
                      <SYMBOL_FUNCTION_CALL line1="371" col1="31" line2="371" col2="34" start="35276" end="35279">mean</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="371" col1="35" line2="371" col2="35" start="35280" end="35280">(</OP-LEFT-PAREN>
                    <expr line1="371" col1="36" line2="371" col2="50" start="35281" end="35295">
                      <expr line1="371" col1="36" line2="371" col2="38" start="35281" end="35283">
                        <SYMBOL_FUNCTION_CALL line1="371" col1="36" line2="371" col2="38" start="35281" end="35283">log</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="371" col1="39" line2="371" col2="39" start="35284" end="35284">(</OP-LEFT-PAREN>
                      <expr line1="371" col1="40" line2="371" col2="49" start="35285" end="35294">
                        <expr line1="371" col1="40" line2="371" col2="46" start="35285" end="35291">
                          <SYMBOL_FUNCTION_CALL line1="371" col1="40" line2="371" col2="46" start="35285" end="35291">colSums</SYMBOL_FUNCTION_CALL>
                        </expr>
                        <OP-LEFT-PAREN line1="371" col1="47" line2="371" col2="47" start="35292" end="35292">(</OP-LEFT-PAREN>
                        <expr line1="371" col1="48" line2="371" col2="48" start="35293" end="35293">
                          <SYMBOL line1="371" col1="48" line2="371" col2="48" start="35293" end="35293">k</SYMBOL>
                        </expr>
                        <OP-RIGHT-PAREN line1="371" col1="49" line2="371" col2="49" start="35294" end="35294">)</OP-RIGHT-PAREN>
                      </expr>
                      <OP-RIGHT-PAREN line1="371" col1="50" line2="371" col2="50" start="35295" end="35295">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="371" col1="51" line2="371" col2="51" start="35296" end="35296">)</OP-RIGHT-PAREN>
                  </expr>
                  <OP-RIGHT-PAREN line1="371" col1="52" line2="371" col2="52" start="35297" end="35297">)</OP-RIGHT-PAREN>
                </expr>
              </expr>
              <OP-RIGHT-BRACE line1="372" col1="3" line2="372" col2="3" start="35343" end="35343">}</OP-RIGHT-BRACE>
            </expr>
            <ELSE line1="372" col1="5" line2="372" col2="8" start="35345" end="35348">else</ELSE>
            <expr line1="372" col1="10" line2="374" col2="3" start="35350" end="35533">
              <OP-LEFT-BRACE line1="372" col1="10" line2="372" col2="10" start="35350" end="35350">{</OP-LEFT-BRACE>
              <expr line1="373" col1="5" line2="373" col2="14" start="35440" end="35449">
                <expr line1="373" col1="5" line2="373" col2="11" start="35440" end="35446">
                  <SYMBOL_FUNCTION_CALL line1="373" col1="5" line2="373" col2="11" start="35440" end="35446">colSums</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="373" col1="12" line2="373" col2="12" start="35447" end="35447">(</OP-LEFT-PAREN>
                <expr line1="373" col1="13" line2="373" col2="13" start="35448" end="35448">
                  <SYMBOL line1="373" col1="13" line2="373" col2="13" start="35448" end="35448">k</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="373" col1="14" line2="373" col2="14" start="35449" end="35449">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-BRACE line1="374" col1="3" line2="374" col2="3" start="35533" end="35533">}</OP-RIGHT-BRACE>
            </expr>
          </expr>
        </expr>
        <expr line1="375" col1="3" line2="375" col2="39" start="35628" end="35664">
          <expr line1="375" col1="3" line2="375" col2="5" start="35628" end="35630">
            <NUM_CONST line1="375" col1="3" line2="375" col2="5" start="35628" end="35630">1e6</NUM_CONST>
          </expr>
          <OP-STAR line1="375" col1="7" line2="375" col2="7" start="35632" end="35632">*</OP-STAR>
          <expr line1="375" col1="9" line2="375" col2="39" start="35634" end="35664">
            <expr line1="375" col1="9" line2="375" col2="13" start="35634" end="35638">
              <SYMBOL_FUNCTION_CALL line1="375" col1="9" line2="375" col2="13" start="35634" end="35638">sweep</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="375" col1="14" line2="375" col2="14" start="35639" end="35639">(</OP-LEFT-PAREN>
            <expr line1="375" col1="15" line2="375" col2="15" start="35640" end="35640">
              <SYMBOL line1="375" col1="15" line2="375" col2="15" start="35640" end="35640">k</SYMBOL>
            </expr>
            <OP-COMMA line1="375" col1="16" line2="375" col2="16" start="35641" end="35641">,</OP-COMMA>
            <expr line1="375" col1="18" line2="375" col2="18" start="35643" end="35643">
              <NUM_CONST line1="375" col1="18" line2="375" col2="18" start="35643" end="35643">2</NUM_CONST>
            </expr>
            <OP-COMMA line1="375" col1="19" line2="375" col2="19" start="35644" end="35644">,</OP-COMMA>
            <expr line1="375" col1="21" line2="375" col2="33" start="35646" end="35658">
              <SYMBOL line1="375" col1="21" line2="375" col2="33" start="35646" end="35658">library.sizes</SYMBOL>
            </expr>
            <OP-COMMA line1="375" col1="34" line2="375" col2="34" start="35659" end="35659">,</OP-COMMA>
            <expr line1="375" col1="36" line2="375" col2="38" start="35661" end="35663">
              <STR_CONST line1="375" col1="36" line2="375" col2="38" start="35661" end="35663">"/"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="375" col1="39" line2="375" col2="39" start="35664" end="35664">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <OP-RIGHT-BRACE line1="376" col1="1" line2="376" col2="1" start="35721" end="35721">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="380" col1="1" line2="380" col2="28" start="36101" end="36128">#' Normalize for gene length</COMMENT>
  <COMMENT line1="381" col1="1" line2="381" col2="2" start="36196" end="36197">#'</COMMENT>
  <COMMENT line1="382" col1="1" line2="382" col2="80" start="36291" end="36370">#' Normalize for gene length using the output of transcript abundance estimators</COMMENT>
  <COMMENT line1="383" col1="1" line2="383" col2="2" start="36386" end="36387">#'</COMMENT>
  <COMMENT line1="384" col1="1" line2="384" col2="74" start="36481" end="36554">#' This function is deprecated and moved to a new general purpose package,</COMMENT>
  <COMMENT line1="385" col1="1" line2="385" col2="49" start="36576" end="36624">#' tximport, which will be added to Bioconductor.</COMMENT>
  <COMMENT line1="386" col1="1" line2="386" col2="2" start="36671" end="36672">#'</COMMENT>
  <COMMENT line1="387" col1="1" line2="387" col2="17" start="36766" end="36782">#' @param ... ...</COMMENT>
  <COMMENT line1="388" col1="1" line2="388" col2="3" start="36861" end="36863">#' </COMMENT>
  <COMMENT line1="389" col1="1" line2="389" col2="10" start="36956" end="36965">#' @export</COMMENT>
  <expr line1="390" col1="1" line2="392" col2="1" start="37051" end="37241">
    <expr line1="390" col1="1" line2="390" col2="19" start="37051" end="37069">
      <SYMBOL line1="390" col1="1" line2="390" col2="19" start="37051" end="37069">normalizeGeneLength</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="390" col1="21" line2="390" col2="22" start="37071" end="37072">&lt;-</LEFT_ASSIGN>
    <expr line1="390" col1="24" line2="392" col2="1" start="37074" end="37241">
      <FUNCTION line1="390" col1="24" line2="390" col2="31" start="37074" end="37081">function</FUNCTION>
      <OP-LEFT-PAREN line1="390" col1="32" line2="390" col2="32" start="37082" end="37082">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="390" col1="33" line2="390" col2="35" start="37083" end="37085">...</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="390" col1="36" line2="390" col2="36" start="37086" end="37086">)</OP-RIGHT-PAREN>
      <expr line1="390" col1="38" line2="392" col2="1" start="37088" end="37241">
        <OP-LEFT-BRACE line1="390" col1="38" line2="390" col2="38" start="37088" end="37088">{</OP-LEFT-BRACE>
        <expr line1="391" col1="3" line2="391" col2="61" start="37148" end="37206">
          <expr line1="391" col1="3" line2="391" col2="13" start="37148" end="37158">
            <SYMBOL_FUNCTION_CALL line1="391" col1="3" line2="391" col2="13" start="37148" end="37158">.Deprecated</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="391" col1="14" line2="391" col2="14" start="37159" end="37159">(</OP-LEFT-PAREN>
          <expr line1="391" col1="15" line2="391" col2="60" start="37160" end="37205">
            <STR_CONST line1="391" col1="15" line2="391" col2="60" start="37160" end="37205">"tximport, a separate package on Bioconductor"</STR_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="391" col1="61" line2="391" col2="61" start="37206" end="37206">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="392" col1="1" line2="392" col2="1" start="37241" end="37241">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="394" col1="1" line2="394" col2="35" start="37431" end="37465">#' Normalized counts transformation</COMMENT>
  <COMMENT line1="395" col1="1" line2="395" col2="2" start="37526" end="37527">#'</COMMENT>
  <COMMENT line1="396" col1="1" line2="396" col2="64" start="37621" end="37684">#' A simple function for creating a \code{\link{DESeqTransform}}</COMMENT>
  <COMMENT line1="397" col1="1" line2="397" col2="68" start="37716" end="37783">#' object after applying: \code{f(count(dds,normalized=TRUE) + pc)}.</COMMENT>
  <COMMENT line1="398" col1="1" line2="398" col2="3" start="37811" end="37813">#' </COMMENT>
  <COMMENT line1="399" col1="1" line2="399" col2="38" start="37906" end="37943">#' @param object a DESeqDataSet object</COMMENT>
  <COMMENT line1="400" col1="1" line2="400" col2="52" start="38001" end="38052">#' @param f a function to apply to normalized counts</COMMENT>
  <COMMENT line1="401" col1="1" line2="401" col2="54" start="38096" end="38149">#' @param pc a pseudocount to add to normalized counts</COMMENT>
  <COMMENT line1="402" col1="1" line2="402" col2="3" start="38191" end="38193">#' </COMMENT>
  <COMMENT line1="403" col1="1" line2="403" col2="79" start="38286" end="38364">#' @seealso \code{\link{varianceStabilizingTransformation}}, \code{\link{rlog}}</COMMENT>
  <COMMENT line1="404" col1="1" line2="404" col2="3" start="38381" end="38383">#' </COMMENT>
  <COMMENT line1="405" col1="1" line2="405" col2="10" start="38476" end="38485">#' @export</COMMENT>
  <expr line1="406" col1="1" line2="420" col2="1" start="38571" end="39901">
    <expr line1="406" col1="1" line2="406" col2="13" start="38571" end="38583">
      <SYMBOL line1="406" col1="1" line2="406" col2="13" start="38571" end="38583">normTransform</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="406" col1="15" line2="406" col2="16" start="38585" end="38586">&lt;-</LEFT_ASSIGN>
    <expr line1="406" col1="18" line2="420" col2="1" start="38588" end="39901">
      <FUNCTION line1="406" col1="18" line2="406" col2="25" start="38588" end="38595">function</FUNCTION>
      <OP-LEFT-PAREN line1="406" col1="26" line2="406" col2="26" start="38596" end="38596">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="406" col1="27" line2="406" col2="32" start="38597" end="38602">object</SYMBOL_FORMALS>
      <OP-COMMA line1="406" col1="33" line2="406" col2="33" start="38603" end="38603">,</OP-COMMA>
      <SYMBOL_FORMALS line1="406" col1="35" line2="406" col2="35" start="38605" end="38605">f</SYMBOL_FORMALS>
      <EQ_FORMALS line1="406" col1="36" line2="406" col2="36" start="38606" end="38606">=</EQ_FORMALS>
      <expr line1="406" col1="37" line2="406" col2="40" start="38607" end="38610">
        <SYMBOL line1="406" col1="37" line2="406" col2="40" start="38607" end="38610">log2</SYMBOL>
      </expr>
      <OP-COMMA line1="406" col1="41" line2="406" col2="41" start="38611" end="38611">,</OP-COMMA>
      <SYMBOL_FORMALS line1="406" col1="43" line2="406" col2="44" start="38613" end="38614">pc</SYMBOL_FORMALS>
      <EQ_FORMALS line1="406" col1="45" line2="406" col2="45" start="38615" end="38615">=</EQ_FORMALS>
      <expr line1="406" col1="46" line2="406" col2="46" start="38616" end="38616">
        <NUM_CONST line1="406" col1="46" line2="406" col2="46" start="38616" end="38616">1</NUM_CONST>
      </expr>
      <OP-RIGHT-PAREN line1="406" col1="47" line2="406" col2="47" start="38617" end="38617">)</OP-RIGHT-PAREN>
      <expr line1="406" col1="49" line2="420" col2="1" start="38619" end="39901">
        <OP-LEFT-BRACE line1="406" col1="49" line2="406" col2="49" start="38619" end="38619">{</OP-LEFT-BRACE>
        <expr line1="407" col1="3" line2="409" col2="3" start="38668" end="38858">
          <IF line1="407" col1="3" line2="407" col2="4" start="38668" end="38669">if</IF>
          <OP-LEFT-PAREN line1="407" col1="6" line2="407" col2="6" start="38671" end="38671">(</OP-LEFT-PAREN>
          <expr line1="407" col1="7" line2="407" col2="31" start="38672" end="38696">
            <expr line1="407" col1="7" line2="407" col2="13" start="38672" end="38678">
              <SYMBOL_FUNCTION_CALL line1="407" col1="7" line2="407" col2="13" start="38672" end="38678">is.null</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="407" col1="14" line2="407" col2="14" start="38679" end="38679">(</OP-LEFT-PAREN>
            <expr line1="407" col1="15" line2="407" col2="30" start="38680" end="38695">
              <expr line1="407" col1="15" line2="407" col2="22" start="38680" end="38687">
                <SYMBOL_FUNCTION_CALL line1="407" col1="15" line2="407" col2="22" start="38680" end="38687">colnames</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="407" col1="23" line2="407" col2="23" start="38688" end="38688">(</OP-LEFT-PAREN>
              <expr line1="407" col1="24" line2="407" col2="29" start="38689" end="38694">
                <SYMBOL line1="407" col1="24" line2="407" col2="29" start="38689" end="38694">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="407" col1="30" line2="407" col2="30" start="38695" end="38695">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="407" col1="31" line2="407" col2="31" start="38696" end="38696">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="407" col1="32" line2="407" col2="32" start="38697" end="38697">)</OP-RIGHT-PAREN>
          <expr line1="407" col1="34" line2="409" col2="3" start="38699" end="38858">
            <OP-LEFT-BRACE line1="407" col1="34" line2="407" col2="34" start="38699" end="38699">{</OP-LEFT-BRACE>
            <expr line1="408" col1="5" line2="408" col2="45" start="38765" end="38805">
              <expr line1="408" col1="5" line2="408" col2="20" start="38765" end="38780">
                <expr line1="408" col1="5" line2="408" col2="12" start="38765" end="38772">
                  <SYMBOL_FUNCTION_CALL line1="408" col1="5" line2="408" col2="12" start="38765" end="38772">colnames</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="408" col1="13" line2="408" col2="13" start="38773" end="38773">(</OP-LEFT-PAREN>
                <expr line1="408" col1="14" line2="408" col2="19" start="38774" end="38779">
                  <SYMBOL line1="408" col1="14" line2="408" col2="19" start="38774" end="38779">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="408" col1="20" line2="408" col2="20" start="38780" end="38780">)</OP-RIGHT-PAREN>
              </expr>
              <LEFT_ASSIGN line1="408" col1="22" line2="408" col2="23" start="38782" end="38783">&lt;-</LEFT_ASSIGN>
              <expr line1="408" col1="25" line2="408" col2="45" start="38785" end="38805">
                <expr line1="408" col1="25" line2="408" col2="31" start="38785" end="38791">
                  <SYMBOL_FUNCTION_CALL line1="408" col1="25" line2="408" col2="31" start="38785" end="38791">seq_len</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="408" col1="32" line2="408" col2="32" start="38792" end="38792">(</OP-LEFT-PAREN>
                <expr line1="408" col1="33" line2="408" col2="44" start="38793" end="38804">
                  <expr line1="408" col1="33" line2="408" col2="36" start="38793" end="38796">
                    <SYMBOL_FUNCTION_CALL line1="408" col1="33" line2="408" col2="36" start="38793" end="38796">ncol</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="408" col1="37" line2="408" col2="37" start="38797" end="38797">(</OP-LEFT-PAREN>
                  <expr line1="408" col1="38" line2="408" col2="43" start="38798" end="38803">
                    <SYMBOL line1="408" col1="38" line2="408" col2="43" start="38798" end="38803">object</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="408" col1="44" line2="408" col2="44" start="38804" end="38804">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-PAREN line1="408" col1="45" line2="408" col2="45" start="38805" end="38805">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="409" col1="3" line2="409" col2="3" start="38858" end="38858">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="410" col1="3" line2="412" col2="3" start="38953" end="39143">
          <IF line1="410" col1="3" line2="410" col2="4" start="38953" end="38954">if</IF>
          <OP-LEFT-PAREN line1="410" col1="6" line2="410" col2="6" start="38956" end="38956">(</OP-LEFT-PAREN>
          <expr line1="410" col1="7" line2="410" col2="74" start="38957" end="39024">
            <expr line1="410" col1="7" line2="410" col2="34" start="38957" end="38984">
              <expr line1="410" col1="7" line2="410" col2="13" start="38957" end="38963">
                <SYMBOL_FUNCTION_CALL line1="410" col1="7" line2="410" col2="13" start="38957" end="38963">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="410" col1="14" line2="410" col2="14" start="38964" end="38964">(</OP-LEFT-PAREN>
              <expr line1="410" col1="15" line2="410" col2="33" start="38965" end="38983">
                <expr line1="410" col1="15" line2="410" col2="25" start="38965" end="38975">
                  <SYMBOL_FUNCTION_CALL line1="410" col1="15" line2="410" col2="25" start="38965" end="38975">sizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="410" col1="26" line2="410" col2="26" start="38976" end="38976">(</OP-LEFT-PAREN>
                <expr line1="410" col1="27" line2="410" col2="32" start="38977" end="38982">
                  <SYMBOL line1="410" col1="27" line2="410" col2="32" start="38977" end="38982">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="410" col1="33" line2="410" col2="33" start="38983" end="38983">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="410" col1="34" line2="410" col2="34" start="38984" end="38984">)</OP-RIGHT-PAREN>
            </expr>
            <AND line1="410" col1="36" line2="410" col2="36" start="38986" end="38986">&amp;</AND>
            <expr line1="410" col1="38" line2="410" col2="74" start="38988" end="39024">
              <expr line1="410" col1="38" line2="410" col2="44" start="38988" end="38994">
                <SYMBOL_FUNCTION_CALL line1="410" col1="38" line2="410" col2="44" start="38988" end="38994">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="410" col1="45" line2="410" col2="45" start="38995" end="38995">(</OP-LEFT-PAREN>
              <expr line1="410" col1="46" line2="410" col2="73" start="38996" end="39023">
                <expr line1="410" col1="46" line2="410" col2="65" start="38996" end="39015">
                  <SYMBOL_FUNCTION_CALL line1="410" col1="46" line2="410" col2="65" start="38996" end="39015">normalizationFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="410" col1="66" line2="410" col2="66" start="39016" end="39016">(</OP-LEFT-PAREN>
                <expr line1="410" col1="67" line2="410" col2="72" start="39017" end="39022">
                  <SYMBOL line1="410" col1="67" line2="410" col2="72" start="39017" end="39022">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="410" col1="73" line2="410" col2="73" start="39023" end="39023">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="410" col1="74" line2="410" col2="74" start="39024" end="39024">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="410" col1="75" line2="410" col2="75" start="39025" end="39025">)</OP-RIGHT-PAREN>
          <expr line1="410" col1="77" line2="412" col2="3" start="39027" end="39143">
            <OP-LEFT-BRACE line1="410" col1="77" line2="410" col2="77" start="39027" end="39027">{</OP-LEFT-BRACE>
            <expr line1="411" col1="5" line2="411" col2="41" start="39050" end="39086">
              <expr line1="411" col1="5" line2="411" col2="10" start="39050" end="39055">
                <SYMBOL line1="411" col1="5" line2="411" col2="10" start="39050" end="39055">object</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="411" col1="12" line2="411" col2="13" start="39057" end="39058">&lt;-</LEFT_ASSIGN>
              <expr line1="411" col1="15" line2="411" col2="41" start="39060" end="39086">
                <expr line1="411" col1="15" line2="411" col2="33" start="39060" end="39078">
                  <SYMBOL_FUNCTION_CALL line1="411" col1="15" line2="411" col2="33" start="39060" end="39078">estimateSizeFactors</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="411" col1="34" line2="411" col2="34" start="39079" end="39079">(</OP-LEFT-PAREN>
                <expr line1="411" col1="35" line2="411" col2="40" start="39080" end="39085">
                  <SYMBOL line1="411" col1="35" line2="411" col2="40" start="39080" end="39085">object</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="411" col1="41" line2="411" col2="41" start="39086" end="39086">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="412" col1="3" line2="412" col2="3" start="39143" end="39143">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="413" col1="3" line2="413" col2="47" start="39238" end="39282">
          <expr line1="413" col1="3" line2="413" col2="4" start="39238" end="39239">
            <SYMBOL line1="413" col1="3" line2="413" col2="4" start="39238" end="39239">nt</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="413" col1="6" line2="413" col2="7" start="39241" end="39242">&lt;-</LEFT_ASSIGN>
          <expr line1="413" col1="9" line2="413" col2="47" start="39244" end="39282">
            <expr line1="413" col1="9" line2="413" col2="9" start="39244" end="39244">
              <SYMBOL_FUNCTION_CALL line1="413" col1="9" line2="413" col2="9" start="39244" end="39244">f</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="413" col1="10" line2="413" col2="10" start="39245" end="39245">(</OP-LEFT-PAREN>
            <expr line1="413" col1="11" line2="413" col2="46" start="39246" end="39281">
              <expr line1="413" col1="11" line2="413" col2="41" start="39246" end="39276">
                <expr line1="413" col1="11" line2="413" col2="16" start="39246" end="39251">
                  <SYMBOL_FUNCTION_CALL line1="413" col1="11" line2="413" col2="16" start="39246" end="39251">counts</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="413" col1="17" line2="413" col2="17" start="39252" end="39252">(</OP-LEFT-PAREN>
                <expr line1="413" col1="18" line2="413" col2="23" start="39253" end="39258">
                  <SYMBOL line1="413" col1="18" line2="413" col2="23" start="39253" end="39258">object</SYMBOL>
                </expr>
                <OP-COMMA line1="413" col1="24" line2="413" col2="24" start="39259" end="39259">,</OP-COMMA>
                <SYMBOL_SUB line1="413" col1="26" line2="413" col2="35" start="39261" end="39270">normalized</SYMBOL_SUB>
                <EQ_SUB line1="413" col1="36" line2="413" col2="36" start="39271" end="39271">=</EQ_SUB>
                <expr line1="413" col1="37" line2="413" col2="40" start="39272" end="39275">
                  <NUM_CONST line1="413" col1="37" line2="413" col2="40" start="39272" end="39275">TRUE</NUM_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="413" col1="41" line2="413" col2="41" start="39276" end="39276">)</OP-RIGHT-PAREN>
              </expr>
              <OP-PLUS line1="413" col1="43" line2="413" col2="43" start="39278" end="39278">+</OP-PLUS>
              <expr line1="413" col1="45" line2="413" col2="46" start="39280" end="39281">
                <SYMBOL line1="413" col1="45" line2="413" col2="46" start="39280" end="39281">pc</SYMBOL>
              </expr>
            </expr>
            <OP-RIGHT-PAREN line1="413" col1="47" line2="413" col2="47" start="39282" end="39282">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="414" col1="3" line2="418" col2="32" start="39333" end="39742">
          <expr line1="414" col1="3" line2="414" col2="4" start="39333" end="39334">
            <SYMBOL line1="414" col1="3" line2="414" col2="4" start="39333" end="39334">se</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="414" col1="6" line2="414" col2="7" start="39336" end="39337">&lt;-</LEFT_ASSIGN>
          <expr line1="414" col1="9" line2="418" col2="32" start="39339" end="39742">
            <expr line1="414" col1="9" line2="414" col2="28" start="39339" end="39358">
              <SYMBOL_FUNCTION_CALL line1="414" col1="9" line2="414" col2="28" start="39339" end="39358">SummarizedExperiment</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="414" col1="29" line2="414" col2="29" start="39359" end="39359">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="415" col1="5" line2="415" col2="10" start="39430" end="39435">assays</SYMBOL_SUB>
            <EQ_SUB line1="415" col1="12" line2="415" col2="12" start="39437" end="39437">=</EQ_SUB>
            <expr line1="415" col1="14" line2="415" col2="15" start="39439" end="39440">
              <SYMBOL line1="415" col1="14" line2="415" col2="15" start="39439" end="39440">nt</SYMBOL>
            </expr>
            <OP-COMMA line1="415" col1="16" line2="415" col2="16" start="39441" end="39441">,</OP-COMMA>
            <SYMBOL_SUB line1="416" col1="5" line2="416" col2="11" start="39525" end="39531">colData</SYMBOL_SUB>
            <EQ_SUB line1="416" col1="13" line2="416" col2="13" start="39533" end="39533">=</EQ_SUB>
            <expr line1="416" col1="15" line2="416" col2="29" start="39535" end="39549">
              <expr line1="416" col1="15" line2="416" col2="21" start="39535" end="39541">
                <SYMBOL_FUNCTION_CALL line1="416" col1="15" line2="416" col2="21" start="39535" end="39541">colData</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="416" col1="22" line2="416" col2="22" start="39542" end="39542">(</OP-LEFT-PAREN>
              <expr line1="416" col1="23" line2="416" col2="28" start="39543" end="39548">
                <SYMBOL line1="416" col1="23" line2="416" col2="28" start="39543" end="39548">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="416" col1="29" line2="416" col2="29" start="39549" end="39549">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="416" col1="30" line2="416" col2="30" start="39550" end="39550">,</OP-COMMA>
            <SYMBOL_SUB line1="417" col1="5" line2="417" col2="13" start="39620" end="39628">rowRanges</SYMBOL_SUB>
            <EQ_SUB line1="417" col1="15" line2="417" col2="15" start="39630" end="39630">=</EQ_SUB>
            <expr line1="417" col1="17" line2="417" col2="33" start="39632" end="39648">
              <expr line1="417" col1="17" line2="417" col2="25" start="39632" end="39640">
                <SYMBOL_FUNCTION_CALL line1="417" col1="17" line2="417" col2="25" start="39632" end="39640">rowRanges</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="417" col1="26" line2="417" col2="26" start="39641" end="39641">(</OP-LEFT-PAREN>
              <expr line1="417" col1="27" line2="417" col2="32" start="39642" end="39647">
                <SYMBOL line1="417" col1="27" line2="417" col2="32" start="39642" end="39647">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="417" col1="33" line2="417" col2="33" start="39648" end="39648">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="417" col1="34" line2="417" col2="34" start="39649" end="39649">,</OP-COMMA>
            <SYMBOL_SUB line1="418" col1="5" line2="418" col2="12" start="39715" end="39722">metadata</SYMBOL_SUB>
            <EQ_SUB line1="418" col1="14" line2="418" col2="14" start="39724" end="39724">=</EQ_SUB>
            <expr line1="418" col1="16" line2="418" col2="31" start="39726" end="39741">
              <expr line1="418" col1="16" line2="418" col2="23" start="39726" end="39733">
                <SYMBOL_FUNCTION_CALL line1="418" col1="16" line2="418" col2="23" start="39726" end="39733">metadata</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="418" col1="24" line2="418" col2="24" start="39734" end="39734">(</OP-LEFT-PAREN>
              <expr line1="418" col1="25" line2="418" col2="30" start="39735" end="39740">
                <SYMBOL line1="418" col1="25" line2="418" col2="30" start="39735" end="39740">object</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="418" col1="31" line2="418" col2="31" start="39741" end="39741">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="418" col1="32" line2="418" col2="32" start="39742" end="39742">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="419" col1="3" line2="419" col2="20" start="39808" end="39825">
          <expr line1="419" col1="3" line2="419" col2="16" start="39808" end="39821">
            <SYMBOL_FUNCTION_CALL line1="419" col1="3" line2="419" col2="16" start="39808" end="39821">DESeqTransform</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="419" col1="17" line2="419" col2="17" start="39822" end="39822">(</OP-LEFT-PAREN>
          <expr line1="419" col1="18" line2="419" col2="19" start="39823" end="39824">
            <SYMBOL line1="419" col1="18" line2="419" col2="19" start="39823" end="39824">se</SYMBOL>
          </expr>
          <OP-RIGHT-PAREN line1="419" col1="20" line2="419" col2="20" start="39825" end="39825">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="420" col1="1" line2="420" col2="1" start="39901" end="39901">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
  <COMMENT line1="422" col1="1" line2="422" col2="75" start="40091" end="40165">#' Integrate bulk DE results with Bioconductor single-cell RNA-seq datasets</COMMENT>
  <COMMENT line1="423" col1="1" line2="423" col2="2" start="40186" end="40187">#'</COMMENT>
  <COMMENT line1="424" col1="1" line2="424" col2="69" start="40281" end="40349">#' A function that assists with integration of bulk DE results tables</COMMENT>
  <COMMENT line1="425" col1="1" line2="425" col2="67" start="40376" end="40442">#' with pre-processed scRNA-seq datasets available on Bioconductor,</COMMENT>
  <COMMENT line1="426" col1="1" line2="426" col2="67" start="40471" end="40537">#' for downstream visualization tasks. The user is prompted to pick</COMMENT>
  <COMMENT line1="427" col1="1" line2="427" col2="65" start="40566" end="40630">#' a scRNA-seq dataset from a menu. The output of the function is</COMMENT>
  <COMMENT line1="428" col1="1" line2="428" col2="60" start="40661" end="40720">#' a list with the original results table, bulk gene counts,</COMMENT>
  <COMMENT line1="429" col1="1" line2="429" col2="60" start="40756" end="40815">#' and the SingleCellExperiment object selected by the user.</COMMENT>
  <COMMENT line1="430" col1="1" line2="430" col2="2" start="40851" end="40852">#'</COMMENT>
  <COMMENT line1="431" col1="1" line2="431" col2="77" start="40946" end="41022">#' This function assists the user in choosing a datset from a menu of options</COMMENT>
  <COMMENT line1="432" col1="1" line2="432" col2="66" start="41041" end="41106">#' that are selected based on the organism of the current dataset.</COMMENT>
  <COMMENT line1="433" col1="1" line2="433" col2="71" start="41136" end="41206">#' Currently only human and mouse bulk and single-cell RNA-seq datasets</COMMENT>
  <COMMENT line1="434" col1="1" line2="434" col2="72" start="41231" end="41302">#' are supported, and it is assumed that the bulk DE dataset has GENCODE</COMMENT>
  <COMMENT line1="435" col1="1" line2="435" col2="72" start="41326" end="41397">#' or Ensembl gene identifiers. Following the selection of the scRNA-seq</COMMENT>
  <COMMENT line1="436" col1="1" line2="436" col2="76" start="41421" end="41496">#' dataset, visualization can be performed with a package \code{vizWithSCE},</COMMENT>
  <COMMENT line1="437" col1="1" line2="437" col2="79" start="41516" end="41594">#' which can be installed with \code{install_github("KwameForbes/vizWithSCE")}.</COMMENT>
  <COMMENT line1="438" col1="1" line2="438" col2="3" start="41611" end="41613">#' </COMMENT>
  <COMMENT line1="439" col1="1" line2="439" col2="68" start="41706" end="41773">#' @param res a results table, as produced via \code{\link{results}}</COMMENT>
  <COMMENT line1="440" col1="1" line2="440" col2="63" start="41801" end="41863">#' @param dds a DESeqDataSet with the bulk gene expression data</COMMENT>
  <COMMENT line1="441" col1="1" line2="441" col2="37" start="41896" end="41932">#' (should contain gene-level counts)</COMMENT>
  <COMMENT line1="442" col1="1" line2="442" col2="75" start="41991" end="42065">#' @param ... additional arguments passed to the dataset-accessing function</COMMENT>
  <COMMENT line1="443" col1="1" line2="443" col2="2" start="42086" end="42087">#'</COMMENT>
  <COMMENT line1="444" col1="1" line2="444" col2="76" start="42181" end="42256">#' @return list containing: res, dds, and a SingleCellExperiment as selected</COMMENT>
  <COMMENT line1="445" col1="1" line2="445" col2="14" start="42276" end="42289">#' by the user</COMMENT>
  <COMMENT line1="446" col1="1" line2="446" col2="2" start="42371" end="42372">#'</COMMENT>
  <COMMENT line1="447" col1="1" line2="447" col2="12" start="42466" end="42477">#' @examples</COMMENT>
  <COMMENT line1="448" col1="1" line2="448" col2="2" start="42561" end="42562">#'</COMMENT>
  <COMMENT line1="449" col1="1" line2="449" col2="12" start="42656" end="42667">#' \dontrun{</COMMENT>
  <COMMENT line1="450" col1="1" line2="450" col2="45" start="42751" end="42795">#'   # involves interactive menu selection...</COMMENT>
  <COMMENT line1="451" col1="1" line2="451" col2="37" start="42846" end="42882">#'   dds &lt;- makeExampleDESeqDataSet()</COMMENT>
  <COMMENT line1="452" col1="1" line2="452" col2="48" start="42941" end="42988">#'   rownames(dds) &lt;- paste0("ENSG",1:nrow(dds))</COMMENT>
  <COMMENT line1="453" col1="1" line2="453" col2="22" start="43036" end="43057">#'   dds &lt;- DESeq(dds)</COMMENT>
  <COMMENT line1="454" col1="1" line2="454" col2="24" start="43131" end="43154">#'   res &lt;- results(dds)</COMMENT>
  <COMMENT line1="455" col1="1" line2="455" col2="45" start="43226" end="43270">#'   dat &lt;- integrateWithSingleCell(res, dds)</COMMENT>
  <COMMENT line1="456" col1="1" line2="456" col2="4" start="43321" end="43324">#' }</COMMENT>
  <COMMENT line1="457" col1="1" line2="457" col2="3" start="43416" end="43418">#' </COMMENT>
  <COMMENT line1="458" col1="1" line2="458" col2="23" start="43511" end="43533">#' @author Kwame Forbes</COMMENT>
  <COMMENT line1="459" col1="1" line2="459" col2="3" start="43606" end="43608">#' </COMMENT>
  <COMMENT line1="460" col1="1" line2="460" col2="10" start="43701" end="43710">#' @export</COMMENT>
  <expr line1="461" col1="1" line2="565" col2="1" start="43796" end="53676">
    <expr line1="461" col1="1" line2="461" col2="23" start="43796" end="43818">
      <SYMBOL line1="461" col1="1" line2="461" col2="23" start="43796" end="43818">integrateWithSingleCell</SYMBOL>
    </expr>
    <LEFT_ASSIGN line1="461" col1="25" line2="461" col2="26" start="43820" end="43821">&lt;-</LEFT_ASSIGN>
    <expr line1="461" col1="28" line2="565" col2="1" start="43823" end="53676">
      <FUNCTION line1="461" col1="28" line2="461" col2="35" start="43823" end="43830">function</FUNCTION>
      <OP-LEFT-PAREN line1="461" col1="36" line2="461" col2="36" start="43831" end="43831">(</OP-LEFT-PAREN>
      <SYMBOL_FORMALS line1="461" col1="37" line2="461" col2="39" start="43832" end="43834">res</SYMBOL_FORMALS>
      <OP-COMMA line1="461" col1="40" line2="461" col2="40" start="43835" end="43835">,</OP-COMMA>
      <SYMBOL_FORMALS line1="461" col1="42" line2="461" col2="44" start="43837" end="43839">dds</SYMBOL_FORMALS>
      <OP-COMMA line1="461" col1="45" line2="461" col2="45" start="43840" end="43840">,</OP-COMMA>
      <SYMBOL_FORMALS line1="461" col1="47" line2="461" col2="49" start="43842" end="43844">...</SYMBOL_FORMALS>
      <OP-RIGHT-PAREN line1="461" col1="50" line2="461" col2="50" start="43845" end="43845">)</OP-RIGHT-PAREN>
      <expr line1="461" col1="52" line2="565" col2="1" start="43847" end="53676">
        <OP-LEFT-BRACE line1="461" col1="52" line2="461" col2="52" start="43847" end="43847">{</OP-LEFT-BRACE>
        <COMMENT line1="463" col1="3" line2="463" col2="67" start="43988" end="44052"># function written by Kwame Forbes, to assist with integration of</COMMENT>
        <COMMENT line1="464" col1="3" line2="464" col2="67" start="44083" end="44147"># bulk DE results with Bioconductor single-cell RNA-seq datasets.</COMMENT>
        <COMMENT line1="465" col1="3" line2="465" col2="67" start="44178" end="44242"># provides a menu of dataset options from pre-processed scRNA-seq</COMMENT>
        <COMMENT line1="466" col1="3" line2="466" col2="61" start="44273" end="44331"># datasets. Downstream visualization is performed using the</COMMENT>
        <COMMENT line1="467" col1="3" line2="467" col2="23" start="44368" end="44388"># vizWithSCE package:</COMMENT>
        <COMMENT line1="469" col1="3" line2="469" col2="45" start="44558" end="44600"># https://github.com/KwameForbes/vizWithSCE</COMMENT>
        <expr line1="471" col1="3" line2="471" col2="36" start="44748" end="44781">
          <expr line1="471" col1="3" line2="471" col2="11" start="44748" end="44756">
            <SYMBOL_FUNCTION_CALL line1="471" col1="3" line2="471" col2="11" start="44748" end="44756">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="471" col1="12" line2="471" col2="12" start="44757" end="44757">(</OP-LEFT-PAREN>
          <expr line1="471" col1="13" line2="471" col2="35" start="44758" end="44780">
            <expr line1="471" col1="13" line2="471" col2="14" start="44758" end="44759">
              <SYMBOL_FUNCTION_CALL line1="471" col1="13" line2="471" col2="14" start="44758" end="44759">is</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="471" col1="15" line2="471" col2="15" start="44760" end="44760">(</OP-LEFT-PAREN>
            <expr line1="471" col1="16" line2="471" col2="18" start="44761" end="44763">
              <SYMBOL line1="471" col1="16" line2="471" col2="18" start="44761" end="44763">res</SYMBOL>
            </expr>
            <OP-COMMA line1="471" col1="19" line2="471" col2="19" start="44764" end="44764">,</OP-COMMA>
            <expr line1="471" col1="21" line2="471" col2="34" start="44766" end="44779">
              <STR_CONST line1="471" col1="21" line2="471" col2="34" start="44766" end="44779">"DESeqResults"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="471" col1="35" line2="471" col2="35" start="44780" end="44780">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="471" col1="36" line2="471" col2="36" start="44781" end="44781">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="472" col1="3" line2="472" col2="36" start="44843" end="44876">
          <expr line1="472" col1="3" line2="472" col2="11" start="44843" end="44851">
            <SYMBOL_FUNCTION_CALL line1="472" col1="3" line2="472" col2="11" start="44843" end="44851">stopifnot</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="472" col1="12" line2="472" col2="12" start="44852" end="44852">(</OP-LEFT-PAREN>
          <expr line1="472" col1="13" line2="472" col2="35" start="44853" end="44875">
            <expr line1="472" col1="13" line2="472" col2="14" start="44853" end="44854">
              <SYMBOL_FUNCTION_CALL line1="472" col1="13" line2="472" col2="14" start="44853" end="44854">is</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="472" col1="15" line2="472" col2="15" start="44855" end="44855">(</OP-LEFT-PAREN>
            <expr line1="472" col1="16" line2="472" col2="18" start="44856" end="44858">
              <SYMBOL line1="472" col1="16" line2="472" col2="18" start="44856" end="44858">dds</SYMBOL>
            </expr>
            <OP-COMMA line1="472" col1="19" line2="472" col2="19" start="44859" end="44859">,</OP-COMMA>
            <expr line1="472" col1="21" line2="472" col2="34" start="44861" end="44874">
              <STR_CONST line1="472" col1="21" line2="472" col2="34" start="44861" end="44874">"DESeqDataSet"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="472" col1="35" line2="472" col2="35" start="44875" end="44875">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="472" col1="36" line2="472" col2="36" start="44876" end="44876">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="474" col1="3" line2="474" col2="74" start="45033" end="45104"># figure out organism from 'dds' or 'res', either using tximeta metadata</COMMENT>
        <COMMENT line1="475" col1="3" line2="475" col2="55" start="45128" end="45180"># or guesswork on the gene names in the results table</COMMENT>
        <expr line1="476" col1="3" line2="476" col2="48" start="45223" end="45268">
          <expr line1="476" col1="3" line2="476" col2="12" start="45223" end="45232">
            <SYMBOL line1="476" col1="3" line2="476" col2="12" start="45223" end="45232">tximetaOrg</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="476" col1="14" line2="476" col2="15" start="45234" end="45235">&lt;-</LEFT_ASSIGN>
          <expr line1="476" col1="17" line2="476" col2="48" start="45237" end="45268">
            <expr line1="476" col1="17" line2="476" col2="39" start="45237" end="45259">
              <expr line1="476" col1="17" line2="476" col2="29" start="45237" end="45249">
                <expr line1="476" col1="17" line2="476" col2="24" start="45237" end="45244">
                  <SYMBOL_FUNCTION_CALL line1="476" col1="17" line2="476" col2="24" start="45237" end="45244">metadata</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="476" col1="25" line2="476" col2="25" start="45245" end="45245">(</OP-LEFT-PAREN>
                <expr line1="476" col1="26" line2="476" col2="28" start="45246" end="45248">
                  <SYMBOL line1="476" col1="26" line2="476" col2="28" start="45246" end="45248">dds</SYMBOL>
                </expr>
                <OP-RIGHT-PAREN line1="476" col1="29" line2="476" col2="29" start="45249" end="45249">)</OP-RIGHT-PAREN>
              </expr>
              <OP-DOLLAR line1="476" col1="30" line2="476" col2="30" start="45250" end="45250">$</OP-DOLLAR>
              <SYMBOL line1="476" col1="31" line2="476" col2="39" start="45251" end="45259">txomeInfo</SYMBOL>
            </expr>
            <OP-DOLLAR line1="476" col1="40" line2="476" col2="40" start="45260" end="45260">$</OP-DOLLAR>
            <SYMBOL line1="476" col1="41" line2="476" col2="48" start="45261" end="45268">organism</SYMBOL>
          </expr>
        </expr>
        <expr line1="477" col1="3" line2="494" col2="3" start="45318" end="46933">
          <IF line1="477" col1="3" line2="477" col2="4" start="45318" end="45319">if</IF>
          <OP-LEFT-PAREN line1="477" col1="6" line2="477" col2="6" start="45321" end="45321">(</OP-LEFT-PAREN>
          <expr line1="477" col1="7" line2="477" col2="26" start="45322" end="45341">
            <OP-EXCLAMATION line1="477" col1="7" line2="477" col2="7" start="45322" end="45322">!</OP-EXCLAMATION>
            <expr line1="477" col1="8" line2="477" col2="26" start="45323" end="45341">
              <expr line1="477" col1="8" line2="477" col2="14" start="45323" end="45329">
                <SYMBOL_FUNCTION_CALL line1="477" col1="8" line2="477" col2="14" start="45323" end="45329">is.null</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="477" col1="15" line2="477" col2="15" start="45330" end="45330">(</OP-LEFT-PAREN>
              <expr line1="477" col1="16" line2="477" col2="25" start="45331" end="45340">
                <SYMBOL line1="477" col1="16" line2="477" col2="25" start="45331" end="45340">tximetaOrg</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="477" col1="26" line2="477" col2="26" start="45341" end="45341">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="477" col1="27" line2="477" col2="27" start="45342" end="45342">)</OP-RIGHT-PAREN>
          <expr line1="477" col1="29" line2="485" col2="3" start="45344" end="46078">
            <OP-LEFT-BRACE line1="477" col1="29" line2="477" col2="29" start="45344" end="45344">{</OP-LEFT-BRACE>
            <expr line1="478" col1="5" line2="484" col2="12" start="45415" end="45992">
              <expr line1="478" col1="5" line2="478" col2="7" start="45415" end="45417">
                <SYMBOL line1="478" col1="5" line2="478" col2="7" start="45415" end="45417">org</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="478" col1="9" line2="478" col2="10" start="45419" end="45420">&lt;-</LEFT_ASSIGN>
              <expr line1="478" col1="12" line2="484" col2="12" start="45422" end="45992">
                <IF line1="478" col1="12" line2="478" col2="13" start="45422" end="45423">if</IF>
                <OP-LEFT-PAREN line1="478" col1="15" line2="478" col2="15" start="45425" end="45425">(</OP-LEFT-PAREN>
                <expr line1="478" col1="16" line2="478" col2="43" start="45426" end="45453">
                  <expr line1="478" col1="16" line2="478" col2="25" start="45426" end="45435">
                    <SYMBOL line1="478" col1="16" line2="478" col2="25" start="45426" end="45435">tximetaOrg</SYMBOL>
                  </expr>
                  <EQ line1="478" col1="27" line2="478" col2="28" start="45437" end="45438">==</EQ>
                  <expr line1="478" col1="30" line2="478" col2="43" start="45440" end="45453">
                    <STR_CONST line1="478" col1="30" line2="478" col2="43" start="45440" end="45453">"Homo sapiens"</STR_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="478" col1="44" line2="478" col2="44" start="45454" end="45454">)</OP-RIGHT-PAREN>
                <expr line1="478" col1="46" line2="480" col2="12" start="45456" end="45612">
                  <OP-LEFT-BRACE line1="478" col1="46" line2="478" col2="46" start="45456" end="45456">{</OP-LEFT-BRACE>
                  <expr line1="479" col1="14" line2="479" col2="20" start="45519" end="45525">
                    <STR_CONST line1="479" col1="14" line2="479" col2="20" start="45519" end="45525">"human"</STR_CONST>
                  </expr>
                  <OP-RIGHT-BRACE line1="480" col1="12" line2="480" col2="12" start="45612" end="45612">}</OP-RIGHT-BRACE>
                </expr>
                <ELSE line1="480" col1="14" line2="480" col2="17" start="45614" end="45617">else</ELSE>
                <expr line1="480" col1="19" line2="484" col2="12" start="45619" end="45992">
                  <IF line1="480" col1="19" line2="480" col2="20" start="45619" end="45620">if</IF>
                  <OP-LEFT-PAREN line1="480" col1="22" line2="480" col2="22" start="45622" end="45622">(</OP-LEFT-PAREN>
                  <expr line1="480" col1="23" line2="480" col2="50" start="45623" end="45650">
                    <expr line1="480" col1="23" line2="480" col2="32" start="45623" end="45632">
                      <SYMBOL line1="480" col1="23" line2="480" col2="32" start="45623" end="45632">tximetaOrg</SYMBOL>
                    </expr>
                    <EQ line1="480" col1="34" line2="480" col2="35" start="45634" end="45635">==</EQ>
                    <expr line1="480" col1="37" line2="480" col2="50" start="45637" end="45650">
                      <STR_CONST line1="480" col1="37" line2="480" col2="50" start="45637" end="45650">"Mus musculus"</STR_CONST>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="480" col1="51" line2="480" col2="51" start="45651" end="45651">)</OP-RIGHT-PAREN>
                  <expr line1="480" col1="53" line2="482" col2="12" start="45653" end="45802">
                    <OP-LEFT-BRACE line1="480" col1="53" line2="480" col2="53" start="45653" end="45653">{</OP-LEFT-BRACE>
                    <expr line1="481" col1="14" line2="481" col2="20" start="45709" end="45715">
                      <STR_CONST line1="481" col1="14" line2="481" col2="20" start="45709" end="45715">"mouse"</STR_CONST>
                    </expr>
                    <OP-RIGHT-BRACE line1="482" col1="12" line2="482" col2="12" start="45802" end="45802">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="482" col1="14" line2="482" col2="17" start="45804" end="45807">else</ELSE>
                  <expr line1="482" col1="19" line2="484" col2="12" start="45809" end="45992">
                    <OP-LEFT-BRACE line1="482" col1="19" line2="482" col2="19" start="45809" end="45809">{</OP-LEFT-BRACE>
                    <expr line1="483" col1="14" line2="483" col2="65" start="45899" end="45950">
                      <expr line1="483" col1="14" line2="483" col2="17" start="45899" end="45902">
                        <SYMBOL_FUNCTION_CALL line1="483" col1="14" line2="483" col2="17" start="45899" end="45902">stop</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="483" col1="18" line2="483" col2="18" start="45903" end="45903">(</OP-LEFT-PAREN>
                      <expr line1="483" col1="19" line2="483" col2="64" start="45904" end="45949">
                        <STR_CONST line1="483" col1="19" line2="483" col2="64" start="45904" end="45949">"Only human and mouse are currently supported"</STR_CONST>
                      </expr>
                      <OP-RIGHT-PAREN line1="483" col1="65" line2="483" col2="65" start="45950" end="45950">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-BRACE line1="484" col1="12" line2="484" col2="12" start="45992" end="45992">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="485" col1="3" line2="485" col2="3" start="46078" end="46078">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="485" col1="5" line2="485" col2="8" start="46080" end="46083">else</ELSE>
          <expr line1="485" col1="10" line2="494" col2="3" start="46085" end="46933">
            <OP-LEFT-BRACE line1="485" col1="10" line2="485" col2="10" start="46085" end="46085">{</OP-LEFT-BRACE>
            <expr line1="486" col1="5" line2="486" col2="33" start="46175" end="46203">
              <expr line1="486" col1="5" line2="486" col2="13" start="46175" end="46183">
                <SYMBOL line1="486" col1="5" line2="486" col2="13" start="46175" end="46183">test.gene</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="486" col1="15" line2="486" col2="16" start="46185" end="46186">&lt;-</LEFT_ASSIGN>
              <expr line1="486" col1="18" line2="486" col2="33" start="46188" end="46203">
                <expr line1="486" col1="18" line2="486" col2="30" start="46188" end="46200">
                  <expr line1="486" col1="18" line2="486" col2="25" start="46188" end="46195">
                    <SYMBOL_FUNCTION_CALL line1="486" col1="18" line2="486" col2="25" start="46188" end="46195">rownames</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="486" col1="26" line2="486" col2="26" start="46196" end="46196">(</OP-LEFT-PAREN>
                  <expr line1="486" col1="27" line2="486" col2="29" start="46197" end="46199">
                    <SYMBOL line1="486" col1="27" line2="486" col2="29" start="46197" end="46199">res</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="486" col1="30" line2="486" col2="30" start="46200" end="46200">)</OP-RIGHT-PAREN>
                </expr>
                <OP-LEFT-BRACKET line1="486" col1="31" line2="486" col2="31" start="46201" end="46201">[</OP-LEFT-BRACKET>
                <expr line1="486" col1="32" line2="486" col2="32" start="46202" end="46202">
                  <NUM_CONST line1="486" col1="32" line2="486" col2="32" start="46202" end="46202">1</NUM_CONST>
                </expr>
                <OP-RIGHT-BRACKET line1="486" col1="33" line2="486" col2="33" start="46203" end="46203">]</OP-RIGHT-BRACKET>
              </expr>
            </expr>
            <expr line1="487" col1="5" line2="493" col2="12" start="46270" end="46847">
              <expr line1="487" col1="5" line2="487" col2="7" start="46270" end="46272">
                <SYMBOL line1="487" col1="5" line2="487" col2="7" start="46270" end="46272">org</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="487" col1="9" line2="487" col2="10" start="46274" end="46275">&lt;-</LEFT_ASSIGN>
              <expr line1="487" col1="12" line2="493" col2="12" start="46277" end="46847">
                <IF line1="487" col1="12" line2="487" col2="13" start="46277" end="46278">if</IF>
                <OP-LEFT-PAREN line1="487" col1="15" line2="487" col2="15" start="46280" end="46280">(</OP-LEFT-PAREN>
                <expr line1="487" col1="16" line2="487" col2="48" start="46281" end="46313">
                  <expr line1="487" col1="16" line2="487" col2="38" start="46281" end="46303">
                    <expr line1="487" col1="16" line2="487" col2="21" start="46281" end="46286">
                      <SYMBOL_FUNCTION_CALL line1="487" col1="16" line2="487" col2="21" start="46281" end="46286">substr</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="487" col1="22" line2="487" col2="22" start="46287" end="46287">(</OP-LEFT-PAREN>
                    <expr line1="487" col1="23" line2="487" col2="31" start="46288" end="46296">
                      <SYMBOL line1="487" col1="23" line2="487" col2="31" start="46288" end="46296">test.gene</SYMBOL>
                    </expr>
                    <OP-COMMA line1="487" col1="32" line2="487" col2="32" start="46297" end="46297">,</OP-COMMA>
                    <expr line1="487" col1="34" line2="487" col2="34" start="46299" end="46299">
                      <NUM_CONST line1="487" col1="34" line2="487" col2="34" start="46299" end="46299">1</NUM_CONST>
                    </expr>
                    <OP-COMMA line1="487" col1="35" line2="487" col2="35" start="46300" end="46300">,</OP-COMMA>
                    <expr line1="487" col1="37" line2="487" col2="37" start="46302" end="46302">
                      <NUM_CONST line1="487" col1="37" line2="487" col2="37" start="46302" end="46302">4</NUM_CONST>
                    </expr>
                    <OP-RIGHT-PAREN line1="487" col1="38" line2="487" col2="38" start="46303" end="46303">)</OP-RIGHT-PAREN>
                  </expr>
                  <EQ line1="487" col1="40" line2="487" col2="41" start="46305" end="46306">==</EQ>
                  <expr line1="487" col1="43" line2="487" col2="48" start="46308" end="46313">
                    <STR_CONST line1="487" col1="43" line2="487" col2="48" start="46308" end="46313">"ENSG"</STR_CONST>
                  </expr>
                </expr>
                <OP-RIGHT-PAREN line1="487" col1="49" line2="487" col2="49" start="46314" end="46314">)</OP-RIGHT-PAREN>
                <expr line1="487" col1="51" line2="489" col2="12" start="46316" end="46467">
                  <OP-LEFT-BRACE line1="487" col1="51" line2="487" col2="51" start="46316" end="46316">{</OP-LEFT-BRACE>
                  <expr line1="488" col1="14" line2="488" col2="20" start="46374" end="46380">
                    <STR_CONST line1="488" col1="14" line2="488" col2="20" start="46374" end="46380">"human"</STR_CONST>
                  </expr>
                  <OP-RIGHT-BRACE line1="489" col1="12" line2="489" col2="12" start="46467" end="46467">}</OP-RIGHT-BRACE>
                </expr>
                <ELSE line1="489" col1="14" line2="489" col2="17" start="46469" end="46472">else</ELSE>
                <expr line1="489" col1="19" line2="493" col2="12" start="46474" end="46847">
                  <IF line1="489" col1="19" line2="489" col2="20" start="46474" end="46475">if</IF>
                  <OP-LEFT-PAREN line1="489" col1="22" line2="489" col2="22" start="46477" end="46477">(</OP-LEFT-PAREN>
                  <expr line1="489" col1="23" line2="489" col2="58" start="46478" end="46513">
                    <expr line1="489" col1="23" line2="489" col2="45" start="46478" end="46500">
                      <expr line1="489" col1="23" line2="489" col2="28" start="46478" end="46483">
                        <SYMBOL_FUNCTION_CALL line1="489" col1="23" line2="489" col2="28" start="46478" end="46483">substr</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="489" col1="29" line2="489" col2="29" start="46484" end="46484">(</OP-LEFT-PAREN>
                      <expr line1="489" col1="30" line2="489" col2="38" start="46485" end="46493">
                        <SYMBOL line1="489" col1="30" line2="489" col2="38" start="46485" end="46493">test.gene</SYMBOL>
                      </expr>
                      <OP-COMMA line1="489" col1="39" line2="489" col2="39" start="46494" end="46494">,</OP-COMMA>
                      <expr line1="489" col1="41" line2="489" col2="41" start="46496" end="46496">
                        <NUM_CONST line1="489" col1="41" line2="489" col2="41" start="46496" end="46496">1</NUM_CONST>
                      </expr>
                      <OP-COMMA line1="489" col1="42" line2="489" col2="42" start="46497" end="46497">,</OP-COMMA>
                      <expr line1="489" col1="44" line2="489" col2="44" start="46499" end="46499">
                        <NUM_CONST line1="489" col1="44" line2="489" col2="44" start="46499" end="46499">7</NUM_CONST>
                      </expr>
                      <OP-RIGHT-PAREN line1="489" col1="45" line2="489" col2="45" start="46500" end="46500">)</OP-RIGHT-PAREN>
                    </expr>
                    <EQ line1="489" col1="47" line2="489" col2="48" start="46502" end="46503">==</EQ>
                    <expr line1="489" col1="50" line2="489" col2="58" start="46505" end="46513">
                      <STR_CONST line1="489" col1="50" line2="489" col2="58" start="46505" end="46513">"ENSMUSG"</STR_CONST>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="489" col1="59" line2="489" col2="59" start="46514" end="46514">)</OP-RIGHT-PAREN>
                  <expr line1="489" col1="61" line2="491" col2="12" start="46516" end="46657">
                    <OP-LEFT-BRACE line1="489" col1="61" line2="489" col2="61" start="46516" end="46516">{</OP-LEFT-BRACE>
                    <expr line1="490" col1="14" line2="490" col2="20" start="46564" end="46570">
                      <STR_CONST line1="490" col1="14" line2="490" col2="20" start="46564" end="46570">"mouse"</STR_CONST>
                    </expr>
                    <OP-RIGHT-BRACE line1="491" col1="12" line2="491" col2="12" start="46657" end="46657">}</OP-RIGHT-BRACE>
                  </expr>
                  <ELSE line1="491" col1="14" line2="491" col2="17" start="46659" end="46662">else</ELSE>
                  <expr line1="491" col1="19" line2="493" col2="12" start="46664" end="46847">
                    <OP-LEFT-BRACE line1="491" col1="19" line2="491" col2="19" start="46664" end="46664">{</OP-LEFT-BRACE>
                    <expr line1="492" col1="14" line2="492" col2="65" start="46754" end="46805">
                      <expr line1="492" col1="14" line2="492" col2="17" start="46754" end="46757">
                        <SYMBOL_FUNCTION_CALL line1="492" col1="14" line2="492" col2="17" start="46754" end="46757">stop</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="492" col1="18" line2="492" col2="18" start="46758" end="46758">(</OP-LEFT-PAREN>
                      <expr line1="492" col1="19" line2="492" col2="64" start="46759" end="46804">
                        <STR_CONST line1="492" col1="19" line2="492" col2="64" start="46759" end="46804">"Only human and mouse are currently supported"</STR_CONST>
                      </expr>
                      <OP-RIGHT-PAREN line1="492" col1="65" line2="492" col2="65" start="46805" end="46805">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-BRACE line1="493" col1="12" line2="493" col2="12" start="46847" end="46847">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="494" col1="3" line2="494" col2="3" start="46933" end="46933">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <expr line1="496" col1="3" line2="496" col2="57" start="47123" end="47177">
          <expr line1="496" col1="3" line2="496" col2="9" start="47123" end="47129">
            <SYMBOL_FUNCTION_CALL line1="496" col1="3" line2="496" col2="9" start="47123" end="47129">message</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="496" col1="10" line2="496" col2="10" start="47130" end="47130">(</OP-LEFT-PAREN>
          <expr line1="496" col1="11" line2="496" col2="56" start="47131" end="47176">
            <expr line1="496" col1="11" line2="496" col2="15" start="47131" end="47135">
              <SYMBOL_FUNCTION_CALL line1="496" col1="11" line2="496" col2="15" start="47131" end="47135">paste</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="496" col1="16" line2="496" col2="16" start="47136" end="47136">(</OP-LEFT-PAREN>
            <expr line1="496" col1="17" line2="496" col2="44" start="47137" end="47164">
              <STR_CONST line1="496" col1="17" line2="496" col2="44" start="47137" end="47164">"Your dataset appears to be"</STR_CONST>
            </expr>
            <OP-COMMA line1="496" col1="45" line2="496" col2="45" start="47165" end="47165">,</OP-COMMA>
            <expr line1="496" col1="47" line2="496" col2="49" start="47167" end="47169">
              <SYMBOL line1="496" col1="47" line2="496" col2="49" start="47167" end="47169">org</SYMBOL>
            </expr>
            <OP-COMMA line1="496" col1="50" line2="496" col2="50" start="47170" end="47170">,</OP-COMMA>
            <expr line1="496" col1="52" line2="496" col2="55" start="47172" end="47175">
              <STR_CONST line1="496" col1="52" line2="496" col2="55" start="47172" end="47175">"\n"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="496" col1="56" line2="496" col2="56" start="47176" end="47176">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="496" col1="57" line2="496" col2="57" start="47177" end="47177">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="498" col1="3" line2="498" col2="53" start="47313" end="47363"># read in table of options from vizWithSCE CSV file</COMMENT>
        <expr line1="499" col1="3" line2="499" col2="72" start="47408" end="47477">
          <expr line1="499" col1="3" line2="499" col2="10" start="47408" end="47415">
            <SYMBOL line1="499" col1="3" line2="499" col2="10" start="47408" end="47415">csv.file</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="499" col1="12" line2="499" col2="13" start="47417" end="47418">&lt;-</LEFT_ASSIGN>
          <expr line1="499" col1="15" line2="499" col2="72" start="47420" end="47477">
            <expr line1="499" col1="15" line2="499" col2="25" start="47420" end="47430">
              <SYMBOL_FUNCTION_CALL line1="499" col1="15" line2="499" col2="25" start="47420" end="47430">system.file</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="499" col1="26" line2="499" col2="26" start="47431" end="47431">(</OP-LEFT-PAREN>
            <expr line1="499" col1="27" line2="499" col2="53" start="47432" end="47458">
              <STR_CONST line1="499" col1="27" line2="499" col2="53" start="47432" end="47458">"extdata/singleCellTab.csv"</STR_CONST>
            </expr>
            <OP-COMMA line1="499" col1="54" line2="499" col2="54" start="47459" end="47459">,</OP-COMMA>
            <SYMBOL_SUB line1="499" col1="56" line2="499" col2="62" start="47461" end="47467">package</SYMBOL_SUB>
            <EQ_SUB line1="499" col1="63" line2="499" col2="63" start="47468" end="47468">=</EQ_SUB>
            <expr line1="499" col1="64" line2="499" col2="71" start="47469" end="47476">
              <STR_CONST line1="499" col1="64" line2="499" col2="71" start="47469" end="47476">"DESeq2"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="499" col1="72" line2="499" col2="72" start="47477" end="47477">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="500" col1="3" line2="500" col2="27" start="47503" end="47527">
          <expr line1="500" col1="3" line2="500" col2="5" start="47503" end="47505">
            <SYMBOL line1="500" col1="3" line2="500" col2="5" start="47503" end="47505">tab</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="500" col1="7" line2="500" col2="8" start="47507" end="47508">&lt;-</LEFT_ASSIGN>
          <expr line1="500" col1="10" line2="500" col2="27" start="47510" end="47527">
            <expr line1="500" col1="10" line2="500" col2="17" start="47510" end="47517">
              <SYMBOL_FUNCTION_CALL line1="500" col1="10" line2="500" col2="17" start="47510" end="47517">read.csv</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="500" col1="18" line2="500" col2="18" start="47518" end="47518">(</OP-LEFT-PAREN>
            <expr line1="500" col1="19" line2="500" col2="26" start="47519" end="47526">
              <SYMBOL line1="500" col1="19" line2="500" col2="26" start="47519" end="47526">csv.file</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="500" col1="27" line2="500" col2="27" start="47527" end="47527">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="502" col1="3" line2="502" col2="89" start="47693" end="47779">
          <expr line1="502" col1="3" line2="502" col2="9" start="47693" end="47699">
            <SYMBOL_FUNCTION_CALL line1="502" col1="3" line2="502" col2="9" start="47693" end="47699">message</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="502" col1="10" line2="502" col2="10" start="47700" end="47700">(</OP-LEFT-PAREN>
          <expr line1="502" col1="11" line2="502" col2="88" start="47701" end="47778">
            <expr line1="502" col1="11" line2="502" col2="15" start="47701" end="47705">
              <SYMBOL_FUNCTION_CALL line1="502" col1="11" line2="502" col2="15" start="47701" end="47705">paste</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="502" col1="16" line2="502" col2="16" start="47706" end="47706">(</OP-LEFT-PAREN>
            <expr line1="502" col1="17" line2="502" col2="26" start="47707" end="47716">
              <STR_CONST line1="502" col1="17" line2="502" col2="26" start="47707" end="47716">"Choose a"</STR_CONST>
            </expr>
            <OP-COMMA line1="502" col1="27" line2="502" col2="27" start="47717" end="47717">,</OP-COMMA>
            <expr line1="502" col1="28" line2="502" col2="30" start="47718" end="47720">
              <SYMBOL line1="502" col1="28" line2="502" col2="30" start="47718" end="47720">org</SYMBOL>
            </expr>
            <OP-COMMA line1="502" col1="31" line2="502" col2="31" start="47721" end="47721">,</OP-COMMA>
            <expr line1="502" col1="32" line2="502" col2="87" start="47722" end="47777">
              <STR_CONST line1="502" col1="32" line2="502" col2="87" start="47722" end="47777">"single-cell dataset to integrate with (0 to cancel):\n"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="502" col1="88" line2="502" col2="88" start="47778" end="47778">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="502" col1="89" line2="502" col2="89" start="47779" end="47779">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="504" col1="3" line2="504" col2="29" start="47883" end="47909">
          <expr line1="504" col1="3" line2="504" col2="5" start="47883" end="47885">
            <SYMBOL line1="504" col1="3" line2="504" col2="5" start="47883" end="47885">tab</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="504" col1="7" line2="504" col2="8" start="47887" end="47888">&lt;-</LEFT_ASSIGN>
          <expr line1="504" col1="10" line2="504" col2="29" start="47890" end="47909">
            <expr line1="504" col1="10" line2="504" col2="12" start="47890" end="47892">
              <SYMBOL line1="504" col1="10" line2="504" col2="12" start="47890" end="47892">tab</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="504" col1="13" line2="504" col2="13" start="47893" end="47893">[</OP-LEFT-BRACKET>
            <expr line1="504" col1="14" line2="504" col2="27" start="47894" end="47907">
              <expr line1="504" col1="14" line2="504" col2="20" start="47894" end="47900">
                <expr line1="504" col1="14" line2="504" col2="16" start="47894" end="47896">
                  <SYMBOL line1="504" col1="14" line2="504" col2="16" start="47894" end="47896">tab</SYMBOL>
                </expr>
                <OP-DOLLAR line1="504" col1="17" line2="504" col2="17" start="47897" end="47897">$</OP-DOLLAR>
                <SYMBOL line1="504" col1="18" line2="504" col2="20" start="47898" end="47900">org</SYMBOL>
              </expr>
              <EQ line1="504" col1="22" line2="504" col2="23" start="47902" end="47903">==</EQ>
              <expr line1="504" col1="25" line2="504" col2="27" start="47905" end="47907">
                <SYMBOL line1="504" col1="25" line2="504" col2="27" start="47905" end="47907">org</SYMBOL>
              </expr>
            </expr>
            <OP-COMMA line1="504" col1="28" line2="504" col2="28" start="47908" end="47908">,</OP-COMMA>
            <OP-RIGHT-BRACKET line1="504" col1="29" line2="504" col2="29" start="47909" end="47909">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="505" col1="3" line2="505" col2="61" start="47978" end="48036">
          <expr line1="505" col1="3" line2="505" col2="6" start="47978" end="47981">
            <SYMBOL line1="505" col1="3" line2="505" col2="6" start="47978" end="47981">tab2</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="505" col1="8" line2="505" col2="9" start="47983" end="47984">&lt;-</LEFT_ASSIGN>
          <expr line1="505" col1="11" line2="505" col2="61" start="47986" end="48036">
            <expr line1="505" col1="11" line2="505" col2="13" start="47986" end="47988">
              <SYMBOL line1="505" col1="11" line2="505" col2="13" start="47986" end="47988">tab</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="505" col1="14" line2="505" col2="14" start="47989" end="47989">[</OP-LEFT-BRACKET>
            <OP-COMMA line1="505" col1="15" line2="505" col2="15" start="47990" end="47990">,</OP-COMMA>
            <expr line1="505" col1="16" line2="505" col2="60" start="47991" end="48035">
              <expr line1="505" col1="16" line2="505" col2="16" start="47991" end="47991">
                <SYMBOL_FUNCTION_CALL line1="505" col1="16" line2="505" col2="16" start="47991" end="47991">c</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="505" col1="17" line2="505" col2="17" start="47992" end="47992">(</OP-LEFT-PAREN>
              <expr line1="505" col1="18" line2="505" col2="22" start="47993" end="47997">
                <STR_CONST line1="505" col1="18" line2="505" col2="22" start="47993" end="47997">"pkg"</STR_CONST>
              </expr>
              <OP-COMMA line1="505" col1="23" line2="505" col2="23" start="47998" end="47998">,</OP-COMMA>
              <expr line1="505" col1="24" line2="505" col2="29" start="47999" end="48004">
                <STR_CONST line1="505" col1="24" line2="505" col2="29" start="47999" end="48004">"func"</STR_CONST>
              </expr>
              <OP-COMMA line1="505" col1="30" line2="505" col2="30" start="48005" end="48005">,</OP-COMMA>
              <expr line1="505" col1="31" line2="505" col2="36" start="48006" end="48011">
                <STR_CONST line1="505" col1="31" line2="505" col2="36" start="48006" end="48011">"data"</STR_CONST>
              </expr>
              <OP-COMMA line1="505" col1="37" line2="505" col2="37" start="48012" end="48012">,</OP-COMMA>
              <expr line1="505" col1="39" line2="505" col2="43" start="48014" end="48018">
                <STR_CONST line1="505" col1="39" line2="505" col2="43" start="48014" end="48018">"pub"</STR_CONST>
              </expr>
              <OP-COMMA line1="505" col1="44" line2="505" col2="44" start="48019" end="48019">,</OP-COMMA>
              <expr line1="505" col1="45" line2="505" col2="52" start="48020" end="48027">
                <STR_CONST line1="505" col1="45" line2="505" col2="52" start="48020" end="48027">"nCells"</STR_CONST>
              </expr>
              <OP-COMMA line1="505" col1="53" line2="505" col2="53" start="48028" end="48028">,</OP-COMMA>
              <expr line1="505" col1="54" line2="505" col2="59" start="48029" end="48034">
                <STR_CONST line1="505" col1="54" line2="505" col2="59" start="48029" end="48034">"desc"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="505" col1="60" line2="505" col2="60" start="48035" end="48035">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-BRACKET line1="505" col1="61" line2="505" col2="61" start="48036" end="48036">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="506" col1="3" line2="506" col2="54" start="48073" end="48124">
          <expr line1="506" col1="3" line2="506" col2="11" start="48073" end="48081">
            <expr line1="506" col1="3" line2="506" col2="6" start="48073" end="48076">
              <SYMBOL line1="506" col1="3" line2="506" col2="6" start="48073" end="48076">tab2</SYMBOL>
            </expr>
            <OP-DOLLAR line1="506" col1="7" line2="506" col2="7" start="48077" end="48077">$</OP-DOLLAR>
            <SYMBOL line1="506" col1="8" line2="506" col2="11" start="48078" end="48081">data</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="506" col1="13" line2="506" col2="14" start="48083" end="48084">&lt;-</LEFT_ASSIGN>
          <expr line1="506" col1="16" line2="506" col2="54" start="48086" end="48124">
            <expr line1="506" col1="16" line2="506" col2="21" start="48086" end="48091">
              <SYMBOL_FUNCTION_CALL line1="506" col1="16" line2="506" col2="21" start="48086" end="48091">ifelse</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="506" col1="22" line2="506" col2="22" start="48092" end="48092">(</OP-LEFT-PAREN>
            <expr line1="506" col1="23" line2="506" col2="38" start="48093" end="48108">
              <expr line1="506" col1="23" line2="506" col2="27" start="48093" end="48097">
                <SYMBOL_FUNCTION_CALL line1="506" col1="23" line2="506" col2="27" start="48093" end="48097">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="506" col1="28" line2="506" col2="28" start="48098" end="48098">(</OP-LEFT-PAREN>
              <expr line1="506" col1="29" line2="506" col2="37" start="48099" end="48107">
                <expr line1="506" col1="29" line2="506" col2="32" start="48099" end="48102">
                  <SYMBOL line1="506" col1="29" line2="506" col2="32" start="48099" end="48102">tab2</SYMBOL>
                </expr>
                <OP-DOLLAR line1="506" col1="33" line2="506" col2="33" start="48103" end="48103">$</OP-DOLLAR>
                <SYMBOL line1="506" col1="34" line2="506" col2="37" start="48104" end="48107">data</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="506" col1="38" line2="506" col2="38" start="48108" end="48108">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="506" col1="39" line2="506" col2="39" start="48109" end="48109">,</OP-COMMA>
            <expr line1="506" col1="41" line2="506" col2="42" start="48111" end="48112">
              <STR_CONST line1="506" col1="41" line2="506" col2="42" start="48111" end="48112">""</STR_CONST>
            </expr>
            <OP-COMMA line1="506" col1="43" line2="506" col2="43" start="48113" end="48113">,</OP-COMMA>
            <expr line1="506" col1="45" line2="506" col2="53" start="48115" end="48123">
              <expr line1="506" col1="45" line2="506" col2="48" start="48115" end="48118">
                <SYMBOL line1="506" col1="45" line2="506" col2="48" start="48115" end="48118">tab2</SYMBOL>
              </expr>
              <OP-DOLLAR line1="506" col1="49" line2="506" col2="49" start="48119" end="48119">$</OP-DOLLAR>
              <SYMBOL line1="506" col1="50" line2="506" col2="53" start="48120" end="48123">data</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="506" col1="54" line2="506" col2="54" start="48124" end="48124">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="507" col1="3" line2="507" col2="39" start="48168" end="48204">
          <expr line1="507" col1="3" line2="507" col2="16" start="48168" end="48181">
            <expr line1="507" col1="3" line2="507" col2="10" start="48168" end="48175">
              <SYMBOL_FUNCTION_CALL line1="507" col1="3" line2="507" col2="10" start="48168" end="48175">rownames</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="507" col1="11" line2="507" col2="11" start="48176" end="48176">(</OP-LEFT-PAREN>
            <expr line1="507" col1="12" line2="507" col2="15" start="48177" end="48180">
              <SYMBOL line1="507" col1="12" line2="507" col2="15" start="48177" end="48180">tab2</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="507" col1="16" line2="507" col2="16" start="48181" end="48181">)</OP-RIGHT-PAREN>
          </expr>
          <LEFT_ASSIGN line1="507" col1="18" line2="507" col2="19" start="48183" end="48184">&lt;-</LEFT_ASSIGN>
          <expr line1="507" col1="21" line2="507" col2="39" start="48186" end="48204">
            <expr line1="507" col1="21" line2="507" col2="27" start="48186" end="48192">
              <SYMBOL_FUNCTION_CALL line1="507" col1="21" line2="507" col2="27" start="48186" end="48192">seq_len</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="507" col1="28" line2="507" col2="28" start="48193" end="48193">(</OP-LEFT-PAREN>
            <expr line1="507" col1="29" line2="507" col2="38" start="48194" end="48203">
              <expr line1="507" col1="29" line2="507" col2="32" start="48194" end="48197">
                <SYMBOL_FUNCTION_CALL line1="507" col1="29" line2="507" col2="32" start="48194" end="48197">nrow</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="507" col1="33" line2="507" col2="33" start="48198" end="48198">(</OP-LEFT-PAREN>
              <expr line1="507" col1="34" line2="507" col2="37" start="48199" end="48202">
                <SYMBOL line1="507" col1="34" line2="507" col2="37" start="48199" end="48202">tab2</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="507" col1="38" line2="507" col2="38" start="48203" end="48203">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="507" col1="39" line2="507" col2="39" start="48204" end="48204">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <COMMENT line1="509" col1="3" line2="509" col2="32" start="48358" end="48387"># print the table in two parts</COMMENT>
        <expr line1="510" col1="3" line2="510" col2="19" start="48453" end="48469">
          <expr line1="510" col1="3" line2="510" col2="7" start="48453" end="48457">
            <SYMBOL_FUNCTION_CALL line1="510" col1="3" line2="510" col2="7" start="48453" end="48457">print</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="510" col1="8" line2="510" col2="8" start="48458" end="48458">(</OP-LEFT-PAREN>
          <expr line1="510" col1="9" line2="510" col2="18" start="48459" end="48468">
            <expr line1="510" col1="9" line2="510" col2="12" start="48459" end="48462">
              <SYMBOL line1="510" col1="9" line2="510" col2="12" start="48459" end="48462">tab2</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="510" col1="13" line2="510" col2="13" start="48463" end="48463">[</OP-LEFT-BRACKET>
            <OP-COMMA line1="510" col1="14" line2="510" col2="14" start="48464" end="48464">,</OP-COMMA>
            <expr line1="510" col1="15" line2="510" col2="17" start="48465" end="48467">
              <expr line1="510" col1="15" line2="510" col2="15" start="48465" end="48465">
                <NUM_CONST line1="510" col1="15" line2="510" col2="15" start="48465" end="48465">1</NUM_CONST>
              </expr>
              <OP-COLON line1="510" col1="16" line2="510" col2="16" start="48466" end="48466">:</OP-COLON>
              <expr line1="510" col1="17" line2="510" col2="17" start="48467" end="48467">
                <NUM_CONST line1="510" col1="17" line2="510" col2="17" start="48467" end="48467">3</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-BRACKET line1="510" col1="18" line2="510" col2="18" start="48468" end="48468">]</OP-RIGHT-BRACKET>
          </expr>
          <OP-RIGHT-PAREN line1="510" col1="19" line2="510" col2="19" start="48469" end="48469">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="511" col1="3" line2="511" col2="19" start="48548" end="48564">
          <expr line1="511" col1="3" line2="511" col2="7" start="48548" end="48552">
            <SYMBOL_FUNCTION_CALL line1="511" col1="3" line2="511" col2="7" start="48548" end="48552">print</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="511" col1="8" line2="511" col2="8" start="48553" end="48553">(</OP-LEFT-PAREN>
          <expr line1="511" col1="9" line2="511" col2="18" start="48554" end="48563">
            <expr line1="511" col1="9" line2="511" col2="12" start="48554" end="48557">
              <SYMBOL line1="511" col1="9" line2="511" col2="12" start="48554" end="48557">tab2</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="511" col1="13" line2="511" col2="13" start="48558" end="48558">[</OP-LEFT-BRACKET>
            <OP-COMMA line1="511" col1="14" line2="511" col2="14" start="48559" end="48559">,</OP-COMMA>
            <expr line1="511" col1="15" line2="511" col2="17" start="48560" end="48562">
              <expr line1="511" col1="15" line2="511" col2="15" start="48560" end="48560">
                <NUM_CONST line1="511" col1="15" line2="511" col2="15" start="48560" end="48560">4</NUM_CONST>
              </expr>
              <OP-COLON line1="511" col1="16" line2="511" col2="16" start="48561" end="48561">:</OP-COLON>
              <expr line1="511" col1="17" line2="511" col2="17" start="48562" end="48562">
                <NUM_CONST line1="511" col1="17" line2="511" col2="17" start="48562" end="48562">6</NUM_CONST>
              </expr>
            </expr>
            <OP-RIGHT-BRACKET line1="511" col1="18" line2="511" col2="18" start="48563" end="48563">]</OP-RIGHT-BRACKET>
          </expr>
          <OP-RIGHT-PAREN line1="511" col1="19" line2="511" col2="19" start="48564" end="48564">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="513" col1="3" line2="513" col2="11" start="48738" end="48746">
          <expr line1="513" col1="3" line2="513" col2="5" start="48738" end="48740">
            <SYMBOL_FUNCTION_CALL line1="513" col1="3" line2="513" col2="5" start="48738" end="48740">cat</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="513" col1="6" line2="513" col2="6" start="48741" end="48741">(</OP-LEFT-PAREN>
          <expr line1="513" col1="7" line2="513" col2="10" start="48742" end="48745">
            <STR_CONST line1="513" col1="7" line2="513" col2="10" start="48742" end="48745">"\n"</STR_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="513" col1="11" line2="513" col2="11" start="48746" end="48746">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="515" col1="3" line2="515" col2="37" start="48928" end="48962"># repeat the message below the fold</COMMENT>
        <expr line1="516" col1="3" line2="516" col2="87" start="49023" end="49107">
          <expr line1="516" col1="3" line2="516" col2="9" start="49023" end="49029">
            <SYMBOL_FUNCTION_CALL line1="516" col1="3" line2="516" col2="9" start="49023" end="49029">message</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="516" col1="10" line2="516" col2="10" start="49030" end="49030">(</OP-LEFT-PAREN>
          <expr line1="516" col1="11" line2="516" col2="86" start="49031" end="49106">
            <expr line1="516" col1="11" line2="516" col2="15" start="49031" end="49035">
              <SYMBOL_FUNCTION_CALL line1="516" col1="11" line2="516" col2="15" start="49031" end="49035">paste</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="516" col1="16" line2="516" col2="16" start="49036" end="49036">(</OP-LEFT-PAREN>
            <expr line1="516" col1="17" line2="516" col2="26" start="49037" end="49046">
              <STR_CONST line1="516" col1="17" line2="516" col2="26" start="49037" end="49046">"Choose a"</STR_CONST>
            </expr>
            <OP-COMMA line1="516" col1="27" line2="516" col2="27" start="49047" end="49047">,</OP-COMMA>
            <expr line1="516" col1="28" line2="516" col2="30" start="49048" end="49050">
              <SYMBOL line1="516" col1="28" line2="516" col2="30" start="49048" end="49050">org</SYMBOL>
            </expr>
            <OP-COMMA line1="516" col1="31" line2="516" col2="31" start="49051" end="49051">,</OP-COMMA>
            <expr line1="516" col1="32" line2="516" col2="85" start="49052" end="49105">
              <STR_CONST line1="516" col1="32" line2="516" col2="85" start="49052" end="49105">"single-cell dataset to integrate with (0 to cancel):"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="516" col1="86" line2="516" col2="86" start="49106" end="49106">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="516" col1="87" line2="516" col2="87" start="49107" end="49107">)</OP-RIGHT-PAREN>
        </expr>
        <expr line1="518" col1="3" line2="518" col2="83" start="49213" end="49293">
          <expr line1="518" col1="3" line2="518" col2="10" start="49213" end="49220">
            <SYMBOL line1="518" col1="3" line2="518" col2="10" start="49213" end="49220">menuOpts</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="518" col1="12" line2="518" col2="13" start="49222" end="49223">&lt;-</LEFT_ASSIGN>
          <expr line1="518" col1="15" line2="518" col2="83" start="49225" end="49293">
            <expr line1="518" col1="15" line2="518" col2="20" start="49225" end="49230">
              <SYMBOL_FUNCTION_CALL line1="518" col1="15" line2="518" col2="20" start="49225" end="49230">ifelse</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="518" col1="21" line2="518" col2="21" start="49231" end="49231">(</OP-LEFT-PAREN>
            <expr line1="518" col1="22" line2="518" col2="36" start="49232" end="49246">
              <expr line1="518" col1="22" line2="518" col2="26" start="49232" end="49236">
                <SYMBOL_FUNCTION_CALL line1="518" col1="22" line2="518" col2="26" start="49232" end="49236">is.na</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="518" col1="27" line2="518" col2="27" start="49237" end="49237">(</OP-LEFT-PAREN>
              <expr line1="518" col1="28" line2="518" col2="35" start="49238" end="49245">
                <expr line1="518" col1="28" line2="518" col2="30" start="49238" end="49240">
                  <SYMBOL line1="518" col1="28" line2="518" col2="30" start="49238" end="49240">tab</SYMBOL>
                </expr>
                <OP-DOLLAR line1="518" col1="31" line2="518" col2="31" start="49241" end="49241">$</OP-DOLLAR>
                <SYMBOL line1="518" col1="32" line2="518" col2="35" start="49242" end="49245">data</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="518" col1="36" line2="518" col2="36" start="49246" end="49246">)</OP-RIGHT-PAREN>
            </expr>
            <OP-COMMA line1="518" col1="37" line2="518" col2="37" start="49247" end="49247">,</OP-COMMA>
            <expr line1="518" col1="39" line2="518" col2="46" start="49249" end="49256">
              <expr line1="518" col1="39" line2="518" col2="41" start="49249" end="49251">
                <SYMBOL line1="518" col1="39" line2="518" col2="41" start="49249" end="49251">tab</SYMBOL>
              </expr>
              <OP-DOLLAR line1="518" col1="42" line2="518" col2="42" start="49252" end="49252">$</OP-DOLLAR>
              <SYMBOL line1="518" col1="43" line2="518" col2="46" start="49253" end="49256">func</SYMBOL>
            </expr>
            <OP-COMMA line1="518" col1="47" line2="518" col2="47" start="49257" end="49257">,</OP-COMMA>
            <expr line1="518" col1="49" line2="518" col2="82" start="49259" end="49292">
              <expr line1="518" col1="49" line2="518" col2="53" start="49259" end="49263">
                <SYMBOL_FUNCTION_CALL line1="518" col1="49" line2="518" col2="53" start="49259" end="49263">paste</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="518" col1="54" line2="518" col2="54" start="49264" end="49264">(</OP-LEFT-PAREN>
              <expr line1="518" col1="55" line2="518" col2="62" start="49265" end="49272">
                <expr line1="518" col1="55" line2="518" col2="57" start="49265" end="49267">
                  <SYMBOL line1="518" col1="55" line2="518" col2="57" start="49265" end="49267">tab</SYMBOL>
                </expr>
                <OP-DOLLAR line1="518" col1="58" line2="518" col2="58" start="49268" end="49268">$</OP-DOLLAR>
                <SYMBOL line1="518" col1="59" line2="518" col2="62" start="49269" end="49272">func</SYMBOL>
              </expr>
              <OP-COMMA line1="518" col1="63" line2="518" col2="63" start="49273" end="49273">,</OP-COMMA>
              <expr line1="518" col1="65" line2="518" col2="72" start="49275" end="49282">
                <expr line1="518" col1="65" line2="518" col2="67" start="49275" end="49277">
                  <SYMBOL line1="518" col1="65" line2="518" col2="67" start="49275" end="49277">tab</SYMBOL>
                </expr>
                <OP-DOLLAR line1="518" col1="68" line2="518" col2="68" start="49278" end="49278">$</OP-DOLLAR>
                <SYMBOL line1="518" col1="69" line2="518" col2="72" start="49279" end="49282">data</SYMBOL>
              </expr>
              <OP-COMMA line1="518" col1="73" line2="518" col2="73" start="49283" end="49283">,</OP-COMMA>
              <SYMBOL_SUB line1="518" col1="75" line2="518" col2="77" start="49285" end="49287">sep</SYMBOL_SUB>
              <EQ_SUB line1="518" col1="78" line2="518" col2="78" start="49288" end="49288">=</EQ_SUB>
              <expr line1="518" col1="79" line2="518" col2="81" start="49289" end="49291">
                <STR_CONST line1="518" col1="79" line2="518" col2="81" start="49289" end="49291">"-"</STR_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="518" col1="82" line2="518" col2="82" start="49292" end="49292">)</OP-RIGHT-PAREN>
            </expr>
            <OP-RIGHT-PAREN line1="518" col1="83" line2="518" col2="83" start="49293" end="49293">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="519" col1="3" line2="519" col2="23" start="49308" end="49328">
          <expr line1="519" col1="3" line2="519" col2="5" start="49308" end="49310">
            <SYMBOL line1="519" col1="3" line2="519" col2="5" start="49308" end="49310">ans</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="519" col1="7" line2="519" col2="8" start="49312" end="49313">&lt;-</LEFT_ASSIGN>
          <expr line1="519" col1="10" line2="519" col2="23" start="49315" end="49328">
            <expr line1="519" col1="10" line2="519" col2="13" start="49315" end="49318">
              <SYMBOL_FUNCTION_CALL line1="519" col1="10" line2="519" col2="13" start="49315" end="49318">menu</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="519" col1="14" line2="519" col2="14" start="49319" end="49319">(</OP-LEFT-PAREN>
            <expr line1="519" col1="15" line2="519" col2="22" start="49320" end="49327">
              <SYMBOL line1="519" col1="15" line2="519" col2="22" start="49320" end="49327">menuOpts</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="519" col1="23" line2="519" col2="23" start="49328" end="49328">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="521" col1="3" line2="521" col2="53" start="49498" end="49548">
          <IF line1="521" col1="3" line2="521" col2="4" start="49498" end="49499">if</IF>
          <OP-LEFT-PAREN line1="521" col1="6" line2="521" col2="6" start="49501" end="49501">(</OP-LEFT-PAREN>
          <expr line1="521" col1="7" line2="521" col2="14" start="49502" end="49509">
            <expr line1="521" col1="7" line2="521" col2="9" start="49502" end="49504">
              <SYMBOL line1="521" col1="7" line2="521" col2="9" start="49502" end="49504">ans</SYMBOL>
            </expr>
            <EQ line1="521" col1="11" line2="521" col2="12" start="49506" end="49507">==</EQ>
            <expr line1="521" col1="14" line2="521" col2="14" start="49509" end="49509">
              <NUM_CONST line1="521" col1="14" line2="521" col2="14" start="49509" end="49509">0</NUM_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="521" col1="15" line2="521" col2="15" start="49510" end="49510">)</OP-RIGHT-PAREN>
          <expr line1="521" col1="17" line2="521" col2="53" start="49512" end="49548">
            <expr line1="521" col1="17" line2="521" col2="20" start="49512" end="49515">
              <SYMBOL_FUNCTION_CALL line1="521" col1="17" line2="521" col2="20" start="49512" end="49515">stop</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="521" col1="21" line2="521" col2="21" start="49516" end="49516">(</OP-LEFT-PAREN>
            <expr line1="521" col1="22" line2="521" col2="52" start="49517" end="49547">
              <STR_CONST line1="521" col1="22" line2="521" col2="52" start="49517" end="49547">"No scRNA-seq dataset selected"</STR_CONST>
            </expr>
            <OP-RIGHT-PAREN line1="521" col1="53" line2="521" col2="53" start="49548" end="49548">)</OP-RIGHT-PAREN>
          </expr>
        </expr>
        <expr line1="523" col1="3" line2="523" col2="21" start="49688" end="49706">
          <expr line1="523" col1="3" line2="523" col2="5" start="49688" end="49690">
            <SYMBOL line1="523" col1="3" line2="523" col2="5" start="49688" end="49690">pkg</SYMBOL>
          </expr>
          <LEFT_ASSIGN line1="523" col1="7" line2="523" col2="8" start="49692" end="49693">&lt;-</LEFT_ASSIGN>
          <expr line1="523" col1="10" line2="523" col2="21" start="49695" end="49706">
            <expr line1="523" col1="10" line2="523" col2="16" start="49695" end="49701">
              <expr line1="523" col1="10" line2="523" col2="12" start="49695" end="49697">
                <SYMBOL line1="523" col1="10" line2="523" col2="12" start="49695" end="49697">tab</SYMBOL>
              </expr>
              <OP-DOLLAR line1="523" col1="13" line2="523" col2="13" start="49698" end="49698">$</OP-DOLLAR>
              <SYMBOL line1="523" col1="14" line2="523" col2="16" start="49699" end="49701">pkg</SYMBOL>
            </expr>
            <OP-LEFT-BRACKET line1="523" col1="17" line2="523" col2="17" start="49702" end="49702">[</OP-LEFT-BRACKET>
            <expr line1="523" col1="18" line2="523" col2="20" start="49703" end="49705">
              <SYMBOL line1="523" col1="18" line2="523" col2="20" start="49703" end="49705">ans</SYMBOL>
            </expr>
            <OP-RIGHT-BRACKET line1="523" col1="21" line2="523" col2="21" start="49706" end="49706">]</OP-RIGHT-BRACKET>
          </expr>
        </expr>
        <expr line1="524" col1="3" line2="540" col2="3" start="49783" end="51303">
          <IF line1="524" col1="3" line2="524" col2="4" start="49783" end="49784">if</IF>
          <OP-LEFT-PAREN line1="524" col1="6" line2="524" col2="6" start="49786" end="49786">(</OP-LEFT-PAREN>
          <expr line1="524" col1="7" line2="524" col2="50" start="49787" end="49830">
            <OP-EXCLAMATION line1="524" col1="7" line2="524" col2="7" start="49787" end="49787">!</OP-EXCLAMATION>
            <expr line1="524" col1="8" line2="524" col2="50" start="49788" end="49830">
              <expr line1="524" col1="8" line2="524" col2="23" start="49788" end="49803">
                <SYMBOL_FUNCTION_CALL line1="524" col1="8" line2="524" col2="23" start="49788" end="49803">requireNamespace</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="524" col1="24" line2="524" col2="24" start="49804" end="49804">(</OP-LEFT-PAREN>
              <SYMBOL_SUB line1="524" col1="25" line2="524" col2="31" start="49805" end="49811">package</SYMBOL_SUB>
              <EQ_SUB line1="524" col1="32" line2="524" col2="32" start="49812" end="49812">=</EQ_SUB>
              <expr line1="524" col1="33" line2="524" col2="35" start="49813" end="49815">
                <SYMBOL line1="524" col1="33" line2="524" col2="35" start="49813" end="49815">pkg</SYMBOL>
              </expr>
              <OP-COMMA line1="524" col1="36" line2="524" col2="36" start="49816" end="49816">,</OP-COMMA>
              <SYMBOL_SUB line1="524" col1="38" line2="524" col2="44" start="49818" end="49824">quietly</SYMBOL_SUB>
              <EQ_SUB line1="524" col1="45" line2="524" col2="45" start="49825" end="49825">=</EQ_SUB>
              <expr line1="524" col1="46" line2="524" col2="49" start="49826" end="49829">
                <NUM_CONST line1="524" col1="46" line2="524" col2="49" start="49826" end="49829">TRUE</NUM_CONST>
              </expr>
              <OP-RIGHT-PAREN line1="524" col1="50" line2="524" col2="50" start="49830" end="49830">)</OP-RIGHT-PAREN>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="524" col1="51" line2="524" col2="51" start="49831" end="49831">)</OP-RIGHT-PAREN>
          <expr line1="524" col1="53" line2="540" col2="3" start="49833" end="51303">
            <OP-LEFT-BRACE line1="524" col1="53" line2="524" col2="53" start="49833" end="49833">{</OP-LEFT-BRACE>
            <expr line1="525" col1="5" line2="525" col2="59" start="49880" end="49934">
              <expr line1="525" col1="5" line2="525" col2="11" start="49880" end="49886">
                <SYMBOL_FUNCTION_CALL line1="525" col1="5" line2="525" col2="11" start="49880" end="49886">message</SYMBOL_FUNCTION_CALL>
              </expr>
              <OP-LEFT-PAREN line1="525" col1="12" line2="525" col2="12" start="49887" end="49887">(</OP-LEFT-PAREN>
              <expr line1="525" col1="13" line2="525" col2="58" start="49888" end="49933">
                <expr line1="525" col1="13" line2="525" col2="18" start="49888" end="49893">
                  <SYMBOL_FUNCTION_CALL line1="525" col1="13" line2="525" col2="18" start="49888" end="49893">paste0</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="525" col1="19" line2="525" col2="19" start="49894" end="49894">(</OP-LEFT-PAREN>
                <expr line1="525" col1="20" line2="525" col2="31" start="49895" end="49906">
                  <STR_CONST line1="525" col1="20" line2="525" col2="31" start="49895" end="49906">"Package: '"</STR_CONST>
                </expr>
                <OP-COMMA line1="525" col1="32" line2="525" col2="32" start="49907" end="49907">,</OP-COMMA>
                <expr line1="525" col1="33" line2="525" col2="35" start="49908" end="49910">
                  <SYMBOL line1="525" col1="33" line2="525" col2="35" start="49908" end="49910">pkg</SYMBOL>
                </expr>
                <OP-COMMA line1="525" col1="36" line2="525" col2="36" start="49911" end="49911">,</OP-COMMA>
                <expr line1="525" col1="38" line2="525" col2="57" start="49913" end="49932">
                  <STR_CONST line1="525" col1="38" line2="525" col2="57" start="49913" end="49932">"' is not installed"</STR_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="525" col1="58" line2="525" col2="58" start="49933" end="49933">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="525" col1="59" line2="525" col2="59" start="49934" end="49934">)</OP-RIGHT-PAREN>
            </expr>
            <expr line1="526" col1="5" line2="526" col2="76" start="49975" end="50046">
              <expr line1="526" col1="5" line2="526" col2="7" start="49975" end="49977">
                <SYMBOL line1="526" col1="5" line2="526" col2="7" start="49975" end="49977">ask</SYMBOL>
              </expr>
              <LEFT_ASSIGN line1="526" col1="9" line2="526" col2="10" start="49979" end="49980">&lt;-</LEFT_ASSIGN>
              <expr line1="526" col1="12" line2="526" col2="76" start="49982" end="50046">
                <expr line1="526" col1="12" line2="526" col2="19" start="49982" end="49989">
                  <SYMBOL_FUNCTION_CALL line1="526" col1="12" line2="526" col2="19" start="49982" end="49989">askYesNo</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="526" col1="20" line2="526" col2="20" start="49990" end="49990">(</OP-LEFT-PAREN>
                <expr line1="526" col1="21" line2="526" col2="75" start="49991" end="50045">
                  <STR_CONST line1="526" col1="21" line2="526" col2="75" start="49991" end="50045">"Would you like to install the necessary data package?"</STR_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="526" col1="76" line2="526" col2="76" start="50046" end="50046">)</OP-RIGHT-PAREN>
              </expr>
            </expr>
            <expr line1="527" col1="5" line2="534" col2="5" start="50070" end="50735">
              <IF line1="527" col1="5" line2="527" col2="6" start="50070" end="50071">if</IF>
              <OP-LEFT-PAREN line1="527" col1="8" line2="527" col2="8" start="50073" end="50073">(</OP-LEFT-PAREN>
              <expr line1="527" col1="9" line2="527" col2="11" start="50074" end="50076">
                <SYMBOL line1="527" col1="9" line2="527" col2="11" start="50074" end="50076">ask</SYMBOL>
              </expr>
              <OP-RIGHT-PAREN line1="527" col1="12" line2="527" col2="12" start="50077" end="50077">)</OP-RIGHT-PAREN>
              <expr line1="527" col1="14" line2="532" col2="5" start="50079" end="50545">
                <OP-LEFT-BRACE line1="527" col1="14" line2="527" col2="14" start="50079" end="50079">{</OP-LEFT-BRACE>
                <expr line1="528" col1="7" line2="530" col2="7" start="50167" end="50357">
                  <IF line1="528" col1="7" line2="528" col2="8" start="50167" end="50168">if</IF>
                  <OP-LEFT-PAREN line1="528" col1="10" line2="528" col2="10" start="50170" end="50170">(</OP-LEFT-PAREN>
                  <expr line1="528" col1="11" line2="528" col2="64" start="50171" end="50224">
                    <OP-EXCLAMATION line1="528" col1="11" line2="528" col2="11" start="50171" end="50171">!</OP-EXCLAMATION>
                    <expr line1="528" col1="12" line2="528" col2="64" start="50172" end="50224">
                      <expr line1="528" col1="12" line2="528" col2="27" start="50172" end="50187">
                        <SYMBOL_FUNCTION_CALL line1="528" col1="12" line2="528" col2="27" start="50172" end="50187">requireNamespace</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="528" col1="28" line2="528" col2="28" start="50188" end="50188">(</OP-LEFT-PAREN>
                      <SYMBOL_SUB line1="528" col1="29" line2="528" col2="35" start="50189" end="50195">package</SYMBOL_SUB>
                      <EQ_SUB line1="528" col1="36" line2="528" col2="36" start="50196" end="50196">=</EQ_SUB>
                      <expr line1="528" col1="37" line2="528" col2="49" start="50197" end="50209">
                        <STR_CONST line1="528" col1="37" line2="528" col2="49" start="50197" end="50209">"BiocManager"</STR_CONST>
                      </expr>
                      <OP-COMMA line1="528" col1="50" line2="528" col2="50" start="50210" end="50210">,</OP-COMMA>
                      <SYMBOL_SUB line1="528" col1="52" line2="528" col2="58" start="50212" end="50218">quietly</SYMBOL_SUB>
                      <EQ_SUB line1="528" col1="59" line2="528" col2="59" start="50219" end="50219">=</EQ_SUB>
                      <expr line1="528" col1="60" line2="528" col2="63" start="50220" end="50223">
                        <NUM_CONST line1="528" col1="60" line2="528" col2="63" start="50220" end="50223">TRUE</NUM_CONST>
                      </expr>
                      <OP-RIGHT-PAREN line1="528" col1="64" line2="528" col2="64" start="50224" end="50224">)</OP-RIGHT-PAREN>
                    </expr>
                  </expr>
                  <OP-RIGHT-PAREN line1="528" col1="65" line2="528" col2="65" start="50225" end="50225">)</OP-RIGHT-PAREN>
                  <expr line1="528" col1="67" line2="530" col2="7" start="50227" end="50357">
                    <OP-LEFT-BRACE line1="528" col1="67" line2="528" col2="67" start="50227" end="50227">{</OP-LEFT-BRACE>
                    <expr line1="529" col1="9" line2="529" col2="77" start="50264" end="50332">
                      <expr line1="529" col1="9" line2="529" col2="12" start="50264" end="50267">
                        <SYMBOL_FUNCTION_CALL line1="529" col1="9" line2="529" col2="12" start="50264" end="50267">stop</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="529" col1="13" line2="529" col2="13" start="50268" end="50268">(</OP-LEFT-PAREN>
                      <expr line1="529" col1="14" line2="529" col2="76" start="50269" end="50331">
                        <STR_CONST line1="529" col1="14" line2="529" col2="76" start="50269" end="50331">"'BiocManager' required to install packages, install from CRAN"</STR_CONST>
                      </expr>
                      <OP-RIGHT-PAREN line1="529" col1="77" line2="529" col2="77" start="50332" end="50332">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-BRACE line1="530" col1="7" line2="530" col2="7" start="50357" end="50357">}</OP-RIGHT-BRACE>
                  </expr>
                </expr>
                <expr line1="531" col1="7" line2="531" col2="31" start="50452" end="50476">
                  <expr line1="531" col1="7" line2="531" col2="26" start="50452" end="50471">
                    <SYMBOL_PACKAGE line1="531" col1="7" line2="531" col2="17" start="50452" end="50462">BiocManager</SYMBOL_PACKAGE>
                    <NS_GET line1="531" col1="18" line2="531" col2="19" start="50463" end="50464">::</NS_GET>
                    <SYMBOL_FUNCTION_CALL line1="531" col1="20" line2="531" col2="26" start="50465" end="50471">install</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="531" col1="27" line2="531" col2="27" start="50472" end="50472">(</OP-LEFT-PAREN>
                  <expr line1="531" col1="28" line2="531" col2="30" start="50473" end="50475">
                    <SYMBOL line1="531" col1="28" line2="531" col2="30" start="50473" end="50475">pkg</SYMBOL>
                  </expr>
                  <OP-RIGHT-PAREN line1="531" col1="31" line2="531" col2="31" start="50476" end="50476">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="532" col1="5" line2="532" col2="5" start="50545" end="50545">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="532" col1="7" line2="532" col2="10" start="50547" end="50550">else</ELSE>
              <expr line1="532" col1="12" line2="534" col2="5" start="50552" end="50735">
                <OP-LEFT-BRACE line1="532" col1="12" line2="532" col2="12" start="50552" end="50552">{</OP-LEFT-BRACE>
                <expr line1="533" col1="7" line2="533" col2="48" start="50642" end="50683">
                  <expr line1="533" col1="7" line2="533" col2="10" start="50642" end="50645">
                    <SYMBOL_FUNCTION_CALL line1="533" col1="7" line2="533" col2="10" start="50642" end="50645">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="533" col1="11" line2="533" col2="11" start="50646" end="50646">(</OP-LEFT-PAREN>
                  <expr line1="533" col1="12" line2="533" col2="47" start="50647" end="50682">
                    <STR_CONST line1="533" col1="12" line2="533" col2="47" start="50647" end="50682">"Package would need to be installed"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="533" col1="48" line2="533" col2="48" start="50683" end="50683">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="534" col1="5" line2="534" col2="5" start="50735" end="50735">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <expr line1="535" col1="5" line2="539" col2="5" start="50830" end="51210">
              <IF line1="535" col1="5" line2="535" col2="6" start="50830" end="50831">if</IF>
              <OP-LEFT-PAREN line1="535" col1="8" line2="535" col2="8" start="50833" end="50833">(</OP-LEFT-PAREN>
              <expr line1="535" col1="9" line2="535" col2="51" start="50834" end="50876">
                <expr line1="535" col1="9" line2="535" col2="24" start="50834" end="50849">
                  <SYMBOL_FUNCTION_CALL line1="535" col1="9" line2="535" col2="24" start="50834" end="50849">requireNamespace</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="535" col1="25" line2="535" col2="25" start="50850" end="50850">(</OP-LEFT-PAREN>
                <SYMBOL_SUB line1="535" col1="26" line2="535" col2="32" start="50851" end="50857">package</SYMBOL_SUB>
                <EQ_SUB line1="535" col1="33" line2="535" col2="33" start="50858" end="50858">=</EQ_SUB>
                <expr line1="535" col1="34" line2="535" col2="36" start="50859" end="50861">
                  <SYMBOL line1="535" col1="34" line2="535" col2="36" start="50859" end="50861">pkg</SYMBOL>
                </expr>
                <OP-COMMA line1="535" col1="37" line2="535" col2="37" start="50862" end="50862">,</OP-COMMA>
                <SYMBOL_SUB line1="535" col1="39" line2="535" col2="45" start="50864" end="50870">quietly</SYMBOL_SUB>
                <EQ_SUB line1="535" col1="46" line2="535" col2="46" start="50871" end="50871">=</EQ_SUB>
                <expr line1="535" col1="47" line2="535" col2="50" start="50872" end="50875">
                  <NUM_CONST line1="535" col1="47" line2="535" col2="50" start="50872" end="50875">TRUE</NUM_CONST>
                </expr>
                <OP-RIGHT-PAREN line1="535" col1="51" line2="535" col2="51" start="50876" end="50876">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="535" col1="52" line2="535" col2="52" start="50877" end="50877">)</OP-RIGHT-PAREN>
              <expr line1="535" col1="54" line2="537" col2="5" start="50879" end="51020">
                <OP-LEFT-BRACE line1="535" col1="54" line2="535" col2="54" start="50879" end="50879">{</OP-LEFT-BRACE>
                <expr line1="536" col1="7" line2="536" col2="56" start="50927" end="50976">
                  <expr line1="536" col1="7" line2="536" col2="13" start="50927" end="50933">
                    <SYMBOL_FUNCTION_CALL line1="536" col1="7" line2="536" col2="13" start="50927" end="50933">message</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="536" col1="14" line2="536" col2="14" start="50934" end="50934">(</OP-LEFT-PAREN>
                  <expr line1="536" col1="15" line2="536" col2="55" start="50935" end="50975">
                    <STR_CONST line1="536" col1="15" line2="536" col2="55" start="50935" end="50975">"Data package was installed successfully"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="536" col1="56" line2="536" col2="56" start="50976" end="50976">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="537" col1="5" line2="537" col2="5" start="51020" end="51020">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="537" col1="7" line2="537" col2="10" start="51022" end="51025">else</ELSE>
              <expr line1="537" col1="12" line2="539" col2="5" start="51027" end="51210">
                <OP-LEFT-BRACE line1="537" col1="12" line2="537" col2="12" start="51027" end="51027">{</OP-LEFT-BRACE>
                <expr line1="538" col1="7" line2="538" col2="90" start="51117" end="51200">
                  <expr line1="538" col1="7" line2="538" col2="10" start="51117" end="51120">
                    <SYMBOL_FUNCTION_CALL line1="538" col1="7" line2="538" col2="10" start="51117" end="51120">stop</SYMBOL_FUNCTION_CALL>
                  </expr>
                  <OP-LEFT-PAREN line1="538" col1="11" line2="538" col2="11" start="51121" end="51121">(</OP-LEFT-PAREN>
                  <expr line1="538" col1="12" line2="538" col2="89" start="51122" end="51199">
                    <STR_CONST line1="538" col1="12" line2="538" col2="89" start="51122" end="51199">"Data package still needs to be installed for integrateWithSingleCell to work"</STR_CONST>
                  </expr>
                  <OP-RIGHT-PAREN line1="538" col1="90" line2="538" col2="90" start="51200" end="51200">)</OP-RIGHT-PAREN>
                </expr>
                <OP-RIGHT-BRACE line1="539" col1="5" line2="539" col2="5" start="51210" end="51210">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="540" col1="3" line2="540" col2="3" start="51303" end="51303">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="542" col1="3" line2="542" col2="16" start="51493" end="51506"># load package</COMMENT>
        <expr line1="543" col1="3" line2="543" col2="35" start="51588" end="51620">
          <expr line1="543" col1="3" line2="543" col2="9" start="51588" end="51594">
            <SYMBOL_FUNCTION_CALL line1="543" col1="3" line2="543" col2="9" start="51588" end="51594">require</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="543" col1="10" line2="543" col2="10" start="51595" end="51595">(</OP-LEFT-PAREN>
          <expr line1="543" col1="11" line2="543" col2="13" start="51596" end="51598">
            <SYMBOL line1="543" col1="11" line2="543" col2="13" start="51596" end="51598">pkg</SYMBOL>
          </expr>
          <OP-COMMA line1="543" col1="14" line2="543" col2="14" start="51599" end="51599">,</OP-COMMA>
          <SYMBOL_SUB line1="543" col1="16" line2="543" col2="29" start="51601" end="51614">character.only</SYMBOL_SUB>
          <EQ_SUB line1="543" col1="30" line2="543" col2="30" start="51615" end="51615">=</EQ_SUB>
          <expr line1="543" col1="31" line2="543" col2="34" start="51616" end="51619">
            <NUM_CONST line1="543" col1="31" line2="543" col2="34" start="51616" end="51619">TRUE</NUM_CONST>
          </expr>
          <OP-RIGHT-PAREN line1="543" col1="35" line2="543" col2="35" start="51620" end="51620">)</OP-RIGHT-PAREN>
        </expr>
        <COMMENT line1="545" col1="3" line2="545" col2="48" start="51778" end="51823"># if the dataset is in the scRNAseq package...</COMMENT>
        <expr line1="546" col1="3" line2="560" col2="3" start="51873" end="53203">
          <IF line1="546" col1="3" line2="546" col2="4" start="51873" end="51874">if</IF>
          <OP-LEFT-PAREN line1="546" col1="6" line2="546" col2="6" start="51876" end="51876">(</OP-LEFT-PAREN>
          <expr line1="546" col1="7" line2="546" col2="23" start="51877" end="51893">
            <expr line1="546" col1="7" line2="546" col2="9" start="51877" end="51879">
              <SYMBOL line1="546" col1="7" line2="546" col2="9" start="51877" end="51879">pkg</SYMBOL>
            </expr>
            <EQ line1="546" col1="11" line2="546" col2="12" start="51881" end="51882">==</EQ>
            <expr line1="546" col1="14" line2="546" col2="23" start="51884" end="51893">
              <STR_CONST line1="546" col1="14" line2="546" col2="23" start="51884" end="51893">"scRNAseq"</STR_CONST>
            </expr>
          </expr>
          <OP-RIGHT-PAREN line1="546" col1="24" line2="546" col2="24" start="51894" end="51894">)</OP-RIGHT-PAREN>
          <expr line1="546" col1="26" line2="553" col2="3" start="51896" end="52538">
            <OP-LEFT-BRACE line1="546" col1="26" line2="546" col2="26" start="51896" end="51896">{</OP-LEFT-BRACE>
            <COMMENT line1="547" col1="5" line2="547" col2="48" start="51970" end="52013"># if only one dataset within the function...</COMMENT>
            <expr line1="548" col1="5" line2="552" col2="5" start="52065" end="52445">
              <IF line1="548" col1="5" line2="548" col2="6" start="52065" end="52066">if</IF>
              <OP-LEFT-PAREN line1="548" col1="8" line2="548" col2="8" start="52068" end="52068">(</OP-LEFT-PAREN>
              <expr line1="548" col1="9" line2="548" col2="28" start="52069" end="52088">
                <expr line1="548" col1="9" line2="548" col2="13" start="52069" end="52073">
                  <SYMBOL_FUNCTION_CALL line1="548" col1="9" line2="548" col2="13" start="52069" end="52073">is.na</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="548" col1="14" line2="548" col2="14" start="52074" end="52074">(</OP-LEFT-PAREN>
                <expr line1="548" col1="15" line2="548" col2="27" start="52075" end="52087">
                  <expr line1="548" col1="15" line2="548" col2="22" start="52075" end="52082">
                    <expr line1="548" col1="15" line2="548" col2="17" start="52075" end="52077">
                      <SYMBOL line1="548" col1="15" line2="548" col2="17" start="52075" end="52077">tab</SYMBOL>
                    </expr>
                    <OP-DOLLAR line1="548" col1="18" line2="548" col2="18" start="52078" end="52078">$</OP-DOLLAR>
                    <SYMBOL line1="548" col1="19" line2="548" col2="22" start="52079" end="52082">data</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="548" col1="23" line2="548" col2="23" start="52083" end="52083">[</OP-LEFT-BRACKET>
                  <expr line1="548" col1="24" line2="548" col2="26" start="52084" end="52086">
                    <SYMBOL line1="548" col1="24" line2="548" col2="26" start="52084" end="52086">ans</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="548" col1="27" line2="548" col2="27" start="52087" end="52087">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="548" col1="28" line2="548" col2="28" start="52088" end="52088">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="548" col1="29" line2="548" col2="29" start="52089" end="52089">)</OP-RIGHT-PAREN>
              <expr line1="548" col1="31" line2="550" col2="5" start="52091" end="52255">
                <OP-LEFT-BRACE line1="548" col1="31" line2="548" col2="31" start="52091" end="52091">{</OP-LEFT-BRACE>
                <expr line1="549" col1="7" line2="549" col2="60" start="52162" end="52215">
                  <expr line1="549" col1="7" line2="549" col2="9" start="52162" end="52164">
                    <SYMBOL line1="549" col1="7" line2="549" col2="9" start="52162" end="52164">sce</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="549" col1="11" line2="549" col2="12" start="52166" end="52167">&lt;-</LEFT_ASSIGN>
                  <expr line1="549" col1="14" line2="549" col2="60" start="52169" end="52215">
                    <expr line1="549" col1="14" line2="549" col2="20" start="52169" end="52175">
                      <SYMBOL_FUNCTION_CALL line1="549" col1="14" line2="549" col2="20" start="52169" end="52175">do.call</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="549" col1="21" line2="549" col2="21" start="52176" end="52176">(</OP-LEFT-PAREN>
                    <expr line1="549" col1="22" line2="549" col2="34" start="52177" end="52189">
                      <expr line1="549" col1="22" line2="549" col2="29" start="52177" end="52184">
                        <expr line1="549" col1="22" line2="549" col2="24" start="52177" end="52179">
                          <SYMBOL line1="549" col1="22" line2="549" col2="24" start="52177" end="52179">tab</SYMBOL>
                        </expr>
                        <OP-DOLLAR line1="549" col1="25" line2="549" col2="25" start="52180" end="52180">$</OP-DOLLAR>
                        <SYMBOL line1="549" col1="26" line2="549" col2="29" start="52181" end="52184">func</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="549" col1="30" line2="549" col2="30" start="52185" end="52185">[</OP-LEFT-BRACKET>
                      <expr line1="549" col1="31" line2="549" col2="33" start="52186" end="52188">
                        <SYMBOL line1="549" col1="31" line2="549" col2="33" start="52186" end="52188">ans</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="549" col1="34" line2="549" col2="34" start="52189" end="52189">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="549" col1="35" line2="549" col2="35" start="52190" end="52190">,</OP-COMMA>
                    <expr line1="549" col1="37" line2="549" col2="59" start="52192" end="52214">
                      <expr line1="549" col1="37" line2="549" col2="40" start="52192" end="52195">
                        <SYMBOL_FUNCTION_CALL line1="549" col1="37" line2="549" col2="40" start="52192" end="52195">list</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="549" col1="41" line2="549" col2="41" start="52196" end="52196">(</OP-LEFT-PAREN>
                      <SYMBOL_SUB line1="549" col1="42" line2="549" col2="48" start="52197" end="52203">ensembl</SYMBOL_SUB>
                      <EQ_SUB line1="549" col1="49" line2="549" col2="49" start="52204" end="52204">=</EQ_SUB>
                      <expr line1="549" col1="50" line2="549" col2="53" start="52205" end="52208">
                        <NUM_CONST line1="549" col1="50" line2="549" col2="53" start="52205" end="52208">TRUE</NUM_CONST>
                      </expr>
                      <OP-COMMA line1="549" col1="54" line2="549" col2="54" start="52209" end="52209">,</OP-COMMA>
                      <expr line1="549" col1="56" line2="549" col2="58" start="52211" end="52213">
                        <SYMBOL line1="549" col1="56" line2="549" col2="58" start="52211" end="52213">...</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="549" col1="59" line2="549" col2="59" start="52214" end="52214">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="549" col1="60" line2="549" col2="60" start="52215" end="52215">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="550" col1="5" line2="550" col2="5" start="52255" end="52255">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="550" col1="7" line2="550" col2="10" start="52257" end="52260">else</ELSE>
              <expr line1="550" col1="12" line2="552" col2="5" start="52262" end="52445">
                <OP-LEFT-BRACE line1="550" col1="12" line2="550" col2="12" start="52262" end="52262">{</OP-LEFT-BRACE>
                <expr line1="551" col1="7" line2="551" col2="81" start="52352" end="52426">
                  <expr line1="551" col1="7" line2="551" col2="9" start="52352" end="52354">
                    <SYMBOL line1="551" col1="7" line2="551" col2="9" start="52352" end="52354">sce</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="551" col1="11" line2="551" col2="12" start="52356" end="52357">&lt;-</LEFT_ASSIGN>
                  <expr line1="551" col1="14" line2="551" col2="81" start="52359" end="52426">
                    <expr line1="551" col1="14" line2="551" col2="20" start="52359" end="52365">
                      <SYMBOL_FUNCTION_CALL line1="551" col1="14" line2="551" col2="20" start="52359" end="52365">do.call</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="551" col1="21" line2="551" col2="21" start="52366" end="52366">(</OP-LEFT-PAREN>
                    <expr line1="551" col1="22" line2="551" col2="34" start="52367" end="52379">
                      <expr line1="551" col1="22" line2="551" col2="29" start="52367" end="52374">
                        <expr line1="551" col1="22" line2="551" col2="24" start="52367" end="52369">
                          <SYMBOL line1="551" col1="22" line2="551" col2="24" start="52367" end="52369">tab</SYMBOL>
                        </expr>
                        <OP-DOLLAR line1="551" col1="25" line2="551" col2="25" start="52370" end="52370">$</OP-DOLLAR>
                        <SYMBOL line1="551" col1="26" line2="551" col2="29" start="52371" end="52374">func</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="551" col1="30" line2="551" col2="30" start="52375" end="52375">[</OP-LEFT-BRACKET>
                      <expr line1="551" col1="31" line2="551" col2="33" start="52376" end="52378">
                        <SYMBOL line1="551" col1="31" line2="551" col2="33" start="52376" end="52378">ans</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="551" col1="34" line2="551" col2="34" start="52379" end="52379">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="551" col1="35" line2="551" col2="35" start="52380" end="52380">,</OP-COMMA>
                    <expr line1="551" col1="37" line2="551" col2="80" start="52382" end="52425">
                      <expr line1="551" col1="37" line2="551" col2="40" start="52382" end="52385">
                        <SYMBOL_FUNCTION_CALL line1="551" col1="37" line2="551" col2="40" start="52382" end="52385">list</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="551" col1="41" line2="551" col2="41" start="52386" end="52386">(</OP-LEFT-PAREN>
                      <SYMBOL_SUB line1="551" col1="42" line2="551" col2="46" start="52387" end="52391">which</SYMBOL_SUB>
                      <EQ_SUB line1="551" col1="47" line2="551" col2="47" start="52392" end="52392">=</EQ_SUB>
                      <expr line1="551" col1="48" line2="551" col2="60" start="52393" end="52405">
                        <expr line1="551" col1="48" line2="551" col2="55" start="52393" end="52400">
                          <expr line1="551" col1="48" line2="551" col2="50" start="52393" end="52395">
                            <SYMBOL line1="551" col1="48" line2="551" col2="50" start="52393" end="52395">tab</SYMBOL>
                          </expr>
                          <OP-DOLLAR line1="551" col1="51" line2="551" col2="51" start="52396" end="52396">$</OP-DOLLAR>
                          <SYMBOL line1="551" col1="52" line2="551" col2="55" start="52397" end="52400">data</SYMBOL>
                        </expr>
                        <OP-LEFT-BRACKET line1="551" col1="56" line2="551" col2="56" start="52401" end="52401">[</OP-LEFT-BRACKET>
                        <expr line1="551" col1="57" line2="551" col2="59" start="52402" end="52404">
                          <SYMBOL line1="551" col1="57" line2="551" col2="59" start="52402" end="52404">ans</SYMBOL>
                        </expr>
                        <OP-RIGHT-BRACKET line1="551" col1="60" line2="551" col2="60" start="52405" end="52405">]</OP-RIGHT-BRACKET>
                      </expr>
                      <OP-COMMA line1="551" col1="61" line2="551" col2="61" start="52406" end="52406">,</OP-COMMA>
                      <SYMBOL_SUB line1="551" col1="63" line2="551" col2="69" start="52408" end="52414">ensembl</SYMBOL_SUB>
                      <EQ_SUB line1="551" col1="70" line2="551" col2="70" start="52415" end="52415">=</EQ_SUB>
                      <expr line1="551" col1="71" line2="551" col2="74" start="52416" end="52419">
                        <NUM_CONST line1="551" col1="71" line2="551" col2="74" start="52416" end="52419">TRUE</NUM_CONST>
                      </expr>
                      <OP-COMMA line1="551" col1="75" line2="551" col2="75" start="52420" end="52420">,</OP-COMMA>
                      <expr line1="551" col1="77" line2="551" col2="79" start="52422" end="52424">
                        <SYMBOL line1="551" col1="77" line2="551" col2="79" start="52422" end="52424">...</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="551" col1="80" line2="551" col2="80" start="52425" end="52425">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="551" col1="81" line2="551" col2="81" start="52426" end="52426">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="552" col1="5" line2="552" col2="5" start="52445" end="52445">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="553" col1="3" line2="553" col2="3" start="52538" end="52538">}</OP-RIGHT-BRACE>
          </expr>
          <ELSE line1="553" col1="5" line2="553" col2="8" start="52540" end="52543">else</ELSE>
          <expr line1="553" col1="10" line2="560" col2="3" start="52545" end="53203">
            <OP-LEFT-BRACE line1="553" col1="10" line2="553" col2="10" start="52545" end="52545">{</OP-LEFT-BRACE>
            <COMMENT line1="554" col1="5" line2="554" col2="48" start="52635" end="52678"># if only one dataset within the function...</COMMENT>
            <expr line1="555" col1="5" line2="559" col2="5" start="52730" end="53110">
              <IF line1="555" col1="5" line2="555" col2="6" start="52730" end="52731">if</IF>
              <OP-LEFT-PAREN line1="555" col1="8" line2="555" col2="8" start="52733" end="52733">(</OP-LEFT-PAREN>
              <expr line1="555" col1="9" line2="555" col2="28" start="52734" end="52753">
                <expr line1="555" col1="9" line2="555" col2="13" start="52734" end="52738">
                  <SYMBOL_FUNCTION_CALL line1="555" col1="9" line2="555" col2="13" start="52734" end="52738">is.na</SYMBOL_FUNCTION_CALL>
                </expr>
                <OP-LEFT-PAREN line1="555" col1="14" line2="555" col2="14" start="52739" end="52739">(</OP-LEFT-PAREN>
                <expr line1="555" col1="15" line2="555" col2="27" start="52740" end="52752">
                  <expr line1="555" col1="15" line2="555" col2="22" start="52740" end="52747">
                    <expr line1="555" col1="15" line2="555" col2="17" start="52740" end="52742">
                      <SYMBOL line1="555" col1="15" line2="555" col2="17" start="52740" end="52742">tab</SYMBOL>
                    </expr>
                    <OP-DOLLAR line1="555" col1="18" line2="555" col2="18" start="52743" end="52743">$</OP-DOLLAR>
                    <SYMBOL line1="555" col1="19" line2="555" col2="22" start="52744" end="52747">data</SYMBOL>
                  </expr>
                  <OP-LEFT-BRACKET line1="555" col1="23" line2="555" col2="23" start="52748" end="52748">[</OP-LEFT-BRACKET>
                  <expr line1="555" col1="24" line2="555" col2="26" start="52749" end="52751">
                    <SYMBOL line1="555" col1="24" line2="555" col2="26" start="52749" end="52751">ans</SYMBOL>
                  </expr>
                  <OP-RIGHT-BRACKET line1="555" col1="27" line2="555" col2="27" start="52752" end="52752">]</OP-RIGHT-BRACKET>
                </expr>
                <OP-RIGHT-PAREN line1="555" col1="28" line2="555" col2="28" start="52753" end="52753">)</OP-RIGHT-PAREN>
              </expr>
              <OP-RIGHT-PAREN line1="555" col1="29" line2="555" col2="29" start="52754" end="52754">)</OP-RIGHT-PAREN>
              <expr line1="555" col1="31" line2="557" col2="5" start="52756" end="52920">
                <OP-LEFT-BRACE line1="555" col1="31" line2="555" col2="31" start="52756" end="52756">{</OP-LEFT-BRACE>
                <expr line1="556" col1="7" line2="556" col2="46" start="52827" end="52866">
                  <expr line1="556" col1="7" line2="556" col2="9" start="52827" end="52829">
                    <SYMBOL line1="556" col1="7" line2="556" col2="9" start="52827" end="52829">sce</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="556" col1="11" line2="556" col2="12" start="52831" end="52832">&lt;-</LEFT_ASSIGN>
                  <expr line1="556" col1="14" line2="556" col2="46" start="52834" end="52866">
                    <expr line1="556" col1="14" line2="556" col2="20" start="52834" end="52840">
                      <SYMBOL_FUNCTION_CALL line1="556" col1="14" line2="556" col2="20" start="52834" end="52840">do.call</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="556" col1="21" line2="556" col2="21" start="52841" end="52841">(</OP-LEFT-PAREN>
                    <expr line1="556" col1="22" line2="556" col2="34" start="52842" end="52854">
                      <expr line1="556" col1="22" line2="556" col2="29" start="52842" end="52849">
                        <expr line1="556" col1="22" line2="556" col2="24" start="52842" end="52844">
                          <SYMBOL line1="556" col1="22" line2="556" col2="24" start="52842" end="52844">tab</SYMBOL>
                        </expr>
                        <OP-DOLLAR line1="556" col1="25" line2="556" col2="25" start="52845" end="52845">$</OP-DOLLAR>
                        <SYMBOL line1="556" col1="26" line2="556" col2="29" start="52846" end="52849">func</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="556" col1="30" line2="556" col2="30" start="52850" end="52850">[</OP-LEFT-BRACKET>
                      <expr line1="556" col1="31" line2="556" col2="33" start="52851" end="52853">
                        <SYMBOL line1="556" col1="31" line2="556" col2="33" start="52851" end="52853">ans</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="556" col1="34" line2="556" col2="34" start="52854" end="52854">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="556" col1="35" line2="556" col2="35" start="52855" end="52855">,</OP-COMMA>
                    <expr line1="556" col1="37" line2="556" col2="45" start="52857" end="52865">
                      <expr line1="556" col1="37" line2="556" col2="40" start="52857" end="52860">
                        <SYMBOL_FUNCTION_CALL line1="556" col1="37" line2="556" col2="40" start="52857" end="52860">list</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="556" col1="41" line2="556" col2="41" start="52861" end="52861">(</OP-LEFT-PAREN>
                      <expr line1="556" col1="42" line2="556" col2="44" start="52862" end="52864">
                        <SYMBOL line1="556" col1="42" line2="556" col2="44" start="52862" end="52864">...</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="556" col1="45" line2="556" col2="45" start="52865" end="52865">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="556" col1="46" line2="556" col2="46" start="52866" end="52866">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="557" col1="5" line2="557" col2="5" start="52920" end="52920">}</OP-RIGHT-BRACE>
              </expr>
              <ELSE line1="557" col1="7" line2="557" col2="10" start="52922" end="52925">else</ELSE>
              <expr line1="557" col1="12" line2="559" col2="5" start="52927" end="53110">
                <OP-LEFT-BRACE line1="557" col1="12" line2="557" col2="12" start="52927" end="52927">{</OP-LEFT-BRACE>
                <expr line1="558" col1="7" line2="558" col2="69" start="53017" end="53079">
                  <expr line1="558" col1="7" line2="558" col2="9" start="53017" end="53019">
                    <SYMBOL line1="558" col1="7" line2="558" col2="9" start="53017" end="53019">sce</SYMBOL>
                  </expr>
                  <LEFT_ASSIGN line1="558" col1="11" line2="558" col2="12" start="53021" end="53022">&lt;-</LEFT_ASSIGN>
                  <expr line1="558" col1="14" line2="558" col2="69" start="53024" end="53079">
                    <expr line1="558" col1="14" line2="558" col2="20" start="53024" end="53030">
                      <SYMBOL_FUNCTION_CALL line1="558" col1="14" line2="558" col2="20" start="53024" end="53030">do.call</SYMBOL_FUNCTION_CALL>
                    </expr>
                    <OP-LEFT-PAREN line1="558" col1="21" line2="558" col2="21" start="53031" end="53031">(</OP-LEFT-PAREN>
                    <expr line1="558" col1="22" line2="558" col2="34" start="53032" end="53044">
                      <expr line1="558" col1="22" line2="558" col2="29" start="53032" end="53039">
                        <expr line1="558" col1="22" line2="558" col2="24" start="53032" end="53034">
                          <SYMBOL line1="558" col1="22" line2="558" col2="24" start="53032" end="53034">tab</SYMBOL>
                        </expr>
                        <OP-DOLLAR line1="558" col1="25" line2="558" col2="25" start="53035" end="53035">$</OP-DOLLAR>
                        <SYMBOL line1="558" col1="26" line2="558" col2="29" start="53036" end="53039">func</SYMBOL>
                      </expr>
                      <OP-LEFT-BRACKET line1="558" col1="30" line2="558" col2="30" start="53040" end="53040">[</OP-LEFT-BRACKET>
                      <expr line1="558" col1="31" line2="558" col2="33" start="53041" end="53043">
                        <SYMBOL line1="558" col1="31" line2="558" col2="33" start="53041" end="53043">ans</SYMBOL>
                      </expr>
                      <OP-RIGHT-BRACKET line1="558" col1="34" line2="558" col2="34" start="53044" end="53044">]</OP-RIGHT-BRACKET>
                    </expr>
                    <OP-COMMA line1="558" col1="35" line2="558" col2="35" start="53045" end="53045">,</OP-COMMA>
                    <expr line1="558" col1="37" line2="558" col2="68" start="53047" end="53078">
                      <expr line1="558" col1="37" line2="558" col2="40" start="53047" end="53050">
                        <SYMBOL_FUNCTION_CALL line1="558" col1="37" line2="558" col2="40" start="53047" end="53050">list</SYMBOL_FUNCTION_CALL>
                      </expr>
                      <OP-LEFT-PAREN line1="558" col1="41" line2="558" col2="41" start="53051" end="53051">(</OP-LEFT-PAREN>
                      <SYMBOL_SUB line1="558" col1="42" line2="558" col2="48" start="53052" end="53058">dataset</SYMBOL_SUB>
                      <EQ_SUB line1="558" col1="49" line2="558" col2="49" start="53059" end="53059">=</EQ_SUB>
                      <expr line1="558" col1="50" line2="558" col2="62" start="53060" end="53072">
                        <expr line1="558" col1="50" line2="558" col2="57" start="53060" end="53067">
                          <expr line1="558" col1="50" line2="558" col2="52" start="53060" end="53062">
                            <SYMBOL line1="558" col1="50" line2="558" col2="52" start="53060" end="53062">tab</SYMBOL>
                          </expr>
                          <OP-DOLLAR line1="558" col1="53" line2="558" col2="53" start="53063" end="53063">$</OP-DOLLAR>
                          <SYMBOL line1="558" col1="54" line2="558" col2="57" start="53064" end="53067">data</SYMBOL>
                        </expr>
                        <OP-LEFT-BRACKET line1="558" col1="58" line2="558" col2="58" start="53068" end="53068">[</OP-LEFT-BRACKET>
                        <expr line1="558" col1="59" line2="558" col2="61" start="53069" end="53071">
                          <SYMBOL line1="558" col1="59" line2="558" col2="61" start="53069" end="53071">ans</SYMBOL>
                        </expr>
                        <OP-RIGHT-BRACKET line1="558" col1="62" line2="558" col2="62" start="53072" end="53072">]</OP-RIGHT-BRACKET>
                      </expr>
                      <OP-COMMA line1="558" col1="63" line2="558" col2="63" start="53073" end="53073">,</OP-COMMA>
                      <expr line1="558" col1="65" line2="558" col2="67" start="53075" end="53077">
                        <SYMBOL line1="558" col1="65" line2="558" col2="67" start="53075" end="53077">...</SYMBOL>
                      </expr>
                      <OP-RIGHT-PAREN line1="558" col1="68" line2="558" col2="68" start="53078" end="53078">)</OP-RIGHT-PAREN>
                    </expr>
                    <OP-RIGHT-PAREN line1="558" col1="69" line2="558" col2="69" start="53079" end="53079">)</OP-RIGHT-PAREN>
                  </expr>
                </expr>
                <OP-RIGHT-BRACE line1="559" col1="5" line2="559" col2="5" start="53110" end="53110">}</OP-RIGHT-BRACE>
              </expr>
            </expr>
            <OP-RIGHT-BRACE line1="560" col1="3" line2="560" col2="3" start="53203" end="53203">}</OP-RIGHT-BRACE>
          </expr>
        </expr>
        <COMMENT line1="562" col1="3" line2="562" col2="64" start="53393" end="53454"># return the original two objects and the SingleCellExperiment</COMMENT>
        <expr line1="563" col1="3" line2="563" col2="41" start="53488" end="53526">
          <expr line1="563" col1="3" line2="563" col2="8" start="53488" end="53493">
            <SYMBOL_FUNCTION_CALL line1="563" col1="3" line2="563" col2="8" start="53488" end="53493">return</SYMBOL_FUNCTION_CALL>
          </expr>
          <OP-LEFT-PAREN line1="563" col1="9" line2="563" col2="9" start="53494" end="53494">(</OP-LEFT-PAREN>
          <expr line1="563" col1="10" line2="563" col2="40" start="53495" end="53525">
            <expr line1="563" col1="10" line2="563" col2="13" start="53495" end="53498">
              <SYMBOL_FUNCTION_CALL line1="563" col1="10" line2="563" col2="13" start="53495" end="53498">list</SYMBOL_FUNCTION_CALL>
            </expr>
            <OP-LEFT-PAREN line1="563" col1="14" line2="563" col2="14" start="53499" end="53499">(</OP-LEFT-PAREN>
            <SYMBOL_SUB line1="563" col1="15" line2="563" col2="17" start="53500" end="53502">res</SYMBOL_SUB>
            <EQ_SUB line1="563" col1="18" line2="563" col2="18" start="53503" end="53503">=</EQ_SUB>
            <expr line1="563" col1="19" line2="563" col2="21" start="53504" end="53506">
              <SYMBOL line1="563" col1="19" line2="563" col2="21" start="53504" end="53506">res</SYMBOL>
            </expr>
            <OP-COMMA line1="563" col1="22" line2="563" col2="22" start="53507" end="53507">,</OP-COMMA>
            <SYMBOL_SUB line1="563" col1="24" line2="563" col2="26" start="53509" end="53511">dds</SYMBOL_SUB>
            <EQ_SUB line1="563" col1="27" line2="563" col2="27" start="53512" end="53512">=</EQ_SUB>
            <expr line1="563" col1="28" line2="563" col2="30" start="53513" end="53515">
              <SYMBOL line1="563" col1="28" line2="563" col2="30" start="53513" end="53515">dds</SYMBOL>
            </expr>
            <OP-COMMA line1="563" col1="31" line2="563" col2="31" start="53516" end="53516">,</OP-COMMA>
            <SYMBOL_SUB line1="563" col1="33" line2="563" col2="35" start="53518" end="53520">sce</SYMBOL_SUB>
            <EQ_SUB line1="563" col1="36" line2="563" col2="36" start="53521" end="53521">=</EQ_SUB>
            <expr line1="563" col1="37" line2="563" col2="39" start="53522" end="53524">
              <SYMBOL line1="563" col1="37" line2="563" col2="39" start="53522" end="53524">sce</SYMBOL>
            </expr>
            <OP-RIGHT-PAREN line1="563" col1="40" line2="563" col2="40" start="53525" end="53525">)</OP-RIGHT-PAREN>
          </expr>
          <OP-RIGHT-PAREN line1="563" col1="41" line2="563" col2="41" start="53526" end="53526">)</OP-RIGHT-PAREN>
        </expr>
        <OP-RIGHT-BRACE line1="565" col1="1" line2="565" col2="1" start="53676" end="53676">}</OP-RIGHT-BRACE>
      </expr>
    </expr>
  </expr>
</exprlist>

